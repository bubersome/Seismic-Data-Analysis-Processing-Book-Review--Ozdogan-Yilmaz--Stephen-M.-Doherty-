$$
\begin{gathered}
\text { SBGSMC } \\
\text { DATA } \\
\text { AMATESTS }
\end{gathered}
$$

Imessing :

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0001.jpg?height=43&width=187&top_left_y=619&top_left_x=421)

$$
\text { Vointere: }
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0001.jpg?height=172&width=234&top_left_y=853&top_left_x=24)

$$
\begin{aligned}
& \text { Hivess-INSAMIONS } \\
& \text { MACBOPHMSUS }
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0001.jpg?height=171&width=232&top_left_y=855&top_left_x=744)

SOCIETH OI BNPIORATION GZORTUTECTSTS

Series: Investigations in Geophysics, Volume I Michael R. Cooper, Series Editor

# SEISMIC DATA ANALYSIS 

Processing, Inversion, and Interpretation of Seismic Data

## ÖZ YILMAZ

Volume I

Stephen M. Doherty, Editor

Society of Exploration Geophysicists

Post Office Box 702740, Tulsa, OK 74170-2740

Library of Congress Cataloging-in-Publication Data

Yilmaz, Ozdogan.

Seismic data analysis: processing, inversion, and interpretation of seismic data / $\ddot{\mathrm{Oz}} \mathrm{Yilmaz}$; Stephen M. Doherty, editor. p. cm (Investigations in geophysies; no. 10)

Rev, ed. of: Seismic data processing. 1987.

Includes bibliographical references and index.

1. Seismic prospecting Data processing. I. Doherty, Stephen M. II. Yilmaz, Özdogan. Seismic data processing. III. Title, IV. Series.

TN269.Y55 2001

$622^{\prime} .1592$-dc21

$00-033846$

ISBN 0-931830-46- $X$ (Series)

ISBN 1-56080-094-1 (Set)

ISBN 1-56080-098-4 (Volume I)

ISBN 1-56080-099-2 (Volume II)

(C)2001 Society of Exploration Geophysicists.

All rights reserved. This book in two volumes or parts hereof may not be reproduced in any form whatsoever without prior permission in writing from the publisher.

First Edition Published in 1987 with the title

Sewmtc Data Processing and

Second Edition Published in 2001 by

Society of Exploration Geophysicists

P. O. Box 702740

Tulsa, OK 74170-2740

USA

Printed in the United States of America

To Mother In Memoriam

TABLE OF CONTENTS

PREFACE TO THE FIRST EDITION

PREFACE

Volume I

INTRODUCTION

Processing of Seismic Data, 4

Inversion of Seismic Data, 10

Interpretation of Seismic Data, 18

From Seismic Exploration to Sejsmic Monitoring, 22

## Chapter 1 <br> FUNDAMENTALS OF SIGNAL PROCESSING

1.0 Introduction, 25

1.1 The 1-D Fourier Transform, 26

Analog versus Digital Signal, 28

Frequency Aliasing, 30

Phase Considerations, 34

Time-Domain Operations, 36

Convolution, 38

Crosscorrelation and Autocorrelation, 39

Vibroseis Correlation, 41

Frequency Filtering, 41

Practical Aspects of Frequency Filtering, 44

Bandwidth and Vertical Resolution, 46

Time-Variant Filtering, 48

1.2 The 2-D Fourier Transform, 48

Spatial Aliasing, 51

1.3 Worldwide Assortment of Shot Records, 67

Wave Types, 70

1.4 Gain Applications, 81

Geometric Spreading Correction, 81

Programmed Gain Control, 85

RMS Amplitude AGC, 85

Instantaneous AGC, 87

Relative Trace Balancing, 89

1,5 Basic Data Processing Sequence, 90

Preprocessing, 91

Deconvolution, 92

CMP Sorting, 93

Velocity Analysis, 93

Normal-Moveout Correction, 94

Multiple Attenuation, 94

Dip-Moveout Correction, 94

CMP Stacking, 95

Poststack Processing, 95

Migration, 95

Residual Statics Corrections, 122

Quality Control in Processing, 122

Parsimony in Processing, 124

Exercises, 150

Appendix A: A Mathematical Review of the Fourier Transform, 153
A. 1 The 1-D Fourier Transform, 153
A. 2 The $z$-Transform, 155
A. 3 The 2-D Fourier Transform, 156

References, 156

## Chapter 2 <br> DECONVOLUTION

2.0 Introduction, 159

2.1 The Convolutional Model, 162

The Convolutional Model in the Time Domain, 167

The Convolutional Model in the Frequency Domain, 170

2.2 Inverse Filtering, 171

The Inverse of the Source Wavelet, 172

Least-Squares Inverse Filtering, 173

Minimum Phase, 175

2.3 Optimum Wiener Filters, 179

Spiking Deconvolution, 180

Prewhitening, 181

Wavelet Processing by Shaping Filters, 183

Predictive Deconvolution, 185

2.4 Predictive Deconvolution in Practice, 190

Operator Length, 190

Prediction Lag, 193

Percent Prewhitening, 203

Effect of Random Noise on Deconvolution, 207

Multiple Attenuation, 209

2.5 Field Data Examples, 211

Prestack Deconvolution, 213

Signature Deconvolution, 217

Vibroseis Deconvolution, 219

Poststack Deconvolution, 222

2.6 The Problem of Nonstationarity, 222

Time-Variant Deconvolution, 227

Time-Variant Spectral Whitening, 231

Frequency-Domain Deconvolution, 233

Inverse $Q$ Filtering, 234

Deconvolution Strategies, 241

Exercises, 247

Appendix B: Mathematical Foundation of Deconvolution, 249
B. 1 Synthetic Seismogram, 249
B. 2 The Inverse of the Source Wavelet, 251
B. 3 The Inverse Filter, 252
B. 4 Frequency-Domain Deconvolution, 253
B. 5 Optimum Wiener Filters, 255
B. 6 Spiking Deconvolution, 258
B. 7 Predictive Deconvolution, 260
B. 8 Surface-Consistent Deconvolution, 262
B. 9 Inverse $Q$ Filtering, 266

References, 270

## Chapter 3 <br> VELOCITY ANALYSIS AND STATICS CORRECTIONS

3.0 Introduction, 271

3.1 Normal Moveout, 274

NMO for a Flat Reflector, 274

NMO in a Horizontally Stratified Earth, 280

Fourth-Order Moveout, 280

NMO Stretching, 283

NMO for a Dipping Reflector, 285

NMO for Several Layers with Arbitrary Dips, 287

Moveout Velocity versus Stacking Velocity, 288

3.2 Velocity Analysis, 288

The Velocity Spectrum, 292

Measure of Coherency, 295

Factors Affecting Velocity Estimates, 302

Interactive Velocity Analysis, 311

Horizon Velocity Analysis, 312

Coherency Attribute Stacks, 318

3.3 Residual Statics Corrections, 324

Residual Statics Estimation by Traveltime Decomposition, 336

Residual Statics Estimation by Stack-Power Maximization, 344

Traveltime Decomposition in Practice, 345

Maximum Allowable Shift, 346

Correlation Window, 361

Other Considerations, 362

Stack-Power Maximization in Practice, 365

3.4 Refraction Statics Corrections, 370

First Breaks, 374

Field Statics Corrections, 375

Flat Refractor, 375

Dipping Refractor, 377

The Plus-Minus Method, 377

The Generalized Reciprocal Method, 379

The Least-Squares Method, 379

Processing Sequence for Statics Corrections, 381

Model Experiments, 382

Field Data Examples, 395

Exercises, 432

Appendix C: Topics in Moveout and Statics Corrections, 437
C. 1 The Shifted Hyperbola, 437
C. 2 Moveout Stretch, 439
C. 3 Equations for a Dipping Refector, 441
C. 4 Traveltime Decomposition for Residual Statics Estimation, 442
C. 5 Depth Estimation from Refracted Arrivals, 444
C. 6 Equations for a Dipping Refractor, 445
C. 7 The Plus-Minus Times, ..... 447
C. 8 Generalized Linear Inversion of Refracted Arrivals, ..... 448
C. 9 Refraction Traveltine Tomography, ..... 453
C. $10 L_{1}$-Norm Refraction Statics ${ }_{1}$ ..... 456
References, 460
Chapter 4
MIGRATION
4.0 Introduction, 463
Exploding Reflectors, 467
Migration Strategies, 470
Migration Algorithms, 471
Migration Parameters, 474
Aspects of Input data, 475
Migration Velocities, 475
4.1 Migration Principles, 476
Kirchhoff Migration, 481
Diffraction Summation, 484
Amplitude and Phase Factors, 485
Kirchhoff Summation, $\mathbf{4 8 5}$
Finite-Difference Migration, 486
Downward Continuation, 486
Differencing Schemes, 488
Rational Approximations for Implicit Schemes, 489
Reverse Time Migration, 491
Frequency-Space Implicit Schemes, 492
Frequency-Space Explicit Schemes, 493
Frequency-Wavenumber Migration, 494
Phase-Shift Migration, 498
Stolt Migration, 500
Summary of Domains of Migration Algorithms, 501
4.2 Kirchhoff Migration in Practice, 502
Aperture Width, 502
Maximum Dip to Migrate, 509
Velocity Errors, 509
4.3 Finite-Difference Migration in Practice, 520
Depth Step Size, 521
Velocity Errors, 525
Cascaded Migration, 525
Reverse Time Migration, 530
4.4 Frequency-Space Migration in Practice, 530
Steep-Dip Implicit Methods, 535
Depth Step Size, 537
Velocity Errors, 544
Steep-Dip Explicit Methods, 549
Dip Limits of Extrapolation Filters, 549
Velocity Errors, 552
4.5 Frequency-Wavenumber Migration in Practice, 559
Maximum Dip to Migrate, 559
Depth Step Size, 566
Velocity Errors, 567
Stolt Stretch Factor, 572

Wraparound, 575

Residual Migration, 575

4.6 Further Aspects of Migration in Practice, 579

Migration and Spatial Aliasing, 581

Migration and Random Noise, 619

Migration and Line Length, 621

Migration from Topography, 626

Exercises, 626

Appendix D: Mathematical Foundation of Migration, 628
D. 1 Wavefield Extrapolation and Migration, 628
D. 2 Stationary Phase Approximations, 638
D. 3 The Parabolic Approximation, 639
D. 4 Frequency-Space Implicit Schemes, 641
D. 5 Stable Explicit Extrapolation, 644
D. 6 Optimum Depth Step, 646
D. 7 Frequency-Wavenumber Migration, 649
D. 8 Residual Migration, 651

References, 652

## Chapter 5 <br> DIP-MOVEOUT CORRECTION AND PRESTACK MIGRATION

### 5.0 Introduction, 655

Salt-Flank Reflections, 657

Fault-Plane Reflections, 657

DMO and Stacking Velocities, 657

Turning-Wave Refiections, 665

5.1 Principles of Dip-Moveout Correction, 668

Prestack Partial Migration, 670

Frequency-Wavenumber DMO Correction, 672

Log-Stretch DMO Correction, 677

Integral DMO Correction, 679

Velocity Errors, 681

Variable Velocity, 684

Turning-Wave Migration, 685

5.2 Dip-Moveout Correction in Practice, 692

Salt Flanks, 692

Fault Planes, 693

DMO and Mutiples, 705

DMO and Coherent Linear Noise, 716

Other Considerations, 716

Aspects of DMO Correction A Summary, 722

5.3 Prestack Time Migration, 725

DMO Correction and Common-Offset Migration, 728

Salt Flanks, 729

Fault Planes, 742

Common-Reflection-Point versus Common-Refection-Surface Stacking, 769

5.4 Migration Velocity Analysis, 775

Prestack Stolt Migration, 776

Common-Offset Migration of DMO-Corrected Data, 777

Prestack Kirchhoff Migration, 788

Velocity Analysis Using Common-Reflection-Point Gathers, 788

Focusing Analysis, 798

Fowler's Velocity-Independent Prestack Migration, 803

Exercises, 815

Appendix E: Topics in Dip-Moveout Correction and Prestack Time Migration, 817
E. 1 Reflection Point Dispersal, 817
E. 2 Equations for DMO Correction, 820
E. 3 Log-Stretch DMO Correction, 823
E. 4 The DMO Ellipse, 826
E. 5 Nonzero-Ofset Traveltime Equation, 827
E. 6 Prestack Frequency-Wavenumber Migration, 831
E. 7 Velocity Analysis by Wavefield Extrapolation, 833

References, 834

## Chapter 6 <br> NOISE AND MULTIPLE ATTENUATION

6.0 Introduction, 837

Coherent Linear Noise, 838

Treatment of Coherent Linear Noise by Conventional Processing, 840

Reverberations and Multiples, 843

Treatment of Reverberations and Multiples by Conventional Processing, 857

Spatially Random Noise, 876

6.1 Multiple Attenuation in the CMP Domain, 877

Periodicity of Multiples, 877

Velocity Discrimination Between Primaries and Multiples, 887

Karhunen-Loeve Transform, 887

Modeing of Multiples, 896

6.2 Frequency-Wavenumber Filtering, 898

Random Noise and Frequency-Wavenumber Filtering, 904

Statics Corrections and Frequency-Wavenumber Filtering, 905

Dip Filtering of Coherent Linear Noise, 905

Frequency-Wavenumber Multiple Attenuation, 907

6.3 The Slant-Stack Transform, 920

Physical Aspects of Slant Stacking, 920

Slant-Stack Transformation, 923

Practical Aspects of Slant Stacking, 924

Slant-Stack Parameters, 928

Time-Variant Dip Filtering, 931

Slant-Stack Multiple Attenuation, 932

6.4 The Radon Transform, 938

Velocity-Stack Transformation, 942

The Discrete Radon Transform, 943

The Parabolic Radon Transform, 944

Practical Considerations, 945

Impulse Response of the Velocity-Stack Operator, 948

Field Data Examples, 948

Radon-Transform Multiple Attenuation, 953

6.5 Linear Uncorrelated Noise Attenuation, 960

Design of Spatial Prediction Filters, 966

Field Data Examples, 966

Exercises, 976

Appendix F: Multichannel Filtering Techniques for Noise and Multiple Attenuation, 97T
F. 1 Analysis of Guided Waves, 977
F. 2 Wavefield Extrapolation in the $\tau-p$ Domain, 980
F. 3 Mathematical Foundation of the Discrete Radon Transform, 982
F. 4 Free-Surface Multiple Attenuation, 989
F. 5 Water-Bottom Multiple Attenuation, 992
F. 6 Spatial Prediction Filter, 995

References, 998

INDEX, xXv

## Volume II <br> Chapter 7 <br> 3-D SEISMIC EXPLORATION

### 7.0 Introduction, 1001

The Need for Imaging in Three Dimensions, 1003

7.1 3-D Survey Design and Acquisition, 1010

Migration Aperture, 1010

Spatial Sampling, 1017

Other Considerations, 1018

Marine Acquisition Geometry, 1018

Cable Feathering, 1019

3-D Binning, 1019

Crossline Smearing, 1020

Strike versus Dip Shooting, 1027

Land Acquisition Geometry, 1028

7.2 Processing of 3-D Seismic Data, 1030

3-D Refraction Statics Corrections, 1036

Azimuth Dependence of Moveout Velocities, 1036

3-D Dip-Moveout Correction, 1046

Inversion to Zero Offset, 1048

Aspects of 3-D DMO Correction A Summary, 1050

Velocity Analysis, 1050

3-D Residual Statics Corrections, 1050

3-D Migration, 1051

Trace Interpolation, 1065

7.3 3-D Poststack Migration, 1073

Separation versus Splitting, 1073

Inpulse Response of the One-Pass Implicit Finite-Difference 3-D Migration, 1074

Two-Pass versus One-Pass Implicit Finite-Difference 3-D Migration in Practice, 1076

Explicit Schennes Combined with the McClellan Transform, 1082

The Phase-Shift-Plus-Correction Method, 1088

7.4 3-D Prestack Time Migration, 1099

3-D DMO Correction Combined with 3-D Common-Offset Migration, 1112

Crossline Migration, 1129

3-D Migration Velocity Analysis, 1131

Aspects of 3-D Prestack Time Migration - A Summary, I137

7.5 Interpretation of 3-D Seismic Data, 1156

Time Slices, 1156

3-D Visualization, 1156

Removal of Opacity, 1158

Seed Detection, 1159

Structural Interpretation, 1161

Stratigraphic Interpretation, I171

Exercises, 1195

Appendix G: Mathematical Foundation of 3-D Migration, 1198
G. 1 Implicit Methods, 1198
G. 2 Explicit Methods, 1200
G. 3 3-D Phase-Shift Migration, 1203
G. 4 3-D Stolt Migration, 1204
G. 5 Trace Interpolation, 1204
G. 6 3-D Nonzero-Offset Traveltime Equation, 1208

References, 1209

## Chapter 8 <br> EARTH IMAGING IN DEPTH

### 8.0 Introduction, 1213 <br> Lateral Velocity Variations, 1222

8.1 Layer Replacement, 1226

Wave-Equation Datuming, 1229

Poststack Layer Replacement, 1230

Prestack Layer Replacement, I231

Field Data Example, 1237

8.2 2-D Poststack Depth Migration, 1238

Image Rays and Lateral Velocity Variations, 1238

Time versus Depth Migration, 1244

Iterative Depth Migration, 1247

Iteration with Zero-Offset Data, 1250

Iteration with CMP-Stacked Data, 1258

Iteration with Prestack Data, 1265

Iteration in Practice, 1265

8.3 2-D Prestack Depth Migration, 1273

Shot-Geophone Migration, 1274

Shot-Profile Migration, 1280

Sensitivity of Image Accuracy to Velocity Errors, 1280

Field Data Examples, 1295

8.4 3-D Poststack Depth Migration, 1304

3-D Poststack Time versus Depth Migration, 1304

Two-Pass versus One-Pass 3-D Poststack Depth Migration, 1313

Implicit versus Explicit 3-D Poststack Depth Migration, 1314

3-D Poststack Datuming, 1321

8.5 3-D Prestack Depth Migration, 1321

Kirchhoff Summation, 1324

Calculation of Traveltimes, 1324

The Eikonal Equation, 1325

Fermat's Principle, 1331

Summation Strategies, 1331

Migration Aperture, 1333

Operator Antialiasing, 1333

3-D Common-Ofiset Depth Migration, 1335

Exercises, 1342

Appendix H: Diffraction and Ray Theory for Wave Propagation, 1342

H. 1 The Kirchhoff Integral, 1342

H. 2 The Eikonal Equation, 1346

H. 3 Finite-Difference Solution to the Eikonal Equation, 1349

References, 1351

## Chapter 9 <br> EARTH MODELING IN DEPTH

9.0 Introduction, ..... 1353
Inversion Methods for Data Modeling, 135
Inversion Procedures for Earth Modeling, 1356
Velocity-Depth Ambiguity, ..... 1357
Model Representation and Visualization, ..... 1360
9.1 Models with Horizontal Layers, ..... 1365
Dix Conversion, ..... 1365
Coherency Inversion, ..... 1369
Near-Surface Layer with Laterally Varying Velocities, ..... 1382
9.2 Model with Low-Relief Structure, 138
Stacking Velocity Inversion, 1392
Coherency Inversion, 1404
Velocity Resolution, 1404
9.3 Model with Complex Overburden Structure, 1404
Image-Gathers, 1406
Constant Half-Space Velocity Analysis, ..... 1415
9.4 Model Building, 1415
Time-to-Depth Conversion, I416
Time Structure Maps, ..... 1416
Interval Velocity Maps, ..... 1417
Depth Structure Maps, 142
Calibration to Well Tops, ..... 1426
Layer-by-Layer Inversion, ..... 1433
Structure-Independent Inversion, 1 ..... 1450
9.5 Model Updating, ..... 1450
Residual Moveout Analysis, 1462
Reflection Traveltime Tomography, 1469
Limitations in Resolving Velocity-Depth Ambiguity by Tomography, 1479
Turning-Ray Tomography, 1512
Exercises, 1524
Appendix J: Data Modeling by Inversion, 1525
J. 1 The Generalized Linear Inversion, 1525
J. 2 The GLI Formalisn of Deconvolution, 1526
J. 3 Applications of the GLI Technique, 1530
J. 4 Dix Conversion, 1534
J. 5 Map Processing, 1539
J. 6 Reflection Traveltime Tomography, 1545
J.7 Threshold for Velocity-Depth Ambiguity, 1553
References, 1554
Chapter 10
STRUCTURAL INVERSION
10.0 Introduction, 1557
10.1 Subsalt Imaging in the North Sea, ..... 1558
Estimation of the Overburden Model, 1562
Estimation of the Substratum Model, 1562
Model Verification, 1563
10.2 Subsalt Imaging in the Gulf of Mexico, 1574
Layered Earth Model Estimation, 1574

Structure-Independent Model Estimation, 1577

10.3 Imaging Beneath Irregular Water Bottom in the Northwest Shelf of Australia, 1597

Earth Modeling and Innaging in Depth, I597

10.4 Imaging Beneath Volcanics in the West of Shetlands of the Atlantic Margin, 1597 Earth Modeling and Imaging in Depth, 1607

10.5 Imaging Beneath Shallow Gas Anomalies in the Gulf of Thailand, 1620 Earth Modeling and Imaging in Depth, 1620

10.6 3-D Structural Inversion Applied to Seismic Data from the Southern North Sea, 1626 Estimation of the Overburden Model, 1626

Model Representation by Tessellation, 1630

3-D Coherency Inversion, 1630

3-D Poststack Depth Migration, 1637

Estimation of the Substratum Model, 1638

10.7 3-D Structural Inversion Applied to Seismic Data from the Central North Sea, 1651

3-D Coherency Inversion Combined with 3-D Poststack Depth Migration, 1665

3-D Stacking Velocity Inversion Combined with 3-D Image-Ray Depth Conversion, 1674

10.8 3-D Structural Inversion Applied to Seismic Data from Offshore Indonesia, 1674

Model Building, 1678

Model Updating, 1678

Imaging in Depth, 1690

Volume-Based Interpretation, 1690

10.9 3-D Structural Inversion Applied to Seismic Data from the Northeast China, 1703

3-D DMO Processing, 1720

3-D Prestack Time Migration, 1720

From RMS to Interval Velocities, 1742

Structural Inversion, 1742

Structural and Stratigraphic Interpretation, 1744

Exercises, 1778

Appendix K: Seismic Modeling, 1779
K. 1 Zero-Ofset Traveltime Modeling 1779
K. 2 Zero-Offset Wavefield Modeling, 1781
K. 3 Nonzero-Offset Wavefield Modeling, 1781
K. 4 Elastic Wavefield Modeling, 1790

References, 1792

## Chapter 11 RESERVOIR GEOPHYSICS

11.0 Introduction, 1793

Elastic Waves and Rock Properties, 1794

11.1 Seismic Resolution, 1801

Vertical Resolution, 1801

Lateral Resolution, 1803

11.2 Analysis of Amplitude Variation with Offset, 1807

Reflection and Refraction, 1808

Reflector Curvature, 1813

AVO Equations, 1816

Processing Sequence for AVO Analysis, 1839

Derivation of AVO Attributes by Prestack Amplitude Inversion, 1851

Interpretation of AVO Attributes, 1862

3-D AVO Analysis, 1863

11.3 Acoustic Impedance Estimation, 1863

Synthetic Sonic Logs, 1864

Processing Sequence for Acoustic Impedance Estimation, 1865

Derivation of Acoustic Impedance Attribute, 1866

3-D Acoustic Impedance Estimation, 1872

Instantaneous Attributes, 1896

11.4 Vertical Seisinic Profiling, 1907

VSP Acquisition Geometry, 1907

Processing of VSP Data, 1907

VSP-CDP Transform, 1908

11.5 4-D Seismic Method, 1911

Processing of 4-D Seismic Data, 1912

Seismic Reservoir Monitoring, 1913

11.6 4-C Seismic Method, 1915

Recording of 4-C Seismic Data, 1919

Gaiser's Coupling Analysis of Geophone Data, 1922

Processing of PP Data, 1926

Rotation of Horizontal Geophone Components, 1926

Common-Conversion-Point Binning, 1933

Velocity Analysis of PS Data, 1946

Dip-Moveout Correction of PS Data, 1959

Migration of PS Data, 1961

11.7 Seismic Anisotropy, 1961

Anisotropic Velocity Analysis, 1965

Anisotropic Dip-Moveout Gorrection, 1968

Anisotropic Migration, 1980

Effect of Anisotropy on AVO, 1998

Shear-Wave Splitting in Anisotropic Media, 1999

Exercises, 2000

Appendix L: Mathematical Foundation of Elastic Wave Propagation, 2001
L. 1 Stress-Strain Relation, 2001
L. 2 Elastic Wave Equation, 2007
L. 3 Seisnic Wave Types - Body Waves and Surface Waves, 2008
L. 4 Wave Propagation Phenomena Diffraction, Reflection, and Refraction, 2012
L. 5 The Zoeppritz Equations, 2014
L. 6 Prestack Amplitude Inversion, 2019

References, 2024

INDEX, XXV

## PREFACE TO THE FIRST EDITION

The seismic method plays a prominent role in the search for hydrocarbons. Seismic exploration consists of three main stages: data acquisition, processing, and interpretation. This book is intended to help the seismic analyst understand the fundamentals of the techniques used in processing seismic data. In particular, emphasis is given to the practical aspects of data analysis.

Topics in this book are treated in two phases. First, each process is described from a physical viewpoint, with less emphasis on mathematical development. In doing so, geometric means are used extensively to help the reader gain the physical insight into the different processes. Second, the geophysical parameters that affect the fidelity of the resulting output from each process are critically examined via an extensive series of synthetic and real data examples. For the student of reflection seismology and new entrants to the seismic industry, this book tries to provide insights into the practical aspects of the application of the theory of time series and waves. For experienced seismic explorationists, this book should serve as a refresher and handy reference. However, it is not just meant for the seismic analyst. Explorationists who would like to gain a practical background in seismic data processing without any mathematical burden also should benefit from it. Nevertheless, for the more theoretically inclined, a mathematical treatise on the main subjects is provided in the appendixes.

The seismic analyst is confronted daily with the important tasks of:

(1) selecting a proper sequence of processing steps appropriate for the field data under consideration,

(2) selecting an appropriate set of parameters for each processing step, and

(3) evaluating the resulting output from each processing step, then diagnosing any problems caused by improper parameter selection.
There is a well-established sequence for standard seimic data processing. The three principal processes deconvolution, stacking, and migration make up the foundation of routine processing. There also are some auxiliary processes that help improve the effectiveness of the principle processes. Questions often arise as to the kind of auxiliary processes that should be used and when they should be applied. For example, if shot records contain an abundance of source-generated coherent noise, then dip filtering may be valuable before deconvolution. Beam steering may be necessary to improve the signal-to-noise ratio while reducing the number of channels in processing by a factor of as much as four. Residual statics corrections often are required for improving velocity estimation and stacking. In a daily production environment, many questions arise concerning the optimal parameter selection for each process. Some of the most repeatedly asked questions are: What is a good length for the deconvolution operator? What should the prediction lag be? What should the design gate for the operator be? How should the correlation window be chosen in residual statics computations? What kind of aperture width should one select in Kirchoff migration? What is the optimum depth step size in finite-difference migration? Many more questions could be included in this list of questions. To help answer these questions, a large number of examples using both field and synthetic data and describing a wide range of processing parameters are provided.

Since the old adage "a picture is worth a thousand words" is especially apt in a discussion of seismic data processing, figures make up the major portion of this textbook. In preparing some of the figures, I received great assistance from my colleagues at Western Geophysical Company. Thanks are due to Darran Lucas, Mike Cox, Greg Godkin, Dave Nichols, Tania Bachus, Tomaso Gabrieli, Dave Hill, and Raphael Tortosa.

Thanks also are due to the oil companies and contractors for supplying data and some figures for which specific acknowledgment is made in the figure captions. I express my deep appreciation to: Soraya Brombacher, Mark Wilson, Wayne Johnson, Mike Jungnickel, and Pam Jakubowicz for the artwork on most of the figures. I also extend my appreciation to Meg LaVergne, who put the final touches on many figures and computerdrafted the flow diagrans. Thanks also to the members of the playback group at Western's London Digital Center: Stephen Blick, John Byrne, Mike Byrne, Chris Godsave, Steven Grace, and Tony Leventis. Sally Humphreys, Jan Mitchell, and Vivian Millson helped key the text into the word processor.

I acknowledge with great appreciation the review work done by Jon Claerbout, Sven Treitel, John Sherwood, Fred Hilterman, and Greg Godkin. I also thank the following individuals who participated in reviewing parts of the earlier drafts: Ron Chambers, Aftab
Alam, Bruce Cassell, Karl Millahn, Tony Kudrna, Dave Brown, Darko Tufekcic, Pete Bibby, John Ferguson, Mark Doyle, Wendell Wiggins, Jeff Resnick, Walt Lynn, Bill Dragoset, Mai Yang, Patrick Ng, Steve Cole, Larry Scott, Ken Larner, and Helmut Jakubowicz. Special thanks are due to Diane Parker, who did an outstanding job of editing for style, proofreading, and preparing the camera-ready copy of the book. Thanks to Lynn Griffin for helping to bring the text up to the SEG standards of publication. Special thanks also are due to my editor, Steve Doherty, for his excellent and comprehensive review, I also appreciate his valuable recommendations in revising the text and the help he provided in bringing clarity to the text. I extend my deepest and wholehearted appreciation to my wife, Hulya, for her everlasting encouragement. And finally, thanks are due to Western Geophysical Company of America for the support provided to me in writing this textbook.

## PREFACE

The first edition, entitled Seismuc Data Processing, was published in 1987 by the Society of Exploration Geophysicists. Thereafter, I began to work on the second edition almost immediately. My objective was to capture continuously the new developments that were taking place in the seismic industry. The second edition is the culmination of this continuous update over the past ten years. The updating process was based on exhaustive model- and real-data experiments with the results of the research and development work of my own and many others. I have also drawn an extensive and demonstrative set of real-data examples from the numerous case studies that I conducted during the course of the update. Another source of update was of course the prolific literature on exploration seismology.

This second edition embodies the broad scope of seismic data analysis - processing, inversion, and interpretation of seismic data. I shall give a brief summary of the most important new developments in seismic data analysis during the past 15 years. To begin with, the 3-D seismic method took a centrally dominant position in the exploration and development of oil and gas fields. Algorithms for 3-D seismic data processing, including 3-D dip-moveout correction, 3-D refraction and residual statics corrections, and 3-D migration have now become an integral part of the applications library of the seismic data processing systems in use today. Additionally, noise attenuation based on prediction filtering is now applied routinely to seismic data. Techniques for multiple attenustion based on the Radon transform and wave extrapolation have been successfully demonstrated on field data.

Shortly after 3-D migration, we also began to image the subsurface before stacking. Efficient workfiows for 3 -D prestack time migration are in use today not only to image the subsurface more accurately in the presence of conflicting dips with different stacking velocities but also to generate common-reflection-point gathers that can be used to perform prestack amplitude inversion and thus obtain attributes associated with amplitude variations with offset. 3 -D prestack time migration also paves the way for estimating a $3-\mathrm{D} \mathrm{rms}$ velocity field that can be used to perform Dix conversion and thus obtain a 3-D interval velocity field.

Concurrent with prestack imaging, we began to image the subsurface also in depth to account for strong lateral velocity variations. During the last decade, years of effort in research and development conducted in previous decades have led to practical inversion methods for earth modeling and imaging in depth. Using appropriate inversion methods, we derive a seismic representation of an earth model in depth, described by two sets of parameters layer velocities and reflector geometries, for low-relief, complex, and complex overburden structures. The power of 3-D visualization has given us the ability to create an earth model in depth with the accuracy needed to image in depth, and that within an efficient work schedule. Additionally, the rapid growth in computer power has enabled us to generate an earth image in depth from 3-D prestack depth migration of large data volumes, again within acceptable work schedules.

To get the most out of the image volumes derived from 3-D prestack time and depth migrations, we now make extensive use of $3-D$ visualization in seismic interpretation. Using a volume-based interpretation strategy, not only do we pick time or depth horizons to delineate the structural model of the subsurface, but we also make use of the seismic amplitudes to infer the depositional model of the subsurface.

The road ahead for exploration seismology includes three main topics 4-D seismic method, 4-C seismic method, and anisotropy, all aimed at seismic characterization of oil and gas reservoirs and eventually monitoring their depletions. By recording 3-D seismic data over the field that is being developed and produced at appropriate time intervals, we may detect changes in the reservoir conditions, such as fluid saturation and
pore pressure. Such changes may be related to changes in the seismic amplitudes from one 3-D survey to the next. Time-lapse 3-D seismic monitoring of reservoirs is referred to as the 4-D seismic method. The fourth dimension represents the calendar time over which the reservoir is being monitored. Potential applications of the 4-D seismic method include monitoring the spatial extent of the steam front following in-situ combustion or steam injection used for thermal recovery, monitoring the spatial extent of the injected water front used for secondary recovery, imaging bypassed oil, determining flow properties of sealing or leaking faults, and detecting changes in oil-water contact.

Some reservoirs can be identified and monitored better by using shear-wave data. For instance, acoustic impedance contrast at the top-reservoir boundary may be too small to detect, whereas shear-wave impedance contrast may be sufficiently large to detect. By recording multicomponent data at the ocean bottom, $P$-wave and $S$-wave images can be derived. Commonly, four data components are recorded the pressure wave-field and inline, crossline, and vertical components of particle velocity. Thus, the multicomponent seismic data recording and analysis is often referred to as the 4$C$ seismic method. Potential applications of the 4-C sejsmic method include imaging beneath gas plumes, salt domes, and basalts, delineating reservoir boundaries with a higher $S$-wave impedance contrast than $P$-wave impedance contrast, differentiating sand from shale, detection of fluid phase change from oil-bearing to water-bearing sands detection of vertical fracture orientation, mapping hydrocarbon saturation, and mapping oil-water contact.

Until recently, exploration sejsmology at large has been based on the assumption of an isotropic medium, albeit we have been cognizant of anisotropic behavior of reservoir rocks. Seismic anisotropy often is associated with directional variations in velocities. For instance, in a vertically fractured limestone reservoir, velocity in the fracture direction is lower than velocity in the direction perpendicular to the plane of fracturing, giving rise to azimuthal anisotropy. Another directional variation of velocities involves horizontal layering and fracturing of rocks parallel to the layering. In this case, velocity in the horizontal direction is higher than the vertical direction, giving rise to transverse isotropy.

In addition to a continuing effort to improve the existing 3-D time- and depth-domain applications, current research and development in seismic data analysis is focused on time- and depth-domain analysis of 4-D and 4-C seismic data while accounting for anisotropy.

Topics in this book are organized to reflect the increasing degree of complexity in the data analysis and the progress made in exploration seismology. Volume
I is devoted to $2-\mathrm{D}$ conventional processing based on the three principle processes deconvolution, stacking, and migration. Volume I is devoted to topics beyond 2-D conventional processing 3-D seismic exploration, seismic inversion for earth modeling and imaging in depth, 4-D seismic method, 4-C seismic method, and anisotropy. Each chapter is accompanied by an appendix that includes a mathematical treatise of selected topics from the chapter itself. As such, practical aspects of seismic data analysis are treated within the chapters themselves without the burden of the theoretical details.

When used as a textbook in a university, I recommend Volume I for a first-semester senior-level course and Volume II for a second-semester senior-level course or a first-year graduate course. Optionally, you may consider an additional one-semester senior- or graduatelevel course on the applied theory of exploration seismology besed on primarily the appendixes.

If you are a seismic analyst using this book as a reference, you can study the practical aspects of seismic data analysis in relation to the projects you are conducting to get helpful hints on the algorithms and workflows. If you are a research geophysicist using this book as a reference, you can study the practical aspects of a specific application of interest to get helpful hints on what assumptions can be made in relation to that application. Also, you can study the appendixes to initiate yourself into the basic theory on the subject of your interest.

I have a passion for the seismic method that I have maintained throughout my career. While the source of this passion is indisputably my teacher and life-long friend, Jon Claerbout, I have been very fortunate to have worked with some of the most talented individuals who have fueled my enthusiasm for exploration seismology. Most appropriately, I wish to express here my heartful gratitudes to each of these individuals.

To begin with, I am deeply grateful to Steve Doherty, my technical editor and life-long friend, for his incisive, meticulous, and prompt editing of this entire work. Steve's editing brought clarity and precision to the text. He was also the editor of the first edition; on that occasion and now, he gracefully shared the experience with me. Thank you, Steve, for your dedication and effort. As part of the technical editing, I also received great assistance from Zhiming $\mathrm{Li}$, who edited Appendices A through J, Joe Stefani who edited Appendix L, and John Toldi who edited Chapter 11. I thank ail of you wholeheartedly for your careful editing of the text $\mathrm{t}_{\mathrm{z}}$ debugging the equations, and introducing clarity to derivations.

Next, I wish to express my sincere gratitude to Judy Hastings, my technical copy editor, for her impressively consistent editing of the entire manuscript
and her diligence in keeping me on schedule. Thank you, Judy, also for your graceful handling of my frustrations with thes and as. I wish to extend my thanks to Ted Bakamjian, Publications Manager of SEG, for his sup port and excellent coordination of the tasks involved in the publication process.

Now I wish to extend my special thanks to Cyril Gregory, Irfan Tanritanir, Ferudun Kilic, Orhan Yilmaz, Fugen Zhou, Ma Xae Ling, and Huseyin Ozdemir, who helped me with several of the case studies, and model- and real-data experiments. Specifically, Cyril helped me create the case studies for my 1996 SEG Distinguished Lecture Tour; these case studies are included in Chapter 10. Cyril has been involved in many of the projects over the past ten years associated with this work. Irfan, Ferudun, and Fugen all worked with me on several case studies which are also included in Chapter 10. Orhan did the processing of the 4-C data presented in Chapter 11. I feel very fortunate to have had such exceptionally talented individuals helping me to bear the burden.

I wish to extend my special thanks to David Lumley, 4th Wave Imaging, and Chevron for contributing examples to the section on 4-D seismic method. I wish to express my sincere appreciation to Moshe Reshef for creating some of the synthetic data sets I used in my experiments described in Chapters 3 and 8 . Likewise, I extend my sincere gratitude to Evgeny Landa for cre- ating the synthetic data sets I used in my experiments described in Chapter 9. Extending the list, I express my thanks to Ed Crase, Chris Taylor, Dave Nichols, Duane Dopkin, Gerald Kidd, Rob Bond, Cerys Biancardi, Davud Babayev, and Lee Bell for providing examples or helping me create them. I am sure that I am unable to recall many of the names associated with the update going back ten years; I thank all of you most sincerely.

I am very grateful to Chevron, Mobil, Britannia, Talisman, Husky Oil, BP-Amoco, Shell, AGIP, Total, BHP, Gulf Canada, ONGC, Shengli Oil Field of CNPC, Saudi Aramco, and many other companies who may or may not have preferred to be anonymous for providing field dat a that enabled me to conduct my experiments.

I wish to sincerely thank Damir Skerl and Western Geophysical, Rutt Bridges and Landmark, Schlumberger Geco-Prakla, Walt Lynn and PGS, and especially Eldad Weiss and Paradigm Geophysical for their most invaluable support and encouragement in my quest to complete this work.

And now the last word, but a special tribute to my wife, Hulya, and my son, Esen. I am wholeheartedly grateful to you both for your enduring love and support. This work undoubtedly demanded sacrifice; and it was definitely a sacrifice on your part. You demanded very little of me, and you gave the whole of your love to me. I shall cherish it all my life.

## INTRODUCTION

## - Processing of Seismic Data - Inversion of Seismic Data - Interpretation of Seismic Data

- From Seismic Exploration to Seismic Monitoring

The Classtcal Greeks had a love for wisdom It came down to us as philo sophta.

And I have a passion for the seismic method Let this be an ode to philo setsmos. $O$ how sweet it is Listening to the echos from the earth.

The seismic method has three principal applications:

(a) Delineation of near-surface geology for engineering studies, and coal and mineral exploration within a depth of up to $1 \mathrm{~km}$ : The seismic method applied to the near-surface studies is known as engineerng seismology.

(b) Hydrocarbon exploration and development within a depth of up to $10 \mathrm{~km}$ : The seismic method applied to the exploration and development of oil and gas fields is known as exploration seismology.

(c) Investigation of the earth's crustal structure within a depth of up to $100 \mathrm{~km}$ : The seismic method applied to the crustal and earthquake studies is known as earthquake sersmology.

This book is devoted to application of the reflection seismic method to the exploration and development of oil and gas fields.

Conventional processing of reflection seismic data yields an earth image represented by a seismic section which usually is displayed in time. Figure I-1 shows a seismic section from the Gulf of Mexico, nearly $40 \mathrm{~km}$ in length. Approximate depth scale indicates a sedimentary section of interbedded sands and shales down to 8 $\mathrm{km}$. Note from this earth image a salt sill embedded in the sedimentary sequence. This allocthonous salt sill has a rugose top and a relatively smooth base. Note the folding and faulting of the sedimentary section above the salt.

The reflection seisnic method has been used to delineate near-surface geology for the purpose of coal and mineral exploration and engineering studies, especially in recent years with increasing acceptance. Figure I-2a shows a seismic section along a $500-\mathrm{m}$ traverse across a bedrock valley with steep flanks. The lithologic column based on borehole data indicates a sedimentary sequence of clay, sand, and gravel deposited within the valley. The bedrock is approximately $15 \mathrm{~m}$ below the surface at the fringes of the valley and $65 \mathrm{~m}$ below the surface at the bottom of the valley. The strong reflection at the sediment-bedrock boundary is a result of the contrast between the low-velocity sediments above and the high-velocity Precambrian quartz pegmatite below.

The reflection seismic method also has been used to delineate the crustal structure down to the Moho

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0023.jpg?height=1034&width=762&top_left_y=167&top_left_x=180)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0024.jpg?height=312&width=758&top_left_y=118&top_left_x=134)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0024.jpg?height=658&width=585&top_left_y=483&top_left_x=222)

(b)

FIG. 1-2. (a) A shallow reflection seismic section from Ontario (Pullan and Hunter, 1990), and (b) a deep reflection selsmic section from southeast Turkey (Yilmaz, 1976).
discontinuity and below. Figure I-2b shows a seismic section recorded on land along a $15-\mathrm{km}$ traverse. Based on regional control, it is known that the section consists of sediments down to about $4 \mathrm{~km}$. The reflection event at $6.5-7 \mathrm{~s}$, which corresponds to a depth range of $15-20$ $\mathrm{km}$, can be postulated as the crystalline basement. The group of reflections between 8-10 s, which corresponds to a depth range of $25-35 \mathrm{~km}$, represents a transition zone in the lower crust most likely, the Moho discontinuity, itself.

Common-midpoint (CMP) recording is the most widely used seismic data acquisition technique. By providing redundancy, measured as the fold of coverage in the seismic experiment, it improves signal quality. Figure I-3 shows seismic data collected along the same traverse in 1965 with single-fold coverage and in 1995 with twelve-fold coverage. These two different vintages of data have been subjected to different treatments in processing; nevertheless, the fold of coverage has caused the most difference in the signal level of the final sections.

Seismic data processing strategies and results are strongly affected by field acquisition parameters. Additionally, surface conditions have a significant, impact on the quality of data collected in the field. Part of the seismic section shown in Figure I-4 between midpoints $A$ and $B$ is over an area covered with karstic limestone. Note the continuous reflections between 2 and 3 s outside the limestone-covered zone. These reflections abruptly disappear under the problem zone in the middle. The lack of events is not the result of a subsurface void of reflectors. Rather, it is caused by a low signal-tonoise (S/N) ratio resulting from energy scattering and absorption in the highly porous surface limestone.

Surface conditions also have an infuence on how much energy from a given source type can penetrate into the subsurface. Figure I-5 shows a seismic section along a traverse over a karstic topography with a highly weathered near-surface. In data acquisition, surface charges have been used to the right of midpoint $A$, and charges have been placed in holes to the left of midpoint $A$. In the absence of source coupling using surface charges, there is very little energy that can penetrate into the subsurface through the weathered near-surface layer. As a result, note the lack of coherent reflections to the right of midpoint $A$. On the other hand, improved source coupling using downhole charges has resulted in better penetration of the energy into the subsurface in the remainder of the section.

Besides surface conditions, environmental and demographic restrictions can have a significant impact on field data quality. The part of the seismic section shown in Figure I-6 between midpoints A and B is through a village. In the village, the vibroseis source was not operated with full power. Hence, not enough energy penetrated into the earth. Although surface conditions were similar along the entire line, the risk of property damage resulted in poor signal quality in the middle portion of the line.

Other factors, such as weather conditions, care taken dusing recording, and the condition of the recording equipment, also influence data quality. Almost always, seismic data are collected often in less-than-ideal conditions. Hence, we can only hope to attenuate the noise and enhance the signal in processing to the extent allowed by the quality of the data acquisition.

In addition to field acquisition parameters, seisrnic data processing results also depend on the techniques used in processing. A conventional processing sequence almost always includes the three principal processes deconvolution, CMP stacking, and migration.

## Processing of Seismic data

We begin with a review of the fundamentals of digital signal processing in Chapter 1. Seismic data recorded in digital form by each channel of the recording instrument are represented by a time series. Processing algorithms are designed for and applied to either singlechannel time series, individually, or multichannel time series. The Fourier transform constitutes the foundation of much of the digital signal processing applied to seismic data. Aside from sections on the one- and twodimensional Fourier transforms and their applications, Chapter 1 also includes a section on a worldwide assortment of recorded seismic data. By referring to the field data examples, we examine characteristics of the seismic signal primary reflections from layer boundaries and random and coherent noise such as multiple reflections, reverberations, linear noise associated with guided waves and point scatterers. Chapter 1 concludes with a section on the basic processing sequence and guidelines for quality control in processing.

The next three chapters are devoted to the three principal processes deconvolution, CMP stacking, and migration. We study deconvolution in Chapter 2. Deconvolution often improves temporal resolution by collapsing the seismic wavelet to approximately a spike and suppressing reverberations on some field data (Figure I-7). The problem with deconvolution is that the accuracy of its output may not always be self-evident unless it can be compared with well data. The main reason for this is that our model for deconvolution is nondeterministic in character.

We study the second principal process, CMP stacking in Chapter 3 with the accompanying subjects on velocity analysis, normal-moveout (NMO), and statics
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0026.jpg?height=968&width=846&top_left_y=118&top_left_x=94)

FIG. I-3. (a) A single-fold section obtained in 1965, and (b) a twelve-fold section obtained in 1995 along the same line traverse. (Data courtesy Turkish Petroleum Corp.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0027.jpg?height=445&width=861&top_left_y=124&top_left_x=91)

FIG. 1-4. The poor signal between midpoints $\mathrm{A}$ and $\mathrm{B}$ on this seismic section is caused by a karstic limestone on the surface.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0027.jpg?height=445&width=842&top_left_y=698&top_left_x=92)

FIG. I-5. The lack of coherent reflections to the right of midpoint $A$ on this seismic section results from the surface charges used during recording. By using charges placed in holes below the karstic limestone in the near surface, signal penetration has been improved to the left of midpoint A)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0028.jpg?height=494&width=874&top_left_y=114&top_left_x=79)

FIG. I-6. A village is situated between midpoints $A$ and $B$. The poor signal in that zone of the selsmic section is caused by operating the vibroseis source at low power.

corrections. Common-midpoint stacking is the most tobust of the three principal processes. By using redundancy in CMP recording, stacking can attenuate uncorrelated noise significantly, thereby increasing the $\mathrm{S} / \mathrm{N}$ ratio (Figure I-3). It also can attenuate a large part of the coherent noise in the data, such as guided waves and multiples.

The normal moveout (NMO) correction before stacking is done using the primary velocity function. Because multiples have larger moveout than primaries, they are undercorrected and, hence, attenuated during stacking (Figure I-8).

The main problem with CMP stacking is that it is based on the hyperbolic moveout assumption. Although it may be violated in areas with severe structural complexities, seismic data acquired in many parts of the world seem to satisfy this assumption reasonably well.

Data acquired on land must be corrected for elevation differences at shot and receiver locations and traveltime distortions caused by a near-surface weathering layer. The corrections usually are in the form of vertical traveltime shifts to a flat datum level (statics corrections). Because of uncertainties in near-surface model estimation, there always remains some residual statics which need to be removed from data before stacking (Figure I-9).
Finally, we study the third principal process, migration, in Chapter 4. Migration collapses diffractions and moves dipping events to their supposedly true subsurface locations (Figure I-10). In other words, migration is an imaging process. Because it is based on the wave equation, migration also is a deterministic process. The migration output often is self-evident you can tell whether the output is migrated properly. When the output is not self-evident, this uncertainty often can be traced to the imprecision of the velocity information available for input to the migration program. Other factors that influence migration results include type of input data two-dimensional (2-D) or three-dimensional (3-D), migration strategies - time or depth, post- or prestack, and algorithms and associated parameters. Two-dimensional migration does not correctly position events with 3 -D orientation in the subsurface. Note the accurate imaging of the erosional unconformity (event A) in Figure I-10. However, this event is intercepted by event B which is most likely associated with the same unconformity, only that it is out-of-the-plane of recording along the line traverse.

Events with conflicting dips require an additional step dip-moveout (DMO) correction, prior to CMP stacking (Figure I-11). Dip-moveout correction is the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0029.jpg?height=627&width=817&top_left_y=126&top_left_x=106)

FIG. I-7. A selsmic section whthout (top) and with (botton) deconvolution. Note the improved vertical resolution on the deconvolved section as a result of wavelet compression and removal of reverberations. (Data courtesy Enterprise Oil.)

subject for Chapter 5. Conflicting dips with different stacking velocities often are associated with fault blocks and salt flanks. Specifically, the moveout associated with steeply dipping fault-plane reflections or reflections off a salt flank is in conflict with the moveout associated with reflections from gently dipping strata. Foliowing NMO correction, DMO correction is applied to data so as to preserve events with conflicting dips during stacking. Migration of a DMO stack then yields an improved image of fault blocks (Figure I-11) and salt flarks (Figure I-1).

The rigorous solution to the problem of conflicting dips with different stacking velocitjes is migration before stack. Because this topic is closely related to DMO correction, it also is covered in Chapter 5.

We study in Chapter 6 various techniques for attenuating random noise, coherent noise, and multiple reflections. Techniques to attenuate random noise ex- ploit part of the signal uncorrelated from trace to trace. Techniques to attenuate coherent linear noise exploit the linearity in the frequency-wavenumber and slantstack domains. Finally, techniques to attenuate multiples exploit their periodicity in the common-midpoint, slent-stack and velocity-stack domains. Multiples also can be attenuated by using techniques that exploit the velocity discrimination between primaries and multiples in the same domains.

After reviewing the fundamentals of signal processing (Chapter 1), studying the three principal processes - deconvolution (Chapter 2), CMP stacking (Chapter 3) and migration (Chapter 4), and reviewing dipmoveout correction (Chapter 5 ) and the noise and multiple attenuation techniques (Chapter 6 ), we then move on to processing of 3-D seismic data in Chapter 7. The principal objective for 3-D seismic exploration is to obtain an earth image in three dimensions. Clearly, all

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0030.jpg?height=525&width=847&top_left_y=116&top_left_x=95)

FIG. I-8. Three CMP gathers before (left) and after (right) NMO correction. Note that the primaries have been flattened and the multiples have been undercorrected after NMO correction. As a result, multiple energy has been attenuated on the stacked section (center) relative to prinary energy. (Data courtesy Petro-Canada Resources.)

of the 2-D processing techniques covered in Chapters 1 through 6 are either directly applicable to 3 -D seismic data or need to be extended to the third dimension, such as migration and dip-moveout correction.

There is a fundamental problem with seismic data processing. Even when starting with the same raw data, the result of processing by one organization seems to be different from that of another organization. The example shown in Figure I-12 demonstrates this problem. The same data have been processed by six different contractors. Note the significant differences in frequency content, S/N ratio, and degree of structural continuity from one section to another. These differences often stem from differences in the choice of pararneters and the detailed aspects of implementation of processing algorithms. For example, all the contractors have applied residual statics corrections in generating the sections in Figure I-12. However, the prograns each contractor has used to estimate residual statics most likely differ in the handling of the correlation window, selecting the traces used for crosscorrelation with the pilot trace, and statistically treating the correlation peaks.
One other aspect of seismic data processing is the generation of artifacts while trying to enhance signal. A good seismic data analysis program not only performs the task for which it is written, but also generates minimum numerical artifacts. One of the features that makes a production program different from a research program, which is aimed at testing whether the idea works or not, is refinement of the algorithm in the production program to minimize artifacts. Processing can be hazardous if artifacts overpower the intended action of the program.

The ability of the seismic data analyst invariably is as important as the effectiveness of the algorithms in determining the quality of the final product from data processing. There are many examples of good processing using mediocre software. There are also examples of poor processing using good software. The example shown in Figure I-12 rigorously demonstrates how implementational differences in processing algorithus and differences in the analyst's skills can influence results of processing.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0031.jpg?height=603&width=450&top_left_y=126&top_left_x=83)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0031.jpg?height=603&width=420&top_left_y=126&top_left_x=532)

(b)

FIG. I-9. A portion of a CMP-stacked section (a) before, and (b) after residual statics corrections. Note the removal of traveltime distortions caused by the near-surface layer and improvement in the continuity of events after residual statics corrections,

## Inversion of Seismic data

A narrow meaning of seismic inversion commonly referred to as trace inversion, is acoustic impedance estimation from a broad-band time-migrated CMP-stacked data. A broad meaning of seismic inversion commonly referred to as elastic inversion, is the grand scheme of estimating elastic parameters directly from observed data. Nevertheiess, in practice, applications of inversion methods can be grouped in two categories data modeling and earth modeling. Much of what we do in seismic data processing described in Chapters 1 through 7 is based on data modeling.

Applications of seismic inversion for data modeling include deconvolution (Chapter 2), refraction and residual statics corrections (Chapter 3) and the discrete Radon transform (Chapter 6). The discrete Radon transform is an excellent example to demonstrate the benefits of data modeling in seismic data processing. Consider a 2-D operator $\mathbf{L}^{\mathbf{T}}$ that corresponds to moveout correction to a CMP gather using a range of constant velocities and summing the trace amplitudes along the offset axis. ( $T$ stands for matrix transpose.) As a result, the data represented by the CMP gather is transformed from the offset space (offset versus two way traveltime) to velocity space (velocity versus twoway zero-offset time). The gather in the output domain is called the velocity stack. The stack amplitudes on the velocity-stack gather exhibit smearing along the velocity axis. This is caused by discrete sampling along the offset axis and finite cable length. The operator $\mathbf{L}^{\mathbf{T}}$ alone does not account for these effects. Instead, we must use its generalized linear inverse $\left(\mathrm{L}^{\mathbf{T}} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T}}$. Application of the operator $\mathbf{L}^{\mathrm{T}}$ is within the framework of conventional processing, whereas application of the operator $\left(\mathbf{L}^{\mathbf{T}} \mathbf{L}\right)^{-1} \mathbf{L}^{\mathbf{T}}$ is within the framework of seismic
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0032.jpg?height=1004&width=852&top_left_y=134&top_left_x=92)

FIG. I-10. A portion of a CMP-stacked section before (top) and after (bottom) migration. Note the accurate imaging of the erosional unconformity (A). Nevertheless, the out-of-the-plane event (B) associated with this unconformity can only be imaged accurately by 3 -D migration.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0033.jpg?height=1002&width=746&top_left_y=124&top_left_x=144)

FIG. I-11. A portion of a CMP-stacked section, which has been corrected for dip moveout, before (top) and after (bottom) migration. Dip-moveout correction preserves diffractions and fault-plane reflections which conflict. with gently-dipping reflections. These conflicting events are otherwise attenuated by conventional stacking. (Data courtesy Schlumberger Geco-Prakla and TGS.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0034.jpg?height=930&width=758&top_left_y=130&top_left_x=132)

FIG. I-12. A seismic line processed by six different contractors. (Data courtesy British Petroleum Development, Ltd.; Carless Exploration Ltd.; Clyde Petroleum Plc.; Goal Petroleum Plc.; Premier Consoldated Oilfelds Plc.; and Tricentrol Oil Corporation Ltd.)
inversion. The CMP gather can be reconstructed by applying inverse moveout correction and summing over the velocity axis. This inverse trangformation is represented by the operator $\mathbf{L}$. Reconstruction of the CMP gather from the velocity-stack gather is one example of data modeling. Data modeling using the velocitystack gather computed by the processing operator $\mathbf{L}^{\mathbf{T}}$ does not faithfully restore the amplitudes of the original CMP gather, whereas dat a modeling using the inversion operator $\left(\mathbf{L}^{\mathrm{T}} \mathbf{L}\right)^{-1} \mathbf{L}^{\mathbf{T}}$ does.

Just as there is a difference between processing and inversion in data modeling, also, there exists a difference between processing and inversion in earth modeling. The primary objective in processing is to obtain an earth model in time with an accompanying earth image in time a time-migrated section or volume of data (Figure I-13). Representation of an earth model in time usually is in the form of a velocaty field, which has to be smoothly varying both in time and space. Whereas the primary objective in inversion is to obtain an earth model in depth with an accompanying earth image in depth a depth-migrated section or volume of data (Figure I-14). Representation of an earth model in depth usually is in the form of a detailed velocty depth model, which can include layer boundaries with velocity contrast (Figure I-14).

Chapters 8 and 9 are devoted to earth imaging and modeling in depth, respectively. Results of conventional processing of seismic data often are displayed in the form of an unmigrated (Figure I-15a) and migrated CMP-stacked section (Figure I-15b), with the vertical axis as time, which is different from the recording time of seismic wavefields. For unmigrated data, the vertical axis of the CMP-stacked section represents times of reflection events in the unmigrated position in the subsurface. These event times are associated with normalincidence raypaths from coincident source-receiver locations at the surface to reflectors in the subsurface and back. For migrated data, the vertical axis represents times of reflection events in the migrated position. These event times are associated with vertical-incidence raypaths from coincident source-receiver locations at the surface to reflectors in the subsurface and beck. As long as there are no lateral velocity variations, seismic imaging of the subsurface can be achieved using time migration techniques and the result can be displayed in time. This time-migrated section can then be converted to depth along vertical raypaths.

When there are mild to moderate lateral velocity variations, time migration can still yield a reasonably accurate image of the subsurface. Nevertheless, depth conversion must be done along image rays to accommodate for the lateral mispositioning of the events as a result of time migration.

In the presence of strong to severe lateral velocity variations, however, time migration no longer is valid.
Instead, seismic imaging of the subsur face must be done using depth migration techniques so as to properly account for lateral velocity variations and the result must. be displayed in depth.

The depth-migrated section (Figure I-15c) can be considered a close representation of the structural crosssection of the subsurface only if the velocity-depth model is sufficiently accurate. In the example shown in Figure I-15, the picked horizons correspond to leyer boundaries with significant velocity contrast. The zone of interest is base Zechstein (the red horizon) and the underlying Carboniferous sequence. The green horizon just below $2 \mathrm{~km}$ is the top Zechstein. This formation consists of two units of anhydrite-dolomite with a thickness of approximately $100 \mathrm{~m}$ the shallow unit very close to top-Zechstein and concordant with it, and the deeper unit which manifests itself with a very complex geometry as seen in the migrated sections.

An earth model in depth usually is described by two sets of parameters layer velocitves and reflector geometries (Figure I-16). Practical methods to delineate reflector geometries described in Chapter 8, and to estimate layer velocities described in Chapter 9 can be appropriately combined to construct earth models in depth from seismic data.

In practice, smoothness of earth models derived from processing means that we can make a straightray assumption and usually do not have to honor ray bending at layer boundaries. In contrast, detailed definition of earth models derived from inversion with a more stringent requirement in accuracy means that we do have to honor ray bending at layer boundaries and account for vertical and lateral velocity gradients within the layers themselves. Hence, to a large extent, processing can be automated, while inversion requires interpretive pause at each layer boundary.

There is a fundamental problem with inversion applied to earth modeling in depth velocty-depth ambiguty. This means that an error in depth is indistinguishable from an error velocity. To resolve velocitydepth ambiguity as much as possible, one needs to do an independent estimate of layer velocities and reflector geometries using prestack data. As a result of velocitydepth ambiguity, an output from inversion is an estimated velocity-depth model with a measure of uncertainty in layer velocities and reflector geometries. It is now widely accepted in the industry that results of inversion are geologically plausable only when there is a sound interpretation effort put into the data analysis.

It is the limited accuracy in velocity estimation that has led to the acceptance of time sections to be the standard mode of display in seismic explotation. Facing the challenge of improving the accuracy in velocity estimation should make the depth sections increasingly more acceptable. Specifically, improving the accuracy meens the ability to resolve detailed velocity

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0036.jpg?height=502&width=713&top_left_y=114&top_left_x=157)

FIG. I-13. An earth image in time obtained by poststack time migration of CMP-stacked section with the color-codod earth model in time represented by a velocity field.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0036.jpg?height=499&width=722&top_left_y=682&top_left_x=147)

FIG. I-14. An earth image in depth obtained by prestack depth migration with the color-coded earth model in depth represented by a velocity-depth model.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0037.jpg?height=1014&width=500&top_left_y=124&top_left_x=263)

FIG. I-15. (a) A cross-bection from an unmigrated volume of CMP-stadked data; (b) the sume croes-section after 3-D poststack time migration: and (c) after 3-D poststack depth migration. See text for details. (Data courtesy Amoco Production (UK) Led.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0038.jpg?height=467&width=635&top_left_y=124&top_left_x=221)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0038.jpg?height=465&width=629&top_left_y=655&top_left_x=220)

b

FIG. I-16. An earth model in depth is described by two sets of parameters

(a) Layer velocities, and (b) reflector geometries.
variations in the vertical and lateral directions, associated with both structural and stratigraphic targets.

Earth modeling in depth usually involves implementation of an inversion procedure layer by layer starting from the top (Figure I-17). First, estimate a velocity field (the color-coded surface and the vertical crosssection) for the first layer, for instance, using 3-D co herency inversion. Then delineate the reflector geometry (the silver surface) associated with the base of the layer, for instance, using 3-D poststack depth migration (Figure I-17a). Next, estimate a velocity field for the second layer and delineate the reflector geometry associated with the base of the layer (Figure I-17b). Alternate between layer velocity estimation and reflector geometry delineation, one layer at a time, to complete the construction of the earth model in depth (Figure 1-17c). This layer-by-layer, structure-dependent estima tion of earth models in depth is needed when there are distinct layer boundaries with significant velocity contrast (as in many parts of the North Sea). In practice, an iterative, structure-independent estimation of earth models in depth also is used in the case of a background velocity field with not-so-distinct leyer boundaries (as in the Gulf of Mexico).

Practical methods of layer velocity estimation include Dix conversion and inversion of stacking velocities, coherency inversion, and analysis of image gathers from prestack depth migration (Chapter 9). Velocity nodes at analysis locations for the layer under consideration (Figure I-18a) are assigned to the normalincidence reflection points over the surface associated with the base of the layer (Figure I-18b). A velocity field for the layer is then created by spatial interpolation of the velocity nodes. This layer velocity field is assigned to the layer together with a similar field for a vertical velocity gradient whenever it is available from well data.

Practical methods of reflector geometry delineation include vertical-ray and image-ray depth conversion of time horizons interpreted from time-migrated data, commonly known as vertical stretch and map migration, respectively. Additionally, reflector geometries in depth can be delineated by interpreting post- and prestack depth-migrated data. By interpreting crosssections from the volume of depth-migrated data at appropriate intervals, horizon strands are created (Figure I-19a). These strands then are interpolated spatially to create the surface that represents the reflector geometry associated with the layer boundary included in the earth model in depth (Figure I-19b).

In Chapter 10, we present case studies for 2- and 3-D earth modeling and imaging in depth applicable to structural plays. These cases involve exploration and development objectives that require solving specific problems such as imaging beneath diapiric structures associated with salt tectonics. imaging beneath imbricate structures associated with overthrust tectonics, target reflectors below an irregular water-bottom topography, fault shadows, and shallow velocity anomalies.

A concise, but sufficiently rigorous, review of seismic wave propagation is given in Chapter 11. This also is intended to remind the reader of the two components of observed seismic data that can be used in inversion

traveltimes and amplitudes, to estimate the earth parameters. It is generally favorable to do the inversion of reflection traveltimes and amplitudes separately. The former is more robust and stable in the presence of noise. The latter is more sensitive to ambient noise and is prone to producing unstable solutions, and therefore, it may require more stringent constraints.

In Chapter 11, we review inversion of amplitudes of acoustic wavefields, specifically, prestack amplitude inversion to derive the attributes associated with amplitude variation with offset (AVO) and poststack amplitude inversion to estimate an acoustic impedance (AI) model of the earth. We broadly associate traveltime inversion with the estimation of a structural model of a reservoir that describes the geometry of the layer boundaries and faults. Whereas, we broadly associate amplitude inversion with the estimation of a stratigraphic model of the reservoir that describes the lateral and vertical variations of the AVO and AI attributes within the layers themselves. The latter can then be transcribed into petrophysical paraneters pore pressure, porosity, permeability, and fluid saturation, and it combined with the structural model to create a model of the reservoir. Therefore, seismic inversion is a true pronouncement of integration between petroloum geology, petroleum engineering, and exploration seismol ogy. Only the explotation seismologists timespeak. while the peroleurn geologists and engineers depthspeak. To achieve integration, they all must be fluent in the sarne language depthspenk.

## Interpretation of Seismic data

When you pick semblance peaks from a velocity spectrum (Section 3.2) to determine the moveout velocity function, you implicitly make a judgment as to what is primary and what is multiple. When you pick a coherency semblance spectrum (Section 9.2) to determine the interval velocity profile, you make a judgment as to what degree of lateral velocity variations needs to be honored. These are but two examples of interpretive work involved in processing and inversion of seismic data, respectively.

What is known as traditional seismic interpreta-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0040.jpg?height=1078&width=660&top_left_y=118&top_left_x=126)

FIG. 1-17. Layer-by-layer estimation of an earth model in depth. See lext for details.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0041.jpg?height=1024&width=712&top_left_y=127&top_left_x=158)

FIG. I-18. Estimated velocities for a layer represented by the color-coded velocity nodes (top) and the velocity field derived from the nodes (bottom).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0042.jpg?height=1024&width=710&top_left_y=128&top_left_x=156)

FIG. I-19. Reflector geometry delincution: (top) depth horizon strands created by interpreting selected cross-sections (dis. played is one such section) from the depth-migrated volume of data, and (bottom) the surface that represents the reflector boundary created by spatial interpolation of the strands.
tion, however, involves picking a reflection time surface associated with a layer boundary from a timemigrated volume of data or a reflector from a depthmigrated volume of data to determine the structure map for that layer boundary (Figure I-19). The power of 3-D visualization of image volumes, velocity volumes, and attribute volumes, such as those associated with AVO analysis and acoustic impedance estimation, have dramatically changed the way seismic interpretation is done now. Interperetation no longer is picking traveltimes to determine the structural geology of the area of interest, but also involves manipulation of amplitudes contained in the data volumes to derive information about the depositional environment, depositional sequence boundaries, and the internal constitution of the sequence units themselves. Interpretation of 3-D seismic data is covered in Section 7.5, while further examples are provided with the case studies in Sections 10.8 and 10.9 .

## From Seismic Exploration to Seismic Monitoring

The seismic industry has been impressively dynamic and creative during its 60-year history. Although it is relatively a small sector within the oil and gas industry at large, it has made the most significant impact on increasing proven reserves and reserve-production ratios worldwide.

We shall now sketch a brief historiography of the seismic industry before we look ahead. The evolution of the scismic industry can be described briefly in decades of development and forward leaps from one theme to another as outlined in Table I-1.

In the $1960 \mathrm{~s}$, the digital revolution profoundly changed seismic acquisition. We were then able to record more data by increasing the number of channcls and fold of coverage. The digital revolution brought about the need to use digital computers to analyze the recorded data. That came about in the 1970 s when we switched from calculators to computers. Many of the data processing algorithms, including deconvolution,

Table 1-1. The milestones in the seismic industry.

1960s From aralog to digatal

1970 s From calculators to computers

$1980 \mathrm{~s}$ From 2-D to 3-D

$1990 \mathrm{~s}$ From tame to depth

2000s From $3-D$ to 4 - $D$

From $4-D$ to $4-C$

From ssotropy to anzsotropy velocity analysis, refraction, and residual statics corrections, normal-moveout corection and stacking, and even migration, were implemented in those years. The computer before the seventies was a person using the calculator; now the computer is a machine and the person became the seismic analyst.

In the 1980s, the seismic industry took another big step forward; it was now beginning to provide the oil and gas industry with 3-D images of the subsurface. We need only to examine the global reserve-production curves over the past decades to see that the 3-D revolution gave a big jump from 35 to 45 years for oil and from 50 to 65 years for gas. The seismic industry was already pushing the computer industry to the limit with its need for power to handle large-scale data volumes acquired by $3-D$ surveys.

Finally, in the 1990 s, the seismic industry was capable of providing the oil and gas industry with images of the subsurface, not just in 3-D, but also in depth. It took years of exhaustive experimental research to test, and field-prove numerous methods to accurately estimate an earth model in depth and use it to efficiently create an earth image in depth. Once again, the seismic industry has challenged the computer industry to provide cost-effective solutions for numerically intensive applications with large input-output operations, such as 3-D prestack depth migration.

As the seismic industry made one breakthrough after another during its history, it also created new challenges for itself. Now we record not just $P$-waves but also converted $S$-waves for a wide range of objectives. Using the multicomponent seismic method, commonly known as the 4 -C seismic method, we are now able to see through gas plumes caused by the reservoir below. We are able to sometimes better image the subsalt and subbasalt targets with the 4-C seismic method. Using the converted $S$-waves, we are able to detect the oil-water contact, and the top or base of the reservoir unit that we sometimes could not delineate using only $P$-waves. We even go further now and attempt to identify fluid types in reservoir rocks, discriminate sand from shale, and map hydrocarbon saturation, again using the 4-C seismic method. Our ultimate objective is to use the seismic method, in addition to the production and geologic data, to characterize oil and gas reservoirs accurately.

Just as we may characterize oil and gas reservoirs seismically, we may also seismically monitor them. Given a set of time-lapse 3-D seismic survey data, which constitutes the basis of the 4-D seismic method, we can track flow paths and fluid distribution in the reservoirs throughout their lifetime. And finally, we have to acknowledge that the earth is anisotropic. By accounting
for anisotropy, we can map fractures and increase the accuracy of velocity esitmation and imaging techniques.

Accompanying all of these new frontiers for the seismic industry is the availability of a dazzling $3-D$ visualization technology that now enables us to perform volume-based processing (Section 5.4) and inversion and interpretation (Sections 10.8 and 10.9). Keep the following principle in mind when analyzing large volumes of data: Before you get more data, get the most out of your data.

The topics on the 4-D and 4-C seismic methods, and anisotropy discussed in Chapter 11 are for the road immediately ahead in the seismic industry with the aim of a rigorous, seismically driven reservoir characterization and monitoring.

## REFERENCES

Pullan, S. E. and Hunter, J. A., 1990, Delineation of buried bedrock valleys using the optimum offset shallow reflection technique, in Ward, S. H., Ed., Geotechnical and environmental geophysics, Vol. III: Soc. Expl. Geophys., 75-87.

Yilmaz, O., 1976, A Short Note on Deep Seismic Sounding in Turkey: J. Geophys. Soc. of Turkey, 3, 5458.

## 1 Fundamentals of Signal Processing

- Introduction - The 1-D Fourier Transform - Analog versus Digital Signal - Frequency Aliasing $\cdot$ Phase Considerations - Time-Domain Operations - Convolution - Crosscorrelation and Autocorrelation $\cdot$ Vibroseis Correlation $\bullet$ Frequency Filtering - Practical Aspects of Frequency Filtering - Bandwidth and Vertical Resolution $\bullet$ Time-Variant Filtering - The 2-D Fourier Transform - Spatial Aliasing - Worldwide Assortment of Shot Records $\cdot$ Wave Types $\cdot$ Gain Applications $\cdot$ Geometric Spreading Correction - Programmed Gain Control $\bullet$ RMS Amplitude AGC $\cdot$ Instantaneous AGC $\cdot$ Relative Trace Balancing $\cdot$ Basic Data Processing Sequence $\cdot$ Preprocessing $\cdot$ Deconvolution $\bullet$ CMP Sorting $\cdot$ Velocity Analysis $\cdot$ Normal-Moveout Correction $\bullet$ Multiple Attenuation $\cdot$ Dip-Moveout Correction $\cdot$ CMP Stacking $\cdot$ Poststack Processing $\cdot$ Migration $\cdot$ Residual Statics Corrections - Quality Control in Processing $\cdot$ Parsimony in Processing $\cdot$ Exercises $\cdot$ Appendix A: A Mathematical Review of the Fourier Transform - The 1-D Fourier Transform - The $z$-Transform - The 2-D Fourier Transform - References


### 1.0 INTRODUCTION

The Fourjer transform is fundamental to seismic data analysis. It applies to almost all stages of processing. A seismic trace represents a seismic wavefield recorded at a receiver location. The digital form of a seismic trace is a time series which can be completely described as a discrete sum of a number of sinusoids - each with a unique peak amplitude, frequency, and a phase-lag (relative alignment). The analysis of a seismic trace into its sinusoidal components is achieved by the forward Fourier transform. Conversely, the synthesis of a seismic trace from the individual sinusoidal components is achieved by the neverse Fourier transform. A brief mathematical review of the Fourier transform is given in Appendix $A$.

Seismic data processing algorithms often can be described or implemented more simply in the frequency domain than in the time domain. In Section 1.1, the one-dimensional (1-D) Fourier transform is introduced and some basic properties of time series in both time and frequency domains are described. Many of the processing techniques single- and multichannel, involve an operand (seismic trace) and an operator (filter). A simple application of Fourier analysis is in the design of zero-phase frequency filters, typically in the form of band-pass filtering.

The two-dimensional (2-D) Fourier transform (Section 1.2) is a way to decompose a seismic wavefield, such as a common-shot gather, into its plane-wave components, each with a certain frequency propagating at a certain angle from the vertical. Therefore, the 2-D Fourier transform can describe processes like migration and frequency-wavenumber $(f-k)$ filtering. A common application of $f-k$ filtering is the rejection of coherent linear noise by dip filtering, and attenuation of nultiples based on velocity discrimination between primaries and multiples in the $f-k$ domain (Section 6.2),

In Section 1.3, 40 common-shot gathers recorded "I rifferent parts of the world with different types of wnuces and recording instruments are introduced. Var1 :" types of seismic energy are described on these shot 1 "ids reflections, refractions, coherent noise such is multiples, guided waves, side-scattered energy and agrmurl roll, and ambient random noise.

Srismic data often require application of a gain funtion time-variant scaling of amplitudes, for varin 1 risons. The scaing function commonly is derived from the data. Gain types are discussed in Section 1.4. (t in carly stage in processing, gain is applied to data to correct for wavefront divergence decay in amplimiles caused by geometric spreading of scismic waves. Seismic data often are gained for display purposes; for instance, by applying automatic gain control (AGC), which brings up weak reflection zones in seismic data. However, an AGC-type gain can destroy signal character and must, therefore, be considered with caution.

Finaily, in Section 1.5, a summary of the basic data processing sequence is presented with field data examplis. There are three primary stages in seismic data prrcessing; each is aimed at improving seismic resolution the ability to separate two events that are very close together, either spatially or temporally:

(a) Deconvolution is performed along the time axis to increase temporal resolution by compressing the basic seismic wavelet to approximately a spike and suppressing reverberating wavetrains.

(b) Stacking compresses the offset dimension, thus reducing seismic data volume to the plane of the zerooffset seismic section and increasing the signal-tonoise ratio.

(c) Migration commonly is performed on the stacked section (which is assumed to be equivalent to a zero-offset section) to increase lateral resolution by collapsing diffractions and moving dipping events to their supposedly true subsurface positions.

Secondary processes are implemented at certain stages to condition the data and improve the performance of deconvolution, stacking, and migration. When coherent noise is dip filtered, for example, deconvolution and velocity analysis may be improved. Residual statics corrections also improve velocity anelysis and, hence, the quality of the stacked section.

### 1.1 THE 1-D FOURIER TRANSFORM

Consider the following experiment. Hold a spring at one erd and attach a weight to the other end. Pull the wisight dovi a certain amount, say 0.8 units of distancer
Release the weiglit. Assume that the spring is elastic it bounces up and down ad infinitum. Sct the time to zero at the onset of motion. Displacement of the weight as a function of time should vary between the peak amplitudes $(+0.8,-0.8)$. If you had a device that could trace the amplitude of the displacement as a function of time, it would produce a sinusoidal curve as slic $" 11$ in Figure 1.1-1 (frame 1). Measure the time intervi =tween two consecutive peaks; you will find that is $0.080 \mathrm{~s}(80 \mathrm{~ms})$. This time interval is called the per of the spring and it depends on the spring constant a measure of spring stiffness. We say that the spring has completed one cycle of motion in a single period of time. Count the number of cycles within one seci fad. This should be 12.5 cycles, which is called the freq. "tcy associated with the spring motion. One cycle per sct ind (cps) is one hertz (Hz). Note that $1 / 0.080 \varepsilon=12 ; 12$, that is, frequency is the inverse of the period.

To continue, repeat the above experiment using a spring with a higher stiffness. Give the second spring a peak displacement amplitude of 04 units. The motioni of the spring is traced as another sinusoid in Figure 11 1 (frame 2). The period and frequency of the spring ale $0.040 \mathrm{~s}$ and $25 \mathrm{~Hz}$, respectively. To keep track of these measurements, plot the peak amplitude of each spring as a function of frequency. These are the amplitude yecttra shown in Figure 1.1-1.

Working with two identical springs, release spring 1 from a peak amplitude displacement of 0.8 units and set the time to zero at the onset of the motion. When spring 1 passes through the zero amplitude position, set spring 2 in motion from the same peak amplitude displacement, (0.8). The motion of spring 1 is plotted in frame 1 , while the motion of spring 2 is plotted in frame 3 of Figure 1.1-1. Because the springs were set to motion with the same peak amplitude displacenent, the amplitude spectra of the two sinusoidal time functions should be identical. However, a difference is noted between the time functions in frames 1 and 3 . In particular, when the sinusoid in frame 1 takes the peak amplitude value, the sinusoid in frame 3 takes the sero amplitude value. There was a time delay ( $20 \mathrm{~ms})$ equuvalent to one-quater of a full cycle in setting spring 2 in motion relative to spring 1 . This time delay is the difference between the two sinusoids shown in frames 1 and 3. A full cycle is equivalent to 360 degrees or $2 \pi \mathrm{ra}$ dians. Therefore, a time delay of one-quarter of a cvele is equivalent to a +90 -degree phase-lag.

Phase is defined as the negative of phat lise (Robinson and Treitel, 1980). Thus, a negatzie mr shift corresponds to a positue phase value. Note that in Figure 1.1-1, if we apply a time slift of one-ruarter of a full cycle $(20 \mathrm{~ms})$ to the sinusoid in frame 3 in the negative time direction. we obtain the sinumoid in frame 1 .

Sinusoids
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0047.jpg?height=424&width=420&top_left_y=156&top_left_x=81)

Amplitude Spectra
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0047.jpg?height=262&width=196&top_left_y=154&top_left_x=502)

1
0.5
0
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0047.jpg?height=140&width=208&top_left_y=429&top_left_x=494)

Phase Spectra
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0047.jpg?height=408&width=216&top_left_y=156&top_left_x=716)

FIG. 1.1-1. Tracing the motion of a spnng in tme yields a sinusoldal curve where positive amplt tude corresponds to spring motion in the upward direction. The peak amplitude represents the maximum displacement of the weight at the end of the spring from the unstretched postion. The time between the two consecutive peaks is the period of the sirusoid, the inverse of which is called frequency. Amplitude spectra distinguish sinusoids 1 and 2, which have different peak amplitudes and frequencies The tume delay of the onset of one spring relative to another is defined as phase-lag. Phase spcctra (the negative of phase-lag spectral distinguish sinusoids 1 and 3 .

Although their amplitude spectra are identical, these two sinusoids can be distinguished based on their phase spectro as seen in Figure 1.1-1.

The experiment is completed. What is learned? First, the motion of an elastic spring can be described by a sinusoidal time function. Second, and more important, a complete description of a sinusoidal motion is given by its frequency, peak amplitude, and phase. This experiment teaches us how to describe spring motion as a function of time and frequency.

Now imagine an ensemble of many springs, each with a sinusoidal motion with a specific frequency, peak amplitude, and phase. The sinusoidal responses of all the members are shown in Figure 1.1-2. Suppose the motions of the individual springs are superimposed by adding all the traces. The result is a tme-dependent signal that is represented by the first trace in Figure 1.1-2 (as indicated by the asterisk). The superposition (synthesis) allows us to transform the motion from frequency to time domain. This transformation is reversible; that is, the time-domain signal can be broken down (analyzed) into its sinusoidal components in the frequency domain.

Mathematically, this two-way process is achieved by the Fourier transform. In practice, the standard algorithm used on digital computers is the fast Fourier transform (FFT). Analysis of a time-dependent signal into its frequency components is done by forward Fourier transform, while synthesis of all the frequency components to the time-domain signal is done by inverse Fourier transform.

Figure 1.1-3 is a display of the Fourier transform of the time-dependent signal from Figure 1.1-2. The amplitude and phase spectra constitute a more condensed frequency-domain representation of the sinusoids in Figure 1.1-2. We can clearly see the parallelism between the two types of displays. In particular, the amplitude spectrum in Figure 1.1-3 has a large and a relatively small peak at about 20 and $40 \mathrm{~Hz}$, respectively. Darker bands corresponding to larger peak amplitudes occur in Figure 1.1-2 at about the same frequencies. On the other hand, zones of weak amplitudes at about $30 \mathrm{~Hz}$ and at the low- and high-frequency ends of the spectrum also

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0048.jpg?height=598&width=849&top_left_y=126&top_left_x=94)

FIG. 1.1-2. An ensemble of sinusoidal motions with different frequency, peak amplitude, and phase-lag can be superimposed to synthesize a time-dependent waveform on the trace as indicated by the asterisk.

are apparent in both types of representations. Remember that the amplitude spectrum curve represents the peak amplitudes of the individual sinusoidal components as a function of frequency.

Now examine the phase spectrum. From the spring experiment, recall that the time delay of a particular frequency component also was expressed as a phase-lag. To better trace phase-lag as a function of frequency, a part of Figure 1.1-2 is magnified in Figure 1.1-4. Follow the positive-peak trend denoted by $P$. Note that the peaks fall above the zero timing line on the negative side of time axis at the low-frequency end of the spectrum. They then cross over to the positive side of the time axis at about $20 \mathrm{~Hz}$ and stay on that side over the rest of the frequency axis. The path that the peaks follow in Figure 1.1-4 can be plotted as the phase spectrum of Figure 1.1-3. If all the peaks were aligned along the zero timing line in Figure 1.1-4, then the corresponding time-domain signal would have a zero-phase spectrum. In this case, all the sinusoids would reinforce each other, causing a maximum peak value at zero time (Figure 1 111).

The physical significance of the amplitude spectrum is easier to understand than that of the phase spectrum. These two spectra are discussed further in this chapter. Basic mathematical details of the Fourier transform are given in Appendix $A$ at the end of this chapter.

## Analog versus Digital Signal

A seismic signal is a continuous time function. In digital recording, the continuous (analog) seismic signal is sampled at a fixed rate in time, called the sampling $n \pi$ terval (or sampling rate). Typical values of sampling intervals range between 1 and $4 \mathrm{~ms}$ for most reflection seismic work. Hjgh-resolution studies require sampling intervals as small as $0.25 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0049.jpg?height=888&width=403&top_left_y=125&top_left_x=84)

FIG. 1.1-3. The information from Figure 1.1-2 cun be condensed into amplitude and phase spectra. Each point along the amplitude spectrum curve corresponds to the peak amplitude of the sunusoid at that frequency plotted as a trace in Figure 1.1-2. Note the equivalence of the two peaks in the amplitude spectrum with the two high-amplitude zones in Figure 1,1-2. Each point along the phase spectrum corresponds to the time delay of a peak or trough along the sinusoid at that frequency with respect to the timing line at $t=0$. Note the equivalence of the phase curve with the trend of a positive peak from trace to trace in Figure 1.1-4.
Figure 1.1-5 shows a continuous signal in time. The discrete samples that might actually be recorded are shown by dots. A discrete time function is called a time senes. The bottom curve in Figure 1.1-5 is an attempted reconstruction of the original analog signal, which is shown as the curve on top. Note that the reconstructed signal lacks the details present in the original analog signal. These details correspond to high-frequency components that were lost by sampling. If a smaller sampling interval were chosen, then the reconstructed signal would more accurately represent the original signal. For the extreme case of a zero sampling interval, the continuous signal can be represented exactly.

Is there a measure of the restorable frequency bandwidth of the digitized data? Figure 1.1-6 shows a time series, such as a seismic trace, with a 2-ms sarrpling interval and the corresponding amplitude spectrum. In general, given the sampling interval $\Delta t$, the highest frequency that can be restored accurately is called the Nyquist frequency and is given by

$$
f_{N y q}=\frac{1}{2 \Delta t}
$$

For the time series in Figure 1.1-6, $\Delta t=2 \mathrm{~ms}$; therefore, the Nyquist frequency is $250 \mathrm{~Hz}$. The original time series was resampled to obtain a series with 4 - and $8-\mathrm{ms}$ sampling intervals. The corresponding Nyquist frequencies are 125 and $62.5 \mathrm{~Hz}$, respectively. Figure 1.1-6 also shows the series (as reconstructed back to $2 \mathrm{~ms}$ for plotting purposes) sampled at 4 and $8 \mathrm{~ms}$ with their amplitude spectra. Note that the coarser the sampling interval, the smoother the serjes. Smoothness results from a loss of high frequencies as seen in the amplitude spectra. Frequency components between 125 and $250 \mathrm{~Hz}$, which are present in the time series with the 2-ms sampling interval, seem to be absent in the series resampled to 4 ms. Likewise, frequency components between 62.5 and $250 \mathrm{~Hz}$ seem to be absent from the series resampled to $8 \mathrm{~ms}$. Can these frequencies be recovered? No. Once a continuous signal as digatized, the highest frequency that can be restored accurately is the Nyqust frequency.

We may think that when the time series sampled at 4 or $8 \mathrm{~ms}$ is interpolated back to a 2 - $\mathrm{ms}$ sampling interval, those high frequencies should return. As stated earlier, the time series in Figure 1.1-6 with 4- and 8ms sampling intervals actually were reconstructed by interpolation back to $2 \mathrm{~ms}$ to get the same number of samples as the original series for plotting with the same scale. Interpolation does not recover the frequencres lost by samping; at onily generates extra samples.

The implication for sampling the continuous signal in the field is an important one. If the earth signal had

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0050.jpg?height=607&width=852&top_left_y=116&top_left_x=91)

FIG. 1.1-4. A portion of Figure 1.1-2 is enlarged to better delneate the trend of the phase curve from trace to trace from one frequency component to unother. Compare the trend indicated by the positive peak $P$ with the phase spectrum in Figure 1.1-3.

frequencies, say up to $150 \mathrm{~Hz}$, then the 4 -ms sampling interval would cause a loss of the band between 125 and $150 \mathrm{~Hz}$.

While maximum recoverable signal frequency is the Nyquist frequency for a 1-D digitized data set, such as a single seismic trace, the situation can be different. for two or more dimensional data. Consider the process of moveout correction and stacking (Section 3.1). Given the sampling rate for the stacked trace, say 4 $\mathrm{ms}$, data sampies are searched on each input trace in the common-midpoint (CMP) gather based on the hyperbolic moveout equation. Since each input trace also is sampled at regular intervals, say $4 \mathrm{~ms}$, the computed input sample location would normally fall in between two samples on a given input trace. By interpolation, the required sample value can be computed and placed on the output sample location (Section 3.1). Such an output-driven process would faithfully preserve frequencies below the Nyquist, only. Consider the alter- native process in which a sample in the input trace is placed at the exact time location on the output trace (Wisecup, 1998). The resulting output stacked trace from this input-driven process would contain all the samples from all the input traces at exact time locations with irregular intervals. Such random sampling then yields a potential Nyquist frequency greater than the Nyquist frequency associated with the input traces.

## Frequency Aliasing

Consider the sinusoid in Figure 1,1-7. This signal is resampled as before to 4 and $8 \mathrm{~ms}$. The amplitude spectra indicate that all three have the same frequency, $25 \mathrm{~Hz}$. Nothing happened to the signal after resampling it to a coarser sampling interval. Now examine the higher frequency sinusoid ( $75 \mathrm{~Hz}$ ) in Figure 1.1-8. It appears the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0051.jpg?height=66&width=395&top_left_y=126&top_left_x=91)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0051.jpg?height=62&width=394&top_left_y=244&top_left_x=93)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0051.jpg?height=57&width=394&top_left_y=368&top_left_x=85)

(c)

FIG. 1.1-5. (a) A continuous analog signal, (b) a digitized form of thr signal, (c) reconstructed analog signal. When digitized, a continuous analog signal loses frequencies above the Nyquist frequency. (Adapted from Rothman, 1981) same at both 2- and 4-ms sampling. However, 1esanpling to $8 \mathrm{~ms}$ changed the signal and made it appear to be a lower frequency sinusoid. The resampled signal haa frequency of $50 \mathrm{~Hz}$ as seen in the amplitude spectrum The Nyquist frequency for an 8-ms sampling interval i$62.5 \mathrm{~Hz}$. The true signal frequency is $75 \mathrm{~Hz}$. As a result of resampling, the signal with $75-\mathrm{Hz}$ frequency folde i back onto the spectrum and appeared at its ahas $\mathrm{fr}$ quency of $50 \mathrm{~Hz}$. Finally, a $150 \mathrm{~Hz}$ sinusoid resamplerl to 4 and $8 \mathrm{~ms}$ is shown in Figure 1.1-9. This time, the 4-ms sampling made the signal appear as a $100-\mathrm{Hz}$ ing nal, while the 8-ms sampling made it appear as a $25 \mathrm{H}$, signal. By using a single-frequency sinusoid, we sce thet frequencies above the Nyquist really are not lost aft (1) sampling, but appear at frequencies below the Nyquist

Now consider the superposition of two sinusuld with frequencies of $12.5-$ and $75-\mathrm{Hz}$ as shown in $\mathrm{Fig}-$ ure 1.1-10. Digitization of this signal at 2- and 4-11, sampling intervals does not alter the original sigıal. since its frequency components are below the Nyquiv frequencies associated with 2- and 4-ms sampling intelvals 250 and $125 \mathrm{~Hz}$, respectively. However, when tlk

## Sampling Rate $=2 \mathbf{~ m s}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0051.jpg?height=137&width=448&top_left_y=676&top_left_x=154)

$4 \mathrm{~ms}$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0051.jpg?height=320&width=448&top_left_y=846&top_left_x=154)

## Amplitude Spectra

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0051.jpg?height=518&width=270&top_left_y=652&top_left_x=608)

FIG. 1.1-6. A tome series sampled at $2 \mathrm{~ms}$ has a Nyquist frequency of $250 \mathrm{~Hz}$. Resampling to 4 and $8 \mathrm{~ms}$ confines the frequency band to 125 and $62.5 \mathrm{~Hz}$, respectively. Note the loss of high frequencies at larger sampling intervals.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0052.jpg?height=470&width=638&top_left_y=134&top_left_x=208)

FIG. 1.1-7. A $25-\mathrm{Hz}$ sinusoid sampled at $2 \mathrm{~ms}$ remains unchanged when resampled at 4 or $8 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0052.jpg?height=142&width=396&top_left_y=716&top_left_x=208)

## Amplitude Spectra

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0052.jpg?height=448&width=632&top_left_y=722&top_left_x=208)

FIG. 1.1-8. A $75-\mathrm{Hz}$ sinusoid sampled at $2 \mathrm{~ms}$ remains unchanged when resampled at $4 \mathrm{~ms}_{\text {, but }}$ but appears as a $50-\mathrm{Hz}$ sinusoid when resampled at $8 \mathrm{~ms}$. Hence, the latter is the alies of the orignal sinusoid.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0053.jpg?height=136&width=373&top_left_y=146&top_left_x=220)

## Amplitude Spectra

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0053.jpg?height=426&width=598&top_left_y=151&top_left_x=220)

FIG. 1.1-9. A 150-Hz sinusoid sampled at $2 \mathrm{~ms}$ appears as a $100 \mathrm{~Hz}$ sinusoid when resampled at $4 \mathrm{~ms}$ and as a $25-\mathrm{Hz}$ sinusoid when resampled at $8 \mathrm{~ms}$. (Amplitude modulation in the 2 -ms sinusoid is a result of limitations in plotting very high-frequency signals.)

Sampling Rate $=2 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0053.jpg?height=111&width=365&top_left_y=741&top_left_x=210)

$4 \mathrm{~ms}$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0053.jpg?height=286&width=372&top_left_y=861&top_left_x=210)

Amplitude Spectra
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0053.jpg?height=426&width=226&top_left_y=722&top_left_x=588)

FIG. 1.1-10. A time series synthesized from two sinusoids with 12.5 and $75 \mathrm{~Hz}$ at 2 -ms sampling rate remains unchanged when resampled at $4 \mathrm{~ms}$. However, at $8 \mathrm{~ms}$, its high-frequency component shifts from 75 to $50 \mathrm{~Hz}$, while its low-frequency component remains the same.
signal is digitized at a coarser sampling interval, such As $8 \mathrm{~ms}$, the amplitude spectrum changes. The 12.5H/ component is not affected, because 8-ms sampling stil] is sufficient to sample this low-frequency compon'11t. On the other hand, the $75-\mathrm{Hz}$ component is seen as a lower-frequency component $(50 \mathrm{~Hz}$ ). Once again, note that those frequencies in the original signal above the Nycuist frequency corresponding to the chosen sampling interval are folded back onto the amplitude spectrun of the digitized version of the signal.

This analysis can be extended to many sinusoids of different frequencies. In particular, the discrete time series derived from a too coarse sampling (undersampling) of t continuous signal actually contains contributions from high-frequency components of that contimous signal. Those high frequencies fold back onto the spectrum of the discrete time series and appear as lower frequencies. The phenomenon that is caused by undersampling the continuous signal is termed frequency aliasing.

To compute the alias frequency $f_{a}$, use the following relation

$$
f_{a}=\left|2 m f_{N}-f_{s}\right|_{1}
$$

where $f_{.}$is the folding frequency, $f_{s}$ is the signal frequency, and $m$ is an integer such that $f_{a}<f_{N}$. For example, suppose that $f_{\mathrm{s}}=65 \mathrm{~Hz}, f_{N}=62.5 \mathrm{~Hz}$, which corresponds to $8-\mathrm{ms}$ sampling rate. The alias frequency then is $f_{a}=|2 \times 62.5-65|=60 \mathrm{~Hz}$.

In conclusion, undersampling has two effects:

(a) band limiting the spectrum of the continuous signal, with the maximum frequency being the Nyquist, and

(b) contamination of the digital signal spectrum by high frequencies beyond the Nyquist, which may have been present in the continuous signal.

Nothing can be done about the first problem. The second problem is of practical importance. To keep the recoverable frequency band between zero and the Nyquist frequency free from aliased frequencies, a high-cut antialiasing filter is applied in the field before analog-todigital conversion of seismic signals. This filter eliminates those frequency components that would have been aliased during sampling. Typically, the high-cut antialiasing filter has a cutoff frequency that is either three-quarters or half of the Nyquist frequency. This filter rolls of steeply so that aliases of frequencies above the Nyquist are highly attenuated.

## Phase Considerations

In the beginning of this section, a time-dependent signal was synthesized from its frequency components (Figure
1.1-2). Consider a signal with a zero-phase spectrum. Figure 1.1-11 shows sinusoids with frequencies ranging from approximately 1 to $32 \mathrm{~Hz}$. All of these sinusoids have zero-phase lag; thus, the peak amplitudes align at $t=0$. The time-domain signal on the trace iclentified by an asterisk in Figure 1.1-11 is synthesized by summing all these sinusoids a process describel by inverse Fourier transform. Such a time-domain sigual is called a wavelet. A wavelet usually is considered a transient signal, that is, a signal with a finite duration. It has a start time and an end time, and its energy is confined between these two time positions. The wavelet that was just constructed is symmetric around $t=0$ and has a (positive) peak amplitude at $t=0$. Such a wavelet is called zero phase. In fact, the wavelet was synthesized using the zero-phase sinusoids of equal peak amplitude.

A zero-phase wavelet is symmetric with respect to zero time and peaks at zero time. Figure 1.1-12 shows the result of applying a linear phase shift to the sinusoids in Figure 1.1-11. Linear phase shift is described by a function that represents a line in the frequency domain: $\phi=\alpha \omega$, where $\alpha$ is the slope constant and $\omega$ is the angular frequency, which is the temporal frequency scaled by $2 \pi$. The wavelet, identified by an asterisk in Figure 1.1-12, has shifted in time by $-0.2 \mathrm{~s}$, but its shape has not changed. Thus, a lanear phase shift is equivalent to a constant tme shift. The slope of the lane describing the phase spectrum is proportional to the time shift.

The wavelet can be shifted by any amount of time simply by changing the slope of the line $\phi=\alpha w$, that describes the phase spectrum. Starting with the zerophase wavelet, Figure 1.1-13 shows the effect of increasing amounts of the linear phase shift on a zero-phase wavelet. Although not shown, by changing the sign of the slope in the phase spectrum, the wavelet can be shifted in the opposite time direction.

If a 90-degree phase shift is applied to each of the sinusoids in Figure 1.1-11, as shown in Figure 1.1-14, then the zero crossings are aligned at $t=0$. The result of this summation yields the antisymmetric wavelet shown on the trace identifed by an asterisk. Note that the two wavelets in Figures 1.1-11 and 1.1-14 have the same amplitude spectrum because they have been synthesized from the sinusoidal components with the same peak amplitude and frequency. The difference lies in their phase spectra. The wavelet in Figure 1.1-11 has zero-phase spectrum, while that in Figure 1.1-14 has a constant-phase spectrum (+90 degrees). Therefore, the difference in wavelet shape is a result of the difference in their phase spectra.

Figure 1.1-15 shows the effect of varions anounts of constant phase shift on a zero-phase wivelet. The 90-degree phase shift converts the zero-phase wavelet

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0055.jpg?height=532&width=385&top_left_y=124&top_left_x=93)

FIG. 1.1-11. Summation of a discrete number of sinusoids with no phase-lag, but with the same peak amplitude, yields a band-limited symmetric wavelet represented by the trace on the right (denoted by an asterisk). This is a zero-phase wavelet.

an antisymmetric wavelet. The 180 -degree phase shift changes the polarity of the zero-phase wavelet. The 270 -degree phase shift changes the polarity of the zerophase wavelet, while converting it to an antisymmetric wavelet. Finally, the 360 -degree phase shift retains the shape of the original wavelet. A constent phase shift to changes the shape of a wavelet. In partucular, a 90 degree phase shyf converts a symmetric wavelet to an antzsymmetric wavelet, while a 180 -degree phase shift changes th polanty.

Figure 1.1-16 shows a portion of a seismic section with the application of different degrees of constant phase rotation. Note the change in the wavelet character of the significant reflections. This difference in wavelet character has an impact on picking events for interpretation. When comparing displays of two different sections, which may be associated with two different vintages of processing of the same data or two different lines from the same survey, the wavelet character of the reflection event that is being picked must be consistent from one section to another. A common mistake

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0055.jpg?height=529&width=403&top_left_y=126&top_left_x=550)

FIG. 1.1-12. The same sinusoidal components as in Figure 1.1-11, but with a -0.2 s constant-time delay. When summed, these sinusoids yield a band-limited symmetric wavelet that is represented by the trace on the right (denoted by an asterisk). This wavelet is the same as that shown in Figure 1.1-11, except that it is shifted in time by $-0.2 \mathrm{~s}$. This time shift is related to the linear phase spectrum associated with the summed frequency components.

is displaying two sections to be compared with opposite polarity. The polarity convention set by the Society of Exploration Geophysicists is based on a negative water-botton reflection coefficient, which corresponds to a positive polarity.

So far, two basic phase spectra have been examined

linear and constant phase shifts. We now examine their combined effect. The phase spectrum is defined by a function $\phi=\phi_{0}+\alpha \omega$, where $\phi_{0}$ is the constant phase shift and $\alpha$ is the slope of the linear phase shift. Figure 1.1-17 shows the result of applying a linear phase shift (as in Figure 1.1-12) plus a 90-degree constant phase shift (as in Figure 1.1-14) to the sinusoids in Figure 1.1-11. The zero-phase wavelet with the same amplitude spectrum as that in Figure 1.1-11 was shifted in time by $-0.2 \mathrm{~s}$ because of the linear phase shift, and converted to an antisymmetric form because of the constant 90 degree phase shift.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0056.jpg?height=298&width=196&top_left_y=126&top_left_x=92)

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0056.jpg?height=296&width=162&top_left_y=129&top_left_x=292)

(b)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0056.jpg?height=290&width=160&top_left_y=136&top_left_x=454)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0056.jpg?height=288&width=152&top_left_y=136&top_left_x=622)

(d)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0056.jpg?height=288&width=154&top_left_y=136&top_left_x=788)

(e)

FIG. 1.1-13. Starting with a zero-phase wavelet (a), linear phase shifts are applied to shift the wavelet in time without changing its shape. The slope of the linear phase finction is related to the time shift.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0056.jpg?height=538&width=394&top_left_y=583&top_left_x=93)

FIG. 1.1-14. The same sinusoidal components as in Figure 1.1-11 but with a constant 90-degree phase shift applied to each. The zero crossings are aligned at $t=0$. Summation of these sinusoids yields an antisymmetric wavelet that is represented by the trace on the right (denoted by an sasterisk).
Other variations in phase spectrum are shown in Figure 1.1-18. The zero-phase wavelet (Figure 1.1-18a) can be modified to different shapes simply by changing the phase spectrum. It can be modified to the extent that it may no longer resemble the original wavelet shape as illustrated by the last example (Figure 1.118d). By keeping the amplitude spectrum unchanged, the wavelet shape can be changed by modufyng the phase spectrum.

## Time-Domain Operations

Consider a reflectivity sequence represented by the time series $\left(1,0, \frac{1}{2}\right)$. Also consider an impulsive source that causes an explosion at $t=0$ with an amplitude of 1 . The response of the reflectivity sequence to an impulse is called the mpulse response. This physical process can be described as in Table 1-1.

Table 1-1. Response of the reflectivity sequence $\left(1,0, \frac{1}{2}\right)$ to a zero-delay explosive impulse $(1,0)$.

| Time of <br> Onset | Reflectivity <br> Sequence | Source | Response |  |  |  |  |  |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 0 | 10 | $\frac{1}{2}$ | 1 | 0 | 1 | 0 | $\frac{1}{2}$ | 0 |

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=148&width=840&top_left_y=135&top_left_x=93)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=134&width=181&top_left_y=306&top_left_x=96)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=136&width=160&top_left_y=305&top_left_x=285)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=136&width=153&top_left_y=305&top_left_x=451)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=136&width=156&top_left_y=305&top_left_x=618)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=134&width=160&top_left_y=306&top_left_x=782)

(e)

FIG. 1.1-15. Starting with the zero-phase wavelet (a), its shape is changed by applying constant phase shifts. A 90-degree phase shift converts the zero-phase wavelet to an antisymmetric wavelet (b), whle a 180-degree phase shift reverses its polarity (c). A 270-degree phase shift reverses the polarity, while making the wavelet antisymmetric (d). Finally, a 360-degree phase shift docs not modify the wavelet (e).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0057.jpg?height=530&width=838&top_left_y=661&top_left_x=81)

FIG. 1.1-16. A portion of a seismic section with different degrees of constant phase rotations.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0058.jpg?height=541&width=390&top_left_y=117&top_left_x=101)

FIG. 1.1-17. A linear (as in Figure 1.1-12) combined with a constant phase shift (as in Figure 1.1-14) results in a timeshifted antisymmetric wavelet. The wavelet is represented by the trace on the right (denoted by an asterisk).
Table 1-2. Response of the reflectivity sequence $\left(1,0, \frac{1}{2}\right)$ to a unit-delay implosive impulse $\left(0,-\frac{1}{2}\right)$.

| Time of <br> Onset | Reflectivity <br> Sequence | Source | Response |  |  |  |  |  |  |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 1 | 0 | $\frac{1}{2}$ | 0 | $-\frac{1}{2}$ | 0 | $-\frac{1}{2}$ | 0 | $-\frac{1}{4}$ |

One unit time later, suppose that the impulsive source generates an implosion with an amplitude of $-\frac{1}{2}$. This response is described in Table 1-2.

Note that the response in each case is the reflectivity sequence scaled by the impulse strength and delayed by the impulse onset. Since a general source function is considered to be a sequence of explosive and implosive impulses, the individual impulse responses are added to obtain the combined response. This process is called hnear superposition and is described in Table 1-3.

## Convolution

In Table 1-3, the asterisk denotes convolution. The response of the reflectivity sequence $\left(1,0, \frac{1}{2}\right)$ to the source wavelet $\left(1,-\frac{1}{2}\right)$ was obtained by convolving the two series. This is done computationally as shown in Ta-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0058.jpg?height=162&width=815&top_left_y=792&top_left_x=106)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0058.jpg?height=158&width=233&top_left_y=982&top_left_x=106)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0058.jpg?height=160&width=182&top_left_y=982&top_left_x=348)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0058.jpg?height=158&width=183&top_left_y=983&top_left_x=546)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0058.jpg?height=157&width=181&top_left_y=985&top_left_x=740)

(d)

FIG. 1.1-18. The shape of a zero-phase wayelet (a) can be modified by introducing a nonzero-phase spectrom of any form as in (b), (c), and (d).

Table 1-3. Linear superposition of the two responses described in Tables 1-1 and I-2.

| Time of <br> Onset | Reflectivity <br> Sequence | Source |  |  |  | Response |  |  |  |
| :--- | ---: | ---: | ---: | ---: | ---: | ---: | ---: | ---: | ---: |
| 0 | 1 | 0 | $\frac{1}{2}$ | 1 | 0 | 1 | 0 | $\frac{1}{2}$ | 0 |
| 1 | 1 | 0 | $\frac{1}{2}$ | 0 | $-\frac{1}{2}$ | 0 | $-\frac{1}{2}$ | 0 | $-\frac{1}{4}$ |
| Superposition: |  | 1 | $-\frac{1}{2}$ | 1 | $-\frac{1}{2}$ | $\frac{1}{2}$ | $-\frac{1}{4}$ |  |  |

Expressed differently: $\left(1,0, \frac{1}{2}\right) *\left(1,-\frac{1}{2}\right)=\left(1,-\frac{1}{2}, \frac{1}{2},-\frac{1}{4}\right)$

ble 1-4. A fixed array is set up from the reflectivity sequence. The source wavelet is reversed (folded) and moved (lagged) one sample at a time. At each lag, the elements that align are multiplied and the resulting products are summed.

The mechanics of convolution are described in Table 1-5. The number of elements of output array $c_{k}$ is given by $m+n-1$, where $m$ and $n$ are the lengths of the operand array $a_{i}$ and the operator array $b_{j}$, respectively.

When the roles of the arrays in Table 1-4 are interchanged, the output array in Table 1-6 results. Note that the output response is identical to that in Table 1-4. Hence, convolution s commutative it does not matter which array is fixed and whech is moved, the output is the same.

## Crosscorrelation and Autocorrelation

Seismic data processing often requires measurement of the similarity or time alignment of two traces. Correla-

Table 1-4. Convolution of the source wavelet $\left(1,-\frac{1}{2}\right)$ with the reflectivity sequence $\left(1,0, \frac{1}{2}\right.$ ).

| Reflectivity <br> Sequence |  | Output <br> Response |  |
| :---: | :---: | :---: | :---: |
|  | $\frac{1}{2}$ |  |  |
| $-\frac{1}{2}$ |  |  | 1 |
|  |  |  | $-\frac{1}{2}$ |
|  | 1 |  | $\frac{1}{2}$ |
|  | $-\frac{1}{2}$ | 1 | $-\frac{1}{4}$ |

Table 1-5. Mechanics of the convolutional process.

Fixed Array:

$a_{0}, a_{1}, a_{2}, a_{3}, a_{4}, a_{5}, a_{6}, a_{7}$

Moving Array:

$b_{0}, b_{1}, b_{2}$

Given two arrays, $a_{2}$ and $b_{j}$ :

Step 1 : Reverse moving array $b$.

Step 2 : Multiply in the vertical direction.

Step 3 : Add the products and write as output $c_{k}$.

Step 4 : Shift array $b$, one sample to the right and repeat Steps 2 and 3.

Convolution Table:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0059.jpg?height=25&width=290&top_left_y=474&top_left_x=569)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0059.jpg?height=223&width=340&top_left_y=518&top_left_x=528)

where

$$
c_{k}=\sum_{\jmath=0}^{n} a_{k-\jmath} b_{\jmath}, \quad k=0,1,2, \cdots, m+n-1 .
$$

Table 1-6. Convolution of the reflectivity sequence $\left(1,0, \frac{1}{2}\right)$ with the source wavelet $\left(1,-\frac{1}{2}\right)$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0059.jpg?height=292&width=428&top_left_y=957&top_left_x=528)

Table 1-7. Crosscorrelation of wavelet 1 with wavelet. 2.

|  | 2 | 1 | -1 | 0 | 0 |  |  | Output | Lag |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 0021 |  |  |  |  |  |  |  | -2 | -4 |
| 002 | 1 |  |  |  |  |  |  | 1 | -3 |
| 00 | 2 | 1 | -1 |  |  |  |  | 6 | -2 |
| 0 | 0 | 2 |  | -1 |  |  |  | 1 | -1 |
|  | 0 | 0 | 2 | 1 | -1 |  |  | -2 | 0 |
|  |  | 0 | 0 | 2 | 1. |  |  | 0 | 1 |
|  |  |  | 0 | 0 | 2 | 1 |  | 0 | 2 |
|  |  |  |  | 0 | 0 | 2 | $1-1$ | 0 | 3 |
|  |  |  |  |  | 0 | 0 | $2 \quad 1-1$ | 0 | 4 |

tron is another time-domain operation that is used to make such measurements. Consider the following two wavelets:

Whvelet 1: $(2,1,-1,0,0)$

Wavelet 2: $(0,0,2,1,-1)$

Although these wavelets are identical in shape, wavelet 2 is shifted by two samples with respect to wavelet 1 . The time lag at which they are most similar can be determined. To do this, perform the operation on wavelet 1 as described in Table 1-5 without reversing wavelet 2 (omit Step 1). This is crosscorrelation and the result is shown in Table 1-7. Crosscorrelation measures how much two time series resemble each other.

From Table 1-7, note that maximum correlation occurs at lag -2 . This suggests that if wavelet 2 were shifted two samples back in time, then these two wavelets would have maximum similarity.

Table 1-8 shows the crosscorrelation values that result when the arrays are interchanged. This time the maximum correlation occurs at lag 2 . Thus, if wavelet

Table 1-8. Crosscorrelation of wavelet 2 with wavelet 1.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0060.jpg?height=249&width=422&top_left_y=996&top_left_x=80)

Table 1-9. Crosscorrelation of wavelet 1 with wavelet 2 and crosscorrelation of wavelet 2 with wavelet I.

| Wavelet 1 <br> with Wavelet 2 | Crosscorrelation <br> Output Lag | Wavelet 2 <br> with Wavelet 1 |
| :---: | :---: | :---: |
| -2 | -4 | 0 |
| 1 | -3 | 0 |
| 6 | -2 | 0 |
| 1 | -1 | 0 |
| -2 | 0 | -2 |
| 0 | 1 | 1 |
| 0 | 2 | 6 |
| 0 | 3 | 1 |
| 0 | 4 | -2 |

1 were shifted by two samples forward in time, these two wavelets would have maximum similarity.

Unlike convolution, crosscorrelation is not commutatwe the output depends on which array is fixed and which is moved. Table 1-9 shows a comparison of the crosscorrelation results listed in Tables 1-7 and 1-8.

Crosscorrelation of a time series with itself is known as autocorrelation. Table 1-10 shows the autocorrelation lags of wavelet 1 . Note that maximum correlation occurs at zero lag, an important property of autocorrelation. Moreover, the autocorrelotion function as symmetric. This is a property of a real time series. Therefore, only one side of the antocorrelation needs to be computed.

It is heuristically shown in the next section on frequency filtering that convolution in the time domain is equivalent to multiplication in the frequency domain (Bracewell, 1965). Since correlation is a convolution without reversing the moving array (Table 1-5), a simi-

Table 1-10. Autocorrelation of wavelet 1.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0060.jpg?height=255&width=426&top_left_y=986&top_left_x=536)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0061.jpg?height=290&width=403&top_left_y=125&top_left_x=84)

FIG. 1.1-19. The frequency-domain description of convolution and correlation.

lar frequency-domain operation also applies to correlation.

Figure 1.1-19 is a summary of frequency-domain descriptions of convolution and correlation. Note the following properties for convolution and correlation:

(a) Both convolution and correlation produce an output with a spectral bandwidth that is common to both of the input series. The immediate example is the band-pass filtering process.

(b) Phases are additive in case of convolution and subtractive in case of correlation (Bracewell, 1965).

(c) For autocorrelation, this implies that the output series is zero-phase. This fact already was verified by the example in Table 1-10 where it was shown that the autocorrelation is symmetric with respect to zero lag.

As a measure of similarity, crosscorrelation is used widely at various stages of data processing. For instance, traces in a CMP gather are crosscorrelated with a pilot trace to compute residual statics shifts (Section 3.3). The fundamental basis for computing velocity spectra is crosscorrelation (Section 3.2). The constituent elements of the Wiener filter (Section 2.3) are crosscorrelation of the desired output waveform with the input wavelet, and autocorrelation of the input wavelet.

## Vibroseis Correlation

One other important process is the vibroseis correlation. This involves crosscorrelation of a swecp signal with the recorded vibroseis trace. The sweep is a frequencymodulated vibroseis source signal input to the ground.
The convolutional model for vibroseis data is described in Section 2.5.

Figure 1.1-20 shows a vibroseis sweep signal, a recorded common-source gather, and the correlated gather. The sweep length is $10 \mathrm{~s}$ with a frequency band of 6 to $60 \mathrm{~Hz}$. The 15-s uncorrelated vibroseis record yields a 5 -s correlated record. Note that the early part of the uncorrelated record contains low-frequency energy with increasingly higher frequencies at late times. This is because an upsweep (frequency increasing with time) signal was used in this data example.

## Frequency Filtering

What happens to a wavelet when its amplitude spectrum is changed while its zero-phase character is preserved? To begin, consider the wavelet in Figure 1.1-21 (summed trace 1) resulting from superposition of two very low-frequency components. Then, add increasingly higher frequency components to the Fourier synthesis (summed traces 2 through 5). Note that the wavelet in the time domain is compressed as the frequency bandwidth (the range of frequencies summed) is increased. Ultimately, if all the frequencies in the inverse Fourier transformation are included, then the resulting wavelet becomes a spike, as seen in Figure 1.1-22 (summed trace 6). Therefore, a spike is characterized as the in-phase synthesis of all frequencies from zero to the Nyquist. For all frequencies, the amplitude spectrum of a spike is unity, while its phase spectrum is zero.

Figure 1.1-23 shows five zero-phase wavelets, synthesized as shown in Figure 1.1-21. Note that all of them have band-limited amplitude spectra. A zerophase band-limited wavelet can be used to filter a seismic trace. The output trace contains only those frequencies that make up the wavelet used in filtering. The time-domain representation of the wavelet is the filter operator. The individual time samples of this operator are the filter coefficients. The process described here is zero-phase frequency filtering, since it does not modify the phase spectrum of the input trace, but merely band-limits its amplitude spectrum.

Frequency-domain filtering involves multiplying the amplitude spectrum of the input seismic trace by that of the filter operator. The procedure is described in Figure 1.1-24. On the other hand, the filtering process in the time domain involves convolving the filter operator with the input time series. Figure 1.1-25 is a description of the filter design and its time-domain application. The frequency- and time-domain formulations of the filtering process (Figures 1.1-24 and 1.1-25) are besed on the following important concept in time series
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0062.jpg?height=750&width=848&top_left_y=132&top_left_x=84)

FIG. 1.1-20. Vibroseis correlation: the sweep signal is correlated with the recorded vibroseis record to get correlated field data. A 10 -s sweep and 15 -s recorded data yield a 5 -s correlated record.

analysis (Section A.1): Convolution in the tome doman is equivalent to multiplication in the frequency domain. Similarly, convolution in the frequency domain is equvalent to multaplicatron on the trme doman.

Frequency filtering can be in the form of band-pass, band-reject, high-pass (low-cut), or low-pass (high-cut) filters. All of these filters are based on the same principle - construction of a zero-phase wavelet with an amplitude spectrum that meets one of the four specifcations

Band-pass filtering is used most commonly, because a seismic trace typically contains some low-frequency noise, such as ground roll, and some high-frequency ambient noise. The usable seismic reflection energy usually is confined to a bandwidth of approximately 10 to 70 $\mathrm{Hz}$, with a dominant frequency around $30 \mathrm{~Hz}$.

Band-pass filtering is performed at various stages in data processing. If necessary, it can be performed before deconvolution to suppress remaining ground-roll energy and high-frequency ambient noise that otherwise would contaminate signal autocorrelation. Narrow band-pass filtering may be necessary before crosscorrelating traces in a CMP gather with a pilot trace for use in estimating residual statics shifts (Section 3.3).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0063.jpg?height=549&width=784&top_left_y=122&top_left_x=116)

FIG, 1.1-21. The summation of zero-phase sinusoids with identical peak amplitudes. Traces resulting from each summation are numbered from 1 to 5 . As the frequency bandwidth is increased, the synthesized zero-phase wavelet is increasingly compressed.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0063.jpg?height=419&width=818&top_left_y=763&top_left_x=103)

FIG. 1.1-22. The output wavelet becomes a spike (summed trace 6) when the summation includes sinusoids at all frequencies up to the Nyquist frequency, Compare this with output treses 1 through 5 in Figure 1.1-21.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=140&width=802&top_left_y=124&top_left_x=122)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=128&width=183&top_left_y=285&top_left_x=124)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=131&width=150&top_left_y=284&top_left_x=306)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=128&width=149&top_left_y=285&top_left_x=465)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=128&width=142&top_left_y=285&top_left_x=622)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=128&width=149&top_left_y=285&top_left_x=772)

(e)

FIG. 1.1-23. A series of zero-phase wavelets (top row) and their respective amplitude spectra (bottom row). As bandwidth is increased, the wavelet is more compressed in time.

Band-pass filtering also can be performed before computing crosscorrelations during construction of the velocity spectrum for improved velocity picking (Section 3.2). Finally, it is a standard practice to apply a timevariant band-pass filter to stacked data (Section 1.5).

## Practical Aspects of Frequency Filtering

Application of a filter in the frequency or time domain (Figures 1.1-24 and 1.1-25) yields basically identical results. In practice, the time-domain approach is favored, since convolution involving a short array, such as a filter operator, is more economical than applying Fourier transforms.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=293&width=396&top_left_y=888&top_left_x=93)

FIG. 1.1-24. Design and application of a zero-phase filter in the frequency domain.
From Figure 1.1-23, the fundamental property of frequency filters can be stated as follows: The broader the bandwedth, the more compressed the filter operator; thus, fewer filter coefficuents are requared. This property also follows from the fundamental concept that the trme span of a time serzes is inversely proportional to ats spectral bandwidth.

In designing a band-pass filter, the goal is to pass a certain bandwidth with little or no modification, and to largely suppress the remaining part of the spectrum as much as practical. At first, it appears that this goal can be met by defining the desired amplitude spectrum for the filter operator as follows:

$$
A(f)= \begin{cases}1, & f_{1}<f<f_{2} \\ 0, & \text { otherwise, }\end{cases}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0064.jpg?height=277&width=382&top_left_y=904&top_left_x=560)

FIG. 1.1-25. Design of a zero-phase frequency filter and its application in the time domain.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0065.jpg?height=203&width=310&top_left_y=126&top_left_x=74)

TIME TME I

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0065.jpg?height=241&width=307&top_left_y=386&top_left_x=74)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0065.jpg?height=201&width=257&top_left_y=128&top_left_x=399)

TIME IM EC

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0065.jpg?height=230&width=257&top_left_y=397&top_left_x=398)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0065.jpg?height=195&width=258&top_left_y=134&top_left_x=673)

TIME $\{M E C)$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0065.jpg?height=249&width=250&top_left_y=381&top_left_x=674)

(c)

FIG. 1.1-26. Three zero-phase wavelets (top row) and their respective amplitude spectra (bottom row). (a) The steeply defined slopes of the passband cause ripples in the wavelet and the actual amplitude spectrum. (b) A moderate and (c) gentle slope help eliminate the ripples. Refer to the text for a discussion of corner frequencies $A_{1}, B, C$, and $D$.

where $f_{1}$ and $f_{2}$ are the cutoff frequencies. This is known as the boxcar amplitude spectrum.

To analyze the properties of such a filter, perform the following sequence of operations:

(a) Define a boxcar amplitude spectrum and zero phase spectrum.

(b) Apply inverse FFT and obtain a filter operator.

(c) Truncate the operator.

(d) Apply forward FFT and compute the amplitude spectrum of the truncated operator.

Figure 1.1-26a shows the results of this sequence of operations. The operator is at the top, and the actual and desired (boxcar) amplitude spectra are superimposed at the bottom. Note that the actual spectrum has a ringy character. This is known as the Gibbs phenomenon (Bracewell, 1965), and results from representing a boxcar with a finite number of Fourier coefficients. From a practical standpoint, the ringing is undesirable, since some of the frequencies in the passband are amplified, while others are attenuated. Additionally, some of the frequencies in the reject zones on both sides of the boxcar are passed.

How is the Gibbs phenomenon circumvented? Instead of defining the desired passband as a boxcar, assign slopes on both sides as shown in Figure 1.1$26 \mathrm{~b}$, and thus define the passband as a trapezoid. Note that the actual and desired amplitude spectra are now closer in agreement and the operator is more compact (it has fewer nonzero coefficients). However, in achieving a more compact operator, the shape of the desired spectrum has been compromised and the passband is broader than intended. The trapezoid slopes must be sufficiently gentle to achieve a satisfactory result as in Figure 1.1-26c, where the actual and desired spectra are approximately equal and the operator is compact. This is most desirable in practice, since it is best to work with operators that are as short as possible. It is recommended that a gentler slope be assigned on the high-frequency side relative to the low-frequency side of the passband. Finally, while defining the passband as a trapezoid, smoothing also must be applied at the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0066.jpg?height=302&width=512&top_left_y=126&top_left_x=102)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0066.jpg?height=138&width=155&top_left_y=287&top_left_x=301)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0066.jpg?height=136&width=160&top_left_y=289&top_left_x=454)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0066.jpg?height=288&width=154&top_left_y=136&top_left_x=620)

(d)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0066.jpg?height=290&width=152&top_left_y=136&top_left_x=778)

(e)

FIG. 1.1-27. Solid bars indicate the live length (nonzero coefficients) of the band-pass filter operator. Severe truncation (a) causes significant departure of the actual amphtude spectrum from the desired (trapezoid) amplitude spectrum, which is the same in all five cases.

corner frequencies (A, B, C, and $D$, as indicated in Figure 1.1-26c). This must be done because the Fourier transform exists only for continuous functions (Bracewell, 1965).

How short can the operator be? Figure 1.1-27 shows a sequence of increasingly longer operators. Solid bars indicate the operator length of the truncated filters. Note that excessive truncation causes a large deviation from the desired amplitude spectrum even though reasonable slopes were provided to the passband. Extension of the operator length brings the desired and actual spectra closer. However, there is a certain length beyond which nearly zero coefficients are added to the operator. The criterion that is used to define the operator length is that the frequency bandundth os unversely proportional to the effectrve length of the operator.

## Bandwidth and Vertical Resolution

Frequency filtering is intimately tied to vertical (temporal) resolution of seismic data. Consider the filter operators in Figure 1.1-28. Both have the same effective bandwidth - the difference between the high-cut and low-cut frequencies. Therefore, the envelopes of the two operators are identical. The greater ringyness of the second operator (Figure 1.1-28b) results from its lower bandwidth ratio the ratio of the high-cut to the lowcut frequency.

There is a common misunderstanding that only high frequencies are needed to increase temporal resolution. This is not true. The top frame in Figure 1.1-29 shows a single refector and three sets of closely situated reflectors with $48-, 24-$ and $12-\mathrm{ms}$ time separations. A series of narrow band-pass filters is applied to these data as shown in the lower frames. The reflectors with the 48 -ms separation are resolved reasonably well by using the $10-\mathrm{to}-20 \mathrm{-Hz}$ bandwidth. However, the more closely
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0066.jpg?height=364&width=414&top_left_y=726&top_left_x=538)

FIG. 1.1-28. Two wavelets (top row) with the same bandwidth (bottom row). The passband of wavelet (B) is centered at $15 \mathrm{~Hz}$, while that of wavelet (b) is centered at $35 \mathrm{~Hz}$. Both wavelets have ripples, although one is low and the other is high frequency in character. Just having low or high frequencies does not suffice; both are needed to increase temporal resolution.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0067.jpg?height=250&width=424&top_left_y=126&top_left_x=72)
$10-20 \mathrm{~Hz}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0067.jpg?height=106&width=414&top_left_y=399&top_left_x=81)
$20-30 \mathrm{~Hz}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0067.jpg?height=114&width=417&top_left_y=528&top_left_x=81)
$30-40 \mathrm{~Hz}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0067.jpg?height=106&width=412&top_left_y=665&top_left_x=84)

## $40-50 \mathrm{~Hz}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0067.jpg?height=113&width=413&top_left_y=794&top_left_x=83)

## $50-60 \mathrm{~Hz}$

FIG. 1.1-29. The top section is a reflectivity model that consists of, from left to right, three reflector with $48-\mathrm{ms}$ separation, three reflectors with $24-\mathrm{ms}$ separation, three reflectors with 12-ms separation, and a single reflector - all centered at $1 \mathrm{~s}$. Band-limited responses (the same bandwidth, $10 \mathrm{~Hz}$, centered at different frequencies) do not provide good resolution.

situated reflectors cannot be resolved with this filter. For the $20-$ to $-30-\mathrm{Hz}$ bandwidth, again, the $48-\mathrm{ms}$ reflectors are reasonably separated. Nevertheless, none of the narrow band-pass filters provides the resolution needed to distinguish the reflectors situated with smaller separations. Just havng low or high frequencies does not

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0067.jpg?height=705&width=417&top_left_y=126&top_left_x=535)

FIG. 1.1-30. The top section is the same reflectivity model as in Figure 1.1-29. Reflectors with large separation ( $48 \mathrm{~ms}$ ) are resolvable with a bandwidth as low as 10 to $30 \mathrm{~Hz}$. However, reflectors with smaller separation ( 24 and $12 \mathrm{~ms}$ ) require increasingly larger bandwidths for resolution.

improve temporal resolution. Both low and high frequencaes are needed to nncrease temporal resolution. This is demonstrated further in Figure 1.1-30. Note that closely situated reflectors can be resolved only with increasingly broader bandwidth. The $10-\mathrm{to}-30-\mathrm{Hz}$ bandwidth is sufficient to resolve the reflectors with $48-\mathrm{ms}$ separation. The $10-$ to $-50-\mathrm{Hz}$ bandwidth is sufficient to resolve the reflectors with 24 -ms separation. Finally, the 10 to $-100-\mathrm{Hz}$ bandwidth is needed to resolve the reflectors that are separated by $12 \mathrm{~ms}$. There is a close relationship between the amount of separation and the desired bandwidth (Section 11.1).

## Time-Variant Filtering

The seismic spectrum, especially the high-frequency end, is subject to absorption along the propagation path because of the intrinsic attenuation of the earth (Section 1.4). Consider the portion of a stacked section and its narrow band-pass filtered panels in Figure 1.1-31. A signal is present from top to bottom within the 10-to-20-, 20-to-30-, 30-to-40-, and $40-$ to- $50-\mathrm{Hz}$ bands. Not much signal is noted below $3.5 \mathrm{~s}$ in the $50-\mathrm{to}-60-\mathrm{Hz}$ band. Nevertheless, the signal content appears to be retained down to $3.5 \mathrm{~s}$ with the $60-\mathrm{to}-70-\mathrm{Hz}$ band. Finally, the $70-$ to- $80-\mathrm{Hz}$ band shows signal down to $2.5 \mathrm{~s}$. Higher frequency bands of useful signal are confined to the shallow part of the section. Thus, temporal resolution is reduced greatly in the deeper portion of the section.

From a practical standpoint, the time-variant character of the signal bandwidth requires an application of frequency filters in a time-varying manner. By so doing, the ambient noise, which begins to dominate the signal at late times, is excluded and a section with a higher signal-to-noise ratio is obtained. Table 1-11 lists the time-variant filter (TVF) parameters selected from the panels in Figure 1.1-31. The filtered section is shown on the far right panel of the same figure. In practice, the filters are blended across adjacent time windows to establish a smooth transition of the passband regions.

A second band-pass series of filter scans, which is shown in Figure 1.1-32, allows an assessment of the right choice of the bandwidth for a given time gate. Here, we start with a narrow band-pass filter at the lowfrequency end of the spectrum and gradually broaden the passband by including higher frequencies

For some data, the bandwidth may be kept quite large from top to bottom. The stacked section in Figure 1.1-32 can tolerate wide-band filtering from early to late times. The filter panels for the stacked section in Figure 1.1-33, however, indicate that the signal band rapidly becomes confined to lower frequencies at late times. A signal is present from top to bottom within the

Table 1-11. Time-variant filter parameters for the data shown in Figure 1.1-31. The frequency values correspond to the corner frequencies described in Figure 1.126 .

| Time, <br> ms | Filter Band, <br> $\mathrm{Hz}$ |
| :---: | :---: |
| 0 | $5,1070,80$ |
| 2500 | $5,1060,70$ |
| 3500 | $5,10-50,60$ |
| 5000 | $5,10-40,50$ |

frequency bands up to $40 \mathrm{~Hz}$. Noise is noted below 2.5 $\mathrm{s}$ in the $40-\mathrm{to}-50-\mathrm{Hz}$ band. This noise quickly builds up to shallower times at a higher frequency band.

Time-variant filters typically are applied on stacked data. A uniform bandwidth must be established when filtering two sets of data that may have different vintages, source types, or noise levels. This is especially significant when trying to tie two lines and follow a re flector across them. The interpreter uses the frequency character of a marker horizon as a reference in the tracking procedure. Therefore, two intersecting lines should be filtered so that the reflection character is consistent from one to the other, thus simplifying the interpretation.

### 1.2 THE 2-D FOURIER TRANSFORM

Multichannel processing operations can be loosely defined as those that must operate on several data traces, simultaneously. Multichannel processes can be useful in discriminating against noise and enhancing signal on the basis of a criterion that can be distinguished from trace to trace, such as dip or moveout. The 2-D Fourier transform is a basis for both analysis and implementation of multichannel processes.

Consider the six zero-offset sections in Figure 1.21. The trace spacing is $25 \mathrm{~m}$ with 24 traces per section. All have monochromatic events with $12 \mathrm{~Hz}$ frequency, but with dips that vary from 0 to $15 \mathrm{~ms} /$ trace. From the discussion on the 1-D Fourier transform (Section 1.1), we know about frequency, particularly temporal frequency, or the number of cycles per unit time. This is the Fourier dual for the time variable. However, a seismic wavefield is not only a function of time, but also a function of a space variable (offset or midpoint axis). The Fourier dual for the space variable is defined as spatial frequency, which is the number of cycles per unit distance, or wavenumber. Just as the temporal frequency of a given sinusoid is determined by counting the number of peaks within a unit time, say $1 \mathrm{~s}$, the wavenumber of a dipping event is determined by counting the number of peaks within a unit distance, say 1 $\mathrm{km}$, along the horizontal direction. Just as the temporal Nyquist frequency is defined as in equation (1-1), the Nyquist wavenumber is defined as

$$
k_{N y q}=\frac{1}{2 \Delta x}
$$

where $\Delta x$ is the spatial sampling interval. For all of the sections in Figures 1.2-1 through 1.2-6, the Nyquist wavenumber is $20 \mathrm{cycles} / \mathrm{km}$, since the trace interval is $25 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0069.jpg?height=441&width=758&top_left_y=118&top_left_x=134)

FIG. 1.1-31. The far left panel is a portion of a CMP stack without filtering. The following panela show the same data with different narrow band-pass filters. The frequency bands specified correspond to the corner frequencies $B$ and $C$ in Figure 1.1-26. Appropriate slopes were assigned to both low- and high-frequency ends of each passband. The far right panel is the same section as that in the far left panel after the application of the time-variant filter specified in Table 1-11.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0069.jpg?height=475&width=741&top_left_y=667&top_left_x=136)

FIG. 1.1-32. The far left panel is a portion of a CMP stack without filtering. The remaining panels show the same data with different band-pass filters which have increasingly wider passbands. The frequency bands specified correspond to the corner frequencies B and $\mathrm{C}$ in Figure 1.1-26. Appropriate slopes were assigned to both low- and high-frequency ends of each passband.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0070.jpg?height=1008&width=754&top_left_y=124&top_left_x=144)

FIG. 1.1-33. The upper far left penel is a portion of a CMP stack without filtering. The remaining panels show the same data with different narrow band-pass filters.

To compute the wavenumber that is associated with the section corresponding, say, to the $15-\mathrm{ms} /$ trace dip in Figure 1.2-1, follow a peak or trough across the section. First compute the total time difference along the selected peak or trough across the section:

$$
(23 \text { traces })(15 \mathrm{~ms} / \mathrm{trace})=345 \mathrm{~ms} .
$$

Then convert this to number of cycles by dividing by the (temporal) period:

$$
\frac{345 \mathrm{~ms}}{(1000 \mathrm{~ms} / \mathrm{s}) /(12 \text { cycles } / \mathrm{s})}=4.14 \text { cycles. }
$$

The spatial extent of the section is $575 \mathrm{~m}$; therefore, the wavenumber associated with the $15-\mathrm{ms} /$ trace dip and the $12-\mathrm{Hz}$ frequency is

$$
\frac{4.14 \text { cycles }}{0.575 \mathrm{~km}}=7.2 \mathrm{cycles} / \mathrm{km} .
$$

To continue this discussion, we will map these sections to the plane of temporal frequency versus spatial wavenumber, then look at two quadrants of this plane. The following convention will be used: Events with downdip to the right are assigned positive dip, while events with updip to the right are assigned negative dip. Additionally, positive dips map onto the right quadrant, which corresponds to positive wavenumbers, while negative dips map onto the left quadrant, which corresponds to negative wavenumbers.

The plane of frequency-qavenumber (the $f-k$ plane) appears at the bottom of each section in Figure 1.2-1. The section with zero-dip events maps onto a single point on the frequency axis at $12 \mathrm{~Hz}$. Zero dip is equivalent to zero wavenumber. The magnitude of the spike corresponds to the peak amplitude of the sinusoids that make up the traces in the section. Therefore, the $f-k$ plane actually represents the $2-\mathrm{D}$ amplitude spectrum of the section in the $t-x$ domain. These data have been transferred from the time-space domain to the frequency-wavenumber domain. This process is described mathematically by the 2-D Fourier transform.

There is a practical relationship between the four variables: timespace $(t-x)$, and their Fourier duals, frequency-wavenumber $(f-k)$. Measure the inverse of the stepout in the 15-ms/trace section in Figure 1.2-1 by following a peak, trough, or zero crossing from trace to trace. Stepout is defined as the slope $\Delta t / \Delta x$. In this case, the inverse of the stepout is

$$
\frac{\Delta x}{\Delta t}=\frac{0.575 \mathrm{~km}}{0.345 \mathrm{~s}}=1.67 \mathrm{~km} / \mathrm{s}
$$

Now, compute the ratio:

$$
\frac{f}{k}=\frac{12 \text { cycles } / \mathrm{s}}{7.2 \mathrm{cycles} / \mathrm{km}}=1.67 \mathrm{~km} / \mathrm{s}
$$

From this, the inverse of the stepout measured in the $t-x$ domain along a constant phase is equal to the ratio of the frequency to the wavenumber associated with the event

$$
\frac{\Delta x}{\Delta t}=\frac{f}{k}
$$

Therefore, whle retaining ficed stepout, doubing the frequency means doubling the wavenumber.

Note that all sections in Figure 1.2-1 have the same frequency component. However, from 0 to $15 \mathrm{~ms} / \mathrm{trace}$, the number of peaks increases horizontally across each section. That is, for a given frequency, higher dips are assigned to higher wavenumbers, as seen on the $f-k$ plots.

## Spatial Aliasing

From Figures 1.2-1 through 1.2-6, consider the same dip components, but at different frequencies. Map each individual section to the $f-k$ plane. Nothing unusual happens until the section with $15-\mathrm{ms} /$ trace dip at $36 \mathrm{~Hz}$ is reached in Figure 1.2-3. Here there is no positive dip. In fact, as a whole, the section displays a checkerboard character making it difficult to determine whether the dip is positive or negative.

At $48 \mathrm{~Hz}$ (Figure 1.2-4), the correct dip direction is observed in the first four sections. However, the fifth section, which corresponds to the $12-\mathrm{ms} / \mathrm{tr}$ ace positive dip, shows a negative dip. Therefore, it is mapped onto the negative quadrant, which is the wrong quadrant for this section. This dip component ( $12 \mathrm{~ms} / \mathrm{trace}$ ) at this frequency $(48 \mathrm{~Hz})$ is spatzally alased. In fact, any dip greater than $\mathbf{1 2} \mathrm{ms} /$ trace is spatially aliased at this frequency.

In the next set of sections in Figure 1.2-5, spatial aliasing occurs at $60 \mathrm{~Hz}$ for a $9-\mathrm{ms} /$ trace dip. Spatial aliasing not only culses mapping to the wrong quadrant, but also causes mapping with the wrong dip. One obvious example of this is mapping a $15-\mathrm{ms} / \mathrm{trace}$ dip at $60 \mathrm{~Hz}$ (Figure 1.2-5). Finally, at $72 \mathrm{~Hz}$ (Figure 1.2-6), the 6-ms/trace dip component is on the verge of spatial aliasing. Moreover, the $15-\mathrm{ms} /$ trace dip component is spatially aliased twice; it folds back to the positive-dip quadrant and appears at a lower dip.

This same analysis can be used for the negativedip components. From Figures 1.2-1 through 1.2-6, note that each section as a whole was mapped onto a single point in the frequency-wavenumber domain. Each section has an associated unique frequency and wavenumber assigned to it. These zero-offset sections can be considered representations of plane waves that propagate at a unique angle from the vertical and carry a monochromatic signal. The wavefront is defined as the line of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0072.jpg?height=467&width=678&top_left_y=124&top_left_x=169)

FIG. 1.2-1. Top row: Six gathers, each containing $12-\mathrm{Hz}$ monofrequency events with different dips ranging from 0 to 15 $\mathrm{ms} /$ trace. Trace spacing is $25 \mathrm{~m}$. Bottom row: Their respoctive amplitude spoctra. The dots on the spectra represent the mapping of cvents on the gathers. The solid vertical lines are the froquency axis. If the positivc dips are defined as downdip from left to right, then all cvents map onto the positive quadrant in the frequency-wavenumber $(f-k)$ planc. This is the first in a series of six figures that describes mapping of monofrequency sygnals in the ( $f-k$ ) domain (Figures 1.2-1 through 1.2-6).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0072.jpg?height=471&width=659&top_left_y=726&top_left_x=189)

FIG. 1.2-2. The same as Figure 1.2-1, except using 24-Hz monofroquency events.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0073.jpg?height=470&width=683&top_left_y=122&top_left_x=123)

FIG. 1.2-3. The same as Figure 1,2-1, except using $36-\mathrm{Hz}$ monofrequency events.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0073.jpg?height=473&width=673&top_left_y=716&top_left_x=133)

FIG. 1.2-4. The same as Figure 1.2-1, except using $48-\mathrm{Hz}$ monofrequency cvents.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0074.jpg?height=467&width=663&top_left_y=113&top_left_x=228)

FIG. 1.2-5. The same as Figure 1.2-1, except using $60-\mathrm{Hz}$ monofrequency events.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0074.jpg?height=470&width=673&top_left_y=704&top_left_x=219)

FIG. 1.2-6. The same as Figure $12-1$, except using $72-\mathrm{Hz}$ monofrequency events.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0075.jpg?height=476&width=660&top_left_y=124&top_left_x=167)

FIG. 1.2-7. Top row: Six gathers, each formed by summing gathers of the like dips in Figures 1 2-1 through 1.2-6. The trace spacing is $25 \mathrm{~m}$. Bottom row: Respective amplitude spectra.

constant phase, while the direction of propagation is perpendicular to the wavefront. Since a seismic wavefield is a superposition of many dips and frequencies, it is equivalent to the synthess of many plane-wave com ponents. In this respect, the physical meaning of the 2-D Fourier transform is important, for it is an analyoss (decomposition) of a wavefield into its plane-wave components.

A recorded wavefield is a composite of many dip and frequency components, such as those shown in Figures 1.2-1 through 1.2-6. Suppose that sections with the same dip, but with different frequencies, are superimposed. The composite sections are shown in Figure 1.2-7 with the composite amplitude spectra below each section. For a given dip, all frequency components map onto the $f-k$ plane along a straight line that passes through the origin. The higher the dip, the closer the radial line in the $f-k$ domuin is to the wavenumber axis. The zero-dip components map along the frequency axis. From the $9-12-$, and $15-\mathrm{ms} /$ trace dips, note that the spatially aliased frequencies are located along the linear segments that wrap around to the opposite quadrant in the amplitude spectrum. The steeper the dip, the lower the frequency at which spatial alzasing occurs.

So far, a discrete number of frequencies was considered. For a continuum of frequency components associated with a single dip, we anticipate that they would map along a straight, continuous line in the $f-k$ domain, as shown in Figure 1.2-8. While the dipping event in Figure $1.2-8$ is not aliased, the dipping event in Figure 1.2-9 is spatially aliased beginning at approximately $21 \mathrm{~Hz}$.

Examination of the monochromatic single-dip sections in Figures 1.2-1 through 1.2-6 shows that each section maps onto a single point in the $f-k$ domain. An extension of this observation is made in Figure 1.2-10. Events with the same dip in the $t-x$ domain, regardless of their location, mup onto a single radial line in the $f-k$ domain. When events are spatially aliased, the radial line wraps around at the Nyquist wavenumber (Figure 1.2-11). These concepts have important practical implications, for they lead to $f-k$ dip filtering of coherent linear noise (Section 6.2). Events with different dips that may interfere in the $t-x$ domain can be isolated in the $f-k$ domain.

The numerical computation of the 2-D Fourier transform involves two 1-D Fourier transforms. Figure 1.2-12 shows the steps that are involved. A brief mathematical formulation of the 2-D Fourier transform is given in Section A.2.

In summary, 2-D Fourier transformation is a way to decompose a wavefield into its plane-wave components. Each plane wave carries a monochromatic signal that

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0076.jpg?height=678&width=425&top_left_y=124&top_left_x=81)

FIG. 1.2-8. A single, isolated dipping event and its 2-D amplitude spectrum. No frequency is spatially aliased. What is the dip of the event in milliseconds per trace?

propagates at a certain angle from the vertical. Events with the same dip in the $t-x$ domain, regardless of location, are mapped onto a single line in the radial direction in the $f-k$ domain. In Chapter 4 , we shall discuss migration methods in the $f-k$ domain, and in Chapter 6, we shall demonstrate use of $f-k$ filtering to remove coherent linear noise and attenuate multiples.

Spatial aliasing has serious effects on the performance of multichannel processes such as $f-k$ filtering (Section 6.2) and migration (Section 4.6). Because of spatial aliesing, these processes can perceive events with steep dips at high frequencies as different from what they actually are and, hence, do not treat them properly. For example, migration moves the spatially aliased

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0076.jpg?height=682&width=425&top_left_y=125&top_left_x=539)

FIG. 1.2-9. A singlc, tsolated dipping event and its 2-D amplitude spoctrum, Frequencies beyond $21 \mathrm{~Hz}$ are spatially aliased.

frequency components in the wrong direction and generates a dispersive noise that degrades the quality of the migrated section.

How is spatial aliasing avoided? Compare the sections in Figures 1.2-8 and 1.2-9. Both have the same frequency content, 6 to $42 \mathrm{~Hz}$. The data in Figure 1.2-9 are spatially aliased because the dipping event is steeper than in Figure 1,2-8. Some ways to avoid spatial aliasing follow:

(a) Apply time shifts so that the steep events appear to have lower dips. Although this could change the dips that were low to higher dips, making them spatially aliased, it often is a feasible solution for

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0077.jpg?height=695&width=423&top_left_y=118&top_left_x=74)

FIG, 1,2-10. Six events with identical dip in the $t-x$ domain map onto the same radial line in the $f-k$ domain. No frequencies are aliased. The dip of these events is the same as that of the single event in Figure 1.2-8. What distinguishes this spectrum from that in Figure 1.2-8?

certain situations. For instance, a linear moveout can be applied to CMP gathers to circurnvent spatial aliasing of shallow events in prestack migration (Li et al,, 1991). Also, a hyperbolic moveout can be applied to CMP gathers before multiple attenuation in the $f-k$ domain (Section 6.2).

(b) If a low-pass filter were applied to the traces in Figure 1.2-9 so that the frequencies up to $21 \mathrm{~Hz}$ were retained, then the segment that is wrapped around to the negative quadrant of the amplitude spectrum is removed. Although spatial aliasing is eliminated, a significant part of the recorded frequency band is lost. This approach is not desirable.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0077.jpg?height=695&width=427&top_left_y=118&top_left_x=527)

FIG. 1.2-11. Six events with identical dip in the $t-x$ domain map onto the samc radial linc in the $f-k$ domain. Frequencies beyond $21 \mathrm{~Hz}$ are aliascd. The dip of these events is the same as that of the single event in Figure 1.2-9.

(c) Figure 1.2-13 shows a single dipping event recorded with three different trace spacings. The 2 -D amplitude spectra suggest a third approach to solving the spatial aliasing problem. Note that the coarser the trace spacing, the more frequencies are spatially aliased. The same frequency bandwidth is kept in all three cases. The $12.5-\mathrm{m}$ trace spacing provides a frequency band with no spatial aliasing. For a $25-\mathrm{m}$ trace spacing, frequencies beyond $36 \mathrm{~Hz}$ are spatially aliased; while for a $50-\mathrm{m}$ trace spacing, frequencies beyond $18 \mathrm{~Hz}$ are spatially aliased For this latter case, spatial aliasing is so severe that the aliased frequencies wrap around the wave-

$$
\begin{gathered}
\text { Input Data, } P(x, t) \\
\downarrow \\
\text { 1-D Fourier Transform } \\
\text { in Time Direction: } \\
P(x, \omega)=\int P(x, t) \exp (-i \omega t) d t \\
\downarrow \\
\text { 1-D Fourier Transform } \\
\text { in Spatial Direction: } \\
P\left(k_{x}, \omega\right)=\int P(\omega, x) \exp \left(i k_{x} x\right) d x
\end{gathered}
$$

FIG. 1.2-12. Computation of the 2-D Fourier transform.

number axis twice. We see that spatial aliasing can be avoided by selecting a sufficiently small trace spacing. This approach requires either a datadependent interpolation scheme (Section 7.2) to generate extra traces or modification of the field recording geometry. If the latter approach were taken, more shots and/or more recording channels are needed.

To circumvent spatial aliasing, data often are recorded with twice as many number of channels per shot record as that would be used in processing. Prior to dropping every other trace at the start of a processing sequence, a wavenumber filter is applied to remove the wavenumber components for all frequencies beyond the Nyquist wavenumber that corresponds to the trace spacing of the data after dropping alternating traces from the shot record. This wavenumber filter actualiy is a spatial high-cut antialias filter akin to the high-cut antialias frequency filter discussed in Section 1.1.

Consider the shot record shown in Figure 1.2-14a recorded with 368 channels at a group interval of 12.5 $\mathrm{m}$. The record which is intended for input to a processing sequence comprises 192 channels with 25 -m group interval. Just as dropping every other sample in a time series can result in frequency aliasing of some of the high frequencies, dropping alternating traces could result in spatial aliasing (Figure 1.2-14b). Note that spatial aliasing in the original record (Figure 1.2-14a) occurs starting at about $75 \mathrm{hz}$. Trace decimation without spatial antialias filter causes spatial aliasing to occur starting at about $40 \mathrm{~Hz}$ (Figure 1.2-14b).

To circumvent spatial aliasing as a result of dropping every other trace in the record, a prior application of a spatial high-cut antialias filter is needed (Figure 1.2-15). Apply a wavenumber filter to remove the energy within the $f-k$ region that is between 50 and 100 wavenumber in both quadrants of the $f-k$ plane
(Figure 1.2-15a). Since the trace spacing of the original record in Figure 1.2-14a is $12.5 \mathrm{~m}$, the corresponding Nyquist wavenumber is 40 cycles $/ \mathrm{km}$. Following trace decimation, the Nyquist wavenumber is $20 \mathrm{cycles} / \mathrm{km}$, corresponding to $25-\mathrm{m}$ trace spacing. Note in the $f-k$ spectrum in Figute 1.2-15a that the wavenumber filter has removed the energy between 20 and $40 \mathrm{cycles} / \mathrm{km}$ for all frequencies in both quadrants. Compare the $f-k$ spectra of the decimated data without (Figure 1.2-14b) and with antialias filtering (Figure 1.2-15b) and note that the wavenumber filter has removed the spatially aliased high-frequency components of the steeply dipping events in the original gather.

The spatial antialias filter design and application involves normal-moveout correction of the data (Section 3.1). Consider the 240 -channel shot record shown in Figure 1.2-16a with $6.25-\mathrm{m}$ group interval. We want to apply spatial antialias filter and reduce the number of channels by half with $12.5-\mathrm{m}$ group interval. Follow the steps below:

(a) Apply normal-moveout correction to the input gather (Figure 1.2-16a) that needs to be decimated to unalias the aliased energy.

(b) Apply 2-D Fourier transform to map the data onto the $f-k$ plane. Following the normal-moveout correction, the energy maps in the $f-k$ plane closer to the frequency axis, thus alleviating the spatial aliasing (Figure 1.2-17a).

(c) Design a spatial antialias filter by specifying reject zones for all frequencies between 50 and 100 wavenumber in both quadrants of the $f-k$ plane.

(d) Apply the wavenumber filter to the moveoutcorrected data in the $f-k$ domain (Figure 1.217b).

(e) Apply inverse Fourier transform of the wavenumber-filtered data (Figure 1.2-16b).

(f) Now drop every other trace to obtain the decimated data (Figure 1.2-16c). The Nyquist wavenumber of the gather following the application of the spatial antialias filter is one-half ot the Nyquist wavenumber of the original gather (Figure 1.2-17c).

(g) Apply inverse moveout correction (Figure 1.2-16d). The resulting shot record contains one-half the number of channels as in the original record (Figure 1.2-16a), and its energy is within the $f-k$ region defined by one-half the Nyquist wavenumber associated with the original record (compare Figures 1.2-17a and 1.2-17d),

The original moveout-corrected shot record (Figure 1.2-16a) after dropping every other trace, but without the application of the antialias wavenumber filter, is shown in Figure 1.2-16e with the $f-k$ spectrum of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0079.jpg?height=1004&width=635&top_left_y=122&top_left_x=200)

FIG. 1.2-13. A single, isolated dipping event sampled at three different trace spacings with the corresponding $f-k$ spectra. No spatial aliasing occurs with the $12.5-\mathrm{m}$ trace spacing (left). Frequencies bcyond $36 \mathrm{~Hz}$ arc aliased with the $25-\mathrm{m}$ trace spacing (center). Double alasing occurs with the $50-\mathrm{m}$ trace spacing (right). Although events on the $f-k$ spectra appear to have different dips, all three have the same dip on the $t-x$ gathers (top). This deceptive character is because of the different horizontal scales used in displaying the $f-k$ spectra.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0080.jpg?height=274&width=536&top_left_y=125&top_left_x=250)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0080.jpg?height=666&width=275&top_left_y=433&top_left_x=254)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0080.jpg?height=665&width=256&top_left_y=431&top_left_x=528)

(b)

FIG. 1.2-14. (a) A shot record with its 2-D amplitude spectrum displayed on top; trace spacing is $12.5 \mathrm{~m}$ and the Nyquist wavenumber is $40 \mathrm{cycles} / \mathrm{km}$. Minimum and maximum offsets are $140 \mathrm{~m}$ and $4727.5 \mathrm{~m}$, respectively. (b) The same record as in (a) with every other trace droppod; hence, trace spacing is $25 \mathrm{~m}$ and the Nyquist wavenumber is $20 \mathrm{cycles} / \mathrm{km}$. Note that little energy is spatially aliased above $75 \mathrm{~Hz}$ in the original rccord (a), whle spatial aliasing occurs beginving at $45 \mathrm{~Hz}$ in the record with every other trace dropped (b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0081.jpg?height=278&width=544&top_left_y=123&top_left_x=241)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0081.jpg?height=665&width=267&top_left_y=431&top_left_x=253)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0081.jpg?height=662&width=256&top_left_y=431&top_left_x=528)

(b)

FIG. 1.2-15. (a) The same shot record as in Figure 1.2-14a after the application of a wavenumber filter to remove the energy beyond half the Nyquist wavenumber for all frequencies. (b) The same record ts in (a) after dropping every other trace. Note that spatial aliasing is circumvented first by applying a high-cut spatial antialiasing wavenumber filter (a) prior to dropping every other trace. In contrast, dropping every other trace without the prior application of an antialias filter causes spatial aliasing of events with large moveout (Figure 1.2-15b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0082.jpg?height=1125&width=762&top_left_y=112&top_left_x=169)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0083.jpg?height=520&width=419&top_left_y=114&top_left_x=72)

## $120 \mathrm{~Hz}$

100

80

60

40

20
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0083.jpg?height=544&width=836&top_left_y=643&top_left_x=73)

FIG. 1.2-17. The $f-k$ spectra of the shot record at various stages as described in Figure 1.2-16.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0084.jpg?height=511&width=436&top_left_y=124&top_left_x=73)

FIG, 1.2-18. A zero-ofiset section (256 traces with $25-\mathrm{m}$ trace spacing) containing 10 dipping events and its 2-D amplitude spectrum. No frequencies are aliased.

the resulting record shown in Figure 1.2-17e. This decimated shot record (Figure 1.2-16e) should be compared with the antialiesed-filtered record (Figure 1.2-16c) after inverse moveout correction (Figures 1.2-16d and $\mathrm{f}$ ). Examine the $f-k$ spectra of the data after trace decimation with (Figure 1.2-17d) and without antialias filtering (Figure 1.2-17f) and note that, for this data set, wavenumber filtering has not been successful in removing spatially aliased energy. Wavenumber filtering for trace decimation is successful if the aliased energy in the original record is confined to the reject zones for all frequencies between 50 and 100 .

So far, only the synthesis of a single dipping event from a discrete number of frequency components has been considered. This analysis now is extended to a range of dips. Figure 1.2-18 shows a section with dips that vary from 0 to 45 degrees and the corresponding 2-D amplitude spectrum. These same dips, but with higher frequency content, also are seen in Figure 1.219. Events with 0-, 5-, 10-, and 15-degree dips are not spatially aliased. The 20 -degree dip is aliased at nearly $72 \mathrm{~Hz}$, the 30 -degree dip at nearly $48 \mathrm{~Hz}$, and the $45-$ degree dip at nearly $36 \mathrm{~Hz}$. Again, the steeper the dip, the lower the frequency at which spatial aliasing occurs.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0084.jpg?height=506&width=425&top_left_y=120&top_left_x=536)

FIG. 1.2-19. A zero-offset section (256 traces with 25 -m trace spacing) containmg 10 dipping events and its 2-D arnplitude spectrum. Steeper dips are aliased at increasingly lower frequencies.

Given a dip value, how is the maximum unaliased frequency determined? Consider the 20-degree dipping event in Figure 1.2-19. First, measure the dip in milliseconds per trace. There are 256 traces in the $t-x$ model with $25-\mathrm{m}$ trace spacing. The 20 -degree dip is equivalent to $7 \mathrm{~ms} / \mathrm{trace}$. Frequency components with periods less than twice the dip are spatially aliased. Thus, given the dip in milliseconds per trace, the threshold frequency at which spatial aliasing begins is 500 per dip. In the present case, the threshold frequency is $500 / 7 \approx 72 \mathrm{~Hz}$. This is verified by examining the amplitude spectrum in Figure 1.2-19.

Figure 1.2-20 shows three field records and their 2$\mathrm{D}$ amplitude spectra, known as $f-k$ spectra. By now, it is easy to recognize and relate various events on the shot gathers to those on the $f-k$ spectra. Event $\mathrm{A}$ is the high-amplitude dispersive coherent noise with very low group velocity. When the spatial extent of these waves broadens, bandwidth in the wavenumber direction becomes smaller. Conversely, when the spatial extent becomes smaller, the event, such as $G$, spans a wider wavenumber bandwidth in the $f-k$ spectrum (compare events A, $F_{1}$ and $G$ ). Events $B$ and $C$ are parts
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0085.jpg?height=774&width=840&top_left_y=124&top_left_x=93)

FIG. 1.2-20. Three common-shot gathers (top) and their $f-k$ spectra (bottom). (The marked events are discussed in the text.) Dip convention: An event maps onto a positive-dip quadrant in the $f-k$ spectrum if it dips down moving from near to far offets. (Data courtesy Deminex Petroleum.)

of the guided wave packet. Event $\mathrm{C}$ contains aliased energy above $42 \mathrm{~Hz}$ (indicated by $\mathrm{D}$ on the $f-k$ spectrum). Primaries and associated multiples are mapped into region $E$ between the frequency axis and event $C$.

Spatial aliasing not only is a concern in a prestack application of a multichannel filter, such as $f-k$ filtering, but also during poststack processing. Specifically, migration of CMP stacked data suffers from spatial aliasing if the trace interval is too coarse. An optimum CMP trace interval to avoid spatial aliasing can be computed as follows. Consider a dipping reflector with a dip angle of $\theta$ (Figure 1.2-21). Also consider a normal-incidence plane wave with a dominant period $T$ recorded at the surface with a trace separation $\Delta x$. (This is the zero-offset case where $\Delta x$ is the CMP trace interval.) From the geometry in Figure 1.2-21, we write

$$
\sin \theta=\frac{v \Delta t}{2 \Delta x}
$$

where $\Delta t$ is the two-way time separation between the arrival times of the plane wave at the two receiver locations, A and B, and $v$ is the medium velocity. Spatral

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0086.jpg?height=497&width=851&top_left_y=119&top_left_x=93)

FIG. 1.2-21. A plane wave reflecting at normal incidence from a dipping reflector with a dip angle $\theta$ grrives at two consecutive receiver locations $A$ and $B$ at the surface with a separation $\Delta x$. Geometry of this plane wave is used to derive equation (1-6).

aliasing occurs when the wavefront separation in time $\Delta t$ equals half the dominant period $T$. When this criterion is applied to equation (1-6), we get the following expression for the maximum threshold frequency, $f_{\text {max }}=1 / T$, that is not aliased for a given dip, velocity, and CMP trace interval:

$$
f_{\max }=\frac{v}{4 \Delta x \sin \theta}
$$

Table 1-12 shows the evaluation of equation (1-7) for a particular numerical example. Equation (1-7) also can be expressed in terms of receiver group interval $2 \Delta x$. Suppose the maximum dip is 30 degrees. If the sampling interval is $4 \mathrm{~ms}$, then the Nyquist frequency is $125 \mathrm{~Hz}$. After antialias filtering, the frequency band extends up to $90 \mathrm{~Hz}$, provided the high-cut filter is at three-quarters of the Nyquist. For a band width without spatial aliasing, we have to select a 12.5-m CMP trace interval.

To circumvent the deleterious effect of spatial aliasing on migrated data, trace interpolation is applied to attain a trace interval appropriate for the bandwidth of the CMP-stacked data. As stated in Section 1.1, 1-D interpolation of a time series, such as a seismic trace, from a coarse to a finer sampling interval does not re-
Table 1-12. Frequency threshold for spatial aliasing. Velocity is $3000 \mathrm{~m} / \mathrm{s}$.

|  | Threshold Frequency (Hz) for |  |  |  |  |
| :---: | ---: | ---: | ---: | ---: | :---: |
| CMP Trace Interval (m) |  |  |  |  |  |
| Dip Angle (deg) | 12.5 | 25 | 37.5 | 50 |  |
|  |  |  |  |  |  |
| 10 | 346 | 173 | 115 | 86 |  |
| 20 | 175 | 88 | 58 | 44 |  |
| 30 | 120 | 60 | 40 | 30 |  |
| 40 | 93 | 47 | 31 | 23 |  |

cover the frequencies lost by the original sampling; but, it only generates extra samples. On the other hand, interpolation of 2-D data, such as a seismic section, from a coarse to a finer trace interval, is possible for all signal frequencies, including those that are aliased. This is because of the fact that one can detect and measure the dip as defined by the stepout of equation (1-5) on a stacked section for the unaliased frequencies and use the dip information to interpolate not only the unaliased but also the aliased frequencies. Modern data acquisition geometries for 2-D data often do not require trace
interpolation. Nevertheless, trace interpolation usually is required in the crossline direction prior to 3-D migration (Section 7.2).

### 1.3 WORLDWIDE ASSORTMENT OF SHOT RECORDS

Forty shot records, both land and marine, from North and South America, Europe, the Middle East, North Africa, and the Far East, are presented in Figures 1.31 through 1.3-40. Source types are vibroseis, Geoflex, dynamite, air gun, Maxipulse, Aquapulse, and Aquaseis. The recording parameters, including the number of traces, number of samples per trace, sampling interval, trace interval, and inner offset, are indicated in Table 1-13. Study the field records to learn how to recognize different types of waves. For display purposes, an instantaneous type of gain (AGC) (Section 1.4) was applied to all 40 records. These records will be referred to by their record numbers in the following discussions.

The main goal in processing reflection seismic data is to enhasce genuine reflection signal by suppressing unwanted energy in the form of coherent and random ambient noise. In the following paragraphs, shot gathers are examined to point out the different types of seismic energy.

Record 1 is a correlated vibroseis data set. (For vibroseis correlation, refer to Section 1.1.) A number of reflections is present in this record with reasonably good signal-to-noise ratio. A genuine reflection is recognized on common-shot gathers by its hyperbolic nature. Reflections behave the same way on CMP gathers. A flat horizon with no dip yields a symmetric hyperbola on both common-shot and common-midpoint gathers recorded using split-spread geometry. (In split-spread geometry, the source is located somewhere in the middle of the receiver cable, usually at the center.) A dipping horizon yields a skewed hyperbola on a commonshot gather, while still yielding a symmetric hyperbola on a common-midpoint gather. Reciprocity of sources and receivers provides this symmetry. From the reflection hyperbolas in Record 1, note that the subsurface is made up of nearly horizontally flat layers. Any irregularity in the shape of the moveout hyperbola can be attributed to near-surface effects and/or lateral variations in velocity.

Record 2 is an asymmetric shot gather. Note the refection energy between 1 and $2 \mathrm{~s}$, with rather irregular moveout.

Record 3, which was obtained by using dynamite, contains a series of reflections with nearly perfect hyperbolic noveout, especially between 1 and $3 \mathrm{~s}$. This record is from the times of analog recording. It is not uncommon to digitize old analog data and process it with modern techniques.

Record 4 contains events with complex moveout between 2.5 and $3.5 \mathrm{~s}$. Events A, B, and C have skewed hyperbolic moveouts, which, in this case, suggests that they are dipping up toward the left. Also note the traveltime distortions along the moveouts caused, most likely, by near-surface irregularities.

Record 5 has some ground-roll energy, which is characterized by its low-frequency, high-amplitude appearance, particularly on short-offset traces. This kind of energy typically is suppressed in the field by using a proper receiver array.

Record 6 contains weak and strong, nearly flat reflectors (A and B). The break in the reflection hyperbola (C1-C2) suggests the presence of a fault $\mathrm{Cl}$ on the upthrown side and $\mathrm{C} 2$ on the downthrown side). Again, note the ground-roll energy with its dispersed low-frequency character on inside traces (event D),

Record 7 contains three interesting events. Event A is a skewed hyperbola, which suggests that it is dipping up toward the left, while event $B$ is nearly symmetric, which suggests a flat dip. Event. $\mathrm{C}$ shows a discontinuity $\mathrm{F}$ along its moveout curve, indicating the presence of a fault.

Record 8 shows a record with excellent signal quality. This dynamite record has a number of reflections and associated interbed reverberations. Note the progressive decrease in the signal-to-noise ratio at late times. This is true for almost all seismic data. Event A has large moveout because it is shallow, while event $B$ has small moveout because it is deep. (Linear energy $C$ is referred to in Exercise 1-3.)

Record 9, which is a correlated vibroseis data set, has a series of reflections and ground roll. Unlike data from impulsive sources such as dynamite, first breaks in vibroseis data may not be distinguishable (compare, for example, Records 8 and 9). This is because the correlated vibroseis record contains some of the side lobes of the sweep signal autocorrelation. Note the increase in random noise in the later part of the record below $3 \mathrm{~s}$.

Record 10 contains two strong shallow reflectors, $A$ and $B$, in addition to ground-roll energy $C$. Also, a bundle of energy with extremely large moveout is noted between 2.5 and $5 \mathrm{~s}$ (D1-D2). This coherent noise may be attributed to side-scattered energy, which is caused by inhomogeneities in the subsurface (particularly at the water bottom) that behave as point sources.

Record 11 contains four prominent reflections. This record is from Alaska, where the thickness of the permafrost layer can be irregular. Such near-surface irreg-

Table 1-13. Parameter index of a worldwide assortment of common-shot gathers.

| Record <br> Number | Area | Number of <br> Samples <br> per Trace | Number of <br> Traces | Sempling <br> Interval, ms | Trace <br> Interval, <br> ft or $\mathrm{m}$ | Inner <br> Offset, <br> ft or $m$ | Source |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 1 | South Texas | 1,275 | 48 | 4 | $330 \mathrm{ft}$ | $990 \mathrm{ft}$ | $\mathrm{V}$ |
| 2 | West Texas | 1,025 | 120 | 4 | $100 \mathrm{ft}$ | $400 \mathrm{ft}$ | V |
| $* 3$ | Louisiana | 1,500 | 24 | 4 | $340 \mathrm{ft}$ | $340 \mathrm{ft}$ | $\mathrm{D}$ |
| 4 | Turkey | 1,275 | 48 | 4 | $100 \mathrm{~m}$ | $250 \mathrm{~m}$ | $\mathrm{~V}$ |
| 5 | South America | 3,000 | 48 | 2 | $100 \mathrm{~m}$ | $200 \mathrm{~m}$ | D |
| 6 | Far East | 1,250 | 48 | 4 | $100 \mathrm{~m}$ | $150 \mathrm{~m}$ | D |
| 7 | South America | 2,600 | 48 | 2 | $100 \mathrm{~m}$ | $300 \mathrm{~m}$ | D <br> $V$ |
| 8 | Central America | 1,300 | 96 | 4 | $50 \mathrm{~m}$ | $100 \mathrm{~m}$ | D |
| 9 | Alaska | 1,000 | 96 | 4 | $220 \mathrm{ft}$ | $990 \mathrm{ft}$ | V |
| 10 | North Africa | 1,325 | 120 | 4 | $25 \mathrm{~m}$ | $300 \mathrm{~m}$ | $\mathrm{~V}$ |
| 11 | Alaska | 1,000 | 96 | 4 | $220 \mathrm{ft}$ | $990 \mathrm{ft}$ | $\mathrm{V}$ |
| 12 | Mississippi | 1,275 | 48 | 4 | $330 \mathrm{ft}$ | $990 \mathrm{ft}$ | $v$ |
| 13 | Offshore Texas | 2,025 | 48 | 4 | $220 \mathrm{ft}$ | $875 \mathrm{ft}$ | $\mathrm{A}$ |
| 14 | Offshore Texas | 1,525 | 48 | 4 | $220 \mathrm{ft}$ | $690 \mathrm{ft}$ | $A$ <br> $\mathbf{P}$ |
| 15 | Offshore Canada | 2,500 | 48 | 2 | $25 \mathrm{~m}$ | $360 \mathrm{~m}$ |  |
| 16 | South America | 1,275 | 48 | 4 | $25 \mathrm{~m}$ | $500 \mathrm{~m}$ <br> $233 \mathrm{~m}$ | A |
| 17 | South America | 2,000 | 48 | 4 | $50 \mathrm{~m}$ | $233 \mathrm{~m}$ |  |
| 18 | Offshore Louisiana | 1,500 | 120 | 4 | $80 \mathrm{ft}$ | $250 \mathrm{~m}$ | A |
| 19 | Turkey | 1,250 | 216 | 4 | $82 \mathrm{ft}$ <br> $10 \mathrm{~m}$ | $716 \mathrm{ft}$ | A |
| 20 | South Aleutians | 2,025 | 120 | 4 |  | $50 \mathrm{~m}$ | $\mathrm{D}$ |
| 21 | Denver Basin | 2,020 <br> 1,550 | 48 |  | $82 \mathrm{ft}$ | $921 \mathrm{ft}$ | A |
| 22 | Williston Basin | 1,550 <br> 1,550 | 48 | 2 | $220 \mathrm{ft}$ | $220 \mathrm{ft}$ | $\mathrm{V}$ |
| 22 <br> 23 | San Juaquin Basin | 1,550 <br> 1,550 | 48 <br> 48 | 2 | $110 \mathrm{ft}$ | $110 \mathrm{ft}$ | V |
| 24 | San Juaquin Basin <br> Arctic | 1,550 |  | 2 | $220 \mathrm{ft}$ | $220 \mathrm{ft}$ | V |
| 25 | Arctic <br> Alberta | 3,000 | 48 <br> 96 | 2 | $220 \mathrm{ft}$ | $220 \mathrm{ft}$ | $S$ |
| 23 <br> 26 | Alberta <br> Alberta | 2,000 | 96 | 2 | $50 \mathrm{~m}$ | $50 \mathrm{~m}$ | $\mathrm{D}$ |
| 20 <br> 27 | Alberta <br> Canada | 1,500 | 48 | 2 | $67 \mathrm{~m}$ | $67 \mathrm{~m}$ | D |
| 27 <br> 28 |  | 1,791 | 92 | 4 | $50 \mathrm{~m}$ | $200 \mathrm{~m}$ | A |
|  | Canada | 2,500 | 48 | 2 | $25 \mathrm{~m}$ | $300 \mathrm{~m}$ | A |
| 29 | Offshore Spain | 2,000 | 48 | 4 | $50 \mathrm{ml}$ | $250 \mathrm{~m}$ | $\mathrm{M}$ |
| 30 | Offshore Crete | 2,125 | 96 | 4 | $25 \mathrm{~m}$ | $230 \mathrm{~m}$ | A |
| 31 | North Sea | 1,550 | 96 | 4 | $25 \mathrm{~m}$ | $228 \mathrm{~m}$ | A |
| 32 | North Sea | 1,550 | 96 | 4 | $25 \mathrm{~m}$ | $178 \mathrm{~m}$ | A |
| 33 | North Sea | 1,625 | 96 | 4 | $25 \mathrm{~m}$ | $200 \mathrm{~m}$ | A |
| 34 | Celtic Sea | 1,500 | 60 | 4 | $50 \mathrm{~m}$ | $253 \mathrm{~m}$ | A |
| 35 | Denmark | 2,500 | 52 | 2 | $100 \mathrm{~m}$ | $100 \mathrm{~m}$ | D |
| 36 | Middle East | 1,024 | 48 | 4 | $50 \mathrm{~m}$ | $250 \mathrm{~m}$ | $\mathrm{v}$ |
| 37 <br> 37 | Turkey <br> Iunk | 1,000 | 48 | 4 | $75 \mathrm{~m}$ | $187 \mathrm{~m}$ | $\mathrm{v}$ |
| $\$ 1$ <br> 38 | Imhc\} <br> North Africa | 2,500 | 60 | 2 | $100 \mathrm{~m}$ | $100 \mathrm{~m}$ | $\mathrm{~V}$ |
| 39 | Middle East | 2,500 | 60 | 2 | $50 \mathrm{~m}$ | $100 \mathrm{~m}$ | G |
| 40 | West Africa | 2,600 | 96 | 2 | $30 \mathrm{~m}$ | $120 \mathrm{~m}$ | $\mathrm{D}$ |

* Analog recording. V: vibroseis, D: dynamite, A: Air gun, P: Aquapulse, M: Maxipulse, G: Geoflex, S: Aquaseis. All vibroseis records have been correlated. Aquapulse and Maxipulse are registered trademarks of Western Geophysical Company of America. Aquaseis and Geoflex are registered trademarks of Imperial Chemical Industries.
ularities can have lateral dimensions that range from less than a group interval to wavelengths that are several times a cable length. As seen on the right flank of the hyperbolas (events A, B, C, and D), these irregularities cause substantial time shifts in reflection arrivals. Such distortions in moveout could be dynamic (timedependent) or static (time-independent). They should be corrected before stacking. Except for these distortions, all events seem to have symmetric, hyperbolic moveouts that indicate nearly horizontally layered substrata.

Record 12 is a field record with a low signal-tonoise ratio. A complex subsurface structure is implied between 2 and $3.5 \mathrm{~s}$.

From Record 13, note the high-frequency hyperbolic energy $\mathrm{S}$ that is associated with a side scatterer, possibly at the water bottom.

Record 14 has three identifiable reflections: A, B, and C. Reverberations and multiples also make up a significant portion of the data.

Record 15 is a marine record. The hard water bottom causes refraction arrival $\mathbf{A}$. This shot gather primarily contains guided waves, which are manifested as linear trends such as B, C, and D. The genuine reflection $\mathrm{E}$ has little moveout.

Guided waves are trapped within a water layer and travel in the horizontal direction. They are dispersive each frequency component travels at a different speed, which is called horzzontal phase velocity. Their behavior is variable, primarily dictated by water bottom conditions and the thickness of the water layer. They are an important source of coherent noise and are confined mainly to the supercritical region of propagation, where no transmission occurs into the substratum. The nature of guided waves is analyzed in Section F.1.

Wave packet $A$ in Record 16 is made up entirely of guided waves. Direct arrivals B carry the highest frequency components, while lower frequencies $\mathrm{C}$ arrive earlier. Moderate frequencies D make up the later portion of the dispersive wave packet. This record has a reflection $\mathrm{E}$ and long-period multiples M1 through M4. The reflection and its multiples also have an accompanying reverberating wavetrain that is nearly $300 \mathrm{~ms}$ long.

Record 17 is longer than the common length (4 to $6 \mathrm{~s})$ used in seismic data acquisition. There is no apparent signal after $4 \mathrm{~s}$; nevertheless, very weak signals can sometimes be uncovered by stacking.

Record 18 has some events worth mentioning. Dispersive waves, which include the head wave and direct arivals A make up the early portion of the record. Some reflections, B, C, and D, are followed by short-period reverberations. In the deeper part of the record, note the events with extremely large moveout $\mathrm{E}$, which is unusual for deep data. These events represent the sidescattered coherent noise.

Record 19 is a walk-away noise test. It is actually a composite of six shot records. The receiver cable was held constant while the shots were moved away without overlap. The receiver group interval is $10 \mathrm{~m}$. The receivers in each group were bundled together without array forming. This allowed all signal and noise wavelengths to be recorded. Horizontal wavelength is determined by measuring the dominant frequency (the reciprocal of the time between successive peaks or troughs) and the horizontal phase velocity (the reciprocal of stepout $\Delta t(\Delta x)$ of the unwanted ground roll. The horizontal wavelength then is used to design the receiver array length that is needed to suppress this energy (see Exercise 1-4). Wave packet A1-A2 (between 1.7 and 4.6 $s$ on the far-left trace) is an excellent example of ground roll. The linear coherent energy with opposite dip A1A2 is the backscattered component. Reflection $\mathrm{C}$ is being disrupted by ground-roll energy.

Ground roll is different from guided waves, although both are dispersive. Ground roll is one type of Rayleigh wave that arises because of the coupling of compressional waves $(P)$ and the vertical component of shear waves ( $S \eta$ ) that propagate along the free surface (Grant and West, 1965). On the other hand, guided waves are one kind of compressional wave that travels within a layer just as sound waves travel in an organ pipe.

Record 20 (marine) shows a variety of wave types. Direct arrivals $A$ are significantly suppressed by receiver arrays in the field. We can see the water bottom reflection B on short-offset traces. Note a shallow reflector $\mathrm{C}$ and associated refraction arrival $\mathrm{D}$. At $1 \mathrm{~s}$, another reflector $E$ is seen. Much of the energy between 1 and 3 s most likely is multiples associated with B, C, and $E$. Linear noise (possibly cable noise) $F$ and the lowerfrequency propeller noise $G$ appear in the deeper portion of the record after $4 \mathrm{~s}$.

Record 21 (vibroseis) has a weak $A$ and a strong $B$ shallow reflector. Below $2 \mathrm{~s}$, ambient noise dominates the record.

Record 22 is another vibroseis record. Note reflection arrivals $A_{1} B$, and $C$. Although reasonably hyperbolic, there are some fluctuations in traveltimes that may be attributed to near-surface complexity (as inferred by the first breaks). Record 23 shows similar characteristics.

Record 24 is a marine shot gather that was acquired with an Aquaseis source. Direct arrivals A, water-bottom reflection $B$, and first-order multiples $M 1$, M2, are recognized easily. A primary reflection $P$ and its peg-leg multiple PL also are distinguished.
hecord 25 (land) has a very good signal quality. In addition to the several primary reflections, note groundroll energy A. It is predominantly low frequency and travels with low group velocity (the speed with which the energy in a wave packet travels). Also note the nearsurface effects that cause traveltime distortions along the right flanks of reflections B, C, D, and E.

Record 26 (dynamite) does not have a welldeveloped ground-roll energy; however, it still is recognianhle from its low-froquency character A. Traveltime paths that correspond to reflections (for example, B, C, and D) have been disrupted by ground roll and possibly distorted by irregularities in the near surface.

Record 27 (marine) is interesting. Note the change in the cable geometry A (Exercise 1-6). There is a welldeveloped dispersive wave packet $\mathbf{B}$ that spans between 1.9 and $2.9 \mathrm{~s}$ at the far-offset trace. This includes the head wave and direct arrivals. Also note the distinct. moveout difference between events $\mathrm{C}$ and $\mathrm{D}$. Event $\mathrm{C}$, with a larger moveout, belongs to the short-period multjple wavetrain that is associated with the water-bottom reflection. Event D, with a small moveout, is a primary reflection with its own peg-leg series $\mathbf{F}$.

The air-gun data in Record 28 contain highvelocity reflections with little moveout. Note the predominant guided wave packet $\mathrm{C}$ that spans between 0.7 and $1.9 \mathrm{~s}$ at the far-offset trace. It results from the strong water-bottom refractor $\mathrm{D}$.

Record 29 is puzzling (see Exercise 1-7). The skewness of the reflection hyperbolas ( $B, C, D$, and $E$ ) increases in depth.

Record 30 is a deep-water shot record. The direct arrival $A$, water-bottom reflection $B$, and shallow reflection $\mathrm{C}$, can be identified easily. First-order waterbottom multiples $\mathrm{M}$ and peg-leg multiples $\mathrm{PL}$, which are associated with the shallow reflector $\mathrm{C}$, also are prominent in this record.

Record 31 is a shot record primarily made up of guided waves. The following wave types are identified: A is the refraction arrival, $\mathrm{B}$ is its multiples, $\mathrm{C}$ is the direct arrival, $D$ is the dispersive medium-frequency components of guided waves between 1.8 and $3 \mathrm{~s}$ at the far-offet trace, and $E$ is the backscattered energy associated with side scatterers at the water bottom.

Record 32 is another marine record that contains strong guided wave energy. A refractor A, direct arrival B, and dispersed wave packet $C$ span between 1.2 and $4 \mathrm{~s}$ at the far-offset trace. Events D and E represent subcritical reflection energy, most of which is reverberation.

The events on Records 33 and 34 are referred to in Exercises $1-9$ and $1-10$, respectively.

The four far left traces in Record 35 are associated with the channels that are used to record auxiliary information.
Record 36 seems to have no events with hyperbolic moveout. Record 37 has a few refections, $\mathrm{AD}, \mathrm{BE}$, $\mathrm{CF}$; however, they are buried in strong ambient noise. Record 38 contains virtually no reflections. A strong dispersive wave (ground roll) makes up the early part of the record, while the remaining part contains primarily random noise.

Record 39 is a Geoflex record containing strong ground-roll energy A. Additionally, the record from top to bottom contains a strong high-frequency reverberating wavetrain and short-period multiples that are associated with the water bottom and, perhaps, a few shallow reflectors.

Record 40 has a small usable segment the longer offset traces on the left side between 1 and $4 \mathrm{~s}$. The remaining part of the record contains strong random noise and transient noise, A, B, C, D, and E, which are attributed to electronic instrument noise (possibly resulting from weather conditions).

## Wave Types

To summarize, field records contain (a) reflections, (b) coherent noise, and (c) random ambient noise. One important aspect of data processing is to uncover genuine reflections by suppressing noise of various types. Processing, however, cannot yield sagnal from field data without signal. At best, it suppresses whatever noise is in the field data and enhances the refection energy that is buried in the noise. Seismic data must not be acquired with the attitude, 'Don't worry, processing will bring out the signal."

Reflections on shot records are recognized by their hyperbolic traveltimes. If the reflecting interface is horizontal, then the apex of the reflection hyperbola is situated at zero offset. On the other hand, if it is a dipping interface, then the reflection hyperbola is skewed in the updip direction.

There are several wave types under the coherent noise category:

(a) Ground roll is recognized by low frequency, strong amplitude, and low group velocity. It is the vertical component of dispersive surface waves. In the field, receiver arrays are used to eliminate ground roll. Ground roll can have strong backscattered components because of lateral inhomogeneities in the near-surface layer.

(b) Guded waves are persistent, especially in shallow marine records in areas with hard water bottom. The water layer makes a strong velocity contrast with the substratum, which causes most of the energy to be trapped within and guided laterally
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0091.jpg?height=930&width=868&top_left_y=217&top_left_x=72)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0092.jpg?height=692&width=774&top_left_y=229&top_left_x=83)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0092.jpg?height=323&width=74&top_left_y=541&top_left_x=872)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0092.jpg?height=205&width=725&top_left_y=957&top_left_x=79)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0093.jpg?height=732&width=744&top_left_y=181&top_left_x=74)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0093.jpg?height=340&width=74&top_left_y=507&top_left_x=845)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0093.jpg?height=226&width=733&top_left_y=948&top_left_x=82)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0094.jpg?height=856&width=878&top_left_y=256&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0095.jpg?height=948&width=764&top_left_y=210&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0096.jpg?height=492&width=742&top_left_y=178&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0096.jpg?height=341&width=78&top_left_y=513&top_left_x=842)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0096.jpg?height=491&width=745&top_left_y=696&top_left_x=80)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0097.jpg?height=412&width=764&top_left_y=252&top_left_x=74)

$\infty$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0097.jpg?height=444&width=758&top_left_y=696&top_left_x=80)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0098.jpg?height=794&width=762&top_left_y=286&top_left_x=74)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0099.jpg?height=762&width=764&top_left_y=200&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0099.jpg?height=343&width=79&top_left_y=519&top_left_x=852)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0099.jpg?height=163&width=753&top_left_y=1002&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0100.jpg?height=658&width=764&top_left_y=210&top_left_x=72)

लें म्ल ब्रें

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0100.jpg?height=39&width=70&top_left_y=540&top_left_x=864)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0100.jpg?height=50&width=66&top_left_y=582&top_left_x=866)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0100.jpg?height=256&width=758&top_left_y=905&top_left_x=80)
through the water layer. The dispersive nature of these waves makes them easy to recognize on shot records. Guided waves also make up the early arrivals. The stronger the velocity contrast between the water layer and the substratum, the smaller the critical angle; thus, more guided-wave energy is trapped in the supercritical region. When there is a strong velocity contrast, refraction energy propagates in the form of a head wave. Guided waves also are found in land records. These waves are largely attenuated by CMP stacking. Because of their prominently linear moveout, in principle they also can be suppressed by dip filtering techniques. One such fltering technique is based on 2-D Fourier transformation of the shot record. This is discussed in Section 6.2. Another approach is based on slant stacking, which is described in Section 6.3.

(c) Side-scattered notse commonly occurs at the water bottom, where there is no flat, smooth topography. Irregularities of varying size act as point scatterers, which cause diffraction arrivals with table-top trajectories. They can be on or off the vertical plane of the recording cable. These arrivals typically exhibit a large range of moveouts, depending on the spatial position of the scatterers in the subsurface.

(d) Cable noise is linear and low in amplitude and frequency. It primarily appears on shot records as late arrivals.

(e) The air wave with a $300 \mathrm{~m} / \mathrm{s}$ velocity can be a serous problem when shooting with surface charges such as Geoflex, Poulter, or land air gun. Perhaps whe only effective way to remove air waves is to zero out the data on shot gathers along a narrow corridor containing this energy (notch muting). It often is impossible to recover any data arriving after the air wave on Poulter data.

(f) Power hnes also cause noisy traces in the form of a monofrequency wave. A monofrequency wave may be 50 or $60 \mathrm{~Hz}$, depending on where the field survey was conducted. Notch filters often are used in the field to suppress such energy.

(g) Multoples are secondary reflections with interbed or intrabed raypaths. Guided waves include supercritical multiple energy. Multiples are attacked by methods, which are based on moveout discrimination, and prediction theory, which uses the periodic behavior of multiples. The most effective moveoutbased suppression technique often is CMP stack with inside-trace mute (Section 6.1). Prediction theory should be particularly effective, at least in theory, in the slant-stack domain (Section 6.3).

Random nowe has various sources. A poorly planted geophone, wind motion, transient movements in the vicinity of the recording cable, wave motion in the water that causes the cable to vibrate, and electrical noise from the recording instrument all can cause ambient noise. The net result of scattered noise from many scatterers in the subsurface also contributes to random noise (Lamer et al., 1983).

In Section 1.4, it is noted that energy propagating within the earth is subject to a decay in amplitude because of wavefront divergence and frequency-dependent absorption from the intrinsic attenuation of rocks. Signal strength therefore decreases in time, while random noise persists and eventually dominates. Unfortunately, gain corrections to restore signal strength at later times boost random noise in the process. Fortunately, CMP stack suppresses a significant part of the random noise uncorrelated from trace to trace.

### 1.4 GAIN APPLICATIONS

Gain is a teme-varant scaling in which the scaling function is based on a desired criterion. For instance, geometric spreading correction is applied to compensate for wavefront divergence early in processing, before deconvolution. Also before deconvolution, an exponential gain may be applied to compensate for attenuation losses. Often, gain is applied to seismic data for display. An automatic gain control (AGC) is applied to seismic data to bring up weak signals. Gain must be used with care, since it can destroy signal character. For example, an instantaneous AGC with a very small time gate makes strong reflections indistinguishable from weak reflections.

Unlike a gain function, trace balancing is a timeinvartant scaling of amplitudes. Trace balancing usually is based on rms-amplitude criterion. Specifically, each trace in a group of traces is scaled so that they all have the sanne desired rms amplitude level.

## Geometric Spreading Correction

A field record represents a wavefield that is generated by a single shot. Conceptually, a single shot is thought of as a point source that generates a spherical wavefield. The earth has two effects on a propagating wavefield:

(a) In a homogeneous medium, energy density decays proportionately to $1 / r^{2}$, where $r$ is the radius of the wavefront. Wave amplitude is proportional to the square root of energy density; it decays as $1 / r$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0102.jpg?height=503&width=538&top_left_y=116&top_left_x=260)

FIG. 1.4-1. A raw field record with no geometric spreading correction (far left panel) and its band-pass filtered versions. Note that the larger reflection amplitudes are confined to shallower times at increasingly higher frequency bands.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0102.jpg?height=498&width=548&top_left_y=688&top_left_x=250)

FIG. 1.4-2. The same field record as in Figure 1.4-1 (far left panel) after correcting for geometric spreading. Amplitudes are restored but frequency absorption remains.

In practice, velocity usually increases with depth, which causes further divergence of the wavefront and a more rapid decay in amplitudes with distance.

(b) The frequency content of the initial source signal changes in a time-variant manner as it propagates. In particular, high frequencies are absorbed more rapidly than low frequencies. This is because of the intrinsic attenuation in rocks.

Attenuation mechanisms still are the subject of extensive research. However, one plausible mechanism for attenuation is related to pore fluids. As the wavefront passes through rocks, the fluids that are present in the pores are disturbed. This disturbance is greater in partially saturated rocks than fully saturated rocks. Pore fluids consume part of the energy of the propagating wavefield, which causes a frequency-dependent decay.

From Figure 1.4-1, note the wavefront divergence and frequency absorption on the field record. The first panel represents field data without any gain recovery function applied. Note the gradual decay in amplitude at later times. This record was filtered with a series of 10-Hz-wide band-pass filters. The signal in the 10-to-20$\mathrm{Hz}$ panel exists down to about $6 \mathrm{~s}$. On the $20-$ to $-30-\mathrm{Hz}$ panel, however, signal is visible only down to about 4 s. Moving to the higher frequency panels, note that the signal level is confined mainly to increasingly shallower times. Now apply the geometric spreading correction to the original field record in the far left panel of Figure 1.4-1. The result is shown in the far left panel of Figure 1.4-2. The amplitude level has been restored at late traveltimes. Filter panels of this record also are shown in Figure 1.4-2. When the filter panels in Figures 1.4-1 and 1.4-2 are compared with the same pass band, we see that the geometric spreading correction brought up some of the signal level at late times. However, note that the geometric spreading correction did not restore the amplitudes of the high frequencies as much as it restored the low frequencies, since the high frequencies were subject to stronger attenuation.

Figure 1.4-3 shows a portion of a CMP-stacked section and its filtered versions using narrow band-pass filters. Note that signal bandwidth only up to $20 \mathrm{~Hz}$ is observed down to $5 \mathrm{~s}$, and frequencies up to $36 \mathrm{~Hz}$ are observed down to $3.5 \mathrm{~s}$. The erosional unconformity just below $3.5 \mathrm{~s}$ constitutes a boundary with large frequency absorption. This results in attenuation of much of the high-frequency signal below this boundary. Frequencies above $36 \mathrm{~Hz}$ are confined to the shallow portion of the stacked section down to $2.5 \mathrm{~s}$.

The effect of attenuation must be removed by modifying the amplitude spectrum of the signal, thereby making it broader. Deconvolution is one process that

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0103.jpg?height=1055&width=437&top_left_y=118&top_left_x=526)

FIG. 1.4-3. A portion of a CMP-stacked section and its filtered versions. Note the attenuation of high frequencies below $2.5 \mathrm{~s}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0104.jpg?height=394&width=861&top_left_y=127&top_left_x=91)

FIG. 1.4-4. Raw field records from a land survey. Note the rapid decay in amplitudes at late times.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0104.jpg?height=390&width=851&top_left_y=572&top_left_x=93)

FIG. 1.4-5. The same field records as in Figure 1.4-4 after correcting for geometric spreading. The amplitudes have been restored at late times. Unfortunately, ambient noise also has been strengthened.

is used to achieve this goal. Alternative methods to compensate for frequency attenuation are time-variant spectral whitening and inverse- $Q$ filtering. All three processes are described in Chapter 2.

The factor $1 / r$ that describes the decay of wave amplitudes as a function of the radius of the spherical wavefront is valid for a homogeneous medium without attenuation. For a layered earth, amplitude decay can be described approximately by $1 /\left[v^{2}(t) t\right]$ (Newman, 1973). Here, $t$ is the two-way traveltime and $v(t)$ is the root-mean-squared (rms) velocity (Section 3.1) of the primary reflections (those reflected only once) averaged over a survey area. Therefore, the gain function for geometric spreading compensation is defined by

$$
g(t)=\frac{v^{2}}{v_{0}^{2}} \frac{(t) t}{t_{0}}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0105.jpg?height=329&width=194&top_left_y=116&top_left_x=83)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0105.jpg?height=325&width=187&top_left_y=127&top_left_x=311)

(b)

FIG. 1.4-6. (a) A raw field record from a marine survey. Before correcting for geometric spreading, refraction and guided wave energy dominate the record. (b) After the geometric spreading correction, while refection amplitudes have been restored, multiples and coherent noise also have been boosted.

where $v_{0}$ is the reference velocity at specified time $t_{0}$. A more rigorous offset-dependent and time-dependent description of the geometric spreading correction function also can be used.

Signal-level decay is evident in the field records in Figure 1.4-4. Note the weak appearance of reflections, particularly below $1 \mathbf{s}$. This does not mean that there are no strong reflections below this time. Because of the amplitude decay resulting from wavefront divergence, no signal is seen at late times. As stated previously, this earth effect must be removed to bring up any signal that may be present in the deep portion of the record.

The same shot records after geometric spreading correction are shown in Figure 1.4-5. While reflections have been brought up in strength, noise components in the data also have been boosted. This is one undesirable aspect of any type of gain application.

Besides ambient noise, coherent noise in the data may be boosted as shown in Figure 1.4-6. By using the primary velocity function in correcting for geometric spreading, the amplitudes of the dispersive coherent noise and multiples have been overcorrected. Another example of overcorrected multiples is shown in Figure 1.4-2. (Compare the far left panel with its equivalent in Figure 1.4-1.)

To prevent overcorrection of amplitudes of multiple reflections, a velocity-independent scaling function, such as

$$
g(t)=t^{\alpha}
$$

where $\alpha$ usually is set to 2, can be used for geometric spreading correction (Claerbout, 1985). Figure 1.4-7 shows a marine record after muting the guided waves and applying $t$-squared scaling. Note from the amplitude spectrum averaged over the shot record that geometric spreading correction does not restore frequency components of the wavefield which are subject to absorption effects in rocks. Nevertheless, by correcting for amplitude decay caused by wavefront divergence, the autocorrelogram better describes the reverberations across all offsets. Actually, $t$-squared scaling now is a commonly used scaling function for geometric spreading correction.

## Programmed Gain Control

Various types of gain criteria are used in practice. Based on a desired criterion, a gain function $g(t)$ is derived from the data and multiplied with trace amplitudes at each time sample. This is illustrated in Figure 1.4-8. The gain function is specified or estimated at the time samples indicated by the dots and interpolated between these samples.

Programmed gain control (PGC) is the simplest type of gain. Referring to part of a stacked section in Figure 1.4-9, a gain function can be defined by interpolating between some scalar values specified at particular time samples. Larger scalar values naturally would be assigned at late times. In Figure 1.4-9, the applied PGC factors are indicated by the pairs of numbers corresponding to 0 and $6 \mathrm{~s}$. While the input panel indicates strong amplitudes at shallow times, the section scaled by the PGC factors $(1,4)$ indicates a balanced amplitude level from top to bottom.

Rather than picking the scalars in a qualitative manner, the envelope of the ungained trace can be computed and smoothed. The envelope, which is the curve drawn by smoothly connecting the adjacent peaks (or troughs) along the trace, is a reliable attribute that describes amplitude decay rate. The PGC function then is the inverse of the trace envelope. A single PGC function is applied to all traces in a gather or stacked section to preserve the relative amplitude variations in the lateral direction.

## RMS Amplitude AGC

The rms amplitude AGC gain function is based on the rms amplitude within a specified time gate on an input trace. This gain function is computed as follows. The input trace is subdivided into fixed time gates. First, the amplitude of each sample in a gate is squared. Second,
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0106.jpg?height=1010&width=532&top_left_y=116&top_left_x=254)

FIG. 1.4-7. (a) A field record from a marine survey, (b) after muting guided waves, and (c) after the geometric spreading correction using $t^{2}$ as the scaling function. Shown on top are the amplitude spectra sveraged over the shot record, and at the bottom are the autocrrelograms.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0107.jpg?height=522&width=546&top_left_y=128&top_left_x=240)

FIG. 1.4-8. Gain is a time-variant scaling defined by a function, $g(t)$. Based on some criteria, this function is defined at the time samples (shown by sold circles) that are usually at the center of specified time gates along the trace as indicated by 1 , 2,3 , and 4 . Gain application simply involves multiplying $g(t)$ by the input trace amplitudes.

the mean of these values is computed and its square root is taken. This is the rms amplitude over that gate. The ratio of a desired rms amplitude (say 2000) to the actual $\mathrm{rms}$ value is assigned as the value of the gain function at the center of the gate. Hence, the scaling function $g(t)$ at the gate center is given by

$$
g(t)=\frac{\text { desired rms }}{\sqrt{\frac{1}{N} \sum_{t=1}^{N} x_{i}^{2}}}
$$

where $x_{t}$ is the trace amplitude and $N$ is the number of samples within the gate.

Typically, we start out with a certain gate length at the shallow part of the trace. Gate length can be kept either constant or it can be increased systematically down the trace. At each gate center, the value of the gain function is computed as described above. Function $g(t)$ then is interpolated between the gate centers. Note that the specified time gates are stationary they do not slide down the trace.

Figure 1.4-10 shows the ungained data and two rms-gained sections. The gate lengths are indicated at the top of each panel. When the gate used in the com- putation is kept small, say $64 \mathrm{~ms}$, then strong reflections become less distinct.

## Instantaneous AGC

Instantaneous $A G C$ is one of the most common gain types used. This gain function is computed as follows. First, the mean absolute value of trace amplitudes is computed within a specified time gate. Second, the ratio of the desired rms level to this mean value is assigned as the value of the gain function. Unlike the rms amplitude $\mathrm{AGC}$, this value is assigned to any desired time sample of the gain function within the time gate, say the $n$th sample of the trace, rather than to the sample at the center of the gate. The next step is to move the time gate one sample down the trace and compute the value of the gain function for the $(n+1)$ th time sample, and so on. No interpolation is therefore required to define this gain function. Hence, the scaling function $g(t)$ at the gate center is given by

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0108.jpg?height=481&width=512&top_left_y=114&top_left_x=260)

FIG. 1.4-9. A portion of a CMP stack before and after application of two different PGC functions. The scale factors used in constructing the gain functions are indicated by the pairs of numbers on top of the gained sections, the first scalar in the pair corresponds to time $t=0$, and the second scalar corresponds to time $t=6 \mathrm{~s}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0108.jpg?height=482&width=509&top_left_y=694&top_left_x=264)

FIG. 1.4-10. A portion of a CMP stack before and after application of two different rms AGC functions. Numbers on the top indicate the window sizes in milliseconds used in computing the AGC gain function described by equation (1-9a).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0109.jpg?height=665&width=807&top_left_y=128&top_left_x=114)

FIG. 1.4-11. A portion of a CMP stack before and after application of five different instantaneous AGC functions. The numbers on top indicate gain window sizes in milliseconds used in computing the AGC gain function described by equation (1-9b).

$$
g(t)=\frac{\text { desired rms }}{\frac{1}{N} \sum_{t=1}^{N}\left|x_{2}\right|}
$$

where $x_{t}$ is the trace amplitude and $N$ is the number of samples within the gate.

Figure 1.4-11 shows the ungained data and four instantaneous AGC-gained sections. Gate lengths are indicated on top of each panel. Very small time gates cause a significant can loss of signal character by boosting zones that contain small amplitudes. This occurs with the 64-ms AGC output. In processing, this is called a fast AGC. In the other extreme, if a large time gate is selected, then the effectiveness of the AGC process is lessened. In practice, AGC time gates commonly aте specified between 200 and $500 \mathrm{~ms}$.

## Relative Trace Balancing

All of the gain applications described in this section modify the trace amplitudes by function $g(t)$ in a timevarying manner (equations 1-4 and 1-5). In true amplitude processing, it is necessary to display the data without applying a time-varying data-dependent gain function. However, some amplitude scaling is always necessary for display, since plotters require input data amplitudes to fall in a specific range. Trace balancing (trace equalization) schemes are used for this type of scaling. The balance factor is defined as the ratio of the desired rms to the rms amplitude that is computed from a specified time window. A separate balance factor

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0110.jpg?height=718&width=293&top_left_y=117&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0110.jpg?height=717&width=269&top_left_y=118&top_left_x=388)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0110.jpg?height=716&width=278&top_left_y=118&top_left_x=655)

(c)

FIG. 1.4-12. (a) A field record, (b) after geometric spreading correction which shows differences in amplitude levels of the near- and far-offset channels caused by differences in gain settings during recording. (c) Following the application of trace balancing, these differences in amplitudes are removed. Displayed at the bottom are the autocorrelograms. Note in (a) the effect of different gain settings on the amplitude level of the autocorrelogram from trace to trace.

is computed for and applied to each trace, individually, Alternatively, a single balance factor based on a selected trace within a group of traces can be applied to the entire group. This is called relative trace balancing. Note that trace halancing amounts to scaling the trace by using a single factor that is time-invariant (equivalent to a single-window rms AGC). Figure 1.4-12 shows rms trace balancing of field data to correct for the differences in gain settings between the recording channels. Trace balancing commonly is applied immediately after deconvolution, and on final stacks using large gates.

### 1.5 BASIC DATA PROCESSING SEQUENCE

Since the intruduction of digital recording, a routine sequence in seismic data processing has evolved. This basic sequence now is described to gain an overall understanding of each step. There are three primary steps in processing seismic data - deconvolution, stacking, and migration, in their usual order of application. Figure 1.5-1 represents the seismic data volume in processing coordinates - midpoint, offset, and time. Deconvolu-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0111.jpg?height=307&width=417&top_left_y=127&top_left_x=80)

FIG. 1.5-1. Seismic data volume represented in processing coordinates - midpoint-offact-time. Deconvolution acts on the data along the time axis and increases temporal resolution. Stacking compresses the data volume in the offset direction and yields the plane of stacked section (the frontal fece of the prism). Migration then moves dipping events to their true subsurface positions and collapses diffractions, and thus increases lateral resolution.

tion acts along the time axis. It removes the basic seismic wavelet (the source time function modified by various effects of the earth and recording system) from the recorded seismic trace and thereby increases temporal resolution. Deconvolution achieves this goal by compressing the wavelet (Chapter 2). Stacking also is a process of compression (Chapter 3). In particular, the data volume in Figure 1.5-1 is reduced to a plane of midpoint-time at zero offiset (the frontal face of the prism) first by applying normal moveout correction to traces from each CMP gather (Section 3.1), then by summing them along the offset axis. The result is a stacked section. (The terms stacked section, CMP stack, and stack often are used synonymously.) Finally, migration commonly is applied to stacked data. It is a process that collapses diffractions and maps dipping events on a stacked section to their supposedly true subsurface locations (Chapter 4). In this respect, migration is a spatial deconvolution process that improves spatial resolution.

All other processing techniques may be considered secondary in that they help improve the effectiveness of the primary processes. For example, dip filtering may need to be applied before deconvolution to remove coherent noise so that the autocorrelation estimate is based on reflection energy that is free from such noise. Wide band-pass filtering also may be needed to remove very low- and high-frequency noise. Before deconvolution, correction for geometric spreading is necessary to compensate for the loss of amplitude caused by wavefront divergence. Velocity analysis, which is an essential step for stacking, is improved by multiple attenuation and residual statics corrections.

Many of the secondary processes are designed to make data compatible with the assumptions of the three primary processes. Deconvolution assumes a stationary, vertically incident, minimum-phase source wavelet and white reflectivity series that is free of noise. Stacking assumes hyperbolic moveout, while migration is based on a zero-offset (primaries only) wavefield assumption. A pessimist could claim that none of these assumptions is valid. However, when applied to field data, these techniques do provide results that are close to the true subsurface image. This is because these three processes are robust and their performance is not very sensitive to the underlying assumptions in their theoretical development.

Keep in mind that the success of a process depends not only on the proper choice of parameters pertinent to that particular process, but also on the effectiveness of the previous processing steps.

We shall use a 2-D seismic line from the Caspian Sea to demonstrate the basic processing sequence. Table 1-14 provides the processing parameters for the line. The water depth at one end of the line is approximately $750 \mathrm{~m}$ and decreases along the line traverse to approximately $200 \mathrm{~m}$ at the other end.

## Preprocessing

Field data are recorded in a multiplexed mode using a certain type of format. The data first are demultiplexed as described in Figure 1.5-2. Mathematically, demulti-

Table 1-14. Processing parameters for the Caspian line used to describe the basic processing sequence in this section.

Shot interval in $\mathrm{m} \quad 25$

Group interval in $\mathrm{m} \quad 25$

Number of receiver groups $\quad 180$

Minimum offset in $\mathrm{m} \quad 175$

Maximum offset in $\mathrm{m} \quad \mathbf{4 , 6 5 0}$

CMP interval in $\mathrm{m} \quad 12.5$

Fold of coverage 90

Number of CMPs $\quad 6,212$

Line length in $\mathrm{km} \quad 77.64$

Sampling interval in $\mathrm{ms} \quad 4$

Maximum time in $\mathrm{ms} \quad 8,000$

Data volume in gigabytes $\quad 4.5$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0112.jpg?height=327&width=392&top_left_y=125&top_left_x=95)

FIG. 1,5-2. Seismic data are recorded in rows of samples samples at the same time at consecutive channels. Demultiplexing involves sorting the data into columns of samples - all the time samples in one channel followed by those in the next channels.

plexing is seen as transposing a big matrix so that the columns of the resulting matrix can be read as seismic traces recorded at different offsets with a common shot point. At this stage, the data are converted to a convenient format that is used throughout processing. This format is determined by the type of processing system and the individual company. A common format used in the seismic industry for data exchange is SEG-Y, established by the Society of Exploration Geophysicists.

Figure 1.5-3 shows selected shot records along the Caspian line under consideration. Note the strong amplitudes at the early part and the relatively weaker energy at the deeper part of the records. Such decay in amplitude primarily is caused by wavefront divergence. The dispersive nature of the guided waves resulting from normal-mode propagation within the water layer appears to vary from record to record. This result.s from a combination of varying water depth, depth of the source array, and water-bottom conditions (Section F.1).

Preprocessing also involves trace editing. Nojsy traces, traces with transient glitches (see Figure 1.3-40), or monofrequency signals (see Figure 1.3-3) are deleted; polarity reversals (see Figure 1.3-2) are corrected. In case of very shallow marine data, guided waves are muted since they travel horizontally within the water layer and do not contain reflections from the substratum.

As seen in Figure 1.5-3, most marine data are contaminated by swell noise and cable noise. These types of noise carry very low-frequency energy but can be high in amplitudes. They can be recognized by their distinctive linear pattern and vertical streaks. The swell noise and cable noise are removed from shot records by a low-cut filtering as shown in Figure 1.5-4. Attenuation of coherent linear noise associated with side scatterers and ground roll may require techniques based on dip filtering (Chapter 6).

Following the trace editing and prefiltering, a gain recovery function is applied to the data to correct for the amplitude effects of spherical wavefront divergence. This amounts to applying a geometric spreading function, which depends on traveltime (Section 1.4). Optionally, this amplitude correction is made dependent on a spatially averaged velocity function, which is associated with primary reflections in a particular survey area. Additionally, an exponential gain function may be used to compensate for attenuation losses.

The date in Figure 1.5-5 have been corrected for geometric spreading using a $t^{2}$ scaling function. While primary reflection amplitudes are corrected for wavefront divergence, energy associated with multiple reflections, coherent linear noise generated by water-bottom point scatterers and the recording cable, and random noise also is inevitably boosted by geometric spreading correction.

Finally, field geometry is merged with the seismic data. This precedes any gain correction that is offsetdependent. Based on survey information for land data or navigation information for marine data, coordinates of shot and receiver locations for all traces are stored on trace headers. Changes in shot and receiver locations are handled properly based on the information available in the observer's log. Many types of processing problems arise from setting up the field geometry, incorrectly. As a result, the quality of a stacked section can be degraded severely.

For land data, elevation statics are applied at this stage to reduce traveltimes to a common datum level. This level may be flat or vary (floating datum) along the line. Reduction of traveltimes to a datum usually requires correction for the near-surface weathering layer in addition to differences in elevation of source and receiver stations. Estimation and correction for the nearsurface effects usually are performed using refracted arrivals associated with the base of the weathering layer (Section 3.4).

## Deconvolution

Typically, prestack deconvolution is aimed at improving temporal resolution by compressing the effective source wavelet contained in the seismic trace to a spike (spiking deconvolution). Predictive deconvolution (Sections 2.3 and 2.4) with a prediction lag (commonly termed
gap) that is equal to the first or second zero crossing of the autocorrelation function also is used commonly. Although deconvolution usually is applied to prestack data trace by trace, it is not uncommon to design a single deconvolution operator and apply it to all the traces on a shot record. Deconvolution techniques used in conventional processing are based on optimum Wiener filtering (Section 2.3).

Figure 1.5-6 shows the common-shot gathers a.fter spiking deconvolution. By examining some of the individual reflections and comparing them with those in Figure 1.5-5, note how the wavelet associated with the significant reflections is compressed and reverberer tory energy that trails behind each reflection is largely attenuated by deconvolution. Because both low- and high-frequency noise and signal are boosted, the data often need filtering with a wide band-pass filter after deconvolution. In addition, some kind of trace balancing (Section 1.4) often is applied after deconvolution to bring the data to a common root-mean-squared (rms) level (Figure 1.5-7).

## CMP Sorting

Seismic data acquisition with multifold coverage is done in shot-receiver $(s, g)$ coordinates. Figure $1.5-8$ a is a schematic depiction of the recording geometry and ray paths associated with a flat reflector. Seismic data processing, on the other hand, conventionally is done in midpoint-offset $(y, h)$ coordinates. The required coordinate transformation is achieved by sorting the data into CMP gathers. Based on the field geometry information, each individual trace is assigned to the midpoint between the shot and receiver locations associated with that trace. Those traces with the same midpoint location are grouped together, making up a CMP gather. Albeit incorrectiy, the term common depth pornt (CDP) and common midpont (GMP) often are used interchangeably.

Figure 1.5-8b depicts the geometry of a CMP gather and raypaths associated with a flat reflector. Note that CDP gather is equivalent to a CMP gather only when reflectors are horizontal and velocities do not vary horizontally. However, when there are dipping reflectors in the subsurface, these two gathers are not equivalent and only the term CMP gather should be used. Selected CMP gathers obtained from sorting the deconvolved shot gathers (Figure 1.5-7) are shown in Figure 1.5-9.

Figure 1.5-10 shows the superposition of shotreceiver $(s, g)$ and midpoint-offset $(y, h)$ coordinates, and raypath geometries for various gather types. The $(y, h)$ coordinates have been rotated 45 degrees relative to the $(s, g)$ coordinates. The dotted area represents the coverage used in recording the seismic profile along the midpoint axis, $O y$. Each dot represents a seismic trace with the time axis perpendicular to the plane of paper. The following gather types are identified in Figure $1.5-10$ :

(1) Common-shot gather (shot record, field record),

(2) Common-receiver gather,

(3) Common-midpoint gather (CMP gather, CDP gather),

(4) Common-offset section (constant-offset section),

(5) CMP-stacked section (zero-offset section)

The recording cable length is $F G$ and the line length is $A D$. The number of dots along the offset axis (cross-section 3 ) is equal to the CMP fold. The fold tapers off at the ends of the profile (segments $A B$ and $C D$ ). Full-fold coverage along the line is at midpoints over segment $B C$. The diagram in Figure 1.5-10 is known as a stacking chart and is useful when setting up the geometry of a line for preprocessing. If there is a missing shot or a bad receiver, the affected midpoints are identified easily (Exercise 1-15).

For most recording geometries, the fold of coverage $n_{f}$ for CMP stacking is given by

$$
n_{f}=\frac{n_{g} \Delta g}{2 \Delta s}
$$

where $\Delta g$ and $\Delta s$ are the receiver-group and shot intervals, respectively, and $n_{g}$ is the number of recording channels. By using this relationship, the following rules can be established:

(a) The fold does not change when alternating traces in each shot record are dropped.

(b) The fold is halved when every other shot record is skipped, whether or not alternating traces in each record are dropped.

## Velocity Analysis

In addition to providing an improved signal-to-noise ratio, multifold coverage with nonzero-offset recording yields velocity information about the subsurface (Chapter 3). Velocity analysis is performed on selected CMP gathers or groups of gathers. The output from one type of velocity analysis is a table of numbers as a function of velocity versus two-way zero-offset time (velocity spectrum). These numbers represent some measure of signal coherency along the hyperbolic trajectories governed by velocity, offset, and traveltime.

Figure 1.5-11 shows the velocity spectra derived from the CMP gathers as in Figure 1.5-9. The horizontal
axis in each spectrum represents the scanned normalmoveout velocity with a range of 1000 to $5000 \mathrm{~m} / \mathrm{s}$, and the vertical axis represents the two-way zero-offset time from 0 to $8 \mathrm{~s}$. Red indicates the maximum coherency measure. The curve in each spectrum represents the velocity function based on the picked maximum coherency values associated with primary reflections. The pairs of numbers along each curve denote the time-velocity values for each pick. Velocity-time pairs are picked from these spectra based on maximum coherency peaks to form velocity functions at analysis locations.

The velocity functions picked at analysis locations then are spatially interpolated between the analysis locations to create a velocity field as shown in Figure 1.5-12. Red in the shallow portion and blue in the deep portion of the section correspond to low and high velocities, respectively. This velocity field is used to supply a velocity function for each CMP gather along the profile.

In areas with complex structure, velocity spectra often fail to provide sufficient accuracy in velocity picks. When this is the case, the data are stacked with a range of constant velocities, and the constant-velocity stacks themselves are used in picking velocities.

## Normal-Moveout Correction

The velocity field (Figure 1.5-12) is used in normal moveout (NMO) correction of CMP gathers (Section 3.1). Based on the assumption that, in a CMP gather, reflection traveltimes as a function of offset follow hyperbolic trajectories, the process of NMO correction removes the moveout effect on traveltimes. Figure 1.5-13 shows the CMP gathers in Figure 1.5-9 after moveout correction. Note that events are mostly flattened across the offset range - the offset effect has been removed from traveltimes. Traces in each CMP gather are then summed to form a stacked trace at each midpoint location. The stacked section comprises the stacked traces at all midpoint locations along the line traverse.

As a result of moveout correction, traces are stretched in a time-varying manner, causing their frequency content to shift toward the low end of the spectrum. Frequency distortion increases at shallow times and large offsets (Figure 1.5-13). To prevent the degradation of especially shallow events, the amplitudes in the distorted zone are zeroed out (muted) before stacking (Figure 1.5-14).

The CMP recording technique, which was invented in the 1950s and published later (Mayne, 1962), uses redundant recording to improve the signal-to-noise ratio during stacking. To achieve redundancy, multiple sources per trace $n_{s}$, multiple receivers per trace $n_{r}$, and multiple offset coverage of the same subsurface point $n_{f}$, are used in the field. Given the total number of elements in the recording system, $N=n_{s} \times n_{r} \times n_{f}$ the signal amplitude-to-rms noise ratio theoretically is improved by a factor of $\sqrt{N}$. This improvement factor is based on the sssumptions that the reflection signal on traces of a CMP gather is identical and the random noise is mutually uncorrelated from trace to trace (Sengbush, 1983). Because these assumptions do not strictly hold in practice, the signal-to-noise ratio improvement gained by stacking is somewhat less than $\sqrt{N}$. Common-midpoint stacking also attenuates coherent noise such as multiples, guided waves, and ground roll. This is because reflected signal and coherent noise usually have different stacking velocities.

In areas with complex overburden structure that gives rise to strong lateral velocity variations, the hyperbolic moveout assumption associated with reflection traveltimes in CMP gathers is no longer valid. As a result, hyperbolic moveout correction and CMP stacking do not always yield a stacked section in which reflections from the underlying strata are faithfully preserved. In such circumstances, imaging in depth and before stack becomes imperative.

## Multiple Attenuation

Multiple reflections and reverberations are attenuated using techniques based on their periodicity or differences in moveout velocity between multiples and primaries. These techniques are applied to data in various domains, including the CMP domain, to best exploit the periodicity and velocity discrimination criteria (Chapter 6 ).

Deconvolution is one method of multiple attenuation that exploits the periodicity criterion. Often, however, the power of conventional deconvolution in attenuating multiples is underestimated. As for the Caspian data example in this section, despite theoretical limitations, deconvolution can remove a significant portion of the energy associated with short-period multiples and reverberations. It also can attenuate long-period multiples if it is applied in data domains in which periodicity is preserved (Chapter 6).

## Dip-Moveout Correction

The normal-moveout correction in Figure 1.5-14 was applied to the CMP gathers using the velocity field of Figure 1.5-12 that is optimum for flat events. Stacking velocities, however, are dip-dependent. Dip-moveout correction (DMO) is needed to correct for the dip effect on stacking velocities and thus preserve events with
conflicting dips during CMP stacking (Chapter 5). Dipmoveout correction has been an integral part of a conventional processing sequence for $2-\mathrm{D}$ and $3-\mathrm{D}$ seismic data since 1985 .

Dip-moveout correction is applied to data following the normal-moveout correction using flat-event velocities (Figure 1.5-15). This then is followed by inverse moveout correction (Figure 1.5-16) and subsequent velocity analysis at closely spaced intervals. Figure 1.5-17 shows the velocity spectra asociated with a subset of the analysis locations which correspond to those of Figure 1.5-11. As for the velocity spectra in Figure 1.5-11, the velocity range is $1000-5000 \mathrm{~m} / \mathrm{s}$ and the maximum time is $8 \mathrm{~s}$. Also, red indicates the maximum coherency measure.

## CMP Stacking

A new velocity field as shown in Figure 1.5-18 is derived from the velocity functions picked from the velocity spectra after DMO correction. As for the velocity field in Figure 1.5-12, red in the shallow portion and blue in the deep portion of the section correspond to low and high velocities, respectively. This new velocity field is used to apply NMO correction to the CMP gathers (Figure 1.5-19). Finally, a CMP stack is obtained (Figure 1.5-20) by summing over the offset axis. The stack is the frontal face of the data volume shown in Figure $1.5-1$.

## Poststack Processing

A typical poststack processing sequence includes the following steps:

(a) Deconvolution after stack (Section 2.5) is usually applied to restore high frequencies attenuated by CMP stacking. It also is often effective in suppressing reverberations and short-period multiples. Figure 1.5-21 shows the CMP stack as in Figure 1.5-20 after spiking deconvolution.

(b) Although not included in the processing sequence for the Caspian data example in this section, often, time-variant spectral whitening (Section 2.6) is used to further flatten the spectrum and accounts for the time-variant character of the source waveform.

(c) Time-variant band-pass filtering (Section 1.1) is then used to remove noise at the high- and lowfrequency end of the signal spectrum (Figure 1.522). (d) The basic processing sequence sometimes includes a step for attenuation of random noise uncorrelated from trace to trace (Chapter 6).

(e) Finally, some type of display gain (Section 1.4) is applied to the stacked data (Figure 1.5-23). For true amplitude preservation, time-variant scaling of stacked amplitudes is avoided; instead, a relative amplitude compensation function that is constant from trace to trace is applied (Section 1.4). This is a slow time-rarying gain function that amplifies weak late reflections without destroying the amplitude relationships from trace to trace that may be caused by subsurface reflectivity.

## Migration

Dipping events are then moved to their supposedly true subsurface positions, and diffractions are collapsed by migrating the stacked section prior to amplitude scaling (Chapter 4). Figure 1.5-24 shows the CMP stack as in Figure 1.5-22 after migration. As for the unmigrated stack, the migrated section also is displayed with the scaled amplitudes (Figure 1.5-25). Although the output of migration is intended to represent the geological cross-section along the line traverse, it often is displayed in time as for the input stacked section. The provided lateral velocity variations are mild to moderate, time megration often is acceptable; otherwise, depth migration is imperative (Chapter 4),

The structural highs below midpoints 4200,6800 , and 8200 in Figure $1.5-25$ are associated with mud diapirism which is prominent in the Caspian basin. Structural complexity caused by faulting and folding generally introduces problems in stacking and imaging the subsurface in three respects:

(a) Steeply dipping reflections associated with fault planes and salt flanks often conflict during stacking with gently dipping or near-flat reflections associated with the less undisturbed strata. The remedy for this problem is prestack time migration for which the robust alternative is dip-moveout correction combined with poststack time migration.

(b) Nonhyperbolic moveout caused by strong lateral velocity variations associated with complex overburden structures involving salt tectonics and overthurst tectonics yields traveltime and amplitude distortions during stacking based on the hyperbolic moveout assumption. The remedy for this problem is prestack depth migration.

(text contmues on p. 122)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0116.jpg?height=1064&width=872&top_left_y=153&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0117.jpg?height=1064&width=849&top_left_y=153&top_left_x=74)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0118.jpg?height=1066&width=870&top_left_y=152&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0119.jpg?height=1068&width=854&top_left_y=150&top_left_x=69)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0120.jpg?height=1050&width=880&top_left_y=159&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0121.jpg?height=418&width=596&top_left_y=120&top_left_x=218)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0121.jpg?height=404&width=583&top_left_y=683&top_left_x=211)

FIG. 1.5-8. (a) Seismic data acquisition is done in shot-recelver $(s, g)$ coordnates. The raypaths are associated with a planar horizontal reflector from a shot point (indicated by the solid circles) to several receiver locations (indicated by the triangles). The processing cocrdinates, midpoint-(half) offet, $(y, h)$ are defined in terms of $(a, g): y=(g+s) / 2, h=(g-s) / 2$. The shot axis here points opposite the profiling direction, which is to the left. On a flat reflector, the subsurface is sampled by reflection points which span a length that is equal to half the cable length. (b) Seismic data processing is done in midpoint-offet $(y, h)$ coordinates. The raypaths are associated with a single CMP gather at midpoint location $M$. A CMP gather is identical to a CDP gatber if the depth point were on a horizontally flat reflector and the medium above were horizontally layered.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0122.jpg?height=931&width=795&top_left_y=220&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0123.jpg?height=946&width=848&top_left_y=210&top_left_x=71)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0124.jpg?height=1088&width=784&top_left_y=141&top_left_x=145)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0125.jpg?height=885&width=682&top_left_y=245&top_left_x=134)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0126.jpg?height=925&width=798&top_left_y=220&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0126.jpg?height=854&width=35&top_left_y=257&top_left_x=886)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0127.jpg?height=922&width=861&top_left_y=216&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0128.jpg?height=969&width=798&top_left_y=198&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0129.jpg?height=967&width=795&top_left_y=199&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0130.jpg?height=182&width=730&top_left_y=147&top_left_x=74)

¿్
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0130.jpg?height=180&width=712&top_left_y=327&top_left_x=92)

㗎
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0130.jpg?height=190&width=712&top_left_y=502&top_left_x=93)

ูู
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0130.jpg?height=186&width=718&top_left_y=686&top_left_x=88)

हू
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0130.jpg?height=364&width=732&top_left_y=865&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0131.jpg?height=861&width=690&top_left_y=255&top_left_x=135)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0132.jpg?height=971&width=799&top_left_y=197&top_left_x=71)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0133.jpg?height=1086&width=668&top_left_y=145&top_left_x=137)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0134.jpg?height=1084&width=658&top_left_y=142&top_left_x=212)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0135.jpg?height=830&width=652&top_left_y=138&top_left_x=145)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0136.jpg?height=1093&width=659&top_left_y=136&top_left_x=233)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0137.jpg?height=807&width=651&top_left_y=143&top_left_x=144)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0138.jpg?height=1080&width=651&top_left_y=145&top_left_x=241)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0139.jpg?height=373&width=725&top_left_y=261&top_left_x=147)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0139.jpg?height=359&width=701&top_left_y=667&top_left_x=148)

(b)

FIG. 1.5-26. The NMO-corrected CMP gathers from a land seisuic line (a) before and (b) after residual statics corrections. Note that the distorted events (CMP 191, 216) have nearly been flattened (b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0140.jpg?height=516&width=392&top_left_y=358&top_left_x=95)

CMP 297

FIG. 1.5-27. Velocity spectra derived from the same data as in Figure 1.5-26, (a) before and (b) after residual statics corrections. Note that no significant difference exists between spectra derived from CMP gather 297 with and without the application of residual statics corrections. Reflection times in this gather did not have significant residual static shifts.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0140.jpg?height=513&width=392&top_left_y=356&top_left_x=550)

CMP 188

FIG. 1.5-28. Velocity spectra derived from the same data as in Figure 1.5-26, (a) before and (b) after residual statics corrections. Note the improvement after corrections down to $2.6 \mathrm{~s}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0141.jpg?height=381&width=765&top_left_y=238&top_left_x=127)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0141.jpg?height=367&width=748&top_left_y=655&top_left_x=134)

(b)

FIG. 1.5-29. The CMP stacks derived from the gathers in Figure 1.5-26. The stack (a) without residual statics corrections shows false structure and poor coherence in the vicinity of CMP 149-197. Both are eliminated by correcting for residual statics (b).
(c) Any of the two cases described in (a) and (b) often manifest themselves as 3-D problems in nature. The remedy for the 3-D effects, of course, is 3-D migration.

The migrated section in Figure 1.5-25 must be evaluated w'thin the above limitations in stacking and imaging the nil)surface.

## Residual Statics Corrections

There is one additional step in conventional processing of land and shallow-water seismic data before stacking residual statics corrections. From the NMO-corrected gathers in Figure 1.5-26a, note that the events in CMP 216 are not as flat as they are in the other gathers. The moveout in CMP gathers does not always conform to a perfect hyperbolic trajectory. This often is because of near-surface velocity irregularities that cause a static or dynamic distortion problem. Lateral velocity variations caused by a complex overburden can cause moveonts that could be negative a reflection event arrives on long-ofisct traces before it arrives on short-offset traces. Close examination of the velocity spectra indirates that some are easier to pick (Figure 1.5-27a) than others (Figure 1.5-28a). The velocity spectrum that corresponds to CMP 297 has sharp coherency peaks that ase associated with a distinctive velocity trend. However, the velocity spectrum that corresponds to CMP 188 does not yield a distinctive trend, thus making it relatively difficult to pick (Figure 1.5-28a).

To improve stacking quality, residual statics corrections (Section 3.3) are performed on the moveoutcorrected CMP gathers. This is done in a surfaceconsistent manner; that is, time shifts are dependent only on shot and receiver locations, not on the ray paths from shots to receivers. The estimated residual corrections are applied to the original CMP gathers with no NMO correction. Velocity analyses then are often repeated to improve the velocity picks (Figures 1.5-27b and 1.5-28b). With the improved velocity field, the CMP gathers are NMO-corrected (Figure 1.5-26b). Finally, the gathers are stacked as shown in Figure 1.529b. For comparison, the stack without the residual statics corrections is shown in Figure 1.5-29a. Reflection contimity over the problem zone between midpoints 53 245 has been improved.

## Quality Control in Processing

The conventional processing sequence is outlined in Figure 1.5-30. Each of the processes described above is presented $\mathrm{m}$ detail in subsequent chapters. In a seismir data processing sequence, the step that is most vulnerable to human errors is defining the geonetry for the survey under consideration and merging it with the seismic data. This involves correctly assigning sources and receivers to their respective surface locations and correctly specifying the source-receiver separation and azimuth for each recorded trace in the survey.

To demonstrate just how important it in to "t $1-$ rectly specify the geometry of a survey, conside the impact of a deliberately incorrect geometry assigu:nent on velocity estimation and normal-moveout correction. Figure 1.5-31 shows CMP gathers before and after moveout correction and velocity spectra at three analysis locations along a seismic traverse. The case shown in Figure 1.5-31a does not appear to exhibit any a! normal moveout behavior. The velocity spectrum yik kis a fairly unambiguous primary velocity function, ancl , rtmary events on the moveout-corrected gather are ne wiy flat. The case shown in Figure 1.5-31b, however, bcgins to show signs of something being wrong with the data.

## Field Txapes and Obgerver's Log

## (1) Preprocessing:

- Demnltiplexing
- Reformatting
- Editing
- Geometric Spreading Correction
- Setup of Fieli Geometry
- Application of Fjeld Staties

(2) Deconvolution and Trace Balancing

(3) CMP Sarting

(4) Velocity Analysis

(5) Residual Statics Corrections

(6) Veloeity Analysis

(7) NMO Correction

(8) DMO Correction

(9) Inverse NMO Correction

(10) Velocity Anqlysis

(11) NMO Correctjon, Mnting and Stacking

(12) Deconvalntion

(13) Time-Variant Spectral whitening

(14) Time-Variant Filtering

(15) Migration

(16) Gain Application

FIG. 1.5-30. A conventional processing flowchart.

Although the velocity spectrum, again, yields a fairly unambiguous primary velocity function, note that the events associated with the major primary reflections in the CMP gather do not submit themselves to flattening properly after normal-moveout correction. Such behavior in the moveout may be attributed to some physical phenomenon, for instance, anisotropy or nonhyperbolic moveout caused by lateral velocity variations. Nevertheless, it is caused in this case by incorrect geometry specification related to wrong offset assignment to the traces in the gather. The abnormal moveout behavior is strikingly more obvious in the case shown in Figure 1.5-31c. Note the ambiguous semblance peaks in the velocity spectrum, which cause failure in normal-moveout correction to properly flatten the primary events in the gather. Note the differences in the degree of abnormal behavior in event moveout from one location to another (Figures 1.5-31a,b,c); the simpler and the flatter the subsurface structure, the less obvious the adverse impact of incorrect geometry on the moveout.

The care required for correct assignment of the geometry of a survey, of course, does not undermine the care required for proper specification of the parameters associated with any other step in a processing sequence. Specifically, each step must be executed with the necessary quality control. Displays of appropriate data attributes, such as amplitude spectrum and autocorrelogram, help the analyst understand signal and noise chracteristics of the recorded data and the effect of a step included in the processing sequence on the data, thus facilitating appropriate specification of parameters associated with that step. Figures 1.5-32 through 1.5-41 show quality control panels that are examples of recommended standard displays for parameter selection at various stages in the analysis. All displays include the amplitude spectrum on the top row averaged over the gather, if it is a prestack test panel, and averaged over the portion of the stack, if it is a poststack test panel, and autocorrelogram of the respective data type on bottorn row.

Figure $1.5-32$ is the quality control panel for prestack signal processing. Shown from left to right are: (a) a CMP gather which exhibits strong, low-frequency swell noise; (b) low-cut filtering to remove the swell noise; (c) $t^{2}$ scaling to correct for geometric spreading (Section 1.4); (d) prestack spiking deconvolution (Sections 2.3, 2.4, and 2.5); (e) and wide bandpass filtering to remove the high-frequency noise boosted by spiking deconvolution. Note that the autocorrelogram better exhibits over the entire cable length the characteristics of the source waveform and reverberations and multiples after $t^{2}$ scaling. Also note that spiking deconvolution has removed much of the energy associated with the reverberations and multiples. The broadening and flattening of the amplitude spectrum after spiking deconvolution are indicative of the increase of vertical resolution.

Figure 1.5-33 shows the spectra which are associated with the gathers from left to right in Figure 1.5-32. The horizontal axis is frequency in $\mathrm{Hz}$ and the vertical axis is two-way traveltime in $s$. Note from (a) that the swell noise at very low frequencies occupies the spectrum along the entire time axis. Note also that the energy in the gather is largely confined to shallow times within a bandlimited region of the spectrum. Following the low-cut filtering (b), note the elimination of the swell noise energy. The $t^{2}$ scaling (c) has restored the energy at late times, and deconvolution (d) has broadened the spectrum. Following the wide bandpass filtering $(e)$, note that the signal bandwidth has been preserved [compare with (a)], and the spectrum has been flattened within the passband.

Figures 1.5-34 and 1.5-35 show two standard test panels for determining prestack deconvolution parameters. With the help of the amplitude spectrum and autocorrelogram, the analyst chooses an optimum operator length and prediction lag. Figure 1.5-34 shows the test panel for prestack spiking deconvolution (Sections 2.3,2.4, and 2.5). Shown from left to right are: the input gather after low-cut filtering and $t^{2}$ scaling as in Figure 1.5-32, followed by deconvolution using operator lengths of $120 \mathrm{~ms}, 160 \mathrm{~ms}, 240 \mathrm{~ms}, 360 \mathrm{~ms}$, and 480 $\mathrm{ms}$. Note that deconvolution using an operator length of $480 \mathrm{~ms}$ best flattens the spectrum within the signal passband. Failure of deconvolution in flattening the spectrum at very high frequencies is most likely due to nonstationarity of the signal. This effect usually is accounted for by time-variant spectral whitening after stack. Since autocorrelation of input data is used in designing a deconvolution operator, it is appropriate to examine the autocorrelation before and after deconvolution. Note from the autocorrelograms in Figure 1.5-34 that operator length dictates the ability of deconvolution in removing reverberations and short-period multiples.

Figure 1.5-35 shows the test panel for prestack predictive deconvolution (Sections 2.3,2.4, and 2.5). Shown from left to right are: the input gather after low-cut filtering and $t^{2}$ scaling as in Figure 1.5-32, followed by deconvolution using prediction lags of $2 \mathrm{~ms}$ (unit prediction lag), $8 \mathrm{~ms}, 16 \mathrm{~ms}, 24 \mathrm{~ms}$, and $32 \mathrm{~ms}$, with the same operator length of $480 \mathrm{~ms}$. Note that the unit-prediction lag yields a flat spectrum across the passband, while increasing the prediction lag results in departure from a flat spectrum. Prediction lag controls the ability of deconvolution to increase the vertical resolution (Section 2.4).

Figures 1.5-36 and 1.5-37 show two standard test panels for determining poststack deconvolution parameters. Note from the average amplitude spectrum of the
section on the left-hand side of each test panel that CMP stacking inherently atteniates high frequencies which need to be restored by poststack deconvolution. Figure 1.5-36 shows the test panel for poststack spiking deconvolution. Shown from left to right are: the input stack, followed by deconvolution using operator lengths of $120 \mathrm{~ms}, 160 \mathrm{~ms}, 240 \mathrm{~ms}, 360 \mathrm{~ms}$ and $480 \mathrm{~ms}$, and high-cut filtering to retain the acseptable signal band and remove the high-frequency noise.

Figure 1.5-37 shows the test panel for poststack predictive deconvolution. Shown from left to right arc: the input stack, followed by deconvolution using prediction lags of $2 \mathrm{~ms}$ (unit preduction lag), $8 \mathrm{~ms}, 16 \mathrm{~ms}, 24$ ms and $32 \mathrm{~ms}$, using the same operator length of 480 $\mathrm{ms}$, and high-cut filtering to retain the acceptable signal band and remove the high-frequency noise. Again, note that the unit-prediction lag yields a flat spectrum across the pasiband, while increasing the prediction lag results in departure from a flat spectrum.

Figure 1.5-38 shows the standard quality control pancl for poststack signal processing. Shown from left to right are: a portion of the stacked scction with prestack processing as described by Figure 1.5-32; spiking deconvolution (Section 2.5) to restore the high frequencies attenuated by the stacking process; time-variant spectral whitering to account for nonstationarity and to further flatten the spectrum (Section 26 ) all three steps followed by high-cut filtering; bandpass filtering to retain the acceptable signal band and remove the high-frequency noise; instantaneous AGC scaling and rms amplitude AGC scaling.

Figures 1.5-39 and 1.5-40 show the test pancls for defining the paramcters for time-variant filtcring (Scction 1.1). A portion of the stacked section is bandpass filtered using a $10-\mathrm{Hz}$ bandwidth that slides from low to high-frequency end of the spectrum. Note that the coherent signal at high-frequency bands is confined to shallow times. Nevertheless, these filter panels indicate that signal up to $90 \mathrm{~Hz}$ is present in the data down to $2.2 \mathrm{~s}$, and the signal up to $100 \mathrm{~Hz}$ is present down to $1.4 \mathrm{~s}$,

Finally, Figure 1.5-41 shows the test panel for poststack noise attemuation using $f-x$ deconvolution (Section 6.5). A parameter that needs to be tested for $f-x$ deconvolution is the percent add-back of the estimated noise to circumvent the smeared appearance of events following noise attenuation. Shown from left to right are: a portion of the stacked section with poststack deconvolution, time-variant spectral whitening and bandpass filtering; noise attenuation with $80,60,40,20$, and 0 percent add-back. Note that without any add-back, the amplitude spectrum of the section after noise attenuation indicates dampening of high-frequency energy that may be attributed to the random noise uncorrelated from trace to trace.
The test panel for quality control in proccssing of seismic data are not limited to those presented in Figures 1.5-32 through 1.5-41. Additional panels with appropriate and convenient format may be constructed to test parameters associated with refraction and residual statics corrections, multiple attenuation, dip-moveout correction, and migration. Powerful interactive tools, including 3-D visualization techniques, facilitate efficicnt parameter testing and quality control in processing.

## Parsimony in Processing

The primary objective in data processing is to enhance the signal-to-noise ratio while preserving the useful signal bandwidth associated with the recorded clata at all stages in the analysis. The principle of parsiniony in processing is the basis to achicve this objective. Speefically, a processing scquence should be optimally lcan and not include any step that may do more harm than the intended action by that process. A further compelling reason for parsimony is preserving relative amplitudes for amplitude-driven exploration objcctives associated with stratigraphic plays.

Figures 1.5-42 through 1.5-53 show the step-bystep appearance of a portion of a stacked section besed on a very basic: processing sequence intended to minimize amplitude distortions whle largely attenuating reverberations, multiples, and random noise and ultimately increasing vertical and lateral resolution.

The stacked sections in Figures 1.5-42 through 1.547 were created based on the following prestack processing sequence:

(a) Figure 15-42: stack based on unprocesed data that contain low-frequency swell noise.

(b) Figure 1.5-43: stack using CMP gathers with lowcut filtering applied to remove the swell noise.

(c) Figure 1.5-44: stack as in (b) with the additional step for $t^{2}$ sealing to compensate for wavefront divergence; note the restoration of amplitudes at late times.

(d) Figure 1.5-45: stack as in (c) with the additional step for prestack spiking deconvolution; note the attenuation of reverberations.

(e) Figure 1.5-46: stack as in (d) with the additional step for wide bandpass filtering to improve velocity analysis.

(f) Figure 1.5-47: stack as in (c) with the additional step for dip-moveout correction; note the preservation of diffractions that interfere with the nearly flat reflections.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0145.jpg?height=1070&width=626&top_left_y=122&top_left_x=210)

FIG. 1.5-31. Anomalous moveout bchavor on CMP gathers caused by incorrect geometry specification See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0146.jpg?height=920&width=775&top_left_y=225&top_left_x=73)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0147.jpg?height=932&width=806&top_left_y=116&top_left_x=72)

FIG. 1.5-33. Spectral analysis associated with the test panel in Figure 1.5-32. See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0148.jpg?height=1083&width=813&top_left_y=145&top_left_x=79)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0149.jpg?height=1081&width=819&top_left_y=146&top_left_x=80)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0150.jpg?height=1080&width=776&top_left_y=145&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0151.jpg?height=1061&width=760&top_left_y=155&top_left_x=79)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0152.jpg?height=1076&width=775&top_left_y=147&top_left_x=148)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0153.jpg?height=1064&width=766&top_left_y=153&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0154.jpg?height=1064&width=713&top_left_y=153&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0155.jpg?height=1071&width=714&top_left_y=151&top_left_x=74)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0156.jpg?height=898&width=827&top_left_y=146&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0157.jpg?height=1065&width=764&top_left_y=153&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0158.jpg?height=1069&width=838&top_left_y=152&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0159.jpg?height=1056&width=820&top_left_y=157&top_left_x=79)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0160.jpg?height=1049&width=827&top_left_y=157&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0161.jpg?height=1085&width=785&top_left_y=144&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0162.jpg?height=1061&width=834&top_left_y=156&top_left_x=79)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0163.jpg?height=981&width=817&top_left_y=155&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0164.jpg?height=980&width=813&top_left_y=158&top_left_x=80)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0165.jpg?height=1051&width=828&top_left_y=157&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0166.jpg?height=1047&width=811&top_left_y=159&top_left_x=81)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0167.jpg?height=1053&width=819&top_left_y=157&top_left_x=80)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0168.jpg?height=900&width=770&top_left_y=210&top_left_x=133)

FIG. 1.5-54. Spectral analysis of the sections based on the prestack procesing shown in Figures 1.5-42 through 1.5-47. See text for details.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0169.jpg?height=904&width=768&top_left_y=206&top_left_x=134)

FIG. 1.5-55. Spectral analysis of the sections based on the poststack processing shown in Figures 1.5-48 through 1.5-53. See text for details.

## Sampling Rate $=2 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0170.jpg?height=135&width=447&top_left_y=168&top_left_x=156)

$4 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0170.jpg?height=132&width=448&top_left_y=339&top_left_x=154)

$8 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0170.jpg?height=160&width=455&top_left_y=505&top_left_x=148)

## Amplitude Spectra

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0170.jpg?height=516&width=276&top_left_y=148&top_left_x=612)

FIG. 1.E-1. A signal with three frequency components, A, B, and C, sampled at three different rates, 2, 4, and $8 \mathrm{~ms}$. Frequency aliasing oceurs at coarser sampling intervals (see Exercise 1-1).

The stacked sections in Figures 1.5-48 through 1.553 were created based on the following poststack processing sequence:

(a) Figure 1.5-48: stack as in (f) of the prestack processing sequence described above with the additional step for poststack spiking deconvolution; note the increase in vertical resolution as a result of wavelet compression.

(b) Figure 1.5-49: stack as in (a) with the additional step for time-varient spectral whitening to account for nonstationarity.

(c) Figure 1.5-50: stack as in (b) with the additional step for wide bandpass filtering.

(d) Figure 1.5-51: stack as in (c) with the additional step for AGC scaling.

(e) Figure 1.5-52: stack as in (d) with the edditional step for attenuation of random noise uncorrelated from trace to trace using $f-x$ deconvolution (Section 6.5).

(f) Figure 1.5-53: migrated stack as in (c) with the additional step for AGC scaling.
Scan through the stacked sections starting with Figure 1.5-42 and observe the effect of each processing step on the result. Additonally, examine the spectra labeled as (a) through (f) in Figure 1.5-54 which correspond to the stacked sections in Figures 1.5-42 through Figure 1.5-47 involving the prestack sequence, respectively, and the spectra labeled as (a) through (f) in Figure 1.5-55 which correspond to the stacked sections in Figures 1.5-48 through Figure 1.5-53 involving the poststack sequence, respectively. Observe the change in the spectral content induced by each process, and note that the ultimate objectives in processing are aimed at preserving the bandwidth of the recorded signal and flattening the spectrum within the signal passband to attain the maximum possible vertical and lateral resolutions.

## EXERCISES

Exercise 1-1. Refer to Figure 1.E-1. Using equation (1-2), compute the alias frequencies at 4- and 8-ms
s

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0171.jpg?height=511&width=628&top_left_y=136&top_left_x=199)

$\mathrm{s}$ туре

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0171.jpg?height=508&width=623&top_left_y=639&top_left_x=200)

FIG. 1.E-2. A field data set displayed in two different domans common-shot and common-midpoint (see Exercise 1-12).
sampling intervals for the three frequency components - A, B and $C$ from the amplitude spectrum of the 2 -ms time series. Confirm the results of your computation by the amplitude spectra.

Exercise 1-2. Using the hyperbolic traveltime equation, compute the average velocity down to reflector $A$ in Figure 1.3-8. Assume a constant velocity between $A$ and the surface. The required information about Record 8 is in Table 1-13.

Exercise 1-3. What is the dispersive event $C$ in Figure 1.3-8?

Exercise 1-4. Refer to the walk-away noise test record in Figure 1.3-19. Measure the phase velocity ( $\Delta x / \Delta t$ ) of the ground-roll energy at location $A_{1}$. Also measure the dominant frcquency at the same location. Then, estimate the dominant wavelength (velocity/dominant frequency) of the ground roll. The receiver array length needed to suppress this energy in the field should be equal to or greater than the longest noise wavelength. The required information about Record 19 that you need for your computations is in Table 1-13.

Exercise 1-5. Measure the group velocity ( $x / t$ ) of ground-roll energy A in Figure 1.3-25. The required information for Record 25 is in Table 1-13.

Exercise 1-6. Refer to the shot record in Figure 1.3-27. The ncar-offset 28 channels were recorded using a 50 -m group interval. What is the group interval for the remaining 64 channels? The required information for Record 27 is in Table 1-13.

Exercise 1-7. What is event A in Figure 1.3-29? Are cvents $C, D$, and $E$ multiples of $B$ ?

Exercise 1-8. Refer to Figure 1.3-30. Compute the water velocity using both the direct arrivals $A$ and the water-bottom reflection $B$. Use one-way time for $A$ and two-way time for $B$. The required information for Record 30 is in Table 1-13.

Exercise 1-9. Identify events A, B, C, D, E, and $F$ in Figure 1.3-33.
Exercise 1-10. Identify events A, B, C, D, and E in Figure 1.3-34.

Exercise 1-11. Gain application involves multiplying the gain function with the seismic trace (Figure 1.4-8). Use the appropriate entry in Table A-1 to de scribe the effect of the gain application in the frequency domain.

Exercise 1-12. From Figure 1.E-2, identify the common-shot and common-midpoint gathers.

Exercise 1-13. Use equation (1-10) to compute fold $n_{f}$ for each of the following recording geometries:

| Number of <br> Channels | Shot <br> Spacing, m | Receiver <br> Spacing, $\mathrm{m}$ |
| :---: | :---: | :---: |
| 240 | 25 | 25 |
| 240 | 50 | 25 |
| 240 | 100 | 25 |
| 240 | 25 | 50 |

Exercise 1-14. Consider the recording geometry in Figure 1.5-8. Sketch the traveltine curves on a common-shot gather associated with point scatterers (a) beneath the cable, (b) behind, and (c) in front of the cable. Assume all scatterers are on the plane of recording.

Exercise 1-15. Suppose that the shot associeted with gather 1 in Figure 1.5-10 is missing. Identify the midpoints that are affected by this missing shot; that is, the midpoints with a lower fold of coverage. Suppose the receiver associated with gather 2 in Figure 1.5-10 is missing. Identify the midpoints that are affected by this.

Exercise 1-16. Prove the shifting, scaling, and differentiation rules applied to the Fourier transform of a function given by the entires (1), (2), and (3) in Table A-1.

## Appendix A <br> A MATHEMATICAL REVIEW OF THE FOURIER TRANSFORM

## A. 1 The 1-D Fourier Transform

Given a continuous function $x(t)$ of a single variable $t$, its Fourier transform is defined by the integral

$$
X(\omega)=\int_{-\infty}^{+\infty} x(t) \exp (-i \omega t) d t
$$

where $w$ is the Fourier dual of the variable $t$. If $t$ signifies time, then $\omega$ is angular frequency. The temporal frequency $f$ is related to the angular frequency $\omega$ by $\omega=2 \pi f$.

The Fourier transform is reversible; that is, given $X(\omega)$, the corresponding time function is

$$
x(t)=\int_{-\infty}^{+\infty} X(\omega) \exp (i \omega t) d \omega
$$

Throughout this book, the following sign convention is used for the Fourier transform. For the forward transform, the sign of the argument in the exponent is negative if the variable is time and positive if the variable is space. Of course, the inverse transform has the opposite sign used in the respective forward transform. For convenience, the scale factor $2 \pi$ in equations (A-1) and (A-2) are omitted.

Generally, $X(\omega)$ is a complex function. By using the properties of the complex functions, $X(\omega)$ is expressed as two other functions of frequency

$$
X(\omega)=A(\omega) \exp [i \phi(\omega)]
$$

where $A(\omega)$ and $\phi(\omega)$ are the amplitude and phase spectra, respectively. They are computed by the following equations:

$$
A(\omega)=\sqrt{X_{r}^{2}(\omega)+X_{4}^{2}(\omega)}
$$

and

$$
\phi(\omega)=\tan ^{-1} \frac{X_{t}(\omega)}{X_{+}(\omega)}
$$

where $X_{r}(\omega)$ and $X_{2}(\omega)$ are the real and imaginary parts of the Fouries transform $X(\omega)$. When $X(\omega)$ is expressed in terms of its real and imaginary components

$$
X(\omega)=X_{+}(\omega)+i X_{1}(\omega)
$$

and is compared with equation (A-3), note that

$$
X_{r}(\omega)=A(\omega) \cos \phi(\omega)
$$

and

$$
X_{t}(\omega)=A(\omega) \sin \phi(\omega)
$$

We now consider two functions $-x(t)$ and $f(t)$. Listed in Table A-1 are basic theorems that are useful in various applications of the Fourier transform.

Table A-1. Foutrier transform theorems (Bracewell, 1965).

| Operation | Time | Firequency |
| :--- | :---: | :---: |
| (1) Shifting | $x(t-\tau)$ | $\exp (-i \omega \tau) X(\omega)$ |
| (2) Scaling | $x(a t)$ | $\|a\|^{-1} X(\omega / a)$ |
| (3) Differentiation | $d x(t) / d t$ | $z \omega X(\omega)$ |
| (4) Addition | $f(t)+x(t)$ | $F(\omega)+X(\omega)$ |
| (5) Multiplication | $f(t) x(t)$ | $F(\omega) * X(\omega)$ |
| (6) Convolution | $f(t) * x(t)$ | $F(\omega) X(\omega)$ |
| (7) Autocorrelation | $x(t) * x(-t)$ | $\|X(\omega)\|^{2}$ |
| (8) Parseval's theorem | $\int\|x(t)\|^{2} d t$ | $\int\|X(\omega)\|^{2} d \omega$ |

* denotes convolution.

Proofs of these theorems can be found in the classic reference on Fourier transforms by Bracewell (1965). Also, some of the proofs are left to the excrcises at the end of this chapter. Here, we shall derive the convolutional relation (6) for continuous functions, and the same relation for discrete functions in Section A.2. Consider convolution of two functions $x(t)$ and $f(t)$ with their Fourier transforms $X(\omega)$ and $F(\omega)$, respectively,

$$
y(t)=f(t) * x(t)
$$

which is explicitly given by the integral

$$
y(t)=\int_{-\infty}^{+\infty} f\left(t-t^{\prime}\right) x\left(t^{\prime}\right) d t^{\prime}
$$

The Fouricr transform of the resulting function $y(t)$ is

$$
Y(\omega)=\int_{-\infty}^{+\infty} y(t) \exp (-\imath \omega t) d t
$$

Substitute the convolution integral of equation (A-7b) into equation (A-8a)

$$
Y(\omega)=\int_{-\infty}^{+\infty}\left[\int_{-\infty}^{+\infty} f\left(t-t^{\prime}\right) x\left(t^{\prime}\right) d t^{\prime}\right] \exp (-z \omega t) d t, \quad(A-8 b)
$$

and interchange the two integrals

$$
Y(\omega)=\int_{-\infty}^{+\infty} x\left(t^{\prime}\right)\left[\int_{-\infty}^{+\infty} f\left(t-t^{\prime}\right) \exp (-\tau \omega t) d t\right] d t^{\prime}
$$

From the shift theorem given by entry (1) of Table A-1, we have

$$
\int_{-\infty}^{+\infty} f\left(t-t^{\prime}\right) \exp (-\imath \omega t) d t=F(\omega) \exp \left(-i \omega t^{\prime}\right)
$$

Use this relation in equation (A-8c) to get

$$
Y(\omega)=\int_{-\infty}^{+\infty} x\left(t^{\prime}\right)\left[F(\omega) \exp \left(-\imath \omega t^{\prime}\right)\right] d t^{\prime}
$$

then rearrange the terms to obtain

$$
Y(\omega)=F(\omega) \int_{-\infty}^{+\infty} x\left(t^{\prime}\right) \operatorname{cxp}\left(-i \omega t^{\prime}\right) d t^{\prime}
$$

Note that the integral in equation (A-10b) is the Fourier trassform of $x(t)$, and therefore,

$$
Y(\omega)=F(\omega) X(\omega)
$$

which is the desired result given by entry (6) of Table A-1.

## A. 2 The $z$-Transform

A discrete time function is called a time series. When digitized, the continuous function $x(t)$ takes the form

$$
x(t)=\sum_{k} x_{k} \delta(t-k \Delta t), \quad k=0,1,2, \ldots
$$

where $\Delta t$ is the sampling interval and $\delta(t-k \Delta t)$ is the Dirac delta function. The discrete equivalent of the Fourier integral given by equation (A-1) is written as a summation

$$
X(\omega)=\sum_{k} x_{k} \exp (-i \omega k \Delta t), \quad k=0,1,2, \ldots
$$

A new variable $z=\exp (-i \omega \Delta t)$ now is defincd. By substituting into equation (A-13) and explicitly writing the summation, we get

$$
X(z)=x_{0}+x_{1} z+x_{2} z^{2}+\ldots
$$

Function $X(z)$ in equation (A-14) is called the $z$-transform of $x(t)$. It is a polynomial of the $z$ variable. The power of $z$ represents the time delay of the discrete samples in the time series $x(t)$.

We now show that convolution of two time series is equivalent to the multiplication of their $z$-transforms. Consider two discrete time series $-x(t):\left(x_{0}, x_{1}, x_{2}\right)$ and $f(t):\left(f_{0}, f_{1}\right)$. Convolution of the two series is obtained by using Table 1-5. The results of the convolutional process are displayed in Table A-2.

The discrete output series $y(t):\left(y_{0}, y_{1}, y_{2}, y_{3}\right)$ is given by

$$
\begin{aligned}
& y_{0}=f_{0} x_{0} \\
& y_{1}=f_{1} x_{0}+f_{0} x_{1} \\
& y_{2}=f_{1} x_{1}+f_{0} x_{2} \\
& y_{3}=f_{1} x_{2}
\end{aligned}
$$

The $z$-transforms of the two input series are expressed by

$$
X(z)=x_{0}+x_{1} z+x_{2} z^{2}
$$

and

$$
F(z)=f_{0}+f_{1} z
$$

By multiplying the two polynomials of equations (A-16a) and (A-16b), we obtain

$$
X(z) F(z)=f_{0} x_{0}+\left(f_{1} x_{0}+f_{0} x_{1}\right) z+\left(f_{1} x_{1}+f_{0} x_{2}\right) z^{2}+\left(f_{1} x_{2}\right) z^{3}
$$

Table A-2. Convolution of $\left(f_{0}, f_{1}\right)$ with $\left(x_{0}, x_{1}, x_{2}\right)$.

|  |  | $x_{0}$ | $x_{1}$ | $x_{2}$ |  | Output |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| $f_{1}$ | $f_{0}$ |  |  |  | $y_{0}$ |  |
|  |  | $f_{1}$ | $f_{0}$ |  |  | $y_{1}$ |
|  |  | $f_{1}$ | $f_{0}$ |  | $y_{2}$ |  |
|  |  |  | $f_{1}$ | $f_{0}$ | $y_{3}$ |  |

By comparing the coefficients of the polynomial given by equation (A-17) with the output of convolution in equations (A-15), we find that if

$$
y(t)=f(t) * x(t)
$$

then,

$$
Y(z)=F(z) X(z)
$$

and, since $z=\exp (-\imath \omega \Delta t)$,

$$
Y(\omega)=F(\omega) X(\omega)
$$

## A. 3 The 2-D Fourier Transform

The 2-D Fourier transform of a 2-D function, such as a wavefield $P(x, t)$, is given by

$$
P\left(k_{x}, \omega\right)=\iint P(x, t) \exp \left(i k_{x} x-i \omega t\right) d x d t
$$

Function $P(x, t)$ can be reconstructed from $P\left(k_{x}, \omega\right)$ by the 2 -D inverse Fourier transform:

$$
P(x, t)=\iint P\left(k_{x}, \omega\right) \exp \left(-i k_{x} x+i \omega t\right) d k_{x} d \omega
$$

The integral given by equation (A-19) is evaluated in two steps. First, by Fouricr transforming in $t$,

$$
P(x, \omega)=\int P(x, t) \exp (-i \omega t) d t
$$

then by Fourier transforming in $x$, we get the 2-D transform:

$$
P\left(k_{x}, \omega\right)=\int P(x, \omega) \exp \left(\imath k_{x}\right) d x
$$

## REFERENCES

Bracewell, R. N., 1965, The Fourier transform and its applications: McGraw-Hill Book Co. Claerbout, J. F., 1976, Fundamentals of geophysical data processing: McGraw-Hill Book Co. Cleerbout, J. F, 1985, Imaging the earth's interior: Blackwell Scientific Publications.

Grant, F. S. and West, G. F., 1965, Interpretation theory in applied geophysics: McGraw-Hill Book Co.

Larner, K. L., Chambers, R., and Rothmen, D., 1981, Trace interpolation and design of 3-D surveys: Presented at the Ann. Eur. Assoc. Expl. Geophys. Mtg.

Larner, K. L., Chambers, R., Yang, M., Lynn, W., and Wai, W., 1983, Coherent noise in marine seismic data: Geophysics, $48,854-886$.

Li, Z., Lynn, W., Chambers, R., Larner, K., and Abma, R., 1991, Enhancements to prestack frequency-wavenumber $(f-k$ ) migration: Geophysics, 56, 27-40.

Mayne, W. H., 1962, Common-reflection-point horizontal data stacking techniques: Geophysics, 27, 927-938.

Newman, P., 1973, Divergence effects in a layered carth: Geophysics, 38, 481-488.

Robinson, E. A. atid Treitel, S., 1980, Geophysical signal analysis: Prentice-Hall, Inc.

Sengbush, R.L., 1983, Seismc exploration methods: Internat. Human Res. Dev. Corp.

Wisecup, R. D., Unambiguous signal recovery above the Nyquist using random-sample-interval imaging: Geophysics, 63, 763-771.

Yilmaz, O. and Cumro, D., 1983, Worldwide assortment of field sesmic records: Tech. Rep., Western Geophysical Company.

## 2 Deconvolution

- Introduction - The Convolutional Model $} \cdot$ The Convolutional Model in the Time Domain \bullet The Convolu- tional Model in the Frequency Domain $\cdot$ Inverse Filtering $\cdot$ The Inverse of the Source Wavelet $\bullet$ Least-Squares Inverse Filtering $\cdot$ Minimum Phase $\bullet$ Optimum Wiener Filters $\cdot$ Spiking Deconvolution $\bullet$ Prewhitening $\bullet$ Wavelet

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0178.jpg?height=22&width=880&top_left_y=411&top_left_x=81)
Length - Prediction Lag $\cdot$ Percent Prewhitening - Effect of Random Noise on Deconvolution $\cdot$ Multiple Attenuation $\cdot$ Field Data Examples - Prestack Deconvolution $\bullet$ Signature Deconvolution $\bullet$ Vibroseis Deconvolution - Poststack Deconvolution - The Problem of Nonstationarity - Time-Variant Deconvolution - Time-Variant Spectral Whitening $\cdot$ Frequency-Domain Deconvolution - Inverse $Q$ Filtering - Deconvolution Strategies $\cdot$ Exercises $\cdot$ Appendix B: Mathematical Foundation of Deconvolution $\cdot$ Synthetic Seismogram $\cdot$ The Inverse of the Source Wavelet $\cdot$ The Inverse Filter $\cdot$ Frequency-Domain Deconvolution $\cdot$ Optimum Wiener Filters $\bullet$ Spiking Deconvolution $\bullet$ Predictive Deconvolution $\bullet$ Surface-Consistent Deconvolution $\bullet$ Inverse $Q$ Filtering $\bullet$ References

### 2.0 INTRODUCTION

Deconvolution compresses the basic wavelet in the recorded seismogram, attenuates reverberations and short-period multiples, thus increases temporal resolution and yields a representation of subsurface reflectivity. The process normally is applied before stack; however, it also is common to apply deconvolution to stacked data. Figure 2.0-1 shows a stacked section with and without deconvolution. Deconvolution has protuced a section with a much higher temporal resolution. The ringy character of the stack without deconvolution limits resolution, considerably.

Figure 2.0-2 shows selected common-midpoint (CMP) gathers from a marine line before and after deconvolution. Note that the prominent reflections stand out more distinctly on the deconvolved gathers. Deconvolution has removed a considerable amount of ringy- ness, while it has compressed the waveform at each of the prominent reflections. The stacked sections associated with these CMP gathers are shown in Figure 2.03. The improvement observed on the deconvolved CMP gathers also are noted on the corresponding stacked section.

Figure 2.0-4 shows some NMO-corrected CMP gathers from a land line with and without deconvolution. Corresponding stacked sections are shown in Figure 2.0-5. Again, note that deconvolution has compressed the wavelet and removed much of the reverberating energy.

Deconvolution sometimes does more than just wavelet compression; it can remove a significant part of the multiple energy from the section. Note that the stacked section in Figure 2.0-6 shows a marked improve-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0179.jpg?height=600&width=880&top_left_y=140&top_left_x=82)

FIG. 2.0-1. Interpreters prefer the crisp, finely detailed appearance of the deconvolved section (right) as opposed to the blurred, ringy appearance of the section without deconvolution (left). (Data courtesy Enterprise Oil.)

ment between 2 and $4 \mathrm{~s}$ after deconvolution.

To understand deconvolution, first we need to examine the constituent elements of a recorded seismic trace (Section 2.1). The earth is composed of layers of rocks with different lithology and physical properties. Seismically, rock layers are defined by the densities and velocities with which seismic waves propagate through them. The product of density and velocity is called seismuc impedance. The inpedance contrast between adjacent rock layers causes the reflections that are recorded along a surface profile. The recorded seismogram can be modeled as a convolution of the earth's impulse response with the seismic wavelet. This wavelet has many components, including source signature, secording filter, surface reflections, and receiver-array response. The earth's impulse response is what would be recorded if the wavelet were just a spike. The impulse response comprises primary reftections (reflectivity series) and all possible multiples.
Ideally, deconvolution should compress the wavelet components and eliminate multiples, leaving only the earth's reflectivity in the seismic trace. Wavelet compression can be done using an inverse filter as a deconvolution operator. An inverse filter, when convolved with the seismic wavelet, converts it to a spike (Section 2.2). When applied to a seismogram, the inverse filter should yield the earth's impulse response. An accurate inverse filter design is achieved using the least-squares method (Section 2.2).

The fundamental assumption underlying the deconvolution process (with the usual case of unknown source wavelet) is that of minimum phase. This issue is dealt with also in Section 2.2 .

The optimum Wiener filter, which has a wide range of applications, is discussed in Section 2.3. The Wiener filter converts the seismic wavelet into any desired shape. For example, much like the inverse filter, a Wiener filter can be designed to convert the seismic

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0180.jpg?height=510&width=653&top_left_y=118&top_left_x=187)

s

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0180.jpg?height=495&width=658&top_left_y=657&top_left_x=187)

(b)

FIG. 2.0-2. Note the prominent reflections on the deconvolved gathers (b). The reverberations would make it difficult to distinguish prominent reflections on the undeconvolved gathers (a).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0181.jpg?height=464&width=442&top_left_y=125&top_left_x=78)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0181.jpg?height=464&width=438&top_left_y=125&top_left_x=527)

(b)

FIG. 2.0-3. (a) The section obtained from the undeconvolved gathers of Figure 2.0-2a, and (b) the section obtained from the deconvolved gathers of Figure 2.0-2b.

wavelet into a spike. However, the Wiener filter differs from the inverse filter in that it is optimal in the lenstsquares sense. Also, the resolution (spikiness) of the output can be controlled by designing a Wiener predicizon error filter the basis for prediçtive deconvolution (Section 2.3). Converting the seismic wavelet into a spike is like asking for a perfect resolution. In practice, because of noise in the seismogram and assumptions made about the seismic wavelet and the recorded seismogram, spiking deconvolution is not always desirable. Finally, the prediction error filter can be used to remove periodic components multiples, from the seimogram. Practical aspects of predictive deconvolution are presented in Section 2.4, and field data examples are provided in Section 2.5. Finally, time-varying aspects of the source waveform nonstationarity, are discussed in Section 2.6 .

The mathematical treatment of deconvolution is found in Appendix B. However, several numerical examples, which provide the theoretical groundwork from a heuristic viewpoint, are given in the text. Much of the early theoretical work on deconvolution came from the MIT Geophysical Analysis Group, which was formed in the mid-1950s.

### 2.1 THE CONVOLUTIONAL MODEL

A sonic $\log$ segment is shown in Figure 2.1-1a. The sonic $\log$ is a plot of interval velocity as a function of depth based on downhole measurement using logging tools. Here, velocities were measured between the $1000-$ to $5400-\mathrm{ft}$ depth interval at 2 - $\mathrm{ft}$ intervals. The velocity function was extrapolated to the surface by a linear ramp. The sonic log exhibits a strong low-frequency component with a distinct blocky character representing gross velocity variations. Actually, it is this lowfrequency component that normally is estimated by velocity analysis of CMP gathers (Section 3.2).

In many sonic logs, the low-frequency component is an expression of the general increase of velocity with depth due to compaction. In some sonic logs, however, the low-frequency component exhibits a blocky character (Figure 2.1-1a), which is due to large-scale lithologic variations. Based on this blocky character, we may define layers of constant interval velocity (Table 2-1), each of which can be associated with a geologic formation (Table 2-2).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0182.jpg?height=328&width=651&top_left_y=112&top_left_x=197)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0182.jpg?height=327&width=649&top_left_y=465&top_left_x=198)

(b)

FIG. 2.0-4. Sorne NMO-corrected gathers associated with the stacked sections in Figure $20-5$, (a) before, (b) after deconvolution. Deconvolution has removed the ringy character from the data.

Table 2-1. The interval velocity trend obtained from the sonic log in Figure 2.1-1a.

| Layer <br> Number | Interval Velocity, ft/s | Depth Range, $\mathrm{ft}$ |
| :---: | :---: | :---: |
| 1 | 21000 | $1000-2000$ |
| 2 | 19000 | $2000-2250$ |
| 3 | 18750 | $2250-2500$ |
| 4 | 12650 | $2500-3775$ |
| 5 | 19650 | $3775-5400$ |

*The velocity in Layer 2 gradually decreases from the top of the layer to the bottom.
Table 2-2. Stratigraphic identification associated with layering described in Table 2-1.

Layer Number Lithologic Unit

Limestone

Shaly limestone with gradual increase in shale content Shaly limestone

Sandstone

Dolomite

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0183.jpg?height=381&width=794&top_left_y=116&top_left_x=127)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0183.jpg?height=373&width=792&top_left_y=537&top_left_x=128)

(b)

FIG. 2.0-5. Deconvolution helps distinguish prominent reflections with ease (b). However, on a section without deconvolution (a), reflections are buried in reverberating energy. Selected CMP gathers for both sections are shown in Figure 2.0-4.

The sonic log also has a high-frequency component superimposed on the low-frequency component. These rapid fluctuations can be attributed to changes in rock properties that are local in nature. For example, the limestone layer can have interbeddings of shale and sand. Porosity changes also can affect interval velocities within a rock layer. Note that well-log measurements have a limited accuracy; therefore, some of the highfrequency variations, particularly those associated with a first arrival that is strong enough to trigger one re- ceiver but not the other in the log tool (cycle skips), are not due to changes in lithology.

Well-log measurements of velocity and density provide a link between seismic data and the geology of the substrata. We now explain the link between $\log$ measurements and the recorded seismic trace provided by seismic impedance the product of density and velocity. The first set of assumptions that is used to build the forward model for the seismic trace follows:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0184.jpg?height=299&width=425&top_left_y=115&top_left_x=84)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0184.jpg?height=304&width=425&top_left_y=450&top_left_x=81)

(b)

FIG. 2,0-6. CMP stacks with (a) no deconvolution before stack, (b) spiking deconvolution before stack. Deconvolution can remove a significant amount of multiple energy from seisrnic data. (Data courtesy Elf Aquitane and partners.)

Assumption 1. The earth is made up of horizontal layers of constant velocity.

Assumption 2. The source generates a compressional plane wave that impinges on layer boundaries at normal incidence. Under such circumstances, no shear waves are generated.

Assumption 1 is violated in both structurally complex areas and in areas with gross lateral facies changes. Assumption 2 implies that our forward model for the seismic trace is based on zero-offset recording an unrealizable experiment. Nevertheless, if the layer boundaries were deep in relation to cable length, we assume that the angle of incidence at a given boundary is small and ignore the angle dependence of reflection coeffi- cients. Combination of the two assumptions thus imply a normal-incidence one-dimensional (1-D) seismogram.

Based on assumptions 1 and 2 , the reflection coeffcjent $c$ (for pressure or stress), which is associated with the boundary between, say, layers 1 and 2, is defined as

$$
c=\frac{I_{2}-I_{1}}{I_{2}+I_{1}}
$$

where $I$ is the seismic impedance associated with each layer given by the product of density $\rho$ and compressional velocity $v$.

From well-log measurements, we find that the vertical density gradient often is much smaller than the vertical velocity gradient. Therefore, we often assume that the impedance contrast between rock layers is essentially due to the velocity contrast, only. Equation (2-1a) then takes the form:

$$
\mathrm{c}=\frac{v_{2}-v_{1}}{v_{2}+v_{1}}
$$

If $v_{2}$ is greater than $v_{1}$, the reflection coefficient would be pasitive. If $v_{2}$ is less than $v_{1}$, then the reflection coefficient would be negative.

The assumption that density is invariant with depth or that it does not vary as much as velocity is not always valid. The reason we can get away with it is that the density gradient usually has the same sign as the velocity gradient. Hence, the impedance function derived from the velocity function only should be correct within a scale factor.

For vertical incidence, the reflection coefficient is the ratio of the reflected wave amplitude to the incident wave amplitude. Moreover, from its definition (equation $2-1, a)$, the reflection coefficient is seen as the ratio of the change in acoustic impedance to twice the average acoustic impedance. Therefore, seismic amplitudes associated with earth models with horizontal layers and vertical incidence (assumptions 1 and 2) are related to acoustic impedance variations.

The reflection coefficient series $c(z)$, where $z$ is the depth variable, is derived from sonic $\log v(z)$ and is shown in Figure 2.1-1b. We note the following:

(a) The position of each spike gives the depth of the layer boundary, and

(b) the magnitude of each spike corresponds to the fraction of a unit-amplitude downward-traveling incident plane wave that would be reflected from the layer boundary.

To convert the reflection coefficient series $c(z)$ (Figure 2.1-1b) derived from the sonic $\log$ into a time series $c(t)$, select a sampling interval, say $2 \mathrm{~ms}$. Then use the velocity information in the log (Figure 2.1-1a) to convert the depth axis to a two-way vertical time axis. The
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0185.jpg?height=988&width=666&top_left_y=192&top_left_x=232)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0186.jpg?height=283&width=384&top_left_y=116&top_left_x=83)

FIG. 2.1-2. A seismic source wavelet after onset takes the form shown at top left. As the wavelet travels into the earth, the amplitude level drops (geometric spreading) and a loss of high frequencies occurs (frequency absorption).

result of this conversion is shown in Figure $2.1-1 \mathrm{c}$, both as a conventional wiggle trace and as a variable area and wiggle trace (the same trace repeated six times to highlight strong refections). The reflection coefficient series $c(t)$ (Figure 2.1-1c) represents the reflectivity of a series of fictitious layer boundaries that are separated by an equal time interval the sampling rate (Goupillaud, 1961). The major events in this reflectivity series are from the boundary between layers 2 and 3 located at about $0.3 \mathrm{~s}$, and the boundary between layers 4 and 5 located at about $0.5 \mathrm{~s}$.

The reflection coefficient series (Figure 2.1-1c) that was constructed is composed only of primary reflections (energy that was reflected only once). To get a complete 1-D response of the horizontally-layered earth model (assumption 1), multiple reflections of all types (surface, intrabed and interbed multiples) must be included. If the source were unit-amplitude spike, then the recorded zero-offset seismogram would be the impulse response of the earth, which includes primary and multiple reflections. Here, the Kunetz method (Claerbout, 1976) is used to obtain such an impulse response. The impulse response derived from the reflection coefficient series in Figure 2.1-1c is shown in Figure 2.1-1d with the variable area and wiggle display.

The characteristic pressure wave created by an impuisive source, such as dynamite or air gun, is called the signature of the source. All signatures can be described as band-limited wavelets of finite duration for example, the measured signature of an Aquapulse source in Figure 2.1-2. As this waveform travels into the earth, its overall amplitude decays because of wavefront divergence. Additionally, frequencies are attenuated because of the absorption effects of rocks (see Section 1.4). The progressive change of the source wavelet in time and depth also is shown in Figure 2.1-2. At any given time, the wavelet is not the same as it was at the onset of source excitation. This time-dependent change in waveform is called nonstatzonarty.

Wavefront divergence is removed by applying a spherical spreading function (Section 1.2). Frequency attenuation is compensated for by the processing techniques discussed in Section 2.6. Nevertheless, the simple convolutional model discussed here does not incorporate nonstationarity. This leads to the following assumption:

Assumption 3. The source waveform does not change as it travels in the subsurface it is stationary.

## The Convolutional Model in the Time Domain

A convolutional model for the recorded seismogram now can be proposed. Suppose a vertically propagating downgoing plane wave with source signature (Figure 2.1-3a) travels in depth and encounters a layer boundary at 0.2 -s two-way time. The refection coefficient associated with the boundary is represented by the spike in Figure 2.1-3b. As a result of reflection, the source wavelet replicates itself such that is is scaled by the reflection coefficient. If we have a number of layer boundaries represented by the individual spikes in Figures 2.1$3 b$ through 2.1-3f, then the wavelet replicates itself at those boundaries in the same manner. If the reflection coefficient is negative, then the wavelet replicates itself with its polarity reversed, as in Figure 2.1-3c.

Now consider the ensemble of the reflection coefficients in Figure 2.1-3g. The response of this sparse spike series to the basic wavelet is a superposition of the individual impulse responses. This linear process is called the principle of superpostion. It is achieved computationally by convolving the basic wavelet with the reflectivity series (Figure $2.1-3 \mathrm{~g}$ ). The convolutional process already was demonstrated by the numerical example in Section 1.1.

The response of the sparse spike series to the basic wavelet in Figure 2.1-3g has some important characteristics. Note that for events at 0.2 and $0.35 \mathrm{~s}$, we identify two layer boundaries. However, to identify the three closely spaced reflecting boundaries from the composite response (at around $0.6 \mathrm{~s}$ ), the source waveform must be removed to obtain the sparse spike series. This removal process is just the opposite of the convolutional process used to obtain the response of the reflectivity series to the basic wavelet. The reverse process appropriately is called deconvolution.

Principle of Superposition

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0187.jpg?height=827&width=775&top_left_y=134&top_left_x=136)

FIG. 2.1-3. A wavelet (a) traveling in the earth repeats itself when it encounters a reflector along its path ( $b, c, d, e, f)$. The left column represents the reflection coefficients, while the right column represents the response to the wavelet. Amplitudes of the response are scaled by the reflection coefficient. The resulting seismogram (bottom right) represents the composite response of the earth's reflectivity (bottom left) to the wavelet (top right).

The principle of superposition now is applied to the impulse response derived from the sonic $\log$ in Figure 2.1-1d. Convolution of a source signature with the impulse response yields the synthetic seismogram shown in Figure 2.1-4. The synthetic seismogram also is shown in Figure 2.1-1e. This 1-D zero-offset seismogram is free of random ambient noise. For a more realistic represen- tation of a recorded seismogram, noise is added (Figure 2.1-4).

The convolutional model of the recorded seismogram now is complete. Mathematically, the convolutional model illustrated in Figure 2.1-4 is given by

$$
x(t)=w(t) * e(t)+n(t)
$$

$(2-2 a)$

Convolutional Model
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0188.jpg?height=614&width=406&top_left_y=135&top_left_x=84)

FIG. 2.1-4. The top frame is the same as in Figure 2.1-1d. The asterisk denotes convolution. The recorded seismogram (bottom frame) is the sum of the noise-free seismogram and the noise trace. This figure is equivalent to equation (2-2a).

where $x(t)$ is the recorded seismogram, $w(t)$ is the besic seismic wavelet, $e(t)$ is the earth's impulse response, $n(t)$ is the random ambient noise, and $*$ denotes convolution. Deconvolution tries to recover the reflectivity series (strictly speaking, the impulse response) from the recorded seismogram.

An alternative to the convolutional model given by equation (2-2a) is based on a surface-consistent spectral decomposition (Taner and Coburn, 1981), In such a formulation, the seismic trace is decomposed into the convolutional effects of source, receiver, offset, and the earth's impulse response, thus explicitly accounting for variations in wavelet shape caused by near-source and near-receiver conditions and source-receiver separation. The following equation describes the surface-consistent convolutional model (Section B.8):

$$
x_{v}^{\prime}(t)=s_{3}(t) * h_{l}(t) * e_{k}(t) * g_{k}(t)+n(t), \quad(2-2 b)
$$

where $x_{1\}}^{\prime}(t)$ is a model of the recorded seismogram, $s_{j}(t)$ is the waveform component associated with source location $j, g_{2}(t)$ is the component associated with receiver location $i$, and $h_{l}(t)$ is the component associated with offset dependency of the waveform defined for each offset index $l=|i-j|$. As in equation (2-2a), $e_{k}(t)$ represents the earth's impulse response at the source-receiver midpoint location, $k=(i+j) / 2$. By comparing equations (2-2a) and (2-2b), we infer that $w(t)$ represents the combined effects of $s(t), h(t)$, and $g(t)$.

The assumption of surface-consistency implies that the basic wavelet shape depends only on the source and receiver locations, not on the details of the raypath from source to reflector to receiver. In a transition zone, surface conditions at the source and receiver locations may vary significantly from dry to wet surface conditions. Hence, the most likely situation where the surface-consistent convolutional model may be applicable is with transition-zone data. Nevertheless, the formulation described in this section is the most accepted model for the 1-D seismogram.

The random noise present in the recorded seismogram has several sources. External sources are wind motion, environmental noise, or a geophone loosely coupled to the ground. Internal noise can arise from the recording instruments. A pure-noise seismogram and its characteristics are shown in Figure 2.1-5. A pure randomnoise series has a white spectrum - it contains all the frequencies. This means that the autocorrelation function is a spike at zero lag and zero at all other lags. From Figure 2.1-5, note that these characteristic requirements are reasonably satisfied.

Now exarnine the equation for the convolutional model. All that normally is known in equation (2-2a) is $x(t)$ - the recorded seismogran. The earth's impulse response $e(t)$ must be estimated everywhere except at the location of wells with good sonic logs. Also, the source waveform $w(t)$ normally is unknown. In certain cases, however, the source waveform is partly known; for example, the signature of an air-gun array can be measured. However, what is measured is only the waveform at the very onset of excitation of the source array, and not the wavelet that is recorded at the receiver. Finally, there is no a priori knowledge of the ambient noise $n(t)$.

We now have three unknowns $-w(t), e(t)$, and $n(t)$, one known $-x(t)$, and one single equation (2-2a). Can this problem be solved? Pessimists would say no. However, in practice, deconvolution is applied to seismic data as an integral part of conventional processing and is an effective method to increase temporal resolution.

To solve for the unknown $e(t)$ in equation (2-2a), further assumptions must be made.

Assumption 4. The noise component $n(t)$ is zero.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0189.jpg?height=444&width=374&top_left_y=116&top_left_x=105)

FIG. 2.1-5. A random signal with infinite length has a flat amplitude spectrum and an autocorrelogran that is zero at all lags except the zero lag. The discrete random series with finite length shown here seems to satisfy these requirements. What distinguishes a random signal from a spike $(1,0,0, \ldots)$ ?

Assumption 5. The source waveform is known.

Under these assumptions, we have one equation,

$$
x(t)=w(t) * e(t) .
$$

and one unknown, the reflectivity series $c(t)$. In reality, however, neither of the above two assumptions normally is valid. Therefore, the convolutional model is examined further in the next section, this time in the frequency domain, to relax assumption 5 .

If the source waveform were known (such as the recorded source signature), then the solution to the deconvolution problem is deterministic. In Section 2.2, one such method of solving for $e(t)$ is considered. If the source waveform were unknown (the usual case), then the solution to the deconvolution problem is statistical. The Wiener prediction theory (Section 2.3) provides one method of statistical deconvolution.

## The Convolutional Model in the Frequency Domain

The convolutional model for the noise-free seismogram (assumption 4) is represented by equation (2-3a). Con- volution in the time domain is equivalent to multiplication in the frequency domain (Section A.1). This means that the the amplitude spectrum of the seismogram equals the product of the amplitude spectra of the seismic wavelet and the earth's impulse response (Section B.1):

$$
A_{x}(\omega)=A_{w}(\omega) A_{e}(\omega)
$$

where $A_{I}(\omega), A_{w}(\omega)$, and $A_{\mathrm{e}}(\omega)$ are the amplitude spectra of $x(t), w(t)$, and $e(t)$, respectively.

Figure 2.1-6 shows the amplitude spectra (top row) of the impulse response $e(t)$, the seismic wavelet $w(t)$, and the seismogram $x(t)$. The impulse response is the same as that shown in Figure 2.1-1d. The similarity in the overall shape between the amplitude spectrum of the wavelet and that of the seismogram is apparent. In fact, a smoothed version of the amplitude spectrum of the seismogram is nearly indistinguishable from the amplitude spectrum of the wavelet. It generally is thought that the rapid fluctuations observed in the amplitude spectrum of a seismogram are a manifestation of the earth's impulse response, while the basic shape is associated primarily with the source wavelet.

Mathematically, the similarity between the amplitude spectra of the seismogram and the wavelet suggests that the amplitude spectrum of the earth's impulse response must be nearly flat (Section B.1). By examining the amplitude spectrum of the impulse response in Figure 2.1-6, we see that it spans virtually the entire spectral bandwidth. As seen in Figure 2.1-5, a time series that represents a random process has a flat (white) spectrum over the entire spectral bandwidth. From close examination of the amplitude spectrum of the impulse response in Figure 2.1-6, we see that it is not entirely flat - the high-frequency components have a tendency to strengthen gradually. Thus, reflectivity is not entirely a random process. In fact, this has been observed in the spectral properties of reflectivity functions derived from a worldwide selection of sonic logs (Walden and Hosken, 1984).

We now study the autocorrelation functions (middle row, Figure 2.16) of the impulse response, seismic wavelet, and synthetic seismogram. Note that the autocorrelation functions of the basic wavelet and seismogram also are similar. This similarity is confined to lags for which the autocorrelation of the wavelet is nonzero. Mathematically, the similarity between the autocorrelogram of the wavelet and that of the seismogram suggests that the impulse response has an autocorrelation function that is small at all lags except the zero lag (Section B.1). The autocorrelation function of the random series in Figure 2.1-5 also has similar characteristics. However, there is one subtle difference. When compared, Figures 2.1-5 and 2.1-6 show that autocorrelation of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0190.jpg?height=228&width=467&top_left_y=116&top_left_x=282)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0190.jpg?height=116&width=289&top_left_y=339&top_left_x=177)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0190.jpg?height=115&width=386&top_left_y=339&top_left_x=462)

(b) (c)

FIG. 2.1-6. Convolution of the earth's impulse response (a) with the wavelet (b) (equation 2-2a) yields the seismogram (c) (bottom row). This process also is convolutional in terms of their autocorrelograms (middie row) and multiplicative in terms of their amplitude spectra (top row). Assumption 6 (white refectivity) is based on the similarity between autocorrelograms and amplitude spectra of the impulse response and wavelet.

the impulse response has a significantly large negative lag value following the zero lag. This is not the case for the autocorrelation of random noise. The positive peak (zero lag) followed by the smaller negative peak in the autocorrelogram of the impulse response arises from the spectral behavior discussed above. In particular, the positive peak and the adjacent, smaller negative peak of the autocorrelogram together nearly act as a fractional derivative operator (Section A.1), which has a ramp effect on the amplitude spectrum of the impulse response as seen in Figure 2.1-6.

The above observations made on the amplitude spectra and autocorrelation functions (Figure 2.1-6) imply that reflectivity is not entirely a random process. Nonetheless, the following assumption aimost always is made about reflectivity to replace the statement made in assumption 5.

Assumption 6. Reflectivity is a random process. This implies that the geismogram has the characteristics of the seismic wavelet in that their antocorrelations and amplitude spectra are similar.

This assumption is the key to implementing the predictive deconvolution. It allows the autocorrelation of the seismogram, which is known, to be substatuted for the autocorrelation of the sersmic wavelet, whach is unknown. In Section 2.3, we shall see that as a result of assumption 6 , an inverse filter can be estimated directly from the autocorrelation of the seismogram. For this type of deconvolution, Assumption 5, which is almost never met in reality, is not required. But first, we need to review the fundamentals of inverse filtering.

### 2.2 INVERSE FILTERING

If a filter operator $f(t)$ were defined such that convolution of $f(t)$ with the known seismogram $x(t)$ yields an estimate of the earth's insulse response $e(t)$, then

$$
e(t)=f(t) * x(t)
$$

By substituting equation (2-4) into equation (2-3a), we get

$$
x(t)=w(t) * f(t) * \mathscr{L}(t)
$$

When $x(t)$ is eliminated from both sides of the equation, the foliowing expression resuits:

$$
\delta(t)=w(t) * f(t)
$$

where $\delta(t)$ represents the Kronecker delta function:

$$
\delta(t)= \begin{cases}1, & t=0 \\ 0, & \text { otherwise. }\end{cases}
$$

By solving equation (2-6) for the filter operator $f(t)$, we obtain

$$
f(t)=\delta(t) * \frac{1}{w(t)}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0191.jpg?height=228&width=290&top_left_y=119&top_left_x=134)

FIG. 2.2-1. A flowchart for inverse filtering.

Therefore, the filtex operator $f(t)$ needed to compute the earth's impulse response from the recorded seismogram turns out to be the mathematical inverse of the seismic wavelet $w(t)$. Equation (2-8) implies that the inverse filter converts the basic wavelet to a spike at $t=0$. Likewise, the iuverse filter converts the seismogran to a series of spikes that defines the earth's impulse response. Therefore, inverse filtering is a method of deconvolution, provided the source waveform is known (determnnstic deconvolution). The procedure for inverse filtering is described in Figure 2.2-1.

## The Inverse of the Source Wavelet

Computation of the inverse of the source wavelet is accomplished mathematically by using the $z$-transform (Section A.2). For example, let the basic wavelet be a two-point time series given by $w(t):\left(1,-\frac{1}{2}\right)$. The $z$-transform of this wavelet is defined by the following polynomial:

$$
W(z)=1-\frac{1}{2} z
$$

The power of variable $z$ is the number of unit time delays associated with each sample in the series. The first term has zero delay, so $z$ is raised to zero power. The second term has unit delay, so $z$ is raised to first power. Hence, the $z$-transform of a time series is a polynomial in $z$, whose coefficients are the values of the time samples.

A relationship exists between the $z$-transform and the Fourier transform (Section A.2). The $z$-variable is defined as

$$
z=\exp (-i \omega \Delta t)
$$

whete $\omega$ is angular frequency and $\Delta t$ is sarmpling interval.

The convolutional relation in the time domain given by equation (2-8) means that the $z$-transform of the inverse filter, $F(x)$, is obtanned by polynomial division of the $z$-transform of the input wavelet, $W^{\prime}(z)$, given by equation (2-9) (Section A.2):

$$
F(z)=\frac{1}{1-\frac{1}{2} z}=1+\frac{1}{2} z+\frac{1}{4} z^{2}+\cdots
$$

The coefficients of $F(z):\left(1, \frac{1}{2}, \frac{1}{4}, \ldots\right)$ represent the time series associated with the filter operator $f(t)$. Note that the series has an infinite number of coefficients, although they decay rapidly. As in any filtering process, in practice the operator is truncated.

First consider the first two terms in equation (211) which yield a two point filter operator $\left(1, \frac{1}{2}\right)$. The design and application of this operator is summarized in Table 2-3. The actual output is $\left(1,0,-\frac{1}{4}\right)$, whereas the ideal result is a zero-delay spike $(1,0,0)$. Although not ideal, the actual result is spikier than the input wavelet, $\left(1,-\frac{1}{2}\right)$.

Can the result be improved by including one more coefficient in the inverse filter? As shown in Table 2-4, the actual output from the three-point filter is $\left(1,0,0,-\frac{1}{8}\right)$. This is a more accurate representation of the desired output $(1,0,0,0)$ than that achieved with the output from the two-point filter (Table 2-3). Note that there is less energy leaking into the nonzero lags of the output from the three-point filter. Therefore, it is spikier. As more terms are included in the inverse filter: the output is closer to being a spike at zero lag. Since the number of points allowed in the operator length is limited, in practice the result never is a perfect spike.

Table 2-3. Design and application of the truncated inverse filter $\left(1, \frac{1}{2}\right)$ with the input wavelet $\left(1,-\frac{1}{2}\right)$.

Filter Design

Input Wavelet

The $z$-Transform

The Inverse

$$
\begin{aligned}
w(t) & :\left(1,-\frac{1}{2}\right) \\
W(z) & =1-\frac{1}{2} z \\
F(z) & =1+\frac{1}{2} z+\frac{1}{4} z^{2}+\cdots \\
f(t) & :\left(1, \frac{1}{2}, \frac{1}{4}, \cdots\right)
\end{aligned}
$$

Filter Apphcation

Truncated Inverse Filter

$$
\begin{aligned}
& \left(1, \frac{1}{2}\right) \\
& \left(1,-\frac{1}{2}\right) \\
& \left(1,0,-\frac{1}{4}\right) \\
& (1,0,0)
\end{aligned}
$$

Input Wavelet

Actual Output

Desired Output

Convolution Table:

$$
1-\frac{1}{2}
$$

Output

$\frac{1}{2}$

| 1 |  |  | 1 |
| ---: | ---: | ---: | ---: |
| $\frac{1}{2}$ | 1 |  | 0 |
|  | $\frac{1}{2}$ | 1 | $=-\frac{4}{4}$ |

Table 2-4. Design and application of the truncated inverse filter $\left(1, \frac{1}{2}, \frac{1}{4}\right)$ with the input wavelet $\left(1,-\frac{1}{2}\right)$.

## Ftiter Deswgn

Input Wavelet

The $z$-Transform

The Inverse

The Inverse Filter

$$
\begin{aligned}
w(t) & :\left(1,-\frac{1}{2}\right) \\
W(z) & =1-\frac{1}{2} z \\
F(z) & =1+\frac{1}{2} z+\frac{1}{4} z^{2}+\cdots \\
f(t) & :\left(1, \frac{1}{2}, \frac{1}{4}, \cdots\right)
\end{aligned}
$$

Filter Application

Truncated Inverse Filter

Input Wavelet

Actual Output

Desired Output

Convolution Table:

$$
\begin{array}{rrrrrr} 
& & 1 & -\frac{1}{2} & \text { Output } \\
\frac{1}{4} & \frac{1}{2} & 1 & & & 1 \\
& \frac{1}{4} & \frac{1}{2} & 1 & & 0 \\
& \frac{1}{4} & \frac{1}{2} & 1 & 0 \\
& & \frac{1}{4} & \frac{1}{2} & 1 & -\frac{1}{8}
\end{array}
$$

$$
\begin{aligned}
& \left(1, \frac{1}{2}, \frac{1}{4}\right) \\
& \left(1,-\frac{1}{2}\right) \\
& \left(1,0,0,-\frac{1}{8}\right) \\
& (1,0,0,0)
\end{aligned}
$$

The inverse of the input wavelet $w(t):\left(1,-\frac{1}{2}\right)$ has coefficients that rapidly decay to zero (equation 2-11). What about the inverse of the input wavelet $w(t):\left(-\frac{1}{2}, 1\right)$ ? Again, define the $z$-transform:

$$
W(z)=-\frac{1}{2}+z
$$

The $z$-transform of its inverse is given by the polynomial division:

$$
F(z)=\frac{1}{-\frac{1}{2}+z}=-2-4 z-8 z^{2}-\cdots
$$

As a result, the inverse filter coefficients are given by the divergent series $f(t):(-2,-4,-8, \cdots)$. Truncate this series and convolve the two-point operator with the input wavelet $\left(-\frac{1}{2}, 1\right)$ as shown in Table $2-5$. The actual output is $(1,0,-4)$, while the desired output is $(1,0,0)$. Not only is the result far from the desired output, but also it is less spiky than the input wavelet $\left(-\frac{1}{2}, 1\right)$. The reason for this poor result is that the inverse filter coefficients increase in time rather than decay (equation 2-13). When truncated, the larger coefficients actually are excluded from the computation.

If we kept the third coefficient of the inverse filter in the above example (equation 2-13), then the actual output (Table 2-6) would be $(1,0,0,-8)$, which also is a bad approximation to the desired output $(\mathbf{1}, 0,0,0)$.
Table 2-5. Design and application of the truncated inverse filter $(-2,-4)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$.

Filter Design

Input Wavelet

The $z$-Transform

The Inverse

The Inverse Filter

$$
\begin{aligned}
w(t) & :\left(-\frac{1}{2}, 1\right) \\
W(z) & =-\frac{1}{2}+z \\
F(z) & =-2-4 z-8 z^{2}-\cdots \\
f(t) & :(-2,-4,-8, \cdots)
\end{aligned}
$$

## Filter Application

Truncated Inverse Filter

$$
(-2,-4)
$$

Input Wavelet

Actual Output

Desired Output

Convolution Table:

| $-\frac{1}{2}$ | 1 | Output |
| :--- | :--- | :--- |

$$
\begin{array}{lllllr}
-4 & -2 & & & & 1 \\
& -4 & -2 & & & 0 \\
& & -4 & -2 & & -4
\end{array}
$$

$$
\begin{aligned}
& (1,0,-4) \\
& (1,0,0)
\end{aligned}
$$

Output

Table 2-6. Design and application of the truncated inverse filter $(-2,-4,-8)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$.

Falter Desagn

Input Wavelet

The $z$-Transform

The Inverse

The Inverse Filter

$$
\begin{aligned}
w(t) & :\left(-\frac{1}{2}, 1\right) \\
W(z) & =-\frac{1}{2}+z \\
F(z) & =-2-4 z-8 z^{2}-\cdots \\
f(t) & :(-2,-4,-8, \cdots)
\end{aligned}
$$

Falter Application

Truncated Inverse Filter $\quad(-2,-4,-8)$

Input Wavelet $\quad\left(-\frac{1}{2}, 1\right)$

Actual Output $\quad(1,0,0,-8)$

Desired Output $\quad(1,0,0,0)$

Convolution Table:

$$
\begin{aligned}
& -\frac{1}{2} \quad 1 \quad \text { Output } \\
& \begin{array}{llll}
-8 & -4 & -2 & 1
\end{array} \\
& \begin{array}{llll}
-8 & -4 & -2
\end{array} \\
& \begin{array}{llll}
-8 & -4 & -2 & 0
\end{array} \\
& \begin{array}{llll}
-8 & -4 & -2 & -8
\end{array}
\end{aligned}
$$

## Least-Squares Inverse Filtering

A well-behaved input wavelet, such as $\left(1,-\frac{1}{2}\right)$ as opposed to $\left(-\frac{1}{2}, 1\right)$, has a $z$-transform whose inverse can be represented by a convergent series. Then the inverse filtering described above yields a good approximation to a zero-lag spike output $(1,0,0)$. Can we do even better than that?

Formulate the following problem: Given the input wavelet $\left(1,-\frac{1}{2}\right)$, find a two-term filter $(a, b)$ such that the error between the actual output and the desired output $(1,0,0)$ is minimum in the least-squares sense.

Compute the actual output by convolving the filter $(a, b)$ with the input wavelet $\left(1,-\frac{1}{2}\right)$ (Table 2-7). The cumulative energy of the error $L$ is defined as the sum of the squares of the differences between the coefficients of the actual and desired outputs:

$$
L=(a-1)^{2}+\left(b-\frac{a}{2}\right)^{2}+\left(-\frac{b}{2}\right)^{2} .
$$

The task is to find coefficients $(a, b)$ so that $L$ takes its minimum value. This requires variation of $L$ with respect to the coefficients $(a, b)$ to vanish (Section B.5). By simplifying equation (2-14), taking the partial derivatives of quantity $L$ with respect to $a$ and $b$, and setting the results to zero, we get

$$
\frac{5}{2} a-b=2
$$

and

$$
-a+\frac{5}{2} b=0
$$

We have two equations and two unknowns; namely, the filter coefficients $(a, b)$. The so-called normal set of equations (2-15a) and (2-15b) can be put into the following convenient matrix form

$$
\left(\begin{array}{cc}
5 / 2 & -1 \\
-1 & 5 / 2
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{l}
2 \\
0
\end{array}\right)
$$

By solving for the filter coefficients, we obtain $(a, b)$ : $(0.95,0.38)$. Design and application of this least-squares inverse filter are summarized in Table 2-7.

To quantify the spikiness of this result and compare it with the result from the inverse filter in Table 2-3, compute the energy of the errors made in both (Table 2-8). Note that the least-squares filter yjelds less error when trying to convert the input wavelet $\left(1,-\frac{1}{2}\right)$ to a spike at zero lag $(1,0,0)$.

We now examine the performance of the leastsquares filter with the input wavelet $\left(-\frac{\mathbf{I}}{2}, 1\right)$. Note that the inverse filter produced unstable results for this wavelet (Table 2-5). We want to find a two-term filter $(a, b)$ that when convolved with the input wavelet $\left(-\frac{1}{2}, 1\right)$, yields an estimate of the desired spike output $(1,0,0)$ (Table 2-9). As before, the least-squares error between the actual output and the desired output should be minimal.

The cumulative energy of the error is given by

$$
L=\left(-\frac{a}{2}-1\right)^{2}+\left(-\frac{b}{2}+a\right)^{2}+b^{2} .
$$

Table 2-7. Design and application of a two-term least-

| 1 | $-\frac{1}{2}$ | Actual Output | Desired Output |
| :---: | :---: | :---: | :---: |
| $b \quad a$ |  | $a$ | 1 |
| $b$ | $a$ | $b-a / 2$ | 0 |
|  |  | $-b / 2$ | 0 |

squares inverse filter $(a, b)$.

Filter Design

Convolution of the filter $(a, b)$ with input wavelet $\left(1,-\frac{1}{2}\right)$ :

Falter Applacation

Least-Squares Filter $(0.95,0.38)$

Input Wavelet $(1,-0.5)$

Actual Output $\quad(0.95,-0.09,-0.19)$

Desired Output $\quad(1,0,0)$

Table 2-8. Frror in two-term inverse and least-squares filtering.

Input: $\left(1,-\frac{1}{2}\right)$

Desired Output: $(1,0,0)$

Actual Output Error

Energy

Inverse Filter $\quad(1,0,-0.25)$

0.063

Least-Squares Filter $\quad(0.95,-0.09,-0.19) \quad 0.048$

Table 2-9. Design and application of a two-term leastsquares inverse filter $(a, b)$.

Fulter Design

Convolution of filter $(a, b)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$ :

| $-\frac{1}{2} \quad 1$ | Actual Output | Desired |
| :--- | :--- | :--- | :--- |
| Output |  |  |


| $b$ | $a$ |  |  | $-a / 2$ | 1 |
| ---: | ---: | ---: | ---: | ---: | ---: |
|  | $b$ | $a$ |  | $-b / 2+a$ | 0 |
|  | $b$ | $a$ | $b$ | 0 |  |

Filter Application

Least-Squares Filter $(-0.95,-0.19)$

Input Wavelet $(-0.5,1)$

Actual Output $\quad(0.24,-0.38,-0.19)$

Desired Output $\quad(1,0,0)$

Table 2-10. Error in two-term inverse and leastsquares filtering.

Input: $\left(-\frac{1}{2}, 1\right)$

Desired Output: $(1,0,0)$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0194.jpg?height=48&width=396&top_left_y=230&top_left_x=80)

Inverse Filter $(1,0,-4)$

16

Least-Squares Filter $\quad(\mathbf{0 . 2 4},-0.38,-\mathbf{0 . 1 9}) \quad 0.762$

By simplifying equation (2-17), taking the partial derivatives of quantity $L$ with respect to $a$ and $b$, and setting the results to zero, we obtain

$$
\frac{5}{2} a-b=-1
$$

and

$$
-a+\frac{5}{2} b=0
$$

Combine equations (2-18a,b) into a matrix form

$$
\left(\begin{array}{cc}
5 / 2 & -1 \\
-1 & 5 / 2
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
-1 \\
0
\end{array}\right) . \quad(2-19)
$$

By solving for the filter coefficients, we obtain $(a, b)$; $(-0.95,-0.19)$. The design and application of this filter are summarized in Table 2-9.

Table 2-10 shows the results from the inverse filter and least-squares filter quantified. The error made by the least-squares filter is, again, much less than the error made by the truncated inverse filter. However, both filters yield larger erxors for input wavelet $\left(-\frac{1}{2}, 1\right)$ (Table $2-10)$ as compared to errors for wavelet $\left(1,-\frac{1}{2}\right)$ (Table 2-8). The reason for this is discussed next.

## Minimum Phase

Two input wavelets, wavelet $1:\left(1,-\frac{1}{2}\right)$ and wavelet 2 : $\left(-\frac{1}{2}, 1\right)$, were used for numerical analyses of the inverse filter and least-squares inverse filter in this section. The results indicate that the error in converting wavelet 1 to a zero-lag spike is less than the error in converting wavelet 2 (Tables 2-8 and 2-10).

Is this also true when the desired ouput is a delayed spke $(0,1,0)$ ? The cumulative energy of the error $L$ associated with the application of a two-term leastsquares filter $(a, b)$ (Table 2-11) to convert the input wavelet $\left(1,-\frac{1}{2}\right)$ to a delayed spike $(0,1,0)$ is

$$
L=a^{2}+\left[\left(b-\frac{a}{2}\right)-1\right]^{2}+\left(-\frac{b}{2}\right)^{2}, \quad(2-20)
$$

Table 2-11. Design and application of a two-term leastsquares inverse filter $(a, b)$.

## Filter Design

Convolution of filter $(a, b)$ with input wavelet $\left(1,-\frac{1}{2}\right)$ :

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0194.jpg?height=275&width=416&top_left_y=237&top_left_x=546)

Table 2-12. Error in least-squares filtering.

Input Wavelet: $\left(1,-\frac{1}{2}\right)$

| Desired Output | Actual Output | Error <br> Energy |
| :--- | ---: | :---: |
| $(1,0,0)$ | $(0.95,-0.09,-0.19)$ | 0.048 |
| $(0,1,0)$ | $(-0.09,0.81,-0.38)$ | 0.190 |

By simplifying equation (2-20), taking the partial derivatives of quantity $L$ with respect to $a$ and $b$, and setting the results to zero, we obtain

$$
\frac{5}{2} a-b=-1, \quad(2-21 a)
$$

and

$$
-a+\frac{5}{2} b=2
$$

Combine equations (2-21a,b) into a matrix form

$$
\left(\begin{array}{cc}
5 / 2 & -1 \\
-1 & 5 / 2
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
-1 \\
2
\end{array}\right)
$$

By solving for the filter coefficients, we obtain $(a, b)$ $:(-0.09,0.76)$. The design and application of this filter are summarized in Table 2-11.

Table 2-12 shows the results of the least-sqaures filtering to convert the input wavelet $\left(1,-\frac{1}{2}\right)$ to zerolag (Table 2-7) and delayed spikes (Table 2-11). Note

Table 2-13. Design and application of a two-term leastsquares inverse filter $(a, b)$.

## Filter Design

Convolution of filter $(a, b)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$ :

|  |  |  |
| :--- | :--- | :--- |
|  | 1 | Actual Output |
| Desired |  |  |
| Output |  |  |

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0195.jpg?height=66&width=360&top_left_y=295&top_left_x=94)

Filter Application

Least-Squares Filter $(0.76,-0.09)$

Input Wavelet $(-0.5,1)$

Actual Output $\quad(-0.38,0.81,-0.09)$

Desired Output $(0,1,0)$

that the input wavelet is converted to a zero-lag spike with less error, and the corresponding actual output more closely resembles a zero-lag spike desired output.

We now examine the performance of the leastsquares filter with the input wavelet $\left(-\frac{1}{2}, 1\right)$. The cumulative energy of the error $L$ associated with the application of a two-term least-squares filter $(a, b)$ (Table 2-13) to convert the input wavelet $\left(-\frac{1}{2}, 1\right)$ to a delayed spike $(0,1,0)$ is

$$
L=\left(-\frac{a}{2}\right)^{2}+\left[\left(-\frac{b}{2}+a\right)-1\right]^{2}+b^{2}
$$

By simplifying equation (2-23), taking the partial derivatives of quantity $L$ with respect to $a$ and $b$, and setting the results to zero, we obtain

$$
\frac{5}{2} a-b=2
$$

and

$$
-a+\frac{5}{2} b=-1
$$

Combine equations (2-24a,b) into a matrix form

$$
\left(\begin{array}{cc}
5 / 2 & -1 \\
-1 & 5 / 2
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
2 \\
-1
\end{array}\right)
$$

By solving for the filter coefficients, we obtain $(a, b)$ $:(0.76,-0.09)$. The design and application of this filter are summarized in Table 2-13.

Table 2-14 shows the results of the least-squares filtering to convert the input wavelet $\left(-\frac{1}{2}, 1\right)$ to zerolag (Table 2-9) and delayed spikes (Table 2-13). Note that the input wavelet is converted to a delayed spike with less error, and the corresponding actual output more closely resembles a delayed spike desired output.
Table 2-14. Error in least-squares filtering.

Input Wavelet: $\left(-\frac{1}{2}, 1\right)$

Desired Output Actual Output Error Energy

| $(1,0,0)$ | $(0.24,-0.38,0.19)$ | 0.762 |
| :--- | :--- | :--- |
| $(0,1,0)$ | $(-0.38,0.81,-0.09)$ | 0.190 |

Now, evaluate the results of the least-squares inverse filtering summarized in Tables 2-12 and 2-14. Wavelet $1:\left(1,-\frac{1}{2}\right)$ is closer to being a zero-delay spike $(1,0,0)$ than wavelet $2:\left(-\frac{1}{2}, 1\right)$. On the other hand, wavelet 2 is closer to being a delayed spike $(0,1,0)$ than wavelet 1 . We conclude that the error is reduced if the desired output closely resembles the energy distribution in the input series. Wavelet 1 has more energy at the onset, while wavelet 2 has more energy concentrated at the end.

Figure 2.2-2 shows three wavelets with the same amplitude spectrum, but with different phase-lag spectra. As a result, their shapes differ. (From Section 1.1, we know that the shape of a wavelet can be altered by changing the phase spectrum without modifying the amplitude spectrum.) The wavelet on top has more energy concentrated at the onset, the wavelet in the middle has its energy concentrated at the center, and the wavelet at the bottom has most of its energy concentrated at the end.

We say that a wavelet is mentmum phase if its en* ergy is maximally concentrated at its onset. Similarly, a wavelet is maximum phase if its energy is maximally concentrated at its end. Finally, in all in-between situations, the wavelet is mared phase. Note that a wavelet is defined as a transient waveform with a finite duration it is realaxable. A minimum-phase wavelet is one-sided - it is zero before $t=0$. A wavelet that is zero for $t<0$ is called causal. These definitions are consistent with intuition - physical systems respond to an excitation only after that excitation. Their response also is of finite duration. In summary, a mannmum-phase wavelet is realizable and causal.

These observations are quantified by considering the following four, three-point wavelets (Robinson, 1966):

Wavelet $A:(4,0,-1)$

Wavelet $B:(2,3,-2)$

Wevelet $C:(-2,3,2)$

Wavelet $D:(-1,0,4)$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0196.jpg?height=592&width=330&top_left_y=106&top_left_x=124)

FIG. 2.2-2. A wavelet has a finite duration. If its energy is maximally front-losded, then it is minimum-phase (top). If its energy is concentrated mostly in the middle, then it is mxed-phase (middle). Finally, if its energy is maximally cnd-loaded, then the wavelet is maximum-phase. A quantitative analysis of this phase concept is provided in Figure $22-3$.

Compute the cumulative energy of each wavelet at any one time. Cumulative energy is computed by adding squared amplitudes as shown in Table 2-15. These values are plotted in Figure 2.2-3. Note that all four wavelets have the same amount of total energy 17 units. Howevcr, the rate at which the energy builds

Table 2-15. Cumulative energy of wavelets $A, B, C$, and $D$ at time samples 0,1 and 2 .

| Wavelet | 0 | 1 | 2 |
| :---: | ---: | ---: | ---: |
| $A$ | 16 | 16 | 17 |
| $B$ | 4 | 13 | 17 |
| $C$ | 4 | 13 | 17 |
| $D$ | 1 | 1 | 17 |

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0196.jpg?height=352&width=352&top_left_y=115&top_left_x=570)

FIG. 2,2-3. A quantitative analysis of the minimum- and maximum-phase concept. The fastest rate of energy build$\mathrm{up}$ in time occurs when the wavelet is minimum-phase (A). The slowest rate occurs when the wavelet is maxmum-phase (D).

up is significantly different for each wavelet. For example, with wavelet $A$, the energy builds up rapidly close to its total value at the very first time lag. The energy for wavelets $B$ and $C$ builds up relatively slowly. Finally, the energy accumulates at the slowest rate for wavelet $D$. From Figure 2.2-3, note that the energy curves for wavelets $A$ and $D$ form the upper and lower boundaries. Wavelet $A$ has the least energy deloy, while wavelet $D$ has the largest energy delay.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0196.jpg?height=367&width=387&top_left_y=811&top_left_x=559)

FIG. 2.2-4. All wavelets referred to in Figure 2.2-3 ( $A, B$, $C$, and $D$ ) have the same smplitude spectrum as shown above (Adapted from Robinson, 1966).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0197.jpg?height=358&width=382&top_left_y=125&top_left_x=103)

FIG. 2.2-5. Phase-lag spectra of the wavelets referred to 10 Figure 2.2-3. They have the common ampltude spectrum of Figure 2.2-4 (Adapted from Robinson, 1966).

Given a fixed amplitude spectrum as in Figure 2.24 , the wavelet with the least energy delay is called minımum delay, while the wavelet with the most energy delay is called maximum delay. This is the basis for Robinson's energy delay theorem: $A$ minmum-phase wavelet has the least energy delay.

Time delay is equivalent to a phase-lag. Figure 2.25 shows the phase spectra of the four wavelets. Note that wavelet $A$ has the least phase change across the frequency axis; we say it is minumum phase. Wavelet $D$ has the largest phase change; we say it is maxumum phase. Finally, wavelets $B$ and $C$ have phase changes between the two extremes; hence, they are mised phase.

Since all four wavelets have the same amplitude spectrum (Figure 2.2-4) and the same power spectrum, they should have the same autocorrelation. This is verified as shown in Table 2-16, where only one side of the autocorrelation is tabulated, since a real time series has a symmetric autocorrelation (Section 1.1).

Note that zero lag of the autocorrelation (Table 216) is equal to the total energy (Table 2-15) contained in each wavelet -17 units. This is true for any wavelet. In fact, Parseval's theorem states that the area under the power spectrum is equal to the zero-lag value of the autocorrelation function (Section A.1).

The process by which the seismic wavelet is compressed to a zero-lag spike is called spiking deconvolution. In this section, filters that achieve this goal were studied - the inverse and the least-squares inverse filters. Their performance depends not only on filter length, but also on whether the input wavelet is minimum phase.
Table 2-16. Autocorrelation lags of wavelets $A, B, C$, and $D$.

Wavelet $A$

| 4 | 0 | -1 |  |  | Output |
| ---: | ---: | ---: | ---: | ---: | ---: |
| 4 | 0 | -1 |  |  | 17 |
|  | 4 | 0 | -1 |  | 0 |
|  |  | 4 | 0 | -1 | -4 |

Wavelet $B$

| 2 | 3 | -2 |  |  | Output |
| ---: | ---: | ---: | ---: | ---: | ---: |
| 2 | 3 | -2 |  |  | 17 |
|  | 2 | 3 | -2 |  | 0 |
|  |  | 2 | 3 | -2 | -4 |

Wavelet $C$

| -2 | 3 | 2 |  |  | Output |
| ---: | ---: | ---: | ---: | ---: | ---: |
| -2 | 3 | 2 |  |  | 17 |
|  | -2 | 3 | 2 |  | 0 |
|  |  | -2 | 3 | 2 | -4 |

Wavelet $D$

| -1 | 0 | 4 |  |  | Output |
| ---: | ---: | ---: | ---: | ---: | ---: |
| -1 | 0 | 4 |  |  | 17 |
|  | -1 | 0 | 4 |  | 0 |
|  |  | -1 | 0 | 4 | -4 |

The spiking deconvolution operator is strictly the inverse of the wavelet. If the wavelet were minimum phase, then we would get a stable inverse, which also is minimum phase. The term stable means that the filter coefficients form a convergent series. Specifically, the coefficients decrease in time (and vanish at $t=\infty$ ); therefore, the filter has finite energy. This is the case for the wavelet $\left(1,-\frac{1}{2}\right)$ with an inverse $\left(1, \frac{1}{2}, \frac{1}{4}, \ldots\right)$. The inverse is a stable spiking deconvolution filter. On the other hand, if the wavelet were maximum phase, then it does not have a stable inverse. This is the case for the wavelet $\left(-\frac{1}{2}, 1\right)$, whose inverse is given by the divergent series $(-2,-4,-8, \ldots)$. Finally, a mixed-phase wavelet does not have a stable inverse. This discussion leads us to assumption 7 .

Assumption 7. The seismic wavelet is mininum phase. Therefore, it has a mininurn-phase inverse.

Now, a summary of the implications of the underlying assumptions for deconvolution stated in Sections 2.1 and 2.2 is appropriate.

(a) Assumptions 1, 2, and 3 allow formulating the convolutional model of the 1-D seismogram by equation (2-2).
(b) Assumption 4 eliminates the unknown noise term in equation (2-2a) and reduces it to equation (23a).

(c) Assumption 5 is the basis for deterministic deconvolution - it allows estimation of the earth's reflectivity series directly from the 1-D seismogram described by equation (2-3a).

(d) Assumption 6 is the basis for statistical deconvolution - it allows estimates for the autocorrelogram and amplitude spectrum of the normally unknown wavelet in equation (2-3a) from the known recorded 1 -D seismogram.

(e) Finally, assumption 7 provides a minimum-phase estimate of the phase spectrum of the seismic wavelet from its amplitude spectrum, which is estimated from the recorded seismogram by way of assumption 6 .

Once the amplitude and phase spectra of the seismic wavelet are statistically estimated from the recorded seismogram, its least-squares inverse - spiking deconvolution operator, is computed using optimum Wiener filters (Section 2.3). When applied to the wavelet, the filter converts it to a zero-delay spike. When applied to the seismogram, the filter yields the earth's impulse response (equation 2-4). In Section 2.3, we show that a known wavelet can be converted into a delayed spike even if it is not minimum phase.

### 2.3 OPTIMUM WIENER FILTERS

Return to the desired output - the zero-delay spike $(1,0,0)$, that was considered when studying inverse and least-square filters (Section 2.2). Rewrite equation (216), whtch we solved to obtain the least-squares inverse fiter, as follows:

$$
2\left(\begin{array}{cc}
5 / 4 & -1 / 2 \\
-1 / 2 & 5 / 4
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{l}
2 \\
0
\end{array}\right)
$$

Divide both sides by 2 to obtain

$$
\left(\begin{array}{cc}
5 / 4 & -1 / 2 \\
-1 / 2 & 5 / 4
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{l}
1 \\
0
\end{array}\right) \text {. }
$$

The autocorrelation of the input wavelet $\left(1,-\frac{1}{2}\right)$ is shown in Table 2-17. Note that the autocorrelation lags are the same as the first column of the $2 \times 2$ matrix on the left side of equation (2-27).

Now compute the crosscorrelation of the desired output $(1,0,0)$ with the input wavelet $\left(1,-\frac{1}{2}\right)$ (Table 2-18). The crosscorrelation lags are the same as the column matrix on the right side of equation (2-27).
Table 2-17. Autocorrelation lags of input wavelet $\left(1,-\frac{1}{2}\right)$.

| 1 | $-\frac{1}{2}$ |  | Output |
| ---: | ---: | ---: | ---: |
| 1 | $-\frac{1}{2}$ | $\frac{5}{4}$ |  |
|  | 1 | $-\frac{1}{2}$ | $-\frac{1}{2}$ |

Table 2-18. Crosscorrelation lags of desired output $(1,0,0)$ with input wavelet $\left(1,-\frac{\mathrm{I}}{2}\right)$.

| 1 | 0 | 0 | Output |
| ---: | ---: | ---: | ---: |
| 1 | $-\frac{1}{2}$ |  | 1 |
|  | 1 | $-\frac{1}{2}$ | 0 |

In general, the elements of the matrix on the left side of equation (2-27) are the lags of the autocorrelation of the input wavelet, while the elements of the column matrix on the right side are the lags of the crosscorrelation of the desired output with the input wavelet.

Now perform similar operations for wavelet $\left(-\frac{1}{2}, 1\right)$. By rewriting the matrix equation (2-19), we obtain

$$
2\left(\begin{array}{cc}
5 / 4 & -1 / 2 \\
-1 / 2 & 5 / 4
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
-1 \\
0
\end{array}\right)
$$

Divide both sides by 2 to obtain

$$
\left(\begin{array}{cc}
5 / 4 & -1 / 2 \\
-1 / 2 & 5 / 4
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
-1 / 2 \\
0
\end{array}\right)
$$

The autocorrelation of wavelet $\left(-\frac{1}{2}, 1\right)$ is given in Table 2-19. The elements of the matrix on the left side of equation (2-29) are the autocorrelation lags of the input wavelet. Note that autocorrelation of wavelet $\left(-\frac{1}{2}, 1\right)$ is identical to that of wavelet $\left(1,-\frac{1}{2}\right.$ ) (Table 2-17). As discussed in Section 2.2, an important property of a group of wavelets with the same amplitude spectrum is that they also have the same autocorrelation.

The crosscorrelation of the desired output $(1,0,0)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$ is given in Table $2-20$. Note that the right side of equation (2-29) is the same as the crosscorrelation lags.

Table 2-19. Autocorrelation lags of input wavelet $\left(-\frac{1}{2}, 1\right)$.

| $-\frac{1}{2}$ | 1 |  | Output |
| :---: | :---: | :---: | :---: |
| $-\frac{1}{2}$ | 1 |  | $\frac{5}{4}$ |
|  | $-\frac{1}{2}$ | 1 | $-\frac{1}{2}$ |

Table 2-20. Crosscorrelation lags of desired output $(1,0,0)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$.

| 1 | 0 | 0 | Output |
| ---: | ---: | ---: | ---: |
| $-\frac{1}{2}$ | 1 | $-\frac{1}{2}$ |  |
|  | $-\frac{1}{2}$ | 1 | 0 |

Matrix equations (2-27) and (2-29) were used to derive the least-squares inverse filters (Section 2.2). These filters then were applied to the input wavelets to compress them to zero-lag spike. The matrices on the left in equations (2-27) and (2-29) are made up of the autocorreiation lags of the input wavelets. Additionally, the column matrices on the right are made up of lags of the crosscorrelation of the desired output - a zerolag spike, with the input wavelets. These observations were generalized by Wiener to derive filters that convert the input to any desired output (Robinson and Treitcl, 1980).

The general form of the matrix equation such as equation (2-29) for a filter of length $n$ is (Section B.5):

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
r_{2} & r_{2} & r_{0} & \cdots & r_{n-3} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
a_{0} \\
a_{1} \\
a_{2} \\
\vdots \\
a_{n-1}
\end{array}\right)=\left(\begin{array}{c}
g_{0} \\
g_{1} \\
g_{2} \\
\vdots \\
g_{n-1}
\end{array}\right)
$$

Here $r_{1}, a_{2}$, and $g_{t}, i=0,1,2, \ldots, n-1$ are the autocorrelation lags of the input wavelet, the Wiener filter coefficients, and the crosscorrelation lags of the desired output with the input wavelet, respectively.

The optimum Wiener filter $\left(a_{0}, a_{1}, a_{2}, \ldots, a_{7-1}\right)$ is optimum in that the least-squares error between the actual and desired outputs is minimum. When the desired output is the zero-lag spike $(1,0,0, \ldots, 0)$, then the Wiener filter is identical to the least-squares inverse filter. In other words, the least-squares inverse filter really is a special case of the Wiener filter.
The Wiener filter applies to a large class of problems in which any desired output can be considered, not just the zero-lag spike. Five choices for the desired output are:

Type 1: Zero-lag spike,

Type 2: Spike at arbitrary lag,

Type 3: Time-advanced form of input series,

Type 4: Zero-phase wavelet,

Type 5: Any desired arbitrary shape.

These desired output forms will be discussed in the following sections.

The general form of the normal equations (2-30) was arrived at through numerical exampies for the special case where the desired output was a zero-lag spike. Section B. 5 provides a concise mathematical treatment of the optimum Wiener filters. Figure 2.3-1 outlines the design and application of Wiener filter.

Dotermination of the Wiener filter coefficients requires solution of the so-called normal equations (230). From equation (2-30), note that the autocorrelation matrix is symmetric. This special matrix, called the Toeplitz matrix, can be solved by Levinson recursion, a computationally efficient scheme (Section B.6). To do this, compute a two-point filter, derive from it a three-point filter, and so or, until the n-point filter is derived (Clacrbout, 1976). In practice, filtering algorithms based on the optimum Wiener filtcr theory are known as Wiener-Levinson algorithms.

## Spiking Deconvolution

The process with type 1 desired output (zero-lag spike) is called spiking deconvolution. Crosscorrelation of the desired spike $(1,0,0, \ldots, 0)$ with input wavelet $\left(x_{0}, x_{1}, x_{2}, \ldots, x_{n-1}\right)$ yields the series $\left(x_{0}, 0,0, \ldots, 0\right)$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0199.jpg?height=263&width=334&top_left_y=932&top_left_x=579)

FIG. 2.3-1. A flowchart for Wiener filter design and applcation.

The generalized form of the normal equations (2-30) takes the special form:

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
r_{2} & r_{1} & r_{0} & \cdots & r_{n-3} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
a_{0} \\
a_{1} \\
a_{2} \\
\vdots \\
a_{n-1}
\end{array}\right)=\left(\begin{array}{c}
1 \\
0 \\
0 \\
\vdots \\
0
\end{array}\right)
$$

Equation (2-31) was scaled by ( $\left.1 / x_{0}\right)$. The leastsquares inverse filter, which was discussed in Section 2.2, has the same form as the matrix equation (2-31). Therefore, spiking deconvolution is mathematically identical to least-squares inverse filtering. A distinction, however, is made in practice between the two types of filtering. The autocorrelation matrix on the left side of equation (2-31) is computed from the input seismogram (assumption 6) in the case of spiking deconvolution (statistical deconvolution), wheress it is computed directly from the known source wavelet in the case of least-squares inverse filtering (deterministuc deconvolution).

Figure 2.3-2 is a summary of spiking deconvolution based on the Wiener-Levinson algorithm. Frame (a) is the input mixed-phase wavelet. Its amplitude spectrum shown in frame (b) indicates that the wavelet has most of its energy confined to a $10-$ to $50-\mathrm{Hz}$ range. The autocorrelation function shown in frame (d) is used in equation (2-31) to compute the spiking deconvolution operator shown in frame (e). The amplitude spectrum of the operator shown in frame (f) is approximately the inverse of the amplitude spectrum of the input wavelet shown in frame (b). (The approximation improves as operator length increases.) This should be expected, since the goal of spiking deconvolution is to flatten the output spectrum. Application of this operator to the input wavelet gives the result shown in frame (k).

Ideally, we would like to get a zero-lag spike, as shown in frame (n). What went wrong? Assumption 7 was violated by the mixed-phase input wavelet shown in frame (a). Frane (h) shows the inverse of the deconvolution operator. This is the minimum-phase equivalent of the input mixed-phase wavelet in frame (a). Both wavelets have the same amplitude spectrum shown in frames (b) and (i), but their phase spectra are significantly different as shown in frames (c) and (j). Since spiking deconvolution is equivalent to least-squares inverse filtcring, the minimum-phase equivalent is merely the inverse of the deconvolution operator. Therefore, the amplitude spectrum of the operator is the inverse of the amplitude spectrum of the minimum-phase equivalent as shown in frames (f) and (i), and the phase spectrum of the operator is the negative of the phase spectrum of the minimum-phase wavelet as shown in frames (g) and (j). One way to extract the seismic wavelet, provided it is minimum phase, is to compute the spiking deconvolution operator and find its inverse.

In conclusion, if the input wavelet is not minimum phase, then spiking deconvolution cannot convert it to a perfect zero-lag spike as in frame (k). Although the amplitude spectrun is virtually flat as shown in frame (l), the phase spectrum of the output is not minimum phase as shown in frame (m). Finally, note that the spiking deconvolution operator is the inverse of the minimumphase equivalent of the input wavelet. This wavelet may or may not be minimum phase.

## Prewhitening

From the preceding section, we know that the amplitude spectrum of the spiking deconvolution operator is (approximately) the inverse of the amplitude spectrum of the input wavelet. This is sketched in Figure 2.3-3. What if we had zeroes in the amplitude spectrum of the input wavelet? To study this, apply a minimum-phase band-pass filter (Exercise 2-10) with a wide passband $(3-108 \mathrm{~Hz})$ to the minimum-phase wavelet of Figure 2.3-2, as shown in frame (h). Deconvolution of the filtered wavelet does not produce a perfect spike; instead, a spike accompanied by a high-frequency pre-and postcursor results (Figure 2.3-4). This poor result occurs because the deconvolution operator tries to boost the absent frequencies, as seen from the amplitude spectrum of the output. Can this problem occur in a recorded seismogram? Situations in which the input amplitude spectrum has zeroes rarely occur. There is always noise in the seismogram and it is additive in both the time and frequency domains. Moreover, numerical noise, which also is additive in the frequency domain, is generated during processing. However, to ensure numerical stability, an artificial level of whate nonse is added to the amplitude spectrum of the input seismogram before deconvolution. This is called prewhetenng and is referred to in Figure 2.3-3.

If the percent prewhitening is given by a scalar, $0 \leq$ $\epsilon<1$, then the normal equations (2-31) are modified as follows:

$$
\left(\begin{array}{ccccc}
\beta r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & \beta r_{0} & r_{1} & \cdots & r_{n-2} \\
r_{2} & r_{1} & \beta r_{0} & \cdots & r_{n-3} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & \beta r_{0}
\end{array}\right)\left(\begin{array}{c}
a_{0} \\
a_{1} \\
a_{2} \\
\vdots \\
a_{n-1}
\end{array}\right)=\left(\begin{array}{c}
1 \\
0 \\
0 \\
\vdots \\
0
\end{array}\right),
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0201.jpg?height=992&width=774&top_left_y=192&top_left_x=156)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0202.jpg?height=190&width=789&top_left_y=114&top_left_x=124)

(a)

(b)

(c)

FIG. 2.3-3. Prewhitening amounts to adding a bias to the amplitude spectrum of the seismogram to be deconvolved. This prevents dividing by zero since the amplitude spectrum of the inverse filter (middle) is the inverse of that of the seismogram (left). Convolution of the filter with the seismogram is equivalent to multiplying their respective amplitude spectra - this yields nearly a white spectrum (right).

where $\beta=1+\varepsilon$. Adding a constant $\varepsilon r_{0}$ to the zero lag of the autocorrelation function is the same as adding white noise to the spectrum, with its total energy equal to that constant. The effect of the prewhitening level on performance of deconvolution is discussed in Section 2.4 .

## Wavelet Processing by Shaping Filters

Spiking deconvolution had trouble compressing wavelet $\left(-\frac{1}{2}, 1\right)$ to a zero-lag spike $(1,0,0)$ (Table 2-14). In terms of energy distribution, this input wevelet is more similar to a delayed spike, such as $(0,1,0)$, than it is to a zero-lag spike, $(1,0,0)$. Therefore, is filter that converts wavelet $\left(-\frac{1}{2}, 1\right)$ to a delayed spike would yield less error than the filter that shapes it to a zero-lag spike (Table 2-14).

Recast the filter design and application outlined in Table 2-13 in terms of optimum Wiener filters by following the flowchart in Figure 2.3-1. First, compute the crosscorrelation (Table 2-21). From Table 2-19, we know the autocorrelation of the input wavelet. By substituting the results from Tables 2-19 and 2-21 into the matrix equation (2-30), we get

$$
\left(\begin{array}{cc}
5 / 4 & -1 / 2 \\
-1 / 2 & 5 / 4
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
1 \\
-1 / 2
\end{array}\right)
$$

By solving for the filter coefficients, we obtain $(a, b)$ : $\left(\frac{16}{21},-\frac{2}{21}\right)$. This filter is applied to the input wavelet as shown in Table 2-22. As we would expect, the output is the same as that of the least-squares filter (Table 2-13). Note that, from Table 2-14, the energy of the leastsquares error between the actual and desired outputs was 0.190 and 0.762 for a delayed spike and a zerolag spike desired output, respectively. This shows that there is less error when converting wavelet $\left(-\frac{1}{2}, 1\right)$ to the delayed spike $(0,1,0)$ than to zero-lag spike $(1,0,0)$.

In general, for any given input wavelet, a series of desired outputs can be defined as delayed spikes. The least-squares errors then can be plotted as a function of delay. The delay (lag) that corresponds to the least error is chosen to define the desired delayed spike output. The actual output from the Wiener filter using this optimum delayed spike should be the most compact possible result.

Table 2-21. Crosscorrelation lags of desired output $(0,1,0)$ with input wavelet $\left(-\frac{1}{2}, 1\right)$.

| 0 | 1 | 0 | Output |
| ---: | ---: | ---: | ---: |
| $-\frac{1}{2}$ | 1 | 1 |  |
|  | $-\frac{1}{2}$ | 1 | $-\frac{1}{2}$ |

Table 2-22. Convolution of input wavelet $\left(-\frac{1}{2}, 1\right)$ with filter coefficients $\left(\frac{16}{21},-\frac{2}{21}\right)$.

|  | $-\frac{1}{2}$ | 1 |  | Output |
| :---: | :---: | :---: | :---: | :---: |
| $-\frac{2}{21}$ | $-\frac{16}{21}$ |  |  | -0.38 |
|  | $-\frac{2}{21}$ | $-\frac{16}{21}$ |  | 0.81 |
|  |  | $-\frac{2}{21}$ | $-\frac{16}{21}$ | -0.09 |

## Autocorrelograms

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0203.jpg?height=140&width=584&top_left_y=174&top_left_x=84)

Amplitude Spectra
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0203.jpg?height=534&width=862&top_left_y=147&top_left_x=90)

FIG. 2.3-4. (a) Minimum-phase wavelet, (b) after band-pass filtering, (c) followed by deconvolution. The amplitude spectrum of the band-pass filtered wavelet is zero above $108 \mathrm{~Hz}$ (middle row); therefore, the inverse filter derived from it ylelds unstable results (bottom row). The time delays on the wavelets in the left frames of the middle and bottom rows are for display purposes only.

The process that has a type 5 desired output (any desired arbitrary shape) is called wavelet shaping. The filter that does this is called a Wiener shaping filter. In fact, type 2 (delayed spike) and type 4 (zero-phase wavelet) desired outputs are special cases of the more general wavelet shaping.

Figure 2.3-5 shows a series of wavelet shapings that use delayed spikes as desired outputs. The input is a mixed-phase wavelet. Filter length was held constant in all eight cases. Note that the zero-delay spike case (spiking deconvolution) does not always yield the best result (Figure 2.3-5a). A delay in the neighborhood of 60 ms (Figure 2.3-5e) seems to yield an output that is closest to being a perfect spike. Typically, the process is not very sensitive to the amount of delay once it is close to the optimum delay, If the input wavelet were minimum-phase, then the optimum delay of the desired output spike generally is zero. On the other hand, if the input wavelet were mixed-phase, as illustrated in Figure 2.3-5, then the optimum delay is nonzero. Finally, if the input wavelet were maximum-phase, then the optimum delay is the length of that wavelet (Robinson and Treitel, 1980).

Can we not delay the desired spike output (Figure 2.3-5) and obtain a better result than we obtained from spiking deconvolution? This goal is achieved by applying a constant-time shift ( $60 \mathrm{~ms}$ in Figure 2.3-5) to a delayed spike result. Better yet, the same result can be obtained by shifting the shaping filter operator as much as the delay in the spike and applying it to the input wavelet. Such a filter operator is two-sided (noncausal), since it has coefficients for negative and positive time values. The one-sided filter defined along the positive time axis has an anticzpation component, while the filter defined along the negative time axis has a memory component (Rohinson and Treitel, 1980). The twosided filter has an anticipation component and a memory component. Figure 2.3-6 shows a series of shaping filterings with two-sided Wiener filters for various spike delay values.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0204.jpg?height=467&width=394&top_left_y=114&top_left_x=94)

FIG. 2.3-5. Shaping filterıng. (0) Input wavelet, (1) desired output, (2) shaping filter operator, (3) actual output. Here, the purpose is to convert the mixed-phased wavelet (0) to a series of delayed spikes as shown in (a) through (h) by using a one-sided operator (anticipation component only). The best result is with a $60-\mathrm{ms}$ delay (e).

Figure 2.3-7 shows examples of wavelet shaping. The input wavelet represented by trace (b) is the same mixed-phase wavelet as in Figure 2.3-6 (top left frame). This wavelet is shaped into zero-phese wavelets with three different bandwidths represented by traces (c), (d) and (e). This process commonly is referred to as dephasing. Figure 2.3-7 shows another wavelet shaping in which the input wavelet is converted to its minimumphase equivalent represented by trace (f). This conversion is often applied to recorded air-gun signatures.

Figure 2.3-8 shows examples of a recorded airgun signature that was shaped into its minimum-phase equivalent and into a spike. When the input is the recorded signature, then the wavelet shapings in Figure 2,3-8 are called signature processing.

Wavelet shaping requires knowledge of the input wavelet to compute the crosscorrelation column on the right side of equation (2-30). If it is unknown, which is the case in reality, then the minimum-phase equivalent of the input wavelet can be estimated statistically from the data. This minimurn-phase estimate then is shaped to a zero-phase wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0204.jpg?height=466&width=385&top_left_y=115&top_left_x=559)

FIG. 2.3-6. Shaping filtering. (0) Input wavelet, (1) desired output, (2) sheping filter operator, (3) actual output. Here, the purpose is to convert the mixed-phase wavelet (0) to a series of delayed spikes as shown in (a) through (h) using a two-sided operator (with mernory and anticipation components). The best result is obtained with a zero-delay spike using a two-sided filter (a),

Wavelet processing is a term that is used with flexibility. The most common mearing refers to estimating (somehow) the basic wavelet embedded in the seismogram, designing a shaping filter to convert the estimated wavelet to a desired form, usually a broad-band zeto-phase wavelet (Figure 2.3-8), and finally, applying the shaping filter to the seismogram. Another type of wavelet processing involves wavelet shaping in which the desired output is the zero-phase wavelet with the same amplitude spectrum os that of the input wavelet (Figure 2.3-9). Note that this type of wavelet processing does not try to flatten the spectrum, but only tries to correct for the phase of the input wavelet, which soraetimes is assumed to be minirnum-phase.

## Predictive Deconvolution

The type 3 desired output, a time-advanced form of the input series, suggests a prediction process. Given the input $x(t)$, we want to predict its value at some future time $(t+\alpha)$, where $\alpha$ is prediction lag. Wiener showed

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0205.jpg?height=515&width=845&top_left_y=121&top_left_x=96)

FIG. 2.3-7. Shaping filtering with various desired outputs. (a) Impulse response, (b) input seismogram. Here, (c), (d) and (e) show three possible desired outputs that are band-limited zero-phase wavelets, whlle (f) shows a desired output that is the minimum-phase equivalent of the input wavelet (b). Finally, (g) and (h) are desired outputs that are band-pass filtered versions of ( $\mathrm{f}$ ).

that the filter used to estimate $x(t+\alpha)$ can be computed by using a special form of the matrix equation (2-30) (Robinson and Treitel, 1980). Since the desired output $x(t+\alpha)$ is the time-advanced version of the input $x(t)$, we need to specialize the right side of equation (2-30) for the prediction problem.

Consider a five-point input time series $x(t)$ : $\left(x_{0}, x_{1}, x_{2}, x_{3}, x_{4}\right)$, and set $\alpha=2$. The autocorrelation of the input series is cornputed in Table 2-23, and the crosscorrelation between the desired output $x(t+2)$ and the input $x(t)$ is computed in Table 2-24. Compare the results in Tables 2-23 and 2-24, and note that $g_{i}=r_{i+\alpha}$ for $\alpha=2$ and $i=0,1,2,3,4$.

Equation (2-30), for this special case, is rewritten as follows:

$$
\left(\begin{array}{lllll}
r_{0} & r_{1} & r_{2} & r_{3} & r_{4} \\
r_{1} & r_{0} & r_{1} & r_{2} & r_{3} \\
r_{2} & r_{1} & r_{0} & r_{1} & r_{2} \\
r_{3} & r_{2} & r_{1} & r_{0} & r_{1} \\
r_{4} & r_{3} & r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{l}
a_{0} \\
a_{1} \\
a_{2} \\
a_{3} \\
a_{4}
\end{array}\right)=\left(\begin{array}{l}
r_{2} \\
r_{3} \\
r_{4} \\
r_{5} \\
r_{6}
\end{array}\right) .
$$

The prediction filter coefficients $a(t):\left(a_{0}, a_{1}\right.$, $a_{2}, a_{3}, a_{4}$ ) can be computed from equation (2-34) and applied to the input series $x(t):\left(x_{0}, x_{1}, x_{2}, x_{3}, x_{4}\right)$ to compute the actual output $y(t):\left\{y_{0}, y_{1}, y_{2}, y_{3}, y_{4}\right)$ (Table 2-25). We want to predict the time-advanced form of the input; hence, the actual output is an estimate of the series $x(t+\alpha):\left(x_{2}, x_{3}, x_{4}\right)$, where $\alpha=2$. The prediction error series $e(t)=x(t+\alpha)-y(t):\left\{e_{2}, e_{3}, e_{4}, e_{5}, e_{6}\right)$ is given in Table 2-26.

The results in Table 2-26 suggest that the error series can be obtained more directly by convolving the input series $x(t):\left(x_{0}, x_{1}, x_{2}, x_{3}, x_{4}\right)$ with a filter with coefficients $\left(1,0,-a_{0},-a_{1},-a_{2},-a_{3},-a_{4}\right)$ (Table 2-27). The results for $\left(e_{2}, e_{3}, e_{4}, e_{5}, e_{6}\right)$ are identical (Tables 2-26 and 2-27). Since the series $\left(a_{0}, a_{1}, a_{2}, a_{3}, a_{4}\right)$ is called the prediction filter, it is natural to call the series $\left(1,0,-a_{0},-a_{1},-a_{2},-a_{3},-a_{4}\right)$ the prediction error filter. When applied to the input series, this filter yields the error series in the prediction process (Table 2-27).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0206.jpg?height=530&width=426&top_left_y=113&top_left_x=81)

FIG. 2.3-8. Signature processing: (a) Recorded signature, (b) desired output, (c) shaping operator, (d) shaped signature. The desired output is a zero-delay spike (top) and the minimum-phase equivalent of the recorded signature (bottom).

Table 2-23. Autocorrelation lags of input series $x(t)$ : $\left(x_{0}, x_{1}, x_{2}, x_{3}, x_{4}\right)$.

$$
\begin{aligned}
& r_{0}=x_{0}^{2}+x_{1}^{2}+x_{2}^{2}+x_{3}^{2}+x_{4}^{2} \\
& r_{1}=x_{0} x_{1}+x_{1} x_{2}+x_{2} x_{3}+x_{3} x_{4} \\
& r_{2}=x_{0} x_{2}+x_{1} x_{3}+x_{2} x_{4} \\
& r_{3}=x_{0} x_{3}+x_{1} x_{4} \\
& r_{4}=x_{0} x_{4} \\
& r_{5}=0 \\
& r_{6}=0
\end{aligned}
$$

Table 2-24. Crosscorrelation of desired output $x(t+$ $\alpha):\left(x_{2}, x_{3}, x_{4}\right), \alpha=2$, with input $x(t):\left(x_{0}, x_{1}, x_{2}\right.$, $\left.x_{3}, x_{4}\right)$.

$$
\begin{aligned}
& g_{0}=x_{0} x_{2}+x_{1} x_{3}+x_{2} x_{4} \\
& g_{1}=x_{0} x_{3}+x_{1} x_{4} \\
& g_{2}=x_{0} x_{4} \\
& g_{3}=0 \\
& g_{4}=0
\end{aligned}
$$

Table 2-25. Convolution of prediction filter $a(t):\left(a_{0}\right.$, $\left.a_{1}, a_{2}, a_{3}, a_{4}\right)$ with input series $x(t):\left(x_{0}, x_{1}, x_{2}, x_{3}, x_{4}\right)$ to compute actual output $y(t):\left(y_{0}, y_{1}, y_{2}, y_{3}, y_{4}\right)$.

$$
\begin{aligned}
& y_{0}=a_{0} x_{0} \\
& y_{1}=a_{1} x_{0}+a_{0} x_{1} \\
& y_{2}=a_{2} x_{0}+a_{1} x_{1}+a_{0} x_{2} \\
& y_{3}=a_{3} x_{0}+a_{2} x_{1}+a_{1} x_{2}+a_{0} x_{3} \\
& y_{4}=a_{4} x_{0}+a_{3} x_{1}+a_{2} x_{2}+a_{1} x_{3}+a_{0} x_{4}
\end{aligned}
$$

Table 2-26. The error series $e(t)=x(t+\alpha)-y(t)$ : $\left(e_{2}, e_{3}, e_{4}, e_{5}, e_{6}\right), \alpha=2$. For $y(t)$, see Table 2-25.

$$
\begin{aligned}
& e_{2}=x_{2}-a_{0} x_{0} \\
& e_{3}=x_{3}-a_{1} x_{0}-a_{0} x_{1} \\
& e_{4}=x_{4}-a_{2} x_{0}-a_{1} x_{1}-a_{0} x_{2} \\
& e_{5}=0-a_{3} x_{0}-a_{2} x_{1}-a_{1} x_{2}-a_{0} x_{3} \\
& e_{6}=0-a_{4} x_{0}-a_{3} x_{1}-a_{2} x_{2}-a_{1} x_{3}-a_{0} x_{4}
\end{aligned}
$$

Table 2-27. Convolution of prediction error filter coefficients $\left(1,0,-a_{0},-a_{1},-a_{2},-a_{3},-a_{4}\right)$ with input series $\tau(t):\left(x_{0}, x_{1}, x_{2}, x_{3}, x_{4}\right)$.

$$
\begin{aligned}
& e_{0}=x_{0} \\
& e_{1}=x_{1} \\
& e_{2}=x_{2}-a_{0} x_{0} \\
& e_{3}=x_{3}-a_{1} x_{0}-a_{0} x_{1} \\
& e_{4}=x_{4}-a_{2} x_{0}-a_{1} x_{1}-a_{0} x_{2} \\
& e_{5}=0-a_{3} x_{0}-a_{2} x_{1}-a_{1} x_{2}-a_{0} x_{3} \\
& e_{6}=0-a_{4} x_{0}-a_{3} x_{1}-a_{2} x_{2}-a_{1} x_{3}-a_{0} x_{4}
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0207.jpg?height=722&width=398&top_left_y=126&top_left_x=89)

FIG. 2.3-9. Wavelet processing. An autocorrelogram (a), estimated from the seismic trace, is used after smoothing (b) to compute the spiking deconvolution operator (d). Here (c) is just a onc-sided version of (b). The inverse of the operator (d) is the minimum-phase wavelet (e), which is sometimes assumed to be the basic wavelet contained in the original seismic trace. It is easy to compute its zero-phase equivalent (f) and design a shaping filter (g) that converts the minimum-phase wavelet (e) to the zero-phase wavelet (f). The actual output is (h), which should be compared with (f). The zero-phase equivalent (f) has the same amplitude spectrum as the minimum-phase wavelet (e).

Why place so much emphasis on the error series? Consider the prediction process as it relates to a seismic trace. From the past values of a time series up to time $t$, a future value can be predicted at time $t+\alpha$, where $\alpha$ is the prediction lag. A seismic trace often has a predictable component (multiples) with a periodic rate

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0207.jpg?height=282&width=392&top_left_y=118&top_left_x=550)

FIG. 2.3-10. A flowchart for predictive deconvolution using a prediction filter.

of occurrence. According to assumption 6, anything else, such as primary reflections, is unpredictable.

Some may claim that reflections are predictable as well; this may be the case if deposition is cyclic. However, this type of deposition is not often encountered. While the prediction filter yields the predictable component (the multiples) of a seismic trace, the remaining unpredictable part, the error series, is essentially the reflection series.

Equation (2-34) can be generalized for the case of an $n$-long prediction filter and an $\alpha$-long prediction lag.

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
r_{2} & r_{1} & r_{0} & \cdots & r_{n-3} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
a_{0} \\
a_{1} \\
a_{2} \\
\vdots \\
a_{n-1}
\end{array}\right)=\left(\begin{array}{c}
r_{\alpha} \\
r_{\alpha+1} \\
r_{\alpha+2} \\
\vdots \\
r_{\alpha+n-1}
\end{array}\right)
$$

Note that design of the prediction filters requires only autocorrelation of the input series.

There are two approaches to predictive deconvolution:

(1) The prediction filter $\left(a_{0}, a_{1}, a_{2}, \ldots, a_{n-1}\right)$ may be designed using equation (2-35) and applied on input series as described in Figure 2.3-10.

(2) Alternatively, the prediction error filter $(1,0,0, \ldots$, $0,-a_{0},-a_{1},-a_{2}, \ldots,-a_{n-1}$ ) can be designed and convolved with the input series as described in Figure 2.3-11.

Now consider the special case of unit prediction lag, $\alpha=1$. For $n=5$, equation (2-35) takes the following form:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0208.jpg?height=288&width=336&top_left_y=115&top_left_x=123)

FIG. 2.3-11, A fiowchart for predictive deconvolution using a prediction error filter.

$$
\left(\begin{array}{lllll}
r_{0} & r_{1} & r_{2} & r_{3} & r_{4} \\
r_{1} & r_{0} & r_{1} & r_{2} & r_{3} \\
r_{2} & r_{1} & r_{0} & r_{1} & r_{2} \\
r_{3} & r_{2} & r_{1} & r_{0} & r_{1} \\
r_{4} & r_{3} & r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{l}
a_{0} \\
a_{1} \\
a_{2} \\
a_{3} \\
a_{4}
\end{array}\right)=\left(\begin{array}{l}
r_{1} \\
r_{2} \\
r_{3} \\
r_{4} \\
r_{5}
\end{array}\right) \cdot(2-36)
$$

By augmenting the right side to the left side, we obtain:

$$
\left(\begin{array}{llllll}
-r_{1} & r_{0} & r_{1} & r_{2} & r_{3} & r_{4} \\
-r_{2} & r_{1} & r_{0} & r_{1} & r_{2} & r_{3} \\
-r_{3} & r_{2} & r_{1} & r_{0} & r_{1} & r_{2} \\
-r_{4} & r_{3} & r_{2} & r_{1} & r_{0} & r_{1} \\
-r_{5} & r_{4} & r_{3} & r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{0} \\
a_{1} \\
a_{2} \\
a_{3} \\
a_{4}
\end{array}\right)=\left(\begin{array}{l}
0 \\
0 \\
0 \\
0 \\
0 \\
0
\end{array}\right)
$$

Add one row and move the negative sign to the column matrix that represents the filter coefficients to get:

$$
\left(\begin{array}{llllll}
r_{0} & r_{1} & r_{2} & r_{3} & r_{4} & r_{5} \\
r_{1} & r_{0} & r_{1} & r_{2} & r_{3} & r_{4} \\
r_{2} & r_{1} & r_{0} & r_{1} & r_{2} & r_{3} \\
r_{3} & r_{2} & r_{1} & r_{0} & r_{1} & r_{2} \\
r_{4} & r_{3} & r_{2} & r_{1} & r_{0} & r_{1} \\
r_{5} & r_{4} & r_{3} & r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
-a_{0} \\
-a_{1} \\
-a_{2} \\
-a_{3} \\
-a_{4}
\end{array}\right)=\left(\begin{array}{l}
L \\
0 \\
0 \\
0 \\
0 \\
0
\end{array}\right) .
$$

where $L=r_{0}-r_{1} a_{0}-r_{2} a_{1}-r_{3} a_{2}-r_{4} a_{3}-r_{5} a_{4}$. Note that there are six unknowns, $\left(a_{0}, a_{1}, a_{2}, a_{4}, a_{5}, L\right)$, and six equations. Solution of these equations yields the unit-delay prediction error filter $\left(1,-a_{0},-a_{1}\right.$, $\left.-a_{2},-a_{4},-a_{5}\right)$, and the quantity $L-$ the error in the filtering process (Section B.5). We can rewrite equation
(2-38) as follows:

$$
\left(\begin{array}{llllll}
r_{0} & r_{1} & r_{2} & r_{3} & r_{4} & r_{5} \\
r_{1} & r_{0} & r_{1} & r_{2} & r_{3} & r_{4} \\
r_{2} & r_{1} & r_{0} & r_{1} & r_{2} & r_{3} \\
r_{3} & r_{2} & r_{1} & r_{0} & r_{1} & r_{2} \\
r_{4} & r_{3} & r_{2} & r_{1} & r_{0} & r_{1} \\
r_{5} & r_{4} & r_{3} & r_{2} & r_{7} & r_{0}
\end{array}\right)\left(\begin{array}{l}
b_{0} \\
b_{1} \\
b_{2} \\
b_{3} \\
b_{4} \\
b_{5}
\end{array}\right)=\left(\begin{array}{c}
L \\
0 \\
0 \\
0 \\
0 \\
0
\end{array}\right) .
$$

where $b_{0}=1, b_{1}=-a_{2}$, and $i=1,2,3,4,5$. This equation has a familiar structure. In fact, except for the scale factor $L$, it has the same form as equation (2-31), which yields the coefficients for the least-squares zero-delay inverse filter. This inverse filter is therefore the same as the prediction error filter with unit prediction lag, except for a scale factor. Hence, spiking decorivolution actually is a special case of predictive deconvolution with unit prediction lag.

We now know that predictive deconvolution is a general process that encompasses spiking deconvolution. In general, the following statement can be made: Geven an input wavelet of length $(n+\alpha)$, the predrction error filter contracts $i t$ to an $\alpha$-long wavelet, where $\alpha$ is the prediction lag (Peacock and Treitel, 1969). When $\alpha=1$, the procedure is called spiking deconvolution.

Figure 2.3-12 interrelates the various filters discussed in this chapter and indicates the kind of process they imply. From Figure 2.3-12, note that Wiener filters can be used to solve a wide range of problems. In particular, predictive deconvolution is an integral part of seismic data processing that is aimed at compressing the seismic wavelet, thereby increasing temporal resolution. In the limit, it can be uscd to spike the sejsmaic wavelet and obtain an estimate for refloctivity.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0208.jpg?height=305&width=428&top_left_y=874&top_left_x=527)

2.3-12. A flowchart for interrelations between various deconvolution filters.

### 2.4 PREDICTIVE DECONVOLUTION IN PRACTICE

It now is appropriate to review the implications of the assumptions stated in Sections 2.1 and 2.2 that underlie the process of deconvolution within the context of predictive deconvolution.

(a) Assumptions 1, 2, and 3 arc the basis for the convolutional model of the recorded seismogram (Section 2.1). In practice, deconvolution often yields good results in areas where these three assumptions are not strictly valid.

(b) Assumption 3 can be reluxed in practice by considering a time-variant deconvolution (Section 2.6). In this technique, a seismogram is divided into a number of time gates, typically three or more. Deconvolution operators then are designed from each gate and convolved with data within that gate. Alternatively, time-variant spectral whitening can be used to account for nonstationarity (Section 2.6).

(c) Not much can be done about assumption 4. Howevcr, noise can be minimized in the recording process. Deconvolution operators can be designed using time gates and frequency bands with low noise levels. Poststack deconvolution can be used in an effort to take advantage of the noise reduction inherent in the stacking process

(d) If the source wavelet were minimum-phase and known (assumption 5), then a perfect result could be obtained from deconvolution in the noise-free case as in trace (c) of Figures 2.4-1 and 2.4-2.

(e) If assumption 6 were violated and if the source waveform were not known, then you would have problems as in trace (d) of Figures 2.4-1 and 2.4-2.

(f) The quality of the output from spiking deconvolution is degraded further when the source wavelet is not minimum-phase as in Figures 2.4-3 and 2.4-4; that is, when assumption 7 is violated.

(g) Finally, in addition to violating assumptions 5 and 7 , if there were noise in the data, that is, when assumption 4 is violated, then the result of the deconvolution would be unacceptable as in Figure 2.4-5.

Figures 2.4-1 through 2.4-5 test our confidence in the usefulness of predictive deconvolution. In reality, deconvolution has been applied to billions of seismic traces; most of the time it has yielded satisfactory results. Figures 2.4-1 through 2.4-5 emphasize the critical assumptions that underlie predictive deconvolution. When deconvolution does not work on some data, the most probable reason is that one or more of the above assumptions has been violated. In the remaining part of this section, a series of numerical experiments will be performed to examine the validity of these assumptions. The purpose of these experiments is to gain a basic understanding of deconvolution from a practical point of view.

## Operator Length

We start with a single, isolated minimum-phase wavelet as in trace (b) of Figure 2.4-6. Assumptions 1 through 5 are satisfied for this wavelet. The ideal result of spiking deconvolution is a zero-lag spike, as indicated by trace (a). In this and the following numerical analyses, we refer to the autocorrelogram and amplitude spectrum (plotted with linear scale) of the output frora each deconvolution test to better evaluate the results. In Figure 2.4-6 and the following figures, $n, \alpha$, and $\varepsilon$ refer to operator length of the prediction filter, prediction lag, and percent prewhitening, respectively. The length of the prediction error filter then is $n+\alpha$.

In Figure 2.4-6, prediction lag is unity and equal to the 2 -ms sampling rate, prewhitening is $0 \%$, and operator length varies as indicated in the figure. Short operators yield spikes with small-amplitude and relatively high-frequency tails. The 128 -ms-long operator gives an almost perfect spike output. Longer operators whiten the spectrum further, bringing it closer to the spectrum of the impulse response.

The action of spiking deconvolution on the seismogran derived by convolving the minimura-phase wavelet with a sparse-spike series is similar (Figure 2.4-7) to the case of the single isolated wavelet (Figure 2.4-6). Recall that spiking deconvolution besically is inverse filtering where the operator is the least-squares inverse of the seismic wavelet. Therefore, an increasingly better result should be obtained when more and more coefficients are included in the inverse filter.

Now consider the real situation of an unknown source wavelet. Based on assumption 6 , autocorrelation of the input seismogram rather than that of the seismic wavelet is used to design the deconvolution operator. The result of using the trace rather than the wavelet, autocorrelation is shown in Figure 2.4-8. Deconvolution recovers the gross aspects of the spike series, trace (a). However, note that the deconvolved traces have spurious small-amplitude spikes trailing each of the real spikes. We see that increasing operator length does not indefinitely improve the results; on the contrary, roore and more spurious spikes are introduced.

Very short operators produce the same type of noise spikes as in Figures 2.4-7 and 2.4-8. Examine the series of deconvolution tests in Figure 2.4-8 and note that the 94-ms operator does the best job. Compare the autocorrelogram of trace (b) in Figure 2.4-8 with

Autocorrelograms
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=280&width=480&top_left_y=152&top_left_x=179)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=140&width=270&top_left_y=443&top_left_x=218)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=82&width=152&top_left_y=247&top_left_x=506)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=200&width=160&top_left_y=348&top_left_x=505)

Time (s)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=420&width=174&top_left_y=115&top_left_x=675)

Frequency $(\mathrm{Hz}$ )

2.4-1. (a) Impulse response, (b) seismogram, (c) spiking deconvolution using known, minimum-phase wavelet, (d) deconvolution assuming an unknown, minimum-phase source wavelet. Impulse response (a) is a sparse-spike series. For an unknown source wavelet (in violation of assumption 4), spiking deconvolution yields a less than perfect result (compare (c) and (d)).

Autocorrelograms Amplitude Spectra

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=86&width=270&top_left_y=700&top_left_x=230)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=82&width=271&top_left_y=803&top_left_x=228)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=82&width=268&top_left_y=899&top_left_x=231)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=98&width=268&top_left_y=1001&top_left_x=231)

Time (s)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=402&width=162&top_left_y=697&top_left_x=506)

Time (s)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0210.jpg?height=406&width=152&top_left_y=690&top_left_x=673)

Frequency (Hz)

2.4-2. (a) Impulse response, (b) seismogram, (c) spiking deconvolution using known, minimum-phase source wavelet, (d) deconvolution assuming an unknown, minimum-phase source wavelet. Impulse response (a) is based on a sonic log (Figure 2.1-1a). For the unknown source wavelet (in violation of assumption 4), spiking deconvolution yields a less than perfeci result. (Compare (c) and (d).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0211.jpg?height=467&width=637&top_left_y=118&top_left_x=200)

2.4-3. (a) Impuise response, (b) seismogram, (c) deconvolution using a known, mixed-phase source wavelet, (d) deconvolution asuming an unknown, mixed-phase source wavelet. Impulse response (a) is a sparse-spike series. For a mixed-phase source wavelet (in violation of essumption 5), spiking deconvolution yields a degraded output (d), even when the wavelet is known (c).

## Autocorrelograms <br> Amplitude Spectra

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0211.jpg?height=90&width=582&top_left_y=704&top_left_x=230)

(b)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0211.jpg?height=94&width=572&top_left_y=802&top_left_x=240)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0211.jpg?height=94&width=570&top_left_y=899&top_left_x=242)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0211.jpg?height=99&width=268&top_left_y=1006&top_left_x=239)

Time (s)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0211.jpg?height=110&width=300&top_left_y=995&top_left_x=515)

Time (s)

Frequency ( $\mathrm{Hz}$ )

2.4-4. (a) Impulse tesponse, (b) seismogram, (c) deconvolution using a known, mixed-phase source wavelet, (d) deconvolution assuming an unknown, mixed-phase sotrce. Impulse response (a) is based on the sonic $\log$ of Figure 2.1-la. For the mixedphase source wavelet (in violation of assumption 5), spiking deconvolution yields a degraded output (d) even when the wavelet is known (c).
(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0212.jpg?height=83&width=268&top_left_y=146&top_left_x=231)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0212.jpg?height=84&width=260&top_left_y=241&top_left_x=239)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0212.jpg?height=97&width=260&top_left_y=338&top_left_x=239)

Time (s)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0212.jpg?height=322&width=324&top_left_y=112&top_left_x=505)

Time (s)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0212.jpg?height=108&width=152&top_left_y=327&top_left_x=654)

Frequency $(\mathrm{Hz}$ )

2.4-5. (a) Impulse response, (b) seismogram with noise, (c) deconvolution assuming an unknown, mixed-phase source wavelet. Impulse response (a) is based on the sonic log of Figure 2.1-1a. In the presence of random noise (in violation of assumption 3), spiking deconvolution can produce a result with nelation to the earth's reflectivity (compare (a) to (c)),

that of trace (b) in Figure 2.4-6. Note that only the first 100 -ms portion represents the autocorrelation of the source wavelet. This explains why the 94-ms operator worked best; that is, the autocorrelation lags of trace (b) in Figure 2.4-8 beyond $94 \mathrm{mls}$ do not represent the seismic wavelet.

Consider the seismogram in Figure 2.4-9, where the wavelet is assumed to be unknown. Deconvolution has restored the spikes that correspond to major reflections in the impulse response as in trace (b) with some success. The $64-\mathrm{ms}$ operator is a good choice.

The mixed-phase wavelet in Figure 2.4-10 shows what can happen when assumption 7 is violated. The wavelet in Figure 2.4-6 is the minimum-phase equivalent of the mixed-phase wavelet in Figure 2.4-10. Both wavelets have the same autocorrelograms and amplitude spectra. Hence, the deconvolution operators for both wavelets are identical. Because the minimumphase assumption was violated, deconvolution does not convert the mixed-phase wavelet to a perfect spike. Instead, the deconvolved output is a complicated highfrequency wavelet. Also note that the dominant peak in the output is negative, while the impulse response has a positive spike. This difference in the sign can happen when a mixed-phase wavelet is deconvolved. Increasing the operator length further whitens the spectrum; however, the 128-ms operator yields a result that cannot be improved further by longer operators.

The seismogram obtained from the mixed-phase wavelet and the sparse-spike series (used in the preceding figures) is shown in Figure $2.4-11$. The $94-\mathrm{ms}$ operator gives the best result. This also is the case in Figure 2.4-12, where both assumptions 6 and 7 are violated. The situation with the seismogram in Figure 2.4-13 is not very good. The spikes that correspond to major reflections in the impulse response were restored; however, there are some timing errors and polarity reversals. (Compare these results with those in Figure 2.49 for the events between 0.2 and $0.3 \mathrm{~s}$ and 0.6 and 0.7 s.) The 64-ms operator gives an output that cannot be improved by longer operators.

What kind of operator length should be used for spiking deconvolution? To select an operator length, ideally we want to use the autocorrelation of the unknown seismic wavelet. Fortunately, the autocorrelation of the input seismogram has the characteristics of the wavelet autocorrelation (assumption 6). Therefore, it seems appropriate that we should use part of the autocorrelation obtained from the input seismogram that most resembles the autocorrelation of the unknown seismic wavelet. That part is the first transient zone in the autocorrelation, as seen by comparing the autocorrelations of trace (b) in Figure 2.4-6 and trace (c) in Figure 2.4-9. The autocorrelations of trace (b) in Figure 2.4-10 and trace (c) in Figure 2.4-13 suggest the same principle.

## Prediction Lag

So far, we have learned that predictive deconvolution has two uses: (a) spiking deconvolution - the case of wnit prediction lag, and (b) predicting the input

(text continues on p. 198)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0213.jpg?height=423&width=843&top_left_y=119&top_left_x=101)

2.4-6. Test of operator length for a single, isolated input wavelet, where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0213.jpg?height=426&width=851&top_left_y=652&top_left_x=93)

2.4-7. Test of operator length where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with known, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0214.jpg?height=430&width=850&top_left_y=116&top_left_x=91)

2.4-8. Test of operator length where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with known, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0214.jpg?height=434&width=851&top_left_y=651&top_left_x=93)

2.4-9. Test of operator length where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Reflectivity, (b) impulse response, (c) seismogram with unknown, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0215.jpg?height=426&width=849&top_left_y=115&top_left_x=94)

2.4-10. Test of operator length for a single, isolated input wavelet where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0215.jpg?height=429&width=851&top_left_y=640&top_left_x=93)

2.4-11. Test of operator length where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhtening. (a) Impulse response, (b) seismogram with known, mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0216.jpg?height=422&width=847&top_left_y=114&top_left_x=95)
S
0.8
s
0.2

0.2

0.4

0.6

$0.4 \mathrm{~Hz}$

100200

2.4-12. Test of operator length where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with unknown, mixed-phese source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0216.jpg?height=428&width=864&top_left_y=643&top_left_x=82)

0.4

0.6

0.8

s

0.2

$0.4 \mathrm{~Hz}$

100

2.4-13. Test of operator length where $n=$ operator length, $\alpha=$ prediction lag, and $\epsilon=$ percent prewhitening. (a) Reflectivity, (b) impulse response, (c) seismogram with unknown, mixed-phase source wavelet.
seismogram at a future time defined by the prediction lag. Case (b) is used to predict and attenuate multiples.

Now, the effect of the prediction lag perameter is examined from an interpretive point of view. Consider the single, isolated minimum-phase wavelet in Figure 2.4-14. Here, operator length and percent prewhitening are kept constant, while prediction lag is varied. When prediction lag is equal to the sampling rate, then the result is equivalent to spiking deconvolution. Predictive deconvolution using a prediction lag greater than unity yields a wavelet of finite duration instead of a spike. Given an input wavelet of $\alpha+n$ samples, predictive deconvolution using prediction filter with length $n$ and prediction $\operatorname{lag} \alpha$ converts this wavelet into another wavelet that is $\alpha$ samples long. The first $\alpha$ lags of the autocorrelation are preserved, while the next $n$ lags are zeroed out. Additionally, the amplitude spectrum of the output increasingly resembles that of the input wavelet as prediction lag is increased (Figure 2.4-14). At a 94ms prediction lag, predictive deconvolution does nothing to the input wavelet because almost all the lags of its autocorrelation have been left untouched. This experiment has an important practical implication: Under the ideal, noise-free conditions, resolution on the output from predictive deconvolution can be controlled by adjusting the prediction lag. Unit prediction lag implies the highest resolution, while a larger prediction lag implies less than full resolution. However, in reality, these assessments are dictated by the signal-to-noise ratio.
The deconvolved output using a unit prediction lag contains high frequencies; nevertheless, resolution may be degraded if the high-frequency energy is mostly noise, not signal.

In Figure 2.4-14, prediction lags of 8 and $22 \mathrm{~ms}$ correspond to the first and second zero crossings on autocorrelation of the input wavelet, respectively. The first zero crossing produces a spike with some width, while the second zero crossing lag produces a wavelet with a positive and negative lobe.

The relationship between prediction lag and whitening also holds for the sparse-spike series in Figure 2.4-15 and when the input wavelet is unknown (Figure 2.4-16).

The effect of prediction lag on the output from predictive deconvolution of a synthetic seismogram, which was obtained from the sonic $\log$ (Figure 2.1-1a), is demonstrated in Figures 2.4-17 and 2.4-18. As the prediction lag is increased, the output spectrum becomes increasingly less broadband. Predictive deconvolution of seismograms constructed from the mixedphase wavelet again demonstrates that output resolution can be controlled by adjusting prediction lag (Figures 2.4-19 through 2.4-23).

If prediction lag is increased, then the output amplitude spectrum becomes increasingly band-limited. The output also can be band-limited by applying a band-pass filter on the spiking deconvolution output.

(text contrnues on p. 203)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0217.jpg?height=426&width=851&top_left_y=758&top_left_x=93)

2.4-14. Test of prediction lag for a single, isolated input wavelet where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening, (a) Impulse response, (b) seismogram with minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0218.jpg?height=402&width=849&top_left_y=119&top_left_x=94)
s
0.2
0.4
0.6
0.8
$\mathbf{s}$
0.2
$0.4 \mathrm{~Hz}$
100

2.4-15. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with known, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0218.jpg?height=427&width=845&top_left_y=654&top_left_x=99)

2.4-16. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with unknown, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0219.jpg?height=430&width=850&top_left_y=121&top_left_x=96)

2.4-17. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening, (a) Reflectivity, (b) impulse response, (c) seismogram with known minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0219.jpg?height=429&width=849&top_left_y=653&top_left_x=95)

2.4-18. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction $\operatorname{lag}$, and $\varepsilon=$ percent prewhitening. (a) Reflectivity, (b) impulse response, (c) seismogram with unknown, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0220.jpg?height=428&width=849&top_left_y=114&top_left_x=94)

2.4-19. Test of prediction lag for a single, isolated input wavelet where $n=$ operator length $\alpha=$ prediction lag, and $\varepsilon-$ percent prewhitening. (a) Impulse response, (b) seismogram with mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0220.jpg?height=428&width=851&top_left_y=638&top_left_x=93)

2.4-20. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with known, mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0221.jpg?height=426&width=847&top_left_y=123&top_left_x=95)

2.4-21. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitenıng. (a) Impulse response, (b) seismogram with unknown, mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0221.jpg?height=424&width=849&top_left_y=653&top_left_x=95)

2.4-22. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent, prewhitening. (a) Reflectivity, (b) impulse response, (c) seismogram with known, mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0222.jpg?height=428&width=851&top_left_y=114&top_left_x=93)

2.4-23. Test of prediction lag where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Reflectivity, (b) impulse response, (c) seismogram with unknown, mixed-phase source wavelet.

Are these two ways of band-limiting equivalent? Refer to the results from both the minimum- and mixed-phase wavelets in Figures 2.4-14 and 2.4-19, respectively. Note that the output of the 22 -ms prediction lag has an amplitude spectrum that is band-limited to approximately 0 to $100 \mathrm{~Hz}$. However, the spectral shape within this bandwidth is not a boxcar, but rather similar to that of the input wavelet. The boxcar shape would be the case if a band-pass filter (0 to $100 \mathrm{~Hz}$ ) were applied to the output of the spiking deconvolution (2-ms prediction lag). Hence, spiking deconvolution followred by band-pass filtering is not equivclent to predictive deconvolution winth a predaction lag greater than unity.

In conclusion, if prediction lag is increased, the output from predictive deconvolution becomes less spiky. This effect can be used to our advantage, since it allows the bandwidth of deconvolved output to be controlled by adjusting the prediction lag. The application of spiking deconvolution to field data is not always desirable, since it boosts high-frequency noise in the data. The most prominent effect of the nomunity prediction lag is suppression of the high-frequency end of the spectrum and preservation of the overall spectral shape of the input data. This effect is seen in Figures 2.4-18 and 2.423 , which correspond to the minimum-and mixed-phase seismic wavelets. If prediction lag is increased further, then the low-frequency end of the spectrum is affected as well, making the output more band-limited.

## Percent Prewhitening

The reasons for prewhitening were discussed in Section 2.3. Consider the single, isolated minimum-phase wavelet in Figure 2.4-24. Keep the operator length and prediction lag constant and vary the percent prewhitening. Note that the effect of varying prewhitening is similar to that of varying the prediction lag; that is, the spectrum increasingly becomes less broadband as the percent prewhitening is increased. Compare Figure 2.4-14 with Figure 2.4-24. Note that prewhitening narrows the spectrum without changing much of the flatness character, whale larger prediction lag narrows the spectrum and alters ats shape, making tt look more like the spectrum of the input sermac wavelet. These characteristics also can be inferred from the shapes of the output wavelets. Prewhitening preserves the spiky character of the output, although it adds a low-amplitude, high-frequency tail (Figure 2.4-24). On the other hand, increasing prediction lag produces a wavelet with a duration equal to the prediction lag (Figure 2.4-14).

The effect of prewhitening on the sparse-spike train seismogran with a known and unknown minimumphase wavelet is shown in Figures 2.4-25 and 2.4-26, respectively. The effect of prewhitening on deconvolution of the synthetic seismogram obtained from the sonic $\log$ (Figure 2.1-1a) is shown in Figures 2.4-27 and 2.4-28 for known and unknown minimum-phase wavelets. Prewhitening tests using the mixed-phase

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0223.jpg?height=418&width=842&top_left_y=126&top_left_x=100)

2.4-24. Test of percent prewhitening for a single, isolated input wavelet where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) sejsmogram with minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0223.jpg?height=427&width=849&top_left_y=646&top_left_x=94)

2.4-25. Test of percent prewhitening where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with known, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0224.jpg?height=428&width=851&top_left_y=114&top_left_x=93)

2.4-26. Test of percent prewhitening where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) sejsmogram with unknown, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0224.jpg?height=429&width=847&top_left_y=636&top_left_x=95)

2.4-27. Test of percent prewhitening where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Reflectıvity, (b) impulse response, (c) seismogram with known, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0225.jpg?height=429&width=851&top_left_y=119&top_left_x=93)

2.4-28. Test of percent prewhitening where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Reflectivity, (b) impulse reaponse, (c) seismogram with unknown, minimum-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0225.jpg?height=426&width=858&top_left_y=643&top_left_x=95)

2.4-29. Test of percent prewhtening for a single, isolated input wavelet where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) sejsmogran with mixed-phase source wavelet.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0226.jpg?height=430&width=853&top_left_y=113&top_left_x=92)

2.4-30. Test of percent prewhitening for a single, isolated input wavelet where $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening. (a) Impulse response, (b) seismogram with minimum-phase source wavelet.

wavelet are shown in Figure 2.4-29. Finally, the combined effects of a prediction lag that is greater than unity and prewhitening for the single, isolated wavelet are shown in Figure 2.4-30. These figures demonstrate that prewhitening narrows the output spectrum, making it band-limited. In particular, the tests in Figures 2.4-24 and 2.4-29 using the single, isolated minimumand mixed-phase wavelets suggest that spiking deconvolution with some prewhitening is somewhat equivalent to spiking deconvolution without prewhitening followed by post-deconvolution broad band-pass filtering. However, this is not exactly true, for prewhitening still leaves some relatively suppressed energy at the highfrequency end of the spectrum. From Figure 2.4-30, we infer that predictive deconvolution with a prediction lag greater than unity and with some prewhitening yields a result somewhat equivalent to a spiking deconvolution followed by band-pass filtering.

In conclusion, we can say that prewhitening yields a band-limited output. However, the effect is less controllable when compared to varying the prediction lag. By varying prediction lag, we have some idea of the output bandwidth, since it is related to prediction lag. The smaller the prediction lag, the broader the output bandwidth. Prewhitening is used only to ensure that numerical instability in solving for the deconvolution operator (equation 2-32) is avoided. In practice, typically 0.1 to $1 \%$ prewhitening is standard.

## Effect of Random Noise on Deconvolution

We assume that the noise component in the recorded seismogram is zero (assumption 4). The autocorrelation of ideal random noise is zero at all lags except the zero lag (Figure 2.1-5). Therefore, the effect of randon noise on deconvolution operators should be somewhat similar to the effect of prewhitening. Both effects modify the diagonal of the autocorrelation matrix, making it more dominant [equation (2-32)]. However, the noise component also slightly modifies the nonzero lags of the autocorrelation. Compare the autocorrelograms of traces (b) in Figures 2.4-24 and 2.4-31. In Figure 2.4-24, an isolated minimum-phase wavelet was considered, while in Figure 2.4-31, random noise was added to the same wavelet. The output wavelet shape from spiking deconvolution of the noisy wavelet using a $128-\mathrm{ms}$ operator is similar to the output from spiking deconvolution of the wavelet without noise, using the same operator length but with, say, 20 percent prewhitening. This result has practical importance prewhitening is equivalent to adding perfect random noise to the systern. Since a recorded seismogram always contains some amount of random noise, only a minute amount, say 0.1 percent, of the white noise needs to be added to the seismogram for numerical stability.

The effect of random noise on the performance of deconvolution is examined further in Figures 2.432 and 2.4-33. These results should be compared with

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0227.jpg?height=424&width=849&top_left_y=120&top_left_x=95)

2.4-31. Effect of random noise on deconvolution performance. Input seismogram (b) associated with reflectivity (a) contains a single, isolated wavelet (at around $0.2 \mathrm{~s}$ ) buried in random noise. Here, $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0227.jpg?height=426&width=845&top_left_y=643&top_left_x=99)

2.4-32. Effect of random noise on deconvolution performance. (a) Reflectivity, (b) impulse response. Input seismogram (c) with unknown, minimum-phase source wavelet is noise contaminated. Here, $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon$ $=$ percent prewhitening.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0228.jpg?height=426&width=847&top_left_y=114&top_left_x=95)

2.4-33. Effect of random noise on deconvolution performance. (a) Reflectivity, (b) impulse response. Input seismogram (c) with unknown, mixed-phase source wavelet is noise contaminated. Here, $n=$ operator length, $\alpha=$ prediction lag, and $\varepsilon=$ percent prewhitening

their noiseless counterparts in Figures 2.4-9 and 2.4 13 , respectively. Observe that the noise component has a harmful effect on deconvolution. For example, when comparing Figures $2.4-9$ and $2.4-32$, note that the deconvolution result from the noisy seismogram has spurous spikes (for instance, between 0.5 and $0.6 \mathrm{~s}$ ), which could be interpreted as genuine reflections. Noisy field data, which yield better stack when not treated by deconvolution, have been noted. Only by testing can we determine whether deconvolution performs satisfactorily on data with a severe noise problem.

## Multiple Attenuation

We have learned that a prediction filter predicts periadic events, like multiples, in the seismogram. The prediction error filter yields the unpredictable component of the seismogram the reflectivity series. For example, consider the simple case of water-bottom multiples. If the reflection coefficient of the water bottom is $c_{w}$ and if water depth is equivalent to a two-way time $t_{w}$, then the time series is

$$
\left(1,0, \ldots, 0,-c_{w}, 0, \ldots, 0, c_{w}^{2}, 0, \ldots, 0,-c_{w}^{3}, 0, \ldots\right)
$$

as represented by trace (b) in Figure 2.4-34. The separation between the spikes is $t_{w}$ in trace (b). Note that the periodicity in the time series (trace (b) or (c)) manifests itself in the amplitude spectrum as periodic peaks (or notches). The greater the spike separation in time, the closer the peaks (or notches) in the amplitude spectrum.

The noise-free convolutional model for the seismogram that contains the water-bottom multiples can be written as

$$
x(t)=w(t) * m(t) * e(t)
$$

where $m(t)$ represents the water-layer reverberation spike series as in trace (b) of Figure 2.4-34, and $e(t)$ now represents the earth's impulse response excluding multiples associated with the water bottom. Predictive deconvolution can suppress the periodic component $m(t)$ in the seismogram as demonstrated by trace (d) in Figure 2.4-3.

Note the two distinct goals for predictive deconvolution: (a) spiking the seismic wavelet $w(t)$, and (b) predicting and attenuating multiples $m(t)$. The first goal is achieved using an operator with unit prediction lag, while the second is achieved using an operator with a prediction lag greater than unity.

The autocorrelation of the input trace can be used to determine the appropriate prediction lag for multiple suppression. Periodicity associated with multiples is evident in the autocorrelogram of trace (c) in Figure 2.434 , as an isolated series of energy lobes in the neighbor-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0229.jpg?height=452&width=849&top_left_y=122&top_left_x=94)

2.4-34. (a) Reflectivity, (b) impulse rezponse, (c) seismogram. Two-step deconvolution aimed at attenuating the multiples, then spiking the remaining primary wavelet (d) to (e). The process can be performed in the reverse order (f) to (g). Here, $n$ $=$ operator length and $\alpha=$ prediction lag.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0229.jpg?height=448&width=845&top_left_y=695&top_left_x=99)

2.4-35. Predictive deconvolution for multiple attenuation. (a) Reflectivity, (b) impulse response, (c) seismogram. Two-step deconvolution: Predictive deconvolution (d) followed by spiking deconvolution (e). Traces (f), (g), and (h) result when singlestep deconvolution is applied to the input trace (c), using the operator lengths $n$ and prediction lags $\alpha$, as indicated.
hood of 0.2 and $0.4 \mathrm{~s}$. Prediction lag should be chosen to bypass the first part of the autocorrelogram that represents the seismic wavelet. Operator length should be chosen to include the first isolated energy packet in the autocorrelogram. After applying predictive deconvolution, we are left with only the water-bottom primary reflection. Isolated bursts in the autocorrelogram have been suppressed, while periodic peaks in the amplitude spectrum have been eliminated as shown in trace (d). If desired, the basic wavelet can be compressed into a spike as shown in trace (e) by applying spiking deconvolution to the output of predictive deconvolution as shown in trace (d). The sequence can be interchanged by first applying spiking deconvolution as shown in trace (f) followed by predictive deconvolution as shown in trace (g).

By using a sufficiently long spiking deconvolution operator, two goals are achieved in one step as seen in trace (h). However, this approach can be dangerous if primary reflections are unintentionally suppressed. This is the case in Figure 2.4-35. Here, the water-bottom refection is followed by a deeper event at about 0.28 $s$ as seen in trace (a). The impulse response contains water-bottom multiples and the peg-leg multiples that are associated with the deeper reflector as seen in trace (b). The amplitude spectrum has peaks that come in pairs, indicating the presence of two different periodic components in the seismogram. Careful choice of predictive deconvolution parameters yields an output with only the wavelets associated with the water bottom and the deeper reflector as seen in trace (d). This is followed by a spiking deconvolution that yields two spikes representative of the water bottom and the deep primary as seen in trace (e). Spiking deconvolution alone produces the reflection coefficient series and the spikes that represent the multiples as seen in trace (f). If a longer spiking deconvolution operator is used, then the primary reflection easily can be eliminated as in trace (g). If a predictive deconvolution operator is used with an improper parameter choice, then again, the primary reflection can be eliminated easily as in trace (h).

How can we ensure that no primaries are destroyed by deconvolution? Examine the autocorrelogram of trace (c) in Figure 2-4-35. The first 50-ms portion represents the seismic wavelet. This is followed by a burst between 50 to $170 \mathrm{~ms}$ that represents the correlation of the water bottom and primary. The isolated burst between 170 to 340 mis represents the actual multiple series (both the peg-legs and water-bottom multiples). The prediction lag must be chosen to bypass the first part of the autocorrelogram, which represents the seismic wavelet and possible correlation between the primaries. The operator length must be chosen to include the first isolated burst, in this case between 170 to $340 \mathrm{~ms}$.

It is only with vertical incidence and zero-offset recording that periodicity of the multiples is preserved. Therefore, predictive deconvolution aimed at multiple suppression may not be entirely effective when applied to nonzero-offset data, such as common-shot or common-midpoint data. Figure 2.4-36a shows a common-shot gather with its autocorrelogram and average amplitude spectrum. The field record is prepared for deconvolution by first applying $t^{2}$-scaling (Figure 2.4-36b) and muting the first arrivals associated with largely guided waves (Figure 2.4-36c). The autocorrelogram in Figure 2.4-36ic indicates the presence of multiples. Note on the shot record the water-bottom reflection is at $0.4 \mathrm{~s}$ at near offset. Additionally, there are two strong primary reflectors at 0.6 and $1.4 \mathrm{~s}$ at near offset; these primaries give rise to a first-order and pegleg multiples. Despite the flatness of the spectrum and the attenuation of nonzero lags of the autocorrelogram after deconvolution, the first-order multiples associated with the water-bottom reflection and the peg-leg multiples associated with the primary reflection at $0.6 \mathrm{~s}$ still persist in the record (Figures 2.436d). This occurs because these events have large moveout which causes significant departure from periodicity at nonzero offsets. On the other hand, note that the peg-leg multiples associated with the primary reflection at $1.4 \mathrm{~s}$ have been attenuated significantly by deconvolution. This event has a very small moveout; thus, its perodicity is much preserved.

Predictive deconvolution sometimes is applied to CMP stacked data in an effort to suppress muitiples. The performance of such an approach can be unsatisfactory, because the amplitude relationships between multiples often are grossly altered by the stacking process, primarily because of velocity differences between primaries and multiples. Also, geometric spreading compensation by using primary velocity function adversely affects the amplitudes of multiples on nonzero-offset data.

There is one domain in which the periodicity and amplitudes of multiples are preserved the slant-stack domain. In Section 6.3, the application of predictive deconvolution to data in the slant-stack domain for multiple suppression is discussed.

### 2.5 FIELD DATA EXAMPLES

The deconvolution parameters now are examined using field data examples. We shall discuss application of sta-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=160&width=173&top_left_y=126&top_left_x=178)

IAr tow gror mint

S

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=29&width=222&top_left_y=316&top_left_x=127)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=611&width=271&top_left_y=339&top_left_x=84)

0- 1 - 1 -

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=155&width=143&top_left_y=126&top_left_x=389)

(8) T-senuased comptMsation
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=774&width=214&top_left_y=319&top_left_x=349)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=150&width=149&top_left_y=126&top_left_x=592)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=20&width=117&top_left_y=294&top_left_x=571)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=147&width=143&top_left_y=126&top_left_x=800)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=31&width=139&top_left_y=282&top_left_x=772)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=20&width=409&top_left_y=318&top_left_x=563)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=618&width=414&top_left_y=336&top_left_x=563)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=138&width=203&top_left_y=956&top_left_x=560)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0231.jpg?height=129&width=202&top_left_y=962&top_left_x=772)

(d)

2.4-36. (a) A common-shot gather, (b) after $t^{2}$-scaling and (c) after muting first arrivals which are largely guided waves, and (d) after spiking deconvolution. The amplitude spectra averaged over the shot record are shown at the top and the autocorrelograms are shown at the bottom.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=616&width=354&top_left_y=117&top_left_x=112)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=170&width=86&top_left_y=563&top_left_x=305)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=167&width=77&top_left_y=563&top_left_x=389)

(c) (d)

2.5-1. An autocorrelation window test used to design deconvolution operators. The solid bars indicate the window boundaries. The entire 6 -s length was included in (a). The autocorrelograms are displayed beneath the records.

tistical deconvolution to pre- and poststack data. Additionally, we shall discuss application of deterministic deconvolution to marine data to convert the recorded source signature to its minimum-phase equivalent, and to land data recorded using a vibroseis source to convert the autocorrelogram of the sweep signal to its minimumphase equivalent.

## Prestack Deconvolution

Figure 2.5-1 shows a CMP gather that contains five prominent refiections at around $1.1,1.35,1.85,2.15$, and $3.05 \mathrm{~s}$. The gather also contains strong reverberations associated with these reflections. The examination of the deconvolution parameters will begin with an
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=448&width=414&top_left_y=118&top_left_x=548)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=167&width=109&top_left_y=571&top_left_x=538)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=171&width=87&top_left_y=565&top_left_x=644)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=173&width=78&top_left_y=564&top_left_x=727)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=168&width=87&top_left_y=569&top_left_x=803)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0232.jpg?height=168&width=76&top_left_y=569&top_left_x=888)

(e)
2.5-2. Test of operator length. The corresponding autocorrelogram is beneath each record. The window used in autocorrelation estimation is shown in Figure 2-5-1c. (a) Input gather. Deconvolution using prediction lag $=4 \mathrm{~ms}$ (splking deconvolution), $0.1 \%$ prewhitening, and prediction fiter operator lengths (b) $40 \mathrm{~ms}$, (c) $80 \mathrm{~ms}$, (d) $160 \mathrm{~ms}$, (e) 240 ms.

analysis of the time gate to estimate the autocorrelation function. A first gate selected may be the entire length (6s) of the record as seen in panel (a). The solid lines on the CMP gathers refer to the gate start and end times. The autocorrelogram of the record is shown at the botton of each panel. A second choice might be to exclude the deeper part of the record where ambient noise dominates. The start of the gate is chosen as the first arrival path as shown in panel (b). A third choice may be to exclude not only the deeper portion, but also the early part of the record that contains energy corresponding to the guided waves as shown in panel (c). These waves travel within the water layer and are not part of the signal reflected from the substrata.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=621&width=113&top_left_y=118&top_left_x=81)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=614&width=89&top_left_y=124&top_left_x=187)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=612&width=81&top_left_y=120&top_left_x=269)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=612&width=161&top_left_y=117&top_left_x=348)

(d) (e)

2.5-3. Test of prediction lag. The corresponding autocorrelogram is beneath each record. The window used in autocorrelation estimation is shown in Figure 2.5-1c. (a) Input gather. Deconvolution using prediction filter operator length $=160 \mathrm{~ms}, 0.1$ percent prewhitening, and prediction lags (b) $12 \mathrm{~ms}$, (c) $32 \mathrm{~ms}^{2}$ (d) $64 \mathrm{~ms}$, (e) $128 \mathrm{~ms}$.

By comparing the autocorrelograms from these different windows, note that the third choice best represents the reverberatory character of the data as shown in panel (c) over most of the offsets. All of the traces in the autocorrelogram within approximately the first $150 \mathrm{~ms}$ have a common appearance. This early portion of the autocorrelogram characterizes the basic seismic wavelet contained in the data.

In general, the autocorrelation window should include part of the record that contains useful reflection signal, and should exclude coherent or incoherent noise. An autocorrelation function contaminated by noise is undesirable since the deconvolution process is most effective on noise-free data (assumption 4).

Another aspect of the autocorrelation window is length. Panel (d) of Figure 2.5-1 shows the autocorrel-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=619&width=119&top_left_y=119&top_left_x=537)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=619&width=80&top_left_y=119&top_left_x=653)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=612&width=161&top_left_y=125&top_left_x=729)

(c) (d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0233.jpg?height=614&width=86&top_left_y=124&top_left_x=888)

(e)
2.5-4. Test of percent prewhitening, The corresponding autocorrelogram is beneath each record. The window used in autocorrelation estimation is shown in Figure 2.5-1c. (a) Input gather. Deconvolution using prediction filter operator length $=160 \mathrm{~ms}$, prediction lag $=4 \mathrm{~ms}$ (spiking deconvolution), and percent prewhitening (b) I percent, (c) 4 percent, (d) 16 percent, (e) 32 percent.

ogram estimated from a narrow window. The autocorrelogram estimated from the narrower part of the time gate (the right side of the record) in some data cases may lack the characteristics of the reverberations, and even those of the basic seismic wavelet.

In general, any autocorrelation function is biased; that is, the first lag value is computed from, say, $n$ nonzero samples, the second lag value is computed from $n-1$ nonzero samples, and so on. If $n$ is not large enough, then there can be an undesirable biasing effect. How large should the data window be to avoid such biasing? If the largest autocorrelation lag used in designing the deconvolution operator were $m$, an accepted rule of
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0234.jpg?height=1020&width=684&top_left_y=118&top_left_x=174)

2.5-5. (a) A common-shot gather, (b) after muting gulded waves, (c) after $t^{2}$-scaling, and (d) after spiking deconvolution using an operator length of 320 ms. The amplitude spectra (top) averaged over the shot record, and the autocorrelograms (bottom) are used to to choose deconvolution parameters and evaluate the data after the application of deconvolution.
thumb is that the number of data samples should be no less than $8 \mathrm{~m}$.

Now that the autocorrelation window is determined, we examine operator length. In Figure 2.5-2, prediction lag ( $4 \mathrm{~ms}$, the same as the sampling rate) and percent prewhitening $(0.1 \%)$ are fixed. The autocorrelograms (at the bottom of each gather) are displayed for diagnostic purposes. From the analyses of the single spike, sparse spike, and reflectivity models (Section 2.4), recall that the short ( $40-\mathrm{ms})$ operator leaves some residual energy that corresponds to the basic wavelet and reverberating wavetrain in the record. For a spiking deconvolution with a $160-\mathrm{ms}$-long operator, no remnant ot the energy is associated with the basc wavelet and reverberations. Any operator longer than $160 \mathrm{~ms}$ does not change the resuit, significantly. From the output of the $160-\mathrm{ms}$ operator, note that the prominent reflections (at 1.1, 1.35, 1.85, and $2.15 \mathrm{~s}$ at the near-offset) have been uncovered, the seismic wavelet has been compressed, and the reverberations have been significantly suppressed.

The effect of prediction lag now is examined. In Figure $2.5-3$, the $160-\mathrm{ms}$ operator length and $0.1 \%$ prewhitening are fixed, while prediction lag is varied. If prediction lag were increased, the deconvolution process would be increasingly less effective in broadening the spectrum, and the autocorrelograrns would contain increasingly more energy at nonzero lags. In the extreme, the deconvolution process is ineffective with a $128-\mathrm{ms}$ prediction lag. In practice, common values for the prediction lag are unity (spiking deconvolution) or the first or second zero crossing of the autocorrelation function (predictive deconvolution).

Finally, the percent of prewhitening is varied, while the 4 -ms prediction lag and $160-\mathrm{ms}$ operator length are fixed. These tests are shown in Figure 2.5-4. By increasing the percent prewhitening, the deconvolution process becomes less effective. The high end of the spectrum is not flattened as much as the rest of the spectrum (Figure 2.4-24). Note that the autocorrelograms contain increasingly more energy at nonzero lags with increasing percent prewhitening. In practice, it is not advisable to assign a large percent of prewhitening. Typically, a value between 0.1 and 1 percent is sufficient to ensure stability in designing the deconvolution operator (equation 2-32)

We now examine the effect of operator length and prediction lag on amplitude spectrum. Figure 2.5-5a shows a common-shot gather with its autocorrelogram and average amplitude spectrum. The field record is prepared for deconvolution by first muting the guided waves (Figure 2.5-5b) and applying $t^{2}$-scaling (Figure 2.5-5c). Figure 2.5-5d shows the same record after spiking deconvolution. Note the flattening of the spectsum
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0235.jpg?height=774&width=418&top_left_y=126&top_left_x=549)

(a) (b)

(c)

FIG. 2.5-6. The shot record in Figure $2.5-5 \mathrm{c}$ after predictrve deconvolution using an operator length of $320 \mathrm{~ms}$ and a prediction lag of: (a) unit-prediction, (b) $8 \mathrm{~ms}$, and (c) $24 \mathrm{~ms}$. The amplitude spectra (top) averaged over the shot record, and the autocorrelograms (bottom) are used to to choose deconvolution parameters and evaluate the data after the application of deconvolution.

within the passband of the recorded data and attenuation of the energy at nonzero lags of the autocorrelogram. With prediction lag greater than unity (Figure 2.5-6), for the same operator length, we note insufficient flattening at the high-frequency end of the spectrum. At larger prediction lags, note the insufficient flattening at
the low-frequency end of the spectrum. A very large prediction lag causes the amplitude spectrum of the deconvolved data remain similar to that of the input data (compare Figures 2.5-6c with 2.5-5c).

The data sometimes must be preconditioned for deconvolution. If the data were too noisy, then a wide band-pass filter could be necessary before deconvolution. If there is significant coherent noise in the data, dip filtering (Sections 6.2 and 6.3 ) can be applied before deconvolution so that coherent noise is not included in the autocorrelation estimate. Alternatively, time-variant spectral whitening (Section 2.6) can be applied to balance the spectrum before deconvolution.

## Signature Deconvolution

In marine seismic exploration, the far-fleld signature of the source array can be recorded. The idea is to apply a deterministic deconvolution to remove the source signature, then to apply predictive deconvolution. The convolutional model is given by

$$
x(t)=s(t) * w(t) * e(t)
$$

where $s(t)$ is the source signature recorded in the farfield just before it travels down into the earth, which has an impulse response $e(t)$. Since $s(t)$ is recorded, an inverse filter can be deterministically designed, is discussed in Section 2.2, then applied to the recorded seismogram to remove it from equation (2-41). The unknown wavelet $w(t)$ includes the propagating effects in the earth and the response of the recording system. This remaining wavelet then is removed by the statistical method of spiking deconvolution as discussed in Section 2.3. Compare equation (2-41) with equation (2-3a) and note that the old $w(t)$ of equation (2-3a) is split into two parts the source signature $s(t)$, which is the known component, and the new $w(t)$, which is the unknown component.

There are two ways to handle $s(t)$. One way is to convert it to its minimum-phase equivalent followed by predictive deconvolution (Figure 2.5-7). Another way is to convert $s(t)$ into a spike followed by predictive deconvolution (Figure 2.5-8). The process involves the following steps:

(a) Estimate the minimum-phase equivalent of the recorded source signature by computing the spiking deconvolution operator (equation 2-39) and taking its inverse.

(b) Design a shaping filter to convert the source signature to its minimum-phase equivalent or a zerodelay spike (equation 2-30).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0236.jpg?height=612&width=192&top_left_y=114&top_left_x=538)

(a) (b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0236.jpg?height=610&width=78&top_left_y=116&top_left_x=728)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0236.jpg?height=610&width=80&top_left_y=116&top_left_x=808)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0236.jpg?height=611&width=76&top_left_y=116&top_left_x=888)

(e)

FIG. 2.5-7. Signature processing. A shaping filter is designed to convert the recorded signature $[s(t)$ in equation (2-41)] to its minmum-phese equivalent and applied to the input record (a). The output (b) has the same bandwidth as the input (a). The output (b) then has been processed by predictive deconvolution using operator length of $160 \mathrm{~ms}$, and prediction lags of (c) $4 \mathrm{~ms}$ (spiking deconvolution), (d) $12 \mathrm{~ms}$, (e) $32 \mathrm{~ms}$. Exarnine the autocorrelograms (bottom) and note that those of (a) and (b) should be identical.

(c) Apply the shaping filter to each trace in each recorded shot record.

(d) Apply predictive deconvolution to output data from step (c).

The results shown in Figures 2.5-7 and 2.5-8 (panels (c)) should be compared with single-step statistical deconvolution (Figure 2.5-9). Since the source was not minimum-phase in this case, Figure 2.5-9b should be better than Figure 2.5-9d. Is it?

Actually, results of signature processing depend on the accuracy of the recorded signature. One should

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0237.jpg?height=594&width=406&top_left_y=124&top_left_x=91)

FIG, 2.5-8. Signature processing. A shaping filter is desugned to convert the recorded signature $(s(t)$ in equation 2-41) to a spike and applied to the input record (a). The output (b) then has been processed by predictive deconvolution using an operator length of $160 \mathrm{~ms}$ and prediction lags of (c) $4 \mathrm{~ms}$ (spiking deconvolution), (d) $12 \mathrm{~ms}$, and (e) $32 \mathrm{~ms}$. Note from the autocorrelograms (bottom) that the out put from signature processing (b) still contains a wavelet component the $w(t)$ component in equation (2-41), that still needs to be removed.

avoid signature processing of old marine data unless there exists a concurrently recorded source signature. Contemporary marine data almost always include the recorded source signature at each shot location. Figure 2.5-10a shows a recorded water-gun signature with its amplitude and phase spectra. The minimum-phase equivalent is shown in Figure 2.5-10b, and the result of signature deconvolution to convert the recorded waveform to its minimum-phase equivalent is shown in Figure 2.5-10c. While the amplitude spectrum is unaltered, the phase spectrum is minimum phase.

Application of signature processing described in Figure 2.5-10 to a recorded shot gather is shown in Figure 2.5-11. Again, note that signature processing

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0237.jpg?height=604&width=102&top_left_y=116&top_left_x=565)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0237.jpg?height=602&width=82&top_left_y=118&top_left_x=676)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0237.jpg?height=601&width=86&top_left_y=119&top_left_x=761)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0237.jpg?height=602&width=79&top_left_y=118&top_left_x=852)

(d)

FIG. 2.5-9. Signature processing compared with statistical deconvolution. (a) Input shot record. (b) A shaping filter is designed to convert the recorded signature $(s(t)$ in equation 2-41) to its minimum-phase equivalent and applied to the input record followed by spiking deconvolution. (This panel is the same as Figure 2.5-7c.) (c) A shaping filter is designed to convert the recorded signature $(s(t)$ in equation $2-41)$ to a spike and applied to the input record followed by spiking deconvolution. (This panel is the same as Figure 2.5-8c.) (d) Spiking deconvolution of the input record (a). The autocorrelograms (bottom) suggest that the wavelet compression is achieved in all three cases, (b), (c) and (d).

aimed at converting the recorded source signature to its minimum-phase equivalent leaves the amplitude spectrum and autocorrelogram of the shot record unaltered (Figures 2.5-t1a,b). We can also observe from the corresponding CMP-stacked sections that the process has not made any impact on the degree of vertical resolution; only a change in phase has taken place (Figure 2.5-12). Following the deterministic step of Figure 2.5$11 \mathrm{~b}$, statistical deconvolution is applied to flatten the spectrum (Figure 2.5-11c).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0238.jpg?height=568&width=418&top_left_y=116&top_left_x=80)

FIG. 2.5-10. (a) A water-gun source signature and its amplitude and phase spectra (top and middle graphs), (b) its minimum-phase equivalent, and (c) the ouput of signature processing to convert (a) to (b).

## Vibroseis Deconvolution

The vibroseis source is a long-duration sweep signal in the form of a frequency-modulated sinusoid that is tapered on both ends. Just as a convolutional model was proposed for the marine seismogram given by equation (2-41), a similar convolutional model can be proposed for the vibroseis seismogram

$$
x(t)=s(t) * w(t) * e(t),
$$

where $x(t)$ is the recorded seismogram, $s(t)$ is the sweep signal, $w(t)$ is the seismic wavelet with the same meaning as in equation (2-41), and $e(t)$ is the earth's impulse response. Convolutions in equation (2-42) become multiplications in the frequency domain:

$$
X(\omega)=S(\omega) W(\omega) E(\omega)
$$

In terms of amplitude $A(\omega)$ and phase $\phi(\omega)$ spectra, equation (2-43) yields

$$
A_{z}(\omega)=A_{s}(\omega) A_{\omega}(\omega) A_{c}(\omega)
$$

and

$$
\phi_{x}(\omega)=\phi_{s}(\omega)+\phi_{w}(\omega)+\phi_{e}(\omega)
$$

Crosscorrelation of the recorded seismogram $x(t)$ with the sweep signal $s(t)$ is equivalent to multiplying equation (2-44a) by $A_{s}(\omega)$ and subtracting $\phi_{s}(\omega)$ from equation (2-44b). The correlated vibroseis seismogram $x^{t}(t)$ therefore would have the following amplitude and phase spectra:

$$
A^{\prime}(\omega)=A_{s}^{2}(\omega) A_{w}(\omega) A_{e}(\omega) \quad(2-45 a)
$$

and

$$
\phi^{\prime}(\omega)=\phi_{w}(\omega)+\phi_{e}(\omega)
$$

The inverse Fourier transform of $\boldsymbol{A}_{s}^{2}(\omega)$ yields the autocorrelation of the sweep signal, which is called the Klauder wavelet $k(t)$. Returning to the time domain, equations $(2-45 \mathbf{a}, \mathbf{b})$ yield

$$
x^{\prime}(t)=k(t) * w(t) * e(t)
$$

Figure 2.5-13 outlines the process of vibroseis correlation where the seismic wavelet $w(t)$ has been omitted for convenience. Note that, following vibroseis correlation, the sweep $s(t)$ contained in the recorded seismogram $x(t)$ is replaced with its autocorrelogram the Klauder wavelet $k(t)$.

Since it is an autocorrelation, the Klauder wavelet is zero-phase. Convolution of $k(t)$ with the assumingly minimum-phase wavelet $w(t)$ yields a mixed-phase wavelet. Because spiking deconvolution is based on the minimum-phase assumption, it cannot recover $e(t)$ properly from vibroseis data.

One approach to deconvolution of vibroseis data is to apply a zero-phase inverse filter to remove $k(t)$, followed by a minimum-phase deconvolution to remove $w(t)$. The amplitude spectrum of the inverse filter is defined as $1 / A_{s}^{2}(\omega)$. In practice, problems arise because of zeroes in the spectrum that are caused by the bandlimited nature of the Klauder wavelet. Inversion of an amplitude spectrum, which has zeroes, yields an unstable operator (Section 2.3). To circumvent this problem, a small percent of white noise, say $0.1 \%$, usually is added before inverting the Klauder wavelet spectrum.

Another approach is to design a filter that converts the Klauder wavelet to its minimum-phase equivalent (Ristow and Jurczyk, 1975). A technique to compute the minimum-phase spectrum from a given amplitude spectrum is described in Section B. 4 and is included in the discussion on frequency-domain deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0239.jpg?height=1036&width=848&top_left_y=170&top_left_x=73)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0240.jpg?height=621&width=449&top_left_y=118&top_left_x=81)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0240.jpg?height=614&width=418&top_left_y=124&top_left_x=536)

(b)

FIG. 2.5-12. (a) A portion of a CMP-stacked section that corresponds to the data in Figure 2.5-11a, and (b) after signature processing of shot records as in Figure 2.5-11b to convert the recorded water-gun signature to its minimum-phase equivalent as described in Figure 2.5-10. Note that signature processing was not aimed at wavelet compression; instead, it was done to convert the source signature to its minimum-phase equivalent.

$$
\begin{aligned}
& \text { Vibroseis correlation } \\
& \begin{array}{l}
\text { correlation } \\
x(t)=s(t) * e(t) \rightarrow\left\{\begin{array}{l}
A_{s}(\omega) A_{e}(\omega) \\
\phi_{s}(\omega)+\phi_{c}(\omega)
\end{array}\right\}
\end{array} \\
& \text { crosscorrelate } \\
& \text { with sweep } \\
& \downarrow \\
& e(t): \text { reflectivity } \quad x^{\prime}(t)=k(t) * e(t) \leftarrow\left\{\begin{array}{r}
A_{s}^{2}(\omega) A_{e}(\omega) \\
\phi_{e}(\omega)
\end{array}\right\} \\
& s(t) \text { : sweep } \\
& \boldsymbol{x}(t) \text { : uncorrelated vibroseis data } \\
& x^{\prime}(t) \text { : correlated vibroseis data } \\
& \boldsymbol{k}(t) \text { : Klauder wavelet }
\end{aligned}
$$

FIG. 2.5-13. An outline of vibroseis correlation.
If the Klauder wavelet were converted to its minimumphase equivalent, then equation (2-45b) would take the form:

$$
\phi^{\prime}(\omega)=\phi_{k}(\omega)+\phi_{\omega}(\omega)+\phi_{e}(\omega) \text {. }
$$

If we assume that $w(t)$ is minimum-phase and if we make $\boldsymbol{k}(t)$ minimum-phase, then the result of their convolution also is minimum-phase. Spiking deconvolution now is applicable since the minimum-phase assumption is satisfied.

There is a 90-degree phase difference in some vibrator systems between the control sweep signal and the baseplate response. As an option, we may want to subtract out this phase difference. Figure 2.5-14 shows the recommended sequence of operations for vibroseis processing.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0241.jpg?height=315&width=404&top_left_y=116&top_left_x=93)

2.5-14. A flowchart for vibrose is deconvolution.

Figure 2.5-15 shows how the flowchart in Figure $2.5-14$ is used with a synthetic reflectivity series. By including the step to convert the Klauder wavelet into its minimum-phase equivalent before spiking deconvolution, a closer representation of the impulse response is produced as seen by comparing steps (k) and (l) with (m).

Although sound in theory, the above scheme may have problems in practice. Fundamental issues, such as whether the convolutional model given in equation (242) really represents what goes on in the earth, are not resolved.

Vibroseis data often are deconvolved as dynamite data, without converting the Klauder wavelet to its minimum-phase equivalent. An example of deconvolution of a correlated vibroseis record is shown in Figure 2.5-16.

Despite the fact that the basic minimum-phase assumption is violated for vibroseis data as compared to explosive data, spiking deconvolution without conversion of the Klauder wavelet to its minimum-phase equivalent seems to work for most field data. Figure 2.5-17 shows a set of correlated vibroseis records before and after spiking deconvolution. Prominent reflections after deconvolution are enhanced and reverberations are atteruated significantly. Nonetheless, the problem of tying vibrator lines to lines recorded with other sources, say dynamite, is more difficult if the vibrator data have not been phase-corrected. Field systems now exist to do minimum-phase vibroseis correlation in the field.

## Poststack Deconvolution

Poststack deconvolution often is considered for several reasons. First, a residual wavelet almost always is present on the stacked section. This is because none of the underlying assumptions for deconvolution is completely met in real data; therefore, deconvolution never can completely compress the basic wavelet contained in prestack data to a spike. Second, since a CMP stack is an approximation to the zero-offset section, predictive deconvolution aimed at removing multiples may be a viable process after stack. Figure 2.5-18 is an example of poststack deconvolution applied to marine data. After deconvolution, the spectrum is flattened, albeit incompletely, the wavelet is compressed further and the marker horizons are better characterized. Again, as the prediction lag is increased, the flatness character of the spectrum and thus vertical resolution is increasingly compromised (Figure 2.5-19),

Figure 2.5-20 shows poststack deconvolution applied to land data. Note the significant improvement in vertical resolution as it can be verified by the autocorrelogram and average amplitude spectrum of the data.

### 2.6 THE PROBLEM OF NONSTATIONARITY

Figure 2.6-1 shows a CMP gather and its filtered versions before deconvolution. The filter scans show that there is signal between 10 to $40 \mathrm{~Hz}$. Note that higher frequencies are confined to the shallower part of the gather. The same field record after spiking deconvolution is shown in Figure 2.6-2. Filter scans of the deconvolved record also are shown in this figure. A comparison of the records before and after deconvolution (Figures 2.61 and 2.6-2) demonstrates the effects of the process; in particular, compression of the wavelet and broadening of the spectrum. The input signal level above $40 \mathrm{~Hz}$ is relatively weaker than that below $40 \mathrm{~Hz}$. Deconvolution has attempted to reduce the differences between the signal levels within different frequency bands by flattening the spectrum. The flattening, however, was more effective in the shallow part of the record than in the deeper part.

As discussed in Sections 1.4 and 2.1, the source wavelet is not statronary its shape and bandwidth change with traveltime (Figure 2.1-2). Specifically, attenuation of high frequencies in the wavelet increases as waves travel deeper in the subsurface. Although multiwindow deconvolution was used in this case (Figure 2.62), spectral flattening was not achieved over the entire length of the record because of the large degree of nonstationarty of the data. Nonstationarity is primarily the result of the effects of wavefront divergence and frequency attenuation.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0242.jpg?height=988&width=672&top_left_y=187&top_left_x=144)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0243.jpg?height=775&width=205&top_left_y=135&top_left_x=125)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0243.jpg?height=668&width=175&top_left_y=134&top_left_x=336)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0243.jpg?height=668&width=181&top_left_y=142&top_left_x=518)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0243.jpg?height=777&width=199&top_left_y=135&top_left_x=713)

(d)

2.5-16. Deconvolution of a vibroseis record. Three windows were used. (a) Correlated vibrosels record and its autocorrelograms (b); (d) spiking deconvolution output and its autocorrelograms (c).

The phenomenon of nonstationarity on stacked data is exemplified in Figure 2.6-3. Following a singlegate poststack spiking deconvolution, note that the average amplitude spectrum of the data does not indicate a flat spectrum (Figure 2.6-3b). Instead, the spectrai behavior is similar to data with predictive deconvolution with a large predictions lag (Figure 2.6-3c). The strong reflector in the neighborhood of $2.5 \mathrm{~s}$ separates the zone with two different bandwidths a broad-band signal zone above, and a relatively narrow-band zone below.

The usual approach to reduce nonstationarity is to apply processes designed to compensate for the effects wavefront divergence and frequency attenuation before deconvolution. Wavefront divergence is corrected for by applying a geometric spreading function (Section 1.4). As yet a method to compensate for attenuation has not been discussed. Attenuation is measured by a quantity
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0244.jpg?height=888&width=880&top_left_y=116&top_left_x=74)

2.5-17. (a) Common-shot gathers recorded with vibroseis source. Geornetric spreading correction and trace balancing have been applied. (b) After spiking deconvolution.

called the quality factor $Q$. An infinite $Q$ means that there is no attenuation. This factor can change in depth and in the lateral direction. If we had an analytic form for an attenuation function, then it would be easy to compensate for its effect. Several models for $Q$ have been proposed. The constant- $Q$ model is quite plausi- ble and the easiest to deal with (Kjartannson, 1979). However, the big problem of estimating $Q$ from seismic data still remains. If a reliable $Q$ value is available, say from borehole measurements, then, as will be discussed later in this section, inverse $Q$ filtering can be applied to data to compensate for the frequency attenuation.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=433&width=173&top_left_y=117&top_left_x=157)

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=430&width=150&top_left_y=117&top_left_x=316)

(b)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=428&width=146&top_left_y=119&top_left_x=454)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=428&width=148&top_left_y=118&top_left_x=591)

(d)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=428&width=144&top_left_y=118&top_left_x=726)

(e)

2.5-18. (a) A portion of s CMP-stacked section, and after spiking deconvolution using an operator length of: (b) $120 \mathrm{~ms}$, (b) $160 \mathrm{~ms}$, (c) $220 \mathrm{~ms}$, and (d) $320 \mathrm{~ms}$. Note from the autocorrelograms (bottom) that much of the reverberating energy is attenuated using a $320-\mathrm{ms}$ operator length. The amplitude spectra averaged over the CMP stack (top) indicate that, irrespective of how long the operator length is, spiking deconvolution in this case has failed to flatten the spectrum completely within the passband. This is because of nonstationarity of the signal.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=426&width=172&top_left_y=697&top_left_x=157)

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=424&width=142&top_left_y=696&top_left_x=324)

(b)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=422&width=146&top_left_y=698&top_left_x=454)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=418&width=138&top_left_y=698&top_left_x=592)

(d)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0245.jpg?height=444&width=142&top_left_y=698&top_left_x=728)

2.5-19. A portion of a CMP-stacked section as in Figure 2.5-7a after predictive deconvolution using an operator length of 320 ms and a prediction lag of: (a) $8 \mathrm{~ms}$, (b) $12 \mathrm{~ms}$, (c) $24 \mathrm{~ms}$, (d) $32 \mathrm{~ms}$, and (e) $48 \mathrm{~ms}$. The amplitude spectra (top) averaged over the CMP stack, and the autocorrelograms (bottom) are used to to choose deconvolution parameters and evaluate the dats after the application of deconvolution.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0246.jpg?height=768&width=238&top_left_y=118&top_left_x=81)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0246.jpg?height=138&width=128&top_left_y=116&top_left_x=304)

$\cdots$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0246.jpg?height=606&width=194&top_left_y=280&top_left_x=317)

(b)

2.5-20. (a) A portion of a CMP-stacked section, and (b) after spiking deconvolution using an operator length of 240 ms. The amplitude spectra (top) averaged over the CMP stack, and the autocorrelograms (bottom) are used to choose deconvolution parameters and evaluate the data after the application of deconvolution.

## Time-Variant Deconvolution

Nonstationarity was discussed in Sections 1.4 and 2.1. The time-variant character of the seismic wavelet (Figure 2.1-2) often requires a multiwindow deconvolution. Figure $2.6-4$ is a field record that was deconvolved

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0246.jpg?height=345&width=406&top_left_y=116&top_left_x=548)

2.6-1. A field record (far left panel) with its band-pass filtered versions.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0246.jpg?height=354&width=416&top_left_y=545&top_left_x=546)

2.6-2. Spiking deconvolution applied to the field record in Figure 2.6-1 (far left panel), followed by application of a series of band-pass filters.

by using three time gates. The sutocorrelograms from gates 1, 2, and 3 are shown in Figure 2.6-5. Note the difference in character of the reverberatory energy from one gate to another. The shallow gate (1) has more highfrequency signal than the middle gate (2); while the middle gate has more high-frequency signal than the deeper gate (3). For best results, we must design different deconvolution operators from different parts of the record and apply them to the corresponding time gates. Up to three windows usually are sufficient to handle the nonstationary character of the seismic signal.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0247.jpg?height=154&width=666&top_left_y=118&top_left_x=156)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0247.jpg?height=768&width=322&top_left_y=317&top_left_x=93)

(a) isi 10 an: +20
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0247.jpg?height=762&width=256&top_left_y=324&top_left_x=422)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0247.jpg?height=9&width=71&top_left_y=319&top_left_x=684)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0247.jpg?height=758&width=256&top_left_y=327&top_left_x=684)

(c)

2.6-3. (a) A portion of a CMP-stacked section with its amplitude spectrum averaged over the CMP range (top) and autocorrelogram (bottom); (b) after time-invariant spiking deconvolution; and (c) after time-invariant predictive deconvolution with a prediction lag of $24 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0248.jpg?height=712&width=185&top_left_y=115&top_left_x=167)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0248.jpg?height=710&width=164&top_left_y=116&top_left_x=358)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0248.jpg?height=710&width=163&top_left_y=116&top_left_x=527)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0248.jpg?height=709&width=169&top_left_y=116&top_left_x=697)

(d)

2.6-4. Three-window deconvolution. The solid bars indicate window boundaries. With data from each window, a deconvolution operator is designed and spplied to the data in that window. The operators are blended across the window boundaries. (a) Input gather. Deconvolution using operator length of $160 \mathrm{~ms}$ and prediction lags of (b) $4 \mathrm{~ms}$, (c) $12 \mathrm{~ms}$, (d) $32 \mathrm{~ms}$.

Another example of single- and multiwindow deconvolution is shown in Figures 2.6-6 and 2.6-7. Here, autocorrelograms from different gates do not show significant variations. Therefore, it probably does not make any difference whether a single or multigate deconvolution is used. In Figures 2.6-6 and 2.6-7, the record is shown after deconvolution followed by a wide bandpass filter application. Since the amplitude spectrum of the input data is flattened as a result of spiking deconvolution, both the high-frequency ambient noise as much as the high-frequency components of the signal are boosted. Therefore, the output of spiking deconvolution often is filtered with a wide band-pass operator.

A practical problem with time-variant deconvolution is limiting design gates to small time windows. Consider, for instance, a three-window deconvolution of a 5$\mathbf{s}$ data. This means that at best an average gate kength of $1.5 \mathrm{~s}$ at near offset and less than $1 \mathrm{~s}$ at far offset can be used to design a deconvolution operator. To attain good statistics in an autocorrelation estimate, an operator length no more than one-eighth to one-tenth of the design gate, say $150 \mathrm{~ms}$, should be considered. Hence, if
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0249.jpg?height=760&width=780&top_left_y=161&top_left_x=72)

ล

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0249.jpg?height=284&width=687&top_left_y=932&top_left_x=77)

$\Xi$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0250.jpg?height=838&width=206&top_left_y=134&top_left_x=122)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0250.jpg?height=297&width=190&top_left_y=116&top_left_x=327)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0250.jpg?height=844&width=184&top_left_y=127&top_left_x=524)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0250.jpg?height=842&width=203&top_left_y=128&top_left_x=716)

(d)

2.6-6. Spiking deconvolution (c) on a shot record (a) followed by bend-pass filtering (d). (b) Autocorrelograms before and after deconvolution.

you need to use a longer operator, time-variant deconvolution may have limited effectiveness in attenuating reverberations and short-period multiples. A way to account for nonstationarity while avoiding the shortoperator effect of multiwindow deconvolution follows.

## Time-Variant Spectral Whitening

Frequency attenuation and a way to compensate for it are illustrated in Figure 2.6-8. Let us assume that we have an input seismogram with amplitudes decaying in

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0251.jpg?height=730&width=181&top_left_y=118&top_left_x=137)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0251.jpg?height=730&width=162&top_left_y=118&top_left_x=345)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0251.jpg?height=730&width=161&top_left_y=118&top_left_x=528)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0251.jpg?height=730&width=173&top_left_y=118&top_left_x=718)

(d)

FIG. 2.6-7. Three-window deconvolution on the same shot record as in Figure 2.6-6. In this case, there is no significant difference between the characters of the autocorrelograms estimated from three windows. (a) Input gather; (b) autocorrelograms before and after spiking deconvolution; (c) three-window spiking deconvolution on (a); (d) band-pass filtering on (c).

time, as depicted. Now apply a series of narrow bandpass filters to this trace. Examine the field record in Fig. ure $2.6-1$ and associate the filter panels with the traces sketched in Figure 2.6-8. Note that the low-frequency component of trace $F_{L}$ has a lower decay rate than the moderate-frequency component $F_{M}$. Likewise, the moderate-frequency component $F_{M}$ has a lower decay rate than the high-frequency component of the signal $F_{H}$. A series of gain functions, such as $G_{1}, G_{2}, G_{3}$, can be computed to describe the decay rates for each frequency band. This is done by computing the envelope of the band-pass filtered traces (Figure 2.6-8). The inverses of these gain functions then are applied to each frequency band and the results are summed. The amplitude spectrum of the resulting trace has thus been whitened in a time-variant manner. This time-variant spectral whitening process is outlined in Figure 2.69. The number of the filter bands, the width of each band, and the overall bandwidth of application of timevariant spectral whitening are parameters that can be prescribed for a particular application.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0252.jpg?height=378&width=418&top_left_y=115&top_left_x=82)

2.6-8. A schematic illustration of the rate of decay of the frequencies in a seismic trace (Gibson and Larner, 1982).

Figures 2.6-10 and 2.6-11 show some field records before and after spiking deconvolution, respectively. Note that this process not only has compressed the wavelet, but also has tried to suppress any reverberations in the data. Refer to Figure 2.6-12 and note that time-variant spectral whitening mainly has compressed the wavelet without changing much of the ringy character of the data. Also note that little was done explicitly to the phase. Therefore, the action of time-variant spectral whitening may be close to a zero-phase deconvolution, although there is no rigorous theoretical proof of this.

In practice, one of the main differences between time-variant spectral whitening and conventional deconvolution is that the former seems to be able to do a better job of flattening the amplitude spectrum. This difference can be significant for broad-band data with large dynamic range.

Time-variant spectral whitening sometimes helps attenuate ground roll on land records by way of its spectral balancing effect. Note that, in Figure 2.6-13, spiking deconvolution with different operator lengths has failed to flatten the spectrum, sufficiently. On the other hand, following spiking deconvolution, application of time-variant spectral whitening has balanced the spectrum and thus attenuated the ground-roll energy.

The ability of time-variant spectral whitening in flattening the spectrum within the passband of stacked data is observed in Figure 2.6-14. Note that spiking deconvolution is fairly effective, but not sufficient, for attaining a flat spectrum (Figure 2.6-14b). Following

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0252.jpg?height=262&width=319&top_left_y=115&top_left_x=592)

2.6-9. A flowchart for time-variant spectral whitening.

time-variant spectral whitening, the spectrum is flattened within the passband of the data as seen in Figure 2.6-14c.

It is a requirement to prepare stacked data input to amplitude inversion with the broadest possible bandwidth and flattest possible spectrum. Hence, a processing sequence tailored for amplitude inversion almost always includes poststack deconvolution and time-variant spectral flattening steps.

## Frequency-Domain Deconvolution

Spectral flattening can be achieved by an alternate approach in the frequency domain. As discussed in Section B.4, minimum-phase spiking deconvolution can be formulated in the frequency domain. Alternatively, we can flatten the amplitude spectrum without modifying the phase. This is called zero-phase frequency-domain deconvolution. When performed over multiple time gates down the trace, it is essentially equivalent to timevariant spectral flattening. If we only want to flatten the spectrum, then the approach shown in Figure 2.615 can be taken.

Although the domains of operations may differ, both minimum-phase frequency-domain and WienerLevinson deconvolution techniques should yield equivalent results. Differences between the results shown in Figures 2.6-11 and 2.6-16 mainly are due to their computational aspects.

The zero-phase frequency-domain deconvolution aimed at achieving time-variant spectral whitening requires partitioning the input seismogram into smail time gates, as well as designing and applying the process described in Figure 2.6-15 to each gate, individually. Figure 2.6-17 shows the field records after zero-phase frequency-domain deconvolution. The output is comparable to the time-variant spectral flattening output shown in Figure 2.6-12.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0253.jpg?height=857&width=746&top_left_y=114&top_left_x=144)

FIG. 2.6-10. CMP gathers with no deconvolution.

## Inverse $Q$ Filtering

Frequency attenuation caused by the intrinsic attenuation in rocks was discussed in Sections 1.4 and 2.1 . Attenuation causes loss of high frequencies in the propgating waveform with increasing traveltime. This gives rise to a nonstationary behavior in the shape of the wavelets arsociated with reflection events at different times.
Wave attenuation usually is described by a dimensionless factor $Q$, which is defined by the ratio of the mean stored energy to the energy loss over a period of time that is equivalent to one cycle of a frequency component of the waveform (Kjartansson, 1979). Timevariant deconvolution and time-variant spectral whitening discussed in this section are proceses that can correct for the time-varying effects of attenuation by spectral flattening. A deterministic alternative to compen-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0254.jpg?height=893&width=776&top_left_y=114&top_left_x=125)

FIG. 2.6-11. Spiking deconvolution applied to the CMP gathers in Figure 2.6-10.

sate for frequency-dependent attenuation is provided by inverse $Q$ filtering.

The amplitude spectrum of the inverse $Q$ filter is given by (Section B.9)

$$
A(\omega, \tau)=\exp \left(\frac{\omega \tau}{2 Q}\right)
$$

where $\omega$ is the angular frequency component associated with the input trace and $\tau$ is the time variable associated with the output trace from inverse $Q$ filtering. The phase spectrum of the inverse $Q$ filter usually is assumed to be minimum-phase, which can be computed by taking the Hilbert transform of the amplitude spectrum (Section B.4).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0255.jpg?height=988&width=850&top_left_y=117&top_left_x=91)

FIG. 2.6-12. Time-variant spectral whitening (TVSW) applied to the CMP gathers in Figure 2.6-10. Compure this with Figures 26-11, 2.6-16, and 2.6-17.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0256.jpg?height=1053&width=858&top_left_y=151&top_left_x=71)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0257.jpg?height=661&width=723&top_left_y=115&top_left_x=157)

FIG. 2.6-14. (a) A portion of a CMP stack and its amplitude spectrum averaged over the CMP range (top) and autocorrelogram (bottom); (b) after spiking deconvolution, (c) followed by time-variant spectral whitening, and (d) time-variant filtering.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0257.jpg?height=306&width=383&top_left_y=868&top_left_x=94)

FIG. 2.6-15. A flowchart for a frequency-domain deconvolution.
Application of the inverse $Q$ filter requires knowledge of the attenuation factor $Q$, which usually is assumed to be constant. A compilation of laboratory measurements of $Q$ for some rock samples is given by Table 2-28.

Note from Table 2-28 that most measurements have been made at extremely high frequencies compared to the typical frequency band of seismic waves. Nevertheless, by assuming frequency-independent $Q$ factor (Kjartansson, 1979), these measurements can still be considered useful. Also note that the $Q$ factor can vary significantly for limestone, sandstone, and shale rock samples of different origin.

The inverse of the amplitude spectrum defined by equation (2-48) can be used to obtain a quantitative measure of attenuation. In terms of frequency $f$, wave

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0258.jpg?height=984&width=891&top_left_y=115&top_left_x=73)

FIG. 2.6-16. Minimum-phase frequency-domain deconvolution applied to the CMP gathers in Figure 2.6-10. Compare this with Figures 2.6-11, 2.6-12, and 2.6-17.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0259.jpg?height=1020&width=892&top_left_y=125&top_left_x=74)

FIG. 2.6-17. Zero-phase frequency-domain deconvolution applied to the CMP gathers in Figure 2.6-10. Compare this with Figures 2.6-11, 2.6-12, and 2.6-16.

Table 2-28. Intrinsic attenuation measurements in rocks (adapted from Waters, 1981).

| Rock Type | Attenuation <br> Constant, $Q$ | Frequency <br> Range (Hz) |
| :--- | ---: | ---: |
| Basalt | 550 | $3,000-4,000$ |
| Granite | 300 | $20,000-200,000$ |
| Quartzite | 400 | $3,000-4,000$ |
| Limestone I | 200 | $\mathbf{1 0 , 0 0 0 - 1 5 , 0 0 0}$ |
| Limestone II | 50 | $2-120$ |
| Limestone III | 650 | $4-18,000$ |
| Chalk | 2 | 150 |
| Sandstone I | 25 | $550-4,000$ |
| Sandstone II | 125 | 20,000 |
| Sandstone III | 75 | $2,500-5,000$ |
| Sandstone IV | 100 | $2-40$ |
| Shale I | 15 | $75-550$ |
| Shale II | 75 | $3,300-12,800$ |

velocity $v$ and depth $z=v \tau$, the inverse is

$$
A^{-1}(f, v, z, Q)=\exp \left(-\frac{\pi f z}{Q v}\right)
$$

To determine how far in depth the wave has to travel before its amplitude reduces to, say, one-tenth of its amplitude at the surface $z=0$, rewrite equation (2-49) as follows:

$$
z=\frac{2.3 Q v}{\pi f}
$$

Note that the smaller the $Q$ factor, the lower the velocity and the higher the frequency, the shallower the depth at which the wave amplitude decays to a fraction of the wave amplitude at $z=0$. Table 2-29 lists the $z$ values for a frequency of $30 \mathrm{~Hz}$ and a velocity of 3000 $\mathrm{m} / \mathrm{s}$ for a range of $Q$ values.

Table 2-29. Depth at which wave amplitude drops to one-tenth of its original at the surface for a range of $Q$ values (equation 2-50).

$v=3000 \mathrm{~m} / \mathrm{s}$

$f=30 \mathrm{~Hz}$

$Q$ Factor

Depth in $\mathrm{m}$

| 25 | 1,830 |
| ---: | ---: |
| 50 | $\mathbf{3}, 660$ |
| 100 | 7,325 |
| 250 | $\mathbf{1 8 , 3 1 2}$ |
| $\mathbf{5 0 0}$ | $\mathbf{3 6 , 6 2 5}$ |

Note that the smaller the $Q$ factor the shallower the depth at which the amplitude drops to the specified value of one-tenth of the original value at the surface $z=0$. For very large $Q$ values, that is, for small attenuation, the amplitude reduction to the specified value does not take place until the wave reaches very large depths beyond the exploration objectives.

Unfortunately, there is no reliable way to estimate the attenuation factor $Q$ directly from seismic data. At best, inverse $Q$ filtering can be applied to post- or prestack data (Section B.9) using a range of constant $Q$ factors to create a $Q$ panel, much like a filter panel (Section 1.1). The fartor that yields the flattest spectrurn in combination with other signal processing applications

deconvolution and time-variant spectral whitening, is chosen as the optimum $Q$ value.

## Deconvolution Strategies

Throughout the development of deconvolution theory, several alternatives have been proposed to better solve the deconvolution problem. Still, predictive deconvolution is used more than the other methods, although the minimum-phase and white reflectivity sequence assumptions have been key issues of concern.

Follow the common sequence for deconvolution of marine data in Figures 2.6-18 through 2.6-22. Note the presence of reverberations and short-period muitiples in the CMP-stacked data with no deconvolution applied (Figure 2.6-18). Signature processing, in this case, was done to convert the recorded source signature to its minimum-phase equivalent (Figure 2.6-19). Therefore, aside from phase, there is no difference between the sections in Figures 2.6-18 and 2.6-19. Deconvolution before stack has helped attenuate reverberations and short-period multiples and, to some extent, compressed the basic wavelet (2.6-20). The additonal step of poststack deconvolution has restored much of the high frequencies attenuated during stacking (Figure 2.6-21). Finally, time-variant spectral whitening has flattened the spectrum within the passband of the data (Figure 2.6-22) and yielded a crisp section with high resolution.

The same sequence can be followed in Figures 2.623 through 2.627. The CMP-stacked section includes reflections associated with a shallow, low-relief sedimentary strata (Figure 2.6-23). Following the signature processing (Figure 2.6-24), observe the gradual increase in the vertical resolution by prestack deconvolution (Figwe 2.6-25), poststack deconvolution (Figure 2.6-26) and time-variant spectral whitening (Figure 2.6-27).

The following formal processing sequence for deconvolution theoretically should yield optimum results:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0261.jpg?height=483&width=872&top_left_y=145&top_left_x=80)

2.6-18. A portion of a CMP-stacked section with no deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0261.jpg?height=483&width=871&top_left_y=692&top_left_x=83)

2.6-19. The section in Figure 26 -18 with signature processing to convert the recorded source signature to its minumum-phase equivalent.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0262.jpg?height=482&width=874&top_left_y=152&top_left_x=79)

2.6-20. The section in Figure 2 6-19 with prestack spiking deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0262.jpg?height=481&width=870&top_left_y=701&top_left_x=81)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0263.jpg?height=486&width=882&top_left_y=175&top_left_x=72)

2.6-22. The section in Figure 2.6-21 with time-vanant spectral whitening.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0263.jpg?height=353&width=870&top_left_y=797&top_left_x=82)

2.6-23. A portion of a CMP-stacked section with no deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0264.jpg?height=364&width=878&top_left_y=196&top_left_x=74)

2.6-24. The section in Figure 2 6-23 with signature processing to convert the recorded source signature to its minimum-phase equivalent.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0264.jpg?height=372&width=885&top_left_y=756&top_left_x=71)

2.6-25. The section in Figure $26-24$ with prestack spikng deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0265.jpg?height=358&width=872&top_left_y=210&top_left_x=80)

2.6-26. The section in Figure 2 e-25 with poststack spikıng deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0265.jpg?height=359&width=877&top_left_y=757&top_left_x=75)

2.6-27. The section in Figure 2.6-26 with time-variant spectral whitening.
(a) Apply a geometric spreading compensation function to remove the amplitude loss due to wavefront divergence.

(b) Apply an exponential gain or minimum-phase inverse $Q$ filter (Hale, 1982; Hargreaves and Calvert, 1991). This compensates for frequency attenuation.

(c) Optionally apply signature processing to marine data. For vibroseis data, apply the filter that converts the Klauder wavelet to its minimum-phase equivalent.

(d) Apply predictive deconvolution to compress the basic wavelet and attenuate reverberations and short-period multiples. If required, apply surfaceconsistent deconvolution (Section B.8). This accounts for the near-surface variations effect on the wavelet because of inhomogeneities in the vicinity of sources and receivers. In step (b), the vertical variations effect on the wavelet is handled.

(e) Apply predictive deconvolution after stack to broaden the spectrum and attenuate short-period multiples.

(f) Apply time-variant spectral whitening. This provides further flattening of the spectrum within the signal bandwidth without affecting phase.

The idea is to do as much deterministic deconvolution as posible. Inverse $Q$ filtering, signature deconvolution, and the filter that converts the Klauder wavelet to its minimum-phase equivalent are deterministic operators. Any remaining issues then are handled by statistical means. However, for most data cases, just doing the geometric spreading correction followed by predictive prestack and poststack deconvolution is adequate.

## EXERCISES

Exercise 2-1. Write the $z$-transform of wavelet $\left(1,0,-\frac{1}{4}\right)$. Design a three-term inverse filter and apply it to the original. Hint: The $z$-transform of the wavelet can be written as a product of two doublets, $\left(1,-\frac{1}{2}\right)$ and $\left(1, \frac{1}{2}\right)$.

Exercise 2-2. Consider the following set of wavelets:

Wavelet A: $(3,-2,1)$

Wavelet B: $(1,-2,3)$

(a) Plot the percent of cumulative energy as a function of time for each wavelet. Use Robinson's energy delay theorem to determine the minimum- and maximum-phase wavelet.

(b) Set up matrix equation (2-31) for each wavelet, compute the spiking deconvolution operators, then apply them. (c) Let the desired output be $(0,0,1,0)$. Set up matrix equation (2-30) for each wavelet, compute the shaping filters, and apply them. Find that the error for wavelet $B$ with the delayed spike is smaller.

Exercise 2-3. Consider wavelet A in Exercise 22. Set up matrix equation (2-32), where $\varepsilon=0.01,0.1$. Note that $\varepsilon=0$ already is assigned in Exercise 2-2. As the percent prewhitening increases, the spikiness of the deconvolution output decreases.

Exercise 2-4. Consider a multiple series associated with a water bottom with a reflection coefficient $c_{w}$ and two-way time $t_{w}$. Design an inverse filter to suppress the multiples. [This is called the Backus filter (Backus, 1959)].

Exercise 2-5. Consider an earth model that comprises a water-bottom reflector and a deep reflector at two-way times of 500 and $750 \mathrm{~ms}$, respectively. What prediction lag and operator length should you choose to suppress (a) water-bottom multiples, and (b) pegleg multiples?

Exercise 2-6. Refer to Figure 2-6.9. Consider the following three bandwidths low $\left(F_{L}\right)$, medium $\left(F_{M}\right)$ and high $\left(F_{H}\right)$, for TVSW application:

$$
\begin{aligned}
& F_{L}: 10 \text { to } 30 \mathrm{~Hz} \\
& F_{M}: 30 \text { to } 50 \mathrm{~Hz} \\
& F_{H}: 50 \text { to } 70 \mathrm{~Hz}
\end{aligned}
$$

What kind of slopes should you assign to each bandwidth so that the output trace has an amplitude spectrum that is unity over the $10-$ to $-70-\mathrm{Hz}$ bandwidth?

Exercise 2-7. If the signal character down the trace changes rapidly (strong nonstationarity), should you consider narrow or broad bandwidths for the filters used in TVSW?

Exercise 2-8. Consider a minimum-phase wavelet and the following two processes applied to it:

(a) Spiking deconvolution followed by $10-\mathrm{to}-50-\mathrm{Hz}$ zero-phase band-pass filtering.

(b) Shaping filter to convert the minimum-phase wavelet to a $10-\mathrm{to}-50 \mathrm{-Hz}$ zero-phase wavelet.

What is the difference between the two outputs?

Exercise 2-9. How would you design a minimumphase band-pass filter operator?

Exercise 2-10. Consider (a) convolving a minimum-phase wavelet with a zero-phase wavelet, (b) convolving a minimum-phase wavelet with a minimumphase wavelet, and (c) adding two minimum-phase wavelets. Are the resulting wavelets minimum-phase?

Exercise 2-11. Consider the sinusoid shown in Figure 1-1 (frame 1) as input to spiking deconvolution. What is the output?

Exercise 2-12. Order the panels in Figure 2.E-1 with increasing prediction lag.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0267.jpg?height=1024&width=882&top_left_y=115&top_left_x=83)

2.E-1. The shot record shown in Figure 2.4-36c after predıtive deconvolution using an operator length of 480 ms, and four different prediction lags (Exercise 2-12). The amplitude spectra averaged over the shot record are shown at the top and the autocorrelograms are shown at the bottom.

## Appendix B MATHEMATICAL FOUNDATION OF DECONVOLUTION

## B. 1 Synthetic Seismogram

Consider an earth model that consists of homogeneous horizontal layers with thicknesses corresponding to the sampling interval. The seismic impedance associated with a layer is defined as $I=\rho v$, where $\rho$ is density and $v$ is the compressional-wave velocity within the layer. The instantaneous value of seismic inpedance for the $k$ th layer is given by

$$
I_{k}=\rho_{k} v_{k}
$$

For a vertically incident plane wave, the pressure amplitude reflection coefficient absociated with an interface is given by

$$
c_{k}=\frac{I_{k+1}-I_{k}}{I_{k+1}+I_{k}}
$$

Assume that the change of density with depth is negligible compared to the change of velocity with depth. Equation (B-2) then takes the form

$$
c_{k}=\frac{v_{k+1}-v_{k}}{v_{k+1}+v_{k}} .
$$

If the amplitude of the incident wave is unity, then the magnitude of the reflection coefficient corresponds to the fraction of amplitude reflected from the interface.

With knowledge of the reflection coefficients, we can compute the impulse response of a horizontally layered earth model using the Kunetz method (Claerbout, 1976). The impulse response contains not only the primary reflections, but also all the possible multiples. Finally, convolution of the impulse response with a source wavelet yields the synthetic seismogram.

Although random noise can be added to the seismogram, the convolutional model used here to establish the deconvolution filters does not include random noise. We also assume that the source waveform does not change as it propagates down into the earth; hence, the convolutional model does not include intrinsic attenuation. The convolution of a seismic wavelet $w(t)$ with the impulse response $e(t)$ yields the seismogram $x(t)$

$$
x(t)=w(t) * e(t)
$$

By Fourier transforming both sides, we get

$$
X(\omega)=W(\omega) E(\omega)
$$

where $X(\omega), W(\omega)$, and $E(\omega)$ represent the complex Fourier transforms of the seismogram, the source waveform, and the impulse response, respectively. In terms of amplitude and phase spectra, the Fourier transforms are expressed as

$$
\begin{aligned}
X(\omega)=A_{\sigma}(\omega) \exp \left[i \phi_{\tau}(\omega)\right], & (B-6 a) \\
W(\omega)=A_{w}(\omega) \exp \left[i \phi_{w}(\omega)\right], & (B-6 b)
\end{aligned}
$$

and

$$
E(\omega)=A_{e}(\omega) \exp \left[\imath \phi_{e}(\omega)\right]
$$

By substituting equations (B-6) into equation (B-5), we have

$$
A_{x}(\omega)=A_{w}(\omega) A_{e}(\omega)
$$

and

$$
\phi_{x}(\omega)=\phi_{w}(\omega)+\phi_{e}(\omega)
$$

Hence, in convolving the seismic wavelet with the impulse response, their phase spectra are added, while the amplitude spectra are multiplied.

We assume that the earth's impulse response can be represented by a white reflectivity series; hence, its amplitude spectrum is flat

$$
A_{c}(\omega)=A_{0}=\text { constant }
$$

By substituting into equation (B-7a), we obtain

$$
A_{x}(\omega)=A_{0} A_{w}(\omega) .
$$

This implies that the amplitude spectrum of the seismogram is a scaled version of the amplitude spectrum of the source wavelet.

We now examine the autocorrelation functions $r(\tau)$ of $x(t), w(t)$, and $e(t)$. Autocorrelation is a measure of similarity between the events on a time series at different time positions. It is a running sum given by the expresision

$$
r_{\mathrm{e}}(\tau)=\frac{1}{N} \sum_{t=0}^{N-1} e_{t} e_{t+\tau}, \quad \tau=0, \mp 1, \mp 2, \ldots, \mp(N-1)
$$

where $\tau$ is time lag. A random time series is an uncorrelated series. (Strictly, it is uncorrelated when it is continuous and infinitely long.) Therefore,

$$
r_{e}(\tau)=0, \quad \tau=0
$$

and

$$
r_{e}(0)=r_{0}=\text { constant. }
$$

Equation (B-11) states that the autocorrelation of a perfect random series is zero at all lags except at zero lag. The zerolag value actually is the cumulative energy containod in the time series:

$$
r_{0}=e_{0}^{2}+e_{1}^{2}+\cdots+e_{N-1}^{2}
$$

Consider the $z$-transform of the convolutional model in equation (B-4):

$$
X(z)=W(z) E(z) .
$$

By putting $1 / z$ in place of $z$ and taking the complex conjugate, we get

$$
\bar{X}(1 / z)=\bar{W}(1 / z) \bar{E}(1 / z)
$$

where the bar denotes the complex conjugate. By multiplying both sides of equations ( $\mathrm{B}-13$ ) and (B-14), we get

$$
X(z) \bar{X}(1 / z)=[W(z) E(z)][W(1 / z) \bar{E}(1 / z)]
$$

By rearranging the right side,

$$
X(z) \bar{X}(1 / z)=[W(z) \bar{W}(1 / z)][E(z) \bar{E}(1 / z)]
$$

Finally, by definition, equation (B-16) yields

$$
r_{x}=r_{w} * r_{\varepsilon}
$$

where $r_{x}, r_{w}$, and $r_{e}$ are the autocorrelations of the seismogram, seismic wavelet, and impulse response, respectively. Based on the white reflectivity series assumption (equation B-11), we have

$$
r_{x}=r_{0} r_{w}
$$

Equation (B-18) states that the autocorrelation of the seismogram is a scaled version of that of the seismic wavelet. We will see that conversion of the seismic wavelet into a zero-lag spike requires knowledge of the wavelet's autocorrelation. Equation (B-18) suggests that the autocorrelation of the seismogram can be used in lieu of that of the seismic wavelet, since the latter often is not known.

## B. 2 The Inverse of the Source Wavelet

A basic purpose of deconvolution is to compress the source waveform into a zero-lag spike so that closely spaced reflections can be resolved. Assume that a fiter operator $f(t)$ exists such that

$$
w(t) * f(t)=\delta(t)
$$

where $\delta(t)$ is the Kronecker delta function. The filter $f(t)$ is called the inverse filter for $w(t)$. Symbolically, $f(t)$ is expressed in terms of the seismic wavelet $w(t)$ as

$$
f(t)=\delta(t) * \frac{1}{w(t)}
$$

The $z$-transform of the seismic wavelet with a finite length $m+1$ is (Appendix $A$ )

$$
W(z)=w_{0}+w_{1} z+w_{2} z^{2}+\cdots+w_{m} z^{m}
$$

The $z$-transform of the inverse filter can be obtained by polynomial division:

$$
F(z)=\frac{1}{W(z)}
$$

The result is another polynomial whose coefficients are the terms of the inverse filter

$$
F(z)=f_{0}+f_{1} z+f_{2} z^{2}+\cdots+f_{n} z^{n}+\cdots
$$

Note that the polynomial $F(z)$ in equation (B-23) has only positive powers of $z$; this means $f(t)$ is causal. If the coefficients of $F(z)$ asymptotically approach zero as time goes to infinity, so that the filter has finite energy, we say that the filter $f(t)$ is realizable. If the coefficients increase without bound, we say that the filter is not realizable. In practice, we prefer to work with a causal and realizable filter. Such a filter, by definition, also is minimum-phase. If $f(t)$ is minimum-phase, then the seismic wavelet $w(t)$ also must be minimum-phase. Finally, to apply the filter with a finite length $n+1$, the polynomial $F(z)$ must be truncated. Truncation of the fiter operator induces some error in spiking the seismic wavelet.

The inverse of the seismic wavelet also can be computed in the frequency domain. By Fourier transforming equation (B-19), we get

$$
W(\omega) F(\omega)=1
$$

By substituting equation (B-6b), we obtain

$$
F(\omega)=\frac{1}{A_{w}(\omega) \exp \left[i \phi_{w}(\omega)\right]}
$$

We express the Fourier transform of the inverse filter $F(\omega)$ as

$$
F(\omega)=A_{f}(\omega) \exp \left[\phi_{f}(\omega)\right]
$$

and compare it with equation (B-25) to get

$$
A_{f}(\omega)=\frac{1}{A_{w}(\omega)}
$$

and

$$
\phi_{f}(\omega)=-\phi_{\omega}(\omega)
$$

Equations (B-27) show that the amplitude spectrum of the inverse filter is the inverse of that of the seismic wavelet, and the phase spectrum of the inverse filter is negative of that of the seismic wavelet.

## B. 3 The Inverse Filter

Instead of the polynomial division procedure described by equation (B-22), consider a different approach to derive the inverse filter. Start with the $z$-transform of the autocorrelation of the seismic wavelet:

$$
R_{w}(z)=W(z) \bar{W}(1 / z), \quad . \quad(B-28)
$$

and the $z$-transform of equation (B-19):

$$
W(z) F(z)=1
$$

from which we get

$$
W(z)=\frac{1}{F(z)}
$$

By substituting into equation (B-28), we obtain

$$
R_{w}(z) F(z)=\bar{W}(1 / z)
$$

Since the wavelet is a real-time function,

$$
r_{w}(\tau)=r_{w}(-\tau)
$$

Consider the special case of a threepoint inverse filter $\left(f_{0}, f_{1}, f_{2}\right)$. We will assume that the seismic wavelet $w(t)$ is minimum-phase (causal and realizable); hence, its inverse $f(t)$ also is minimum-phase. The $z$-transform of $f(t)$ is

$$
F(z)=f_{0}+f_{1} z+f_{2} z^{2}
$$

The $z$-transform of its autocorrelogram $r_{w}(\tau)$ is, by way of equation (B-32),

$$
R_{w}(z)=\cdots+r_{2} z^{-2}+r_{1} z^{-1}+r_{0}+r_{1} z+r_{2} z^{2}+\cdots
$$

The $z$-transform of $w(t)$ is

$$
W(z)=w_{0}+w_{1} z+w_{2} z^{2}+\cdots+w_{m} z^{m}
$$

therefore,

$$
\bar{W}(1 / z)=\bar{w}_{0}+\bar{w}_{1} z+\bar{w}_{2} z^{2}+\cdots+\bar{w}_{m} z^{m}
$$

By substituting equations (B-33a), (B-33b), and (B-33c) into equation (B-31), we obtain

$$
\left(r_{2} z^{-2}+r_{1} z^{-\overline{1}} r_{0}+r_{1} z+r_{2} z^{2}\right)\left(f_{0}+f_{1} z+f_{2} z^{2}\right)=\bar{w}_{0}+\bar{w}_{1} z^{-1}+\bar{w}_{2} z^{-2}
$$

To solve for $\left(f_{0}, f_{1}, f_{2}\right)$, we identify the coefficients of powers of $z$. The coefficient of $z^{0}$ yields

$$
r_{0} f_{0}+r_{1} f_{1}+r_{2} f_{2}=\bar{w}_{0}
$$

the coefficient of $z^{1}$ yields

$$
r_{1} f_{0}+r_{0} f_{1}+r_{1} f_{2}=0
$$

while the coefficient of $z^{2}$ yiclds

$$
r_{2} f_{0}+r_{1} f_{1}+r_{0} f_{2}=\mathbf{0}
$$

When put into matrix form, these equations for the coefficients of powers of $z$ yield

$$
\left(\begin{array}{lll}
r_{0} & r_{1} & r_{2} \\
r_{1} & r_{0} & r_{2} \\
r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{l}
f_{0} \\
f_{1} \\
f_{2}
\end{array}\right)=\left(\begin{array}{c}
\bar{w}_{0} \\
0 \\
0
\end{array}\right)
$$

Note that $\bar{w}_{0}$, which equals $w_{0}$ for the usual case of a real source wavelet, is the amplitude of the wavelet at $t=0$. There are four unknowns and three equations. By normalizing with respect to $f_{0}$, we get

$$
\left(\begin{array}{lll}
r_{0} & r_{1} & r_{2} \\
r_{1} & r_{0} & r_{1} \\
r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1} \\
a_{2}
\end{array}\right)=\left(\begin{array}{l}
L \\
0 \\
0
\end{array}\right)
$$

where $a_{1}=f_{1} / f_{0}, a_{2}=f_{2} / f_{0}$, and $L=w_{0} / f_{0}$. We now have three unknowns, $a_{1}, a_{2}$, and $L$, and three equations. The square matrix elements on the left side of the cquation represent the autocorrelation lags of the seismic wavelet, which we do not know. However, the autocorrelation lags from equation (B-18) of the seismogram that we do know can be substituted.

For the general case of an $n$-point inverse filter $\left(f_{0}, f_{1}, f_{2}, \ldots, f_{n}\right.$ ), equation (B-36a) takes the form

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-1} \\
r_{2} & r_{1} & r_{0} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n} & r_{n-1} & r_{n-2} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1} \\
a_{2} \\
\vdots \\
a_{n-1}
\end{array}\right)=\left(\begin{array}{c}
L \\
0 \\
0 \\
\vdots \\
0
\end{array}\right) .
$$

The autocorrelation matrix in equation (B-36b) is of a special type. First, it is a symmetric matrix; second, its diagonal elements are identical. This type of matrix is called a Toeplitz matrix, For $n$ number of normal equations, the standard algorithms require a memory space that is proportional to $n^{2}$ and CPU time that is proportional to $n^{3}$. Because of the special properties of the Toeplitz matrix, Levinson devised a recursive scheme (Claerbout, 1976) that requires a memory space and CPU time proportional to $n$ and $n^{2}$, respectively (Section B.6).

## B. 4 Frequency-Domain Deconvolution

We want to estimate a minimum-phase wavelet from the recorded seismogram. The inverse of the wavelet is the spiking deconvolution operator. We start with the autocorrelation of the seismic wavelet $w(t)$ in the frequency domain:

$$
R_{\omega}(\omega)=W(\omega) \bar{W}(\omega)
$$

where $\bar{W}(\omega)$ is the complex conjugate of the Fourier transform of $w(t)$. Since $w(t)$ normally is not known, $R_{n}(\omega)$ is not known. However, based on an assumption of white reflectivity series (equation B-18), we can substitute the a.ntocorrelation function of the seismogram in equation (B-37).

Define a new function $U(\omega)$ :

$$
U(\omega)=\ln \left[R_{w}(\omega)\right]
$$

When both sides of equation (B-38) are exponentiated:

$$
R_{w}(\omega)=\exp [U(\omega)]
$$

Suppose that another function, $\phi(\omega)$, is defined and that equation (B-39) is rewritten as (Claerbout, 1976)

$$
R_{w}(\omega)=\exp \left\{\frac{1}{2}[U(\omega)+\imath \phi(\omega)]\right\} \exp \left\{\frac{1}{2}[U(\omega)-i \phi(\omega)]\right\}
$$

When equation (B-40) is compared with equation (B-37), we see that

$$
W(\omega)=\exp \left\{\frac{1}{2}[U(\omega)+\imath \phi(\omega)]\right\}
$$

We know $R_{w}(\omega)$ from equation (B-18) and therefore we know $U(\omega)$ from equation (B-38). To estimate $W(\omega)$ from equation (B-41), we also need to know $\phi(\omega)$. If we make the minimumphase assumption, $\phi(\omega)$ turns out to be the Hilbert transforn of $U(\omega)$ (Claerbout, 1976). To perform the Hilbert transform, first inverse Fourier transform $U(\omega)$ back to the time domain. Then, double the positive time values, leave the zero-lag alone, and set the negative time values to zero. This operation yields a time function $u^{+}(t)$, which vanishes before $t=0$. Then, return to the transform domain to get

$$
U^{+}(\omega)=\frac{1}{2}[U(\omega)+i \phi(\omega)]
$$

where $U^{+}(\omega)$ is the Fourier transform of $u^{+}(t)$. Finally, exponentiating $U^{+}(\omega)$ yields the Fourier transform $W(\omega)$ of the minimum-phase wavelet $w(t)$ (equation B-41).

Once the minimum phase wavelet $w(t)$ is estimated, its Fourier transform $W(\omega)$ is rewritten in terms of its amplitude and phase spectra,

$$
W(\omega)=A(\omega) \exp [i \phi(\omega)]
$$

The deconvolution filter in the Fourier transform domain is

$$
F(\omega)=\frac{1}{W(\omega)}
$$

By substituting equation (B-43), we obtain the amplitude and phase spectra of this filter:

$$
A_{j}(\omega)=\frac{1}{A(\omega)}
$$

and

$$
\phi_{f}(\omega)=-\phi(\omega)
$$

Since the estimated wavelet $w(t)$ is minimum phase, it follows that the deconvolution filter [whose Fourier transform is given by equation (B-44)] also is minimum phase. By inverse Fourier transforming, equation (B-44) yields the deconvolution operator. The frequency-domain method of deconvolution is outlined in Figure B-1.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0274.jpg?height=534&width=372&top_left_y=115&top_left_x=335)

FIG. B-1. Flowchart for frequency-donain deconvolution.

Figure B-2 illustrates the frequency-domain deconvolution that is described in Figure B-1. The panels in Figure B-2 should be compared with the corresponding results of the WienerLevinson (time-domain) method in Figure 2-20. As expected, there is virtually no difference between the two results.

From the discussion so far, we see that the spiking deconvolution operator is the inverse of the minimum-phase equivalent of the seismic wavelet. The process of estimating the minimumphase equivalent of a seismic wavelet is called spectrol decomposetion. The minimum-phase wavelet, once computed, can be inverted easily to get the deconvolution operator. To avoid dividing by zero in equation (B-45a) and to ensure that the filtcr is stable, a small number often is added to the amplitude spectrum before division. This is called prewhitening. Equation (B-45a) then takes the form

$$
A_{f}(\omega)=\frac{1}{A(\omega)+\varepsilon}
$$

The amplitude spectrum also can be smoothed to get a more stable opcrator. Smoothing the spectrum is analogous to shortening the equivalent time-domain deconvolution operator.

Zero-phase deconvolution can be implemented conveniently in the frequency domain. To do this, the phase spectrum given by equation ( $\mathrm{B}-45 \mathrm{~b}$ ) is set to zero and thus yields a deconvolution operator that flattens the amplitude spectrum of the input seismogram, but does not alter the phase.

## B. 5 Optimum Wiener Filters

The following concise discussion of optimum Wiener filters is based on Robinson and Treitel (1980). Consider the general filter model in Figure B-3. Wioner filtering involves designing the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0275.jpg?height=920&width=762&top_left_y=222&top_left_x=136)

Wiener Filters

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0276.jpg?height=208&width=271&top_left_y=138&top_left_x=388)

FIG. B-3. Wiener filter model.

filter $f(t)$ so that the least-squares error between the actual and desired outputs is minimum. Error $L$ is defined as

$$
L=\sum_{i}\left(d_{t}-y_{t}\right)^{2}
$$

The actual output is the convolution of the filter with the input

$$
y_{t}=f_{t} * x_{t}
$$

When equation (B-48) is substituted into equation (B-47), we get

$$
L=\sum_{t}\left(d_{t}-\sum_{\tau} f_{\tau} x_{t-\tau}\right)^{2}
$$

The goal is to compute the filter coefficients $\left(f_{0}, f_{1}, \ldots, f_{n-1}\right)$ so that the error is minimum. Filter length $n$ must be predefined. The minimum error is attained by setting the variation of $L$ with respect to $f_{i}$ to zero:

$$
\frac{\partial L}{\partial f_{t}}=0, \quad i=0,1,2, \ldots,(n-1)
$$

By expanding the square term in equation (B-49), we have

$$
L=\sum_{t} d_{t}^{2}-2 \sum_{t} d_{t} \sum_{\tau} f_{\tau} x_{t-\tau}+\sum_{t}\left(\sum_{\tau} f_{\tau} x_{t-\tau}\right)^{2} .
$$

By taking the partial derivatives and setting them to zero, we get

$$
\frac{\partial L}{\partial f_{t}}=-2 \sum_{t} d_{t} x_{t-1}+2 \sum_{t}\left(\sum_{\tau} f_{\tau} x_{t-\tau}\right) x_{t-t}=0
$$

or

$$
\begin{aligned}
& \sum_{\tau} f_{\tau} \sum_{t} x_{t-\tau} x_{t-t}= \sum_{t} d_{t} x_{t-i} \\
& i=0,1,2, \ldots,(n-1) .
\end{aligned}
$$

By using

$$
\sum_{t} x_{t-\tau} x_{t-t}=r_{\imath}
$$

and

$$
\sum_{t} d_{1} x_{t-t}=g_{2}
$$

for each $\imath$ th term. we get

$$
\sum_{\tau} f_{\tau} r_{i-\tau}=g_{i}, \quad i=0,1,2, \ldots,(n-1)
$$

When put into matrix form, equation (B-55) becomes

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
f_{0} \\
f_{1} \\
\vdots \\
f_{n-1}
\end{array}\right)=\left(\begin{array}{c}
g_{0} \\
g_{1} \\
\vdots \\
g_{n-1}
\end{array}\right) .
$$

Here, $r_{z}$ are the autocorrelation lags of the input and $g_{2}$ are the lags of the crosscorrelation between the desired output and input. Since the autocorrclation matrix is Toeplitz, the optimum Wiener filter coefficients $f_{2}$ can be computed by using Levinson recursion (Claerbout, 1976).

The least-squares error involved in this process now is computed. Expressed again, equation (B-51) becomes

$$
L_{\text {тn2n }}=\sum_{i} d_{t}^{2}-2\left(\sum_{t} \sum_{\tau} d_{t} f_{\tau} x_{t-\tau}\right)+\sum_{t}\left(\sum_{\tau} f_{\tau} x_{t-\tau}\right)^{2}
$$

By substituting the relationships

$$
\sum_{t} d_{t} x_{t-r}=g_{r}
$$

and

$$
\sum_{t} x_{t} x_{t-\tau}=r_{\tau}
$$

into equation (B-57), we get

$$
L_{m: n}=\sum_{t} d_{t}^{2}-2 \sum_{\tau} f_{\tau} g_{\tau}+\sum_{\tau} f_{\tau} \sum_{t} f_{\tau} \sum_{t} x_{t-\tau} x_{t-t}
$$

or

$$
L_{\text {inun }}=\sum_{t} d_{t}^{2}-2 \sum_{\tau} f_{\tau} g_{\tau}+\sum_{\tau} f_{\tau} \sum_{\boldsymbol{t}} f_{t} r_{\tau-\imath}
$$

Finally, by using equation (B-55), we get

$$
L_{m n}=\sum_{t} d_{t}^{2}-\sum_{\tau} f_{\tau} g_{\tau}
$$

## B. 6 Spiking Deconvolution

Consider the desired output to be the zero-delay spike $d_{t}:(1,0,0, \ldots)$. Given the input series $x_{t}:\left(x_{0}, x_{1}, x_{2}, \ldots\right)$, equation (B-56) takes the form

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
f_{0} \\
f_{1} \\
\vdots \\
f_{n-1}
\end{array}\right)=\left(\begin{array}{c}
x_{0} \\
0 \\
\vdots \\
0
\end{array}\right) .
$$

Divide both sides by $f_{0}$ to obtain

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1} \\
\vdots \\
a_{n-1}
\end{array}\right)=\left(\begin{array}{c}
v \\
0 \\
\vdots \\
0
\end{array}\right)
$$

where $a_{2}=f_{2} / f_{0}, i=1,2, \ldots, n-1$, and $v=x_{0} / f_{0}$. Equation (B-63) is solved for the unknown quantity $v$ and the filter coefficients $\left(a_{1}, a_{2}, \ldots, a_{n-1}\right)$. Since the desired ortput is a zero-delay spike, the filter $\left(1, a_{1}, a_{2}, \ldots, a_{n-1}\right)$ describes a spiking deconvolution process.

The solution to equation (B-63) can be obtained efficiently using the Levinson recursion (Claerbout, 1976). Start with the solution of equation (B-63) for the two-term filter ( $\left.1, a_{1}\right)$, then solve for the filter $\left(1, a_{1}, a_{2}\right)$ and so on. Equation (B-63) for $n=2$ takes the form

$$
\left(\begin{array}{ll}
r_{0} & r_{1} \\
r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1}
\end{array}\right)=\left(\begin{array}{l}
v \\
0
\end{array}\right) .
$$

Write out the simultaneous equations:

$$
r_{0}+r_{1} a_{1}=v
$$

and

$$
r_{1}+r_{0} a_{1}=0
$$

which yield the filter coefficient $a_{1}$ and the unknown variable $v$ from the first iteration:

$$
a_{1}=-r_{1} / r_{0}
$$

and

$$
v=r_{0}+r_{1} a_{1}
$$

Now write equation (B-63) for the three-term filter $\left(1 . a_{1}^{\prime}, a_{2}^{\prime}\right)$ :

$$
\left(\begin{array}{lll}
r_{0} & r_{1} & r_{2} \\
r_{1} & r_{0} & r_{1} \\
r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1}^{\prime} \\
a_{2}^{\prime}
\end{array}\right)=\left(\begin{array}{c}
v^{\prime} \\
0 \\
0
\end{array}\right)
$$

We want to solve for the filter coefficients $\left(a_{1}^{\prime}, a_{2}^{\prime}\right)$ by using the results of the previous step (equations B-65a,b). First, rewrite equation (B-64) by adding a row in the following manner:

$$
\left(\begin{array}{lll}
r_{0} & r_{1} & r_{2} \\
r_{1} & r_{0} & r_{1} \\
r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1} \\
0
\end{array}\right)=\left(\begin{array}{l}
v \\
0 \\
\epsilon
\end{array}\right)
$$

where

$$
e=r_{2}+r_{1} a_{1}
$$

Rewrite equation (B-67) by changing the order of the rows:

$$
\left(\begin{array}{lll}
r_{0} & r_{1} & r_{2} \\
r_{1} & r_{0} & r_{1} \\
r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
0 \\
a_{1} \\
1
\end{array}\right)=\left(\begin{array}{l}
e \\
0 \\
v
\end{array}\right)
$$

Multiply both sides of equation (B-69) with variable $c_{1}$, yet to be determined, and subtract the result from equation (B-67):

$$
\left(\begin{array}{lll}
r_{0} & r_{1} & r_{2} \\
r_{1} & r_{0} & r_{1} \\
r_{2} & r_{1} & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
a_{1}-c a_{1} \\
-c
\end{array}\right)=\left(\begin{array}{c}
v-c e \\
0 \\
e-c v
\end{array}\right)
$$

Finally, compare equation (B-70) with equation (B-66), and note that

$$
\left(\begin{array}{c}
1 \\
a_{1}^{\prime} \\
a_{2}^{\prime}
\end{array}\right)=\left(\begin{array}{c}
1 \\
a_{1}-c a_{1} \\
-c
\end{array}\right)
$$

and

$$
\left(\begin{array}{l}
v^{\prime} \\
0 \\
0
\end{array}\right)=\left(\begin{array}{c}
v-c e \\
0 \\
e-c v
\end{array}\right)
$$

Solve for $c$ and $v^{\prime}$ :

$$
c=\frac{e}{v}
$$

and

$$
v^{\prime}=v\left[1-\left(\frac{e}{v}\right)^{2}\right]
$$

Hence, the new filter coefficients ( $\left.a_{1}^{\prime}, a_{2}^{\prime}\right)$ are (eqriations B-71a)

$$
a_{1}^{\prime}=a_{1}-\frac{e}{v} a_{1}
$$

and

$$
a_{2}^{\prime}=-\frac{e}{v}
$$

This recursive scherne is repeated to determine the next set of filter coefficients:

(a) Compute $v$ and $e$ using the autocorrelation lags of the input series and the present filter coefficients (equations B-67).

(b) Compute the next set of filter coefficients (equations B-71a).

(c) Compute a new value for $v$ (equation B-72b).

This recursive process yields the Wiener filter $\left(1, a_{1}, a_{2}, \ldots, a_{n-1}\right)$ of the desired length $n$.

## B. 7 Predictive Deconvolution

Suppose that the desired output in the filter model of Figure B-3 is a time-advanced version of the input, $d(t)=x(t+\alpha)$. We want to design a Wiener filter $f(t)$ that predicts $x(t+\alpha)$ from the past values of the input $x(t)$. In this special casc, the crosscorrelation function $g$ becomes

$$
g_{\tau}=\sum_{t} d_{t} x_{t-\tau}=\sum_{t} x_{t+\alpha} x_{t-\tau}=\sum_{t} x_{t} x_{t-(\alpha+\tau)}
$$

By deanition, we have

$$
r_{\tau}=\sum_{t} x_{t} x_{t-\tau}
$$

For the $\alpha+\tau$ lag, equation (B-75) becomes

$$
r_{\alpha+\tau}=\sum_{t} x_{t} x_{t-(\alpha+r)}
$$

Combine equations (B-74) and (B-76) and note that $r_{\alpha+\tau}=g_{\tau}$. By substituting this result into cquation (B-56), we get the set of normal equations that must be solved to find the prediction
fiter $\left(f_{0}, f_{1}, \ldots, f_{n-1}\right)$ :

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
f_{0} \\
f_{1} \\
\vdots \\
f_{n-1}
\end{array}\right)=\left(\begin{array}{c}
r_{\alpha} \\
r_{\alpha+1} \\
\vdots \\
r_{\alpha+n-1}
\end{array}\right)
$$

For a unit prediction lag, $\alpha=1$, equation (B-77) takes the form:

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n-1} & r_{n-2} & r_{r_{2}-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
f_{0} \\
f_{1} \\
\vdots \\
f_{n-1}
\end{array}\right)=\left(\begin{array}{c}
r_{1} \\
r_{2} \\
\vdots \\
r_{n}
\end{array}\right) .
$$

By augmenting the right side to the square matrix on the left side, we have

$$
\left(\begin{array}{cccccc}
-r_{1} & r_{0} & r_{1} & r_{2} & \cdots & r_{n-1} \\
-r_{2} & r_{1} & r_{0} & r_{1} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
-r_{n} & r_{n-1} & r_{n-2} & r_{n-3} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
f_{0} \\
f_{1} \\
\vdots \\
f_{n-1}
\end{array}\right)=\left(\begin{array}{c}
0 \\
0 \\
0 \\
\vdots \\
0
\end{array}\right)
$$

By adding one row, then putting the negative sign to the filter column, we obtain

$$
\left(\begin{array}{ccccc}
r_{0} & r_{1} & r_{2} & \cdots & r_{T 2} \\
r_{1} & r_{0} & r_{1} & \cdots & r_{n-1} \\
r_{2} & r_{1} & r_{0} & \cdots & r_{n-2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{n} & r_{n-1} & r_{n-2} & \cdots & r_{0}
\end{array}\right)\left(\begin{array}{c}
1 \\
-f_{0} \\
-f_{1} \\
\vdots \\
-f_{\pi-1}
\end{array}\right)=\left(\begin{array}{c}
L \\
0 \\
0 \\
\vdots \\
0
\end{array}\right) .
$$

We now have $n+1$ equations and $n+1$ unknowns -- $\left(f_{0}, f_{L}, \ldots, f_{n-1}, L\right)$. From equation (B-80)

$$
L=r_{0}-r_{1} f_{0}-r_{2} f_{1}-\cdots-r_{n} f_{n-1} .
$$

By using equation (B-61), the minimum error associated with the unit prediction-lag filter can be computed as follows. Start with

$$
d_{t}=x_{t+1}
$$

so that

$$
\sum_{t} d_{t}^{2}=r_{0}
$$

and

$$
g_{t}=r_{t+1}
$$

Substituting into equation (B-61), we get

$$
L_{n n 1 n}=r_{0}-\left(r_{1} f_{0}+r_{2} f_{1}+\cdots+r_{n} f_{n-1}\right)
$$

which is identical to quantity $L$ given by equation (B-81). Therefore, when we solve equation (B-81), we compute both the minimum error and the filter coefficients.

Equation (B-77) gives us the prediction filter with prediction lag $\alpha$. The desired output is $x_{t+\alpha}$. The actual output is $\widehat{x}_{t+\alpha}$, which is an estimate of the desired output. This desired output
is the predictable component of the input series; i.e, periodic events such as multiples. The error series contains the unpredictable component of the series and is defined as

$$
e_{t+\alpha}=x_{t+\alpha}-\hat{x}_{t+\alpha}=x_{t+\alpha}-\sum_{r} f_{\tau} x_{t-\tau}
$$

We assume that the unpredictable component $e_{t}$ is the uncorrelated reflectivity we want to extract from the seismogram. By taking the $z$-transform of equation (B-85), we have

$$
z^{-\alpha} E(z)=z^{-\alpha} X(z)-F(z) X(z)
$$

or

$$
E(z)=\left[1-z^{\alpha} F(z)\right] X(z)
$$

Now define a ncw filter $a(t)$ whose $z$-transform is

$$
A(z)=1-z^{\alpha} F(z)
$$

so that, when substituted into equation (B-87), we have

$$
E(z)=A(z) X(z)
$$

The corresponding time-domain relationship is

$$
e(t)=a(t) * a(t)
$$

After defining $e(t)$ as reflectivity, equation (B-90) states that by applying filter $a(t)$ to the input seisrogram $2(t)$, we obtain the reflectivity series. Since computing the reflectivity series is a goal of deconvolution, prediction filtering can be used for deconvolution. The time-domain form $a(t)$ of the filter defined by equation (B-88) is

$$
a_{t}=(1, \overbrace{0,0, \cdots, 0}^{a-1}-f_{0},-f_{1}, \cdots,-f_{n-1})
$$

The filter $a(t)$ is obtained from the prediction filter $f(t)$, which is the solution to equation (B-77). We call $a(t)$ the prediction error filter. For unit-prediction lag, the filter coefficients given by equation (B-91) are of the form

$$
a_{t}=\left(1 .-f_{0},-f_{1}, \cdots,-f_{n-1}\right) \text {. }
$$

This is the same as the solution of equation (B-80). Moreover, equation (B-80) is equivalent to equation (B-36) for $n=2$. Thus, we can conclude that a prediction error filter with unitprediction lag and with $n+1$ length is equivalent to an inverse filter of the same length except for a scale factor.

## B. 8 Surface-Consistent Deconvolution

Dcconvolution can be formulated as a surface-consistent spectral decomposition (Taner and Cobun, 1981). In such a formulation, the seismic trace is decomposed into the convolutional effects of source, receiver, offset, and the earth's impulse response, thus explicitly accounting for variations in wavelet shape affected by near-source and near-receiver conditions and sourcereceiver separation. Decomposition is followed by inverse filtering to recover the earth's impulse response. The assumption of surface-consistency implies that the basic wavelet shape depends only on the source and receiver locations, and not on the details of the raypath from source to reflector to receiver.

The convolutional model discussed in Section 2.1 is described by

$$
x(t)=w(t) * e(t)+n(t)
$$

where $x(t)$ is the recorded seismogram, $w(t)$ is the source waveform, $e(t)$ is the earth's impulse response that we want to estimate, and $n(t)$ is the noise component.

A postulated surface-consistent convolutional model is given by

$$
x_{i j}^{\prime}(t)=s_{j}(t) * h_{l}(t) * e_{k}(t) * g_{i}(t)+n(t),
$$

where $x_{t}^{\prime}(t)$ is a model of the recorded seismogram, $s_{j}(t)$ is the waveform component associated with source location $j, g_{i}(t)$ is the component associated with receiver location 2 , and $h_{l}(t)$ is the component associated with offet dependency of the waveform defined for each offset index $l=|z-\jmath|$. As in equation (B-93), $e_{k}(t)$ represents the earth's impulse response at the sourcereceiver midpoint location, $k=(i+j) / 2$. By comparing equations (B-93) and (B-94), we infer that $w(t)$ represents the combined effects of $s(t), h(t)$, and $g(t)$. Cambois and Stoffe (1992) offer an alternative to equation (B-94) in which the offet term is ignored.

To illustrate a method of computing $s_{3}(t), h_{l}(t), e_{k}(t)$, and $g_{2}(t)$, assumc $n(t)=0$ and Fourier transform equation (B-94):

$$
X_{\imath}^{\prime}(\omega)=S_{\jmath}(\omega) H_{l}(\omega) E_{k}(\omega) G_{2}(\omega)
$$

This equation can be separated into the following amplitude spectral components:

$$
\bar{X}_{2 j}^{\prime}(\omega)=\bar{S}_{j}(\omega) \bar{H}_{i}(\omega) \bar{E}_{k}(\omega) \bar{G}_{t}(\omega)
$$

and phase spectral components (Section A.1):

$$
\phi_{\imath \jmath}^{\prime}(\omega)=\phi_{\mathrm{sj}}(\omega)+\phi_{h i}(\omega)+\phi_{\mathrm{ek}}(\omega)+\phi_{\mathrm{rz}}(\omega)
$$

If the minimum-phase assumption is made, only the amplitude spectra (cquation $B-96 a$ ) need to be considered.

Equation (B-96a) now can be linearized by taking the logarithm of both sides:

$$
\tilde{X}_{\imath}^{\prime}(\omega)=\tilde{S}_{j}(\omega)+\tilde{H}_{l}(\omega)+\tilde{E}_{k}(\omega)+\tilde{G}_{i}(\omega)
$$

The left side is the logarithm of the amplitude spectrum $\bar{X}_{v}^{\prime}(\omega)$ of the modeled input trace as in the left-hand side of equation (B-96a), and the right-hand terms are the logarithms of the amplitude spectra of the individual components as in the right-hand side of equation (B-96a).

An altemative model equation is given by Cary and Lorentz (1993) bascd on the work by Morley and Claerbout (1983):

$$
\tilde{X}_{i}^{\prime \prime}(\omega)=\tilde{S}_{j}(\omega)+\tilde{H}_{l}(\omega)+\tilde{E}_{k}(\omega)+\tilde{G}_{i}(\omega),
$$

where

$$
\tilde{X}_{i j}^{\prime \prime}(\omega)=\ddot{X}_{i j}^{\prime}(\omega)-\tilde{X}_{a v g}^{\prime}(\omega) .
$$

The spectral component $\tilde{X}_{a v g}^{\prime}(\omega)$ is associated with the average amplitude spectrum for the entire data set. The terms on the right-hand side of equation (B-98) now correspond to residual spectral components for each source, offet, midpoint, and receiver location.

The spectral components on the right-hand side of equation (B-98a) can be computed by least-squares error minimization. For each frequency $\omega$, equation (B-98a) is written for each trace of each CMP gather in the data set. Consider a data set with $n_{s}$ shot locations and $n_{c}$ channels, so that the total number of traces is $n_{t} \times n_{c}$. For $n_{e} \times n_{c}$ values of the actual spectral components $\tilde{X}_{\imath j}$ at frequency $\omega$, and $n_{s}$ shot locations, $n_{r}$ receiver locations, $n_{e}$ midpoint locations, and $n_{h}$
offsets, we have the following set of model equations:

$$
\left(\begin{array}{c} 
\\
\vdots \\
\tilde{X}_{* 3}^{\prime \prime} \\
\vdots
\end{array}\right)=\left(\begin{array}{llll}
\cdots & 1 \cdots & 1 \cdots & 1 \cdots
\end{array}\right)\left(\begin{array}{c}
\vdots \\
\tilde{S}_{3} \\
\vdots \\
\vdots \\
\tilde{H}_{l} \\
\vdots \\
\vdots \\
E_{k} \\
\vdots \\
\vdots \\
\hat{G}_{3} \\
\vdots
\end{array}\right), \quad(B-99 a)
$$

Write equation (B-99a) in matrix notation:

$$
\overline{\mathbf{X}}^{\prime \prime}=\mathbf{L p}
$$

where $\tilde{\mathbf{X}}^{\prime \prime}$ is the column vector of $m$-length on the left-hand side in equation (B-99), $\mathrm{L}$ is the sparse matrix with dimensions $\left(n_{s} \times n_{c}\right) \times\left(n_{s}+n_{h}+n_{e}+n_{r}\right)$ and $\mathbf{p}$ is the column vector of $\left(n_{s}+n_{h}+n_{e}+n_{r}\right)$-length on the right-hand side of the same equation. Except the four elements in each row, the $L$ matrix contains zeros.

We want to estimate for each frequency $\omega$ the model parameters $p$ such that the difference between the actual spectral component $\overline{\mathbf{X}}$ and the modeled spectral component $\tilde{\mathbf{X}}^{\prime \prime}$ is minimum in the least-squares sense.

The error vector $\mathbf{v}$ is defined as the difference between the modeled and the actual spectral component for each frequency $\omega$

$$
\mathbf{v}=\overline{\mathbf{X}}-\tilde{\mathbf{X}}^{\prime \prime}
$$

Substituto equation (B-99b) into equation (B-100a) to obtain

$$
\mathbf{v}=\tilde{\mathbf{X}}-\mathbf{L p}
$$

Following lines and Treitel (1984), the least-squares solution for equation (B-100b) can be determined. First, the cumulative squared error $C$ is expressed as

$$
C=\mathbf{v}^{\mathbf{T}+} \mathbf{v}
$$

where $T$ is for transpose and $*$ is for complex conjugate. By substituting for $v$ from equation (B-100b), we get

$$
C=\left(\overline{\mathbf{X}}-\mathbf{L}_{p}\right)^{\mathbf{T} *}\left(\overline{\mathbf{X}}-\mathbf{L}_{p}\right)
$$

Minimization of $C$ with respect to $\mathbf{p}$ requires that

$$
\frac{\partial C}{\partial \tilde{S}_{3}}=\frac{\partial C}{\partial \tilde{H}_{l}}=\frac{\partial C}{\partial \tilde{E}_{k}}=\frac{\partial C}{\partial \tilde{G}_{1}}=0
$$

This requirement yields the desired least-squares solution:

$$
\mathrm{p}=\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T} *} \tilde{\mathbf{X}}
$$

Application of the least-squares minimization to surface-consistent prediction-error filtering is given by Levin (1989), A practical scheme for solving equation (B-98a) is based on the GaussSeidel method. In this scheme, each term on the right-hand side of cquation (B-98a) is computed
by the following set of recursive equations:

$$
\begin{aligned}
& \tilde{S}_{j}^{m}=\frac{1}{n_{r}} \sum_{i}^{n_{r}}\left\{\tilde{X}_{i j}-\tilde{H}_{l}^{m-1}-\tilde{E}_{k}^{m-1}-\tilde{G}_{i}^{m-1}\right\} \\
& \tilde{G}_{\imath}^{m}=\frac{1}{n_{s}} \sum_{j}^{n_{s}}\left\{\tilde{X}_{\imath j}-\tilde{H}_{l}^{m-1}-\tilde{E}_{k}^{m-1}-\bar{S}_{j}^{m-1}\right\} \\
& \tilde{H}_{l}^{m}=\frac{1}{n_{c}} \sum_{k}^{n_{e}}\left\{\tilde{X}_{\imath j}-\bar{S}_{j}^{m-1}-\bar{E}_{k}^{m-1}-\tilde{G}_{i}^{m-1}\right\}
\end{aligned}
$$

and

$$
\tilde{E}_{k}^{m}=\frac{1}{n_{k}} \sum_{l}^{n_{h}}\left\{\bar{X}_{t}-\tilde{S}_{j}^{m-1}-\tilde{H}_{l}^{m-1}-\tilde{G}_{2}^{m-1}\right\}
$$

where $m$ is the iteration index. The solutions in equations (B-103) are based on the orthogonality of the shot and receiver axes, and the orthogonality of the midpoint and offset axes. Equations (B-103) can be modified as follows:

$$
\begin{aligned}
& \tilde{S}_{3}^{m}=\frac{1}{n_{r}} \sum_{i}^{n_{r}}\left\{\tilde{X}_{\imath}\right\}-\frac{1}{n_{r}} \sum_{i}^{n_{r}}\left\{\tilde{H}_{l}^{m-1}-\tilde{E}_{k}^{m-1}-\bar{G}_{t}^{m-1}\right\}, \\
& \tilde{G}_{t}^{m}=\frac{1}{n_{\tau}} \sum_{j}^{n_{t}}\left\{\tilde{X}_{\imath \jmath}\right\}-\frac{1}{n_{s}} \sum_{j}^{n_{*}}\left\{\tilde{H}_{l}^{m_{i}-1}-\tilde{E}_{k}^{m-1}-\tilde{S}_{j}^{m-1}\right\}, \\
& \tilde{H}_{i}^{m}=\frac{1}{n_{e}} \sum_{k}^{n_{e}}\left\{\tilde{X}_{\imath \jmath}\right\}-\frac{1}{n_{e}} \sum_{k}^{n_{c}}\left\{\tilde{S}_{j}^{m-1}-\tilde{E}_{k}^{m-1}-\bar{G}_{\imath}^{m-1}\right\},
\end{aligned}
$$

and

$$
\tilde{E}_{k}^{m}=\frac{1}{n_{h}} \sum_{l}^{n_{h}}\left\{\tilde{X}_{v}\right\}-\frac{1}{n_{h}} \sum_{l}^{n_{h}}\left\{\tilde{S}_{l}^{m-1}-\tilde{H}_{l}^{m-1}-\tilde{G}_{\imath}^{m-1}\right\}
$$

This modification enables us to compute and store the sum of the spectral components of input data $\sum X_{t}$, thus circumventing the need for storing the individual spectral components $X_{t}$ (Cary and Lorentz, 1993). The process is iterated until an index $m$ that attains the least-squares minimization.

The parameter vector $\mathbf{p}$ that contains the spectral components $\hat{S}_{j}, \tilde{G}_{\mathbf{t}}, \tilde{H}_{l}$, and $\tilde{E}_{k}$, which are associated with the source and recejver locations, offset dependency, and earth's impulse response, is solved for each frequency component $\omega$ using equations (B-104). Rcsults from all frequency components are then combined to obtain the terms in equation (B-98a). The surfaceconsistent spiking deconvolution operator to be applicd to each trace in the data set is then the minimum-phase inverse of $s_{3}(t) * g_{3}(t) * h_{l}(t)$. In the case of predictive deconvolution with a desired prediction lag, for each source, receiver and, midpoint location, a deconvolution operator is computed by using the autocorrelograms of the terms $s_{3}(t), g_{2}(t)$, and $h_{l}(t)$. To each trace in the data set, these operators are then applied in a cascaded manner.

As a by-product of the derivation of the surface-consistent spectral decomposition equation (B-97), trace amplitudes themselves can be corrected for in a surface-consistent manner (Taner and Koehler, 1981). Sum the individual terms in equation (B-97) aver the frequencies:

$$
\sum_{\omega} \tilde{X}_{i}^{\prime}(\omega)=\sum_{\omega} \tilde{S}_{j}(\omega)+\sum_{\omega} \tilde{H}_{i}(\omega)+\sum_{\omega} \tilde{E}_{k}(\omega)+\sum_{\omega} \bar{G}_{2}(\omega)
$$

$(B-105 a)$

Each term yields a scalar that is related to the source, receiver, offset and midpoint locations:

$$
\tilde{x}_{i j}^{\prime}=\tilde{s}_{j}+\tilde{h}_{t}+\tilde{e}_{k}+\tilde{g}_{i} .
$$

$(B-105 b)$

Once computed in the same manner as the terms in equation (B-98a), these scalars are then applied to individual traces in the data set for surface-consistent amplitude corrections.

In practice, application of surface-consistent deconvolution to field data usually involves two terms, only - the source term $s_{3}(t)$ and the receiver term $g_{i}(t)$. In a transition zone, surface conditions at source and receiver locations may vary significantly from dry to wet surface conditions. Hence, the most likely situation where surface-consistent amplitude corrections and deconvolution may be required is transition-zone data. Figure B-4 shows a field data example of surface-consistent deconvolution. Note the variations in the autocorrelograms from one source location to the next and from one receiver location to the next. Differences in reflection continuity are observed within the first $1 \mathrm{~s}$ on the stacked sections created by application of conventional trace-by-trace deconvolution and surface-consistent deconvolution.

## B. 9 Inverse $Q$ Filtering

Consider a 1-D seismogram that represents a compressional plane wave that propagates vertically downward in a homogeneous medium with intrinsic attenuation. This plane wave is expressed as the solution to the scalar wave equation:

$$
\frac{1}{v^{2}} \frac{\partial^{2} P}{\partial t^{2}}=\frac{\partial^{2} P}{\partial z^{2}}
$$

where $P(t, z)$ is the plane wave represented by the 1-D seismogram - a CMP-stacked trace, $t$ is the traveltime, $z$ is the depth variable and $v$ is the wave velocity. We shall assume that the wave velocity is constant.

To solve equation (B-106), first, Fourier transform in the time direction:

$$
\frac{\omega^{2}}{v^{2}} P=\frac{\partial^{2} P}{\partial z^{2}}
$$

where $P(\omega, z)$ is the Fourier tramsform of the wavefield $P(t, z)$, and $\omega$ is the angular frequency. The upcoming wave solution is then given by

$$
P(\omega, z)=P(\omega, z=0) \exp \left(-i \frac{\omega}{v} z\right)
$$

To include amplitude decay in wave propagation in a medium with intrinsic attenuation, the wave velocity is defined as a complex variable:

$$
v=\alpha+i \beta
$$

Substitute equation (B-109) into equation (B-108) to get

$$
P(\omega, z)=P(\omega, z=0) \exp \left(-i \frac{\omega}{\alpha+i \beta} z\right)
$$

By simple algebra, rewrite equation (B-110) as follows:

$$
P(\omega, z)=P(\omega, z=0)^{2} \exp \left(-i \frac{\omega \alpha}{\alpha^{2}+\beta^{2}} z\right) \exp \left(-\frac{\omega \beta}{\alpha^{2}+\beta^{2}} z\right)
$$

For most rocks, the assumption that $\beta$ is much smaller than $\alpha$ can be made. As a result, equation (B-111) can be simplified as follows:

$$
P(\omega, z)=P(\omega, z=0) \exp \left(-i \frac{\omega}{\alpha} z\right) \exp \left(-\frac{\omega \beta}{\alpha^{2}} z\right)
$$

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=264&width=333&top_left_y=188&top_left_x=536)

## s

7म्नाम

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=174&width=340&top_left_y=471&top_left_x=187)

1 40

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=44&width=337&top_left_y=652&top_left_x=183)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=39&width=342&top_left_y=691&top_left_x=181)
$\frac{12}{2} x$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=47&width=373&top_left_y=743&top_left_x=160)
20

2

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=30&width=341&top_left_y=842&top_left_x=181)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=173&width=372&top_left_y=867&top_left_x=158)

C

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0286.jpg?height=615&width=352&top_left_y=454&top_left_x=528)

FIG. B-d. Surface-consistent deconvolution applied to field data: autocorrelograms of (a) the source term, and (b) the receiver term as in equation (B-94), (c) conventional trace-by-trace prestack deconvolution, and (d) surface-consistent deconvolution using the autocorrelation estimates as in (a) and (b) (Analysis by Duane Dopkin).

Now, define a vertical time variable $\tau$ equivalent to the depth variable $z$ via $z=\alpha \tau$, and rewrite equation (B-112):

$$
P(\omega, \tau)=P(\omega, \tau=0) \exp (-i \omega \tau) \exp \left(-\omega \frac{\beta}{\alpha} \tau\right)
$$

Assume an attenuation constant $Q$ that is independent of frequency $\omega$ (Kjartansson, 1979):

$$
\frac{1}{2 Q}=\frac{\beta}{\alpha}
$$

and substitute into equation (B-113) to obtain

$$
P(\omega, \tau)=P(\omega, \tau=0) \exp (-i \omega \tau) \exp \left(-\frac{\omega \tau}{2 Q}\right)
$$

Note from equation (B-115) that the higher the frequency the greater the attentation.

For a nondissipative medium, $\beta=\mathbf{0}$; hence, equation (B-114) states that $Q$ is infinite. As a result, equation (B-115) takes the special form

$$
P(\omega, \tau)=P(\omega, \tau=0) \exp (-i \omega \tau)
$$

The amplitude spectrum of the inverse $Q$ filter is thus given by the exponential scaling function

$$
A(\omega, \tau)=\exp \left(\frac{\omega \tau}{2 Q}\right)
$$

The phase spectrum can either be set to zero, or more appropriately, assumed to be minimumphase. In the latter case, it can be computed by taking the Hilbert transform of the amplitude spectrum given by equation (B-117a) (Section B.4):

$$
\phi(\omega, \tau)=\mathbf{H}\{A(\omega, \tau)\}
$$

where $\mathbf{H}$ represents the Hilbert transform.

By combining the amplitude and phase spectra given by equations ( $B-117 a, b)$, we define the minimum-phase inverse $Q$ filter as

$$
W(\omega, \tau)=A(\omega, \tau) \exp \{-i \phi(\omega, \tau)\}
$$

The inverse $Q$ filtering equation (B-115) now takes the form

$$
P(\omega, \tau)=P(\omega, \tau=0) \exp (-i \omega \tau) W(\omega, \tau)
$$

Note that the time variable $t$ is associated with the input trace $P(t, \tau=0)$ and the time variable $\tau$ is associated with the output trace $P(t=0, \tau)$ after the application of the inverse $Q$ filter.

To apply the filter $W(\omega, \tau)$ to a trace $P(\omega, \tau=0)$, define a time step $\Delta \tau$ and write equation (B-119) in its recursive form:

$$
P(\omega, k \Delta \tau)=P[\omega,(k-1) \Delta \tau] \exp (-i \omega \Delta \tau) W(\omega, \Delta \tau)
$$

where $k=1,2, \ldots, n$, with $n$ number of time steps (number of samples in the input trace).

Equation (B-120) can now be used to describe a procedure for inverse $Q$ filtering:

(a) Fourier transform the input trace $P(t, \tau=0)$ to obtain the complex transform function $P(\omega, \tau=0)$.

(b) Define a time step $\Delta \tau$ and apply the linear phase shift to $P(\omega, \tau=0)$ by multiplying with the exponential $\exp (-w \Delta \tau)$.

(c) Specify a constant $Q$ and apply the inverse $Q$ filter given by equation (B-117a,b) that represents the inverse $Q$ filter.

(d) Repeat steps (a), (b), and (c) for all frequencies.

(e) Sum over all frequencies to obtain the inverse $Q$-filtered wavcfield at time step $\Delta \tau$ given by $P(t=0, \Delta \tau)$.

(f) Repeat step (d) for all time steps $k \Delta T, k=1,2, \ldots, n$, to obtain the inverse $Q$-filtered wavefield $P(t=0, \tau)$ at all times $\tau$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0288.jpg?height=327&width=377&top_left_y=117&top_left_x=155)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0288.jpg?height=148&width=373&top_left_y=464&top_left_x=156)

c

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0288.jpg?height=153&width=374&top_left_y=631&top_left_x=154)

d
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0288.jpg?height=680&width=354&top_left_y=118&top_left_x=534)

FIG. B-5. Inverse $Q$ filtering applied to field data (Saatcilar, 1996): Portion of a stacked section with (a) no deconvolution, (b) inverse $Q$ filtering, (c) inverse $Q$ filtering followed by deconvolution, and (d) deconvoiution, only; (e) average amplitude spectrum of the data shown in (a); (f) average amplitude spectrum of the data shown n (b); (g) average amplitude spectrum of the data shown in (c).

Inverse $Q$ filtering often is applied to data using a constant $Q$ factor. An efficient scheme for a vertically varying $Q$ factor is described by Hargreaves and Calvert (1991).

Figure B-5 shows an example of inverse $Q$ filtering applied to field data. Compare the stacked sections and the average amplitude spectra with no deconvolution, inverse $Q$ filtering, juverse $Q$ filtering followed by deconvolution and deconvolution, only. An inverse $Q$ filter restores the high-frequency components of signal subjected to intrinsic attenuation by the propagation medium. The deconvolution that follows the inverse $Q$ filtering then easily flattens the spectrum within the passband.

## REFERENCES

Backus, M. M., 1959, Water reverberations: Their nature and elimination: Geophysics, 24, 233-261.

Cambois, G. and Stoffa, P. L., 1992, Surface-consistent deconvolution in the log-Fourier doman: Geophysics, 57, 823-840.

Cary, P. W. and Lorentz, G. A., 1993, Four-component surface-consistent deconvolutiou: Geophysics, 58, 383-392.

Claerbout, J. F., 1976, Fundamentels of geophysical data processing: McGraw-Hill Book Co.

Gibson, B. and Larner, K. L, 1982, Comparison of spectral Hattening techniques: unpublished technical document, Western Geophysical Company.

Goupillaud, P., 1961, An approach to inverse filtering of near-surface layer effects from seismic records: Geophysics, 26, 754-760.

Hale, I. D., 1982, $Q$-adaptive deconvolution: Stanford Expl, Proj, Rep. No. 30, 133-158.

Hargreaves, N. D. and Calvert, A. J., 1991, Inverse $Q$ filtering by Fourier transform: Geophysics, 56, 519-527.

Kjartansson, E., 1979, Constant Q-wave propagation and attenuation: J. Geophys. Res., 84, 47374748.

Levin, S. A., 1989, Surface-consistent deconvolution: Geophysics, 54, 1123-1133.

Lincs, L. R. and Treitel, S., 1984, Tutorial: A review of least-squares inversion and its application to geophysical problems: Geophys. Prosp., 32, 159-186.

Morley, L. and Claerbout, J. F., 1983, Predictive deconvolution in shot-teceiver space: Geophysics, 48, $515-531$.

Peacock, K. L. and Treitel, S., 1969, Predietive deconvolution - theory and practice: Geophysics, $34,155-169$.

Ristow, D. and Jurezyk, D., 1975, Vibroseis deconvolution: Geophys. Prosp., 23, 363-379.

Robinson, E. A. and Treitel, S., 1980, Geophysical signal analysis: Prentice-Hall Book Co.

Seatcilar, R., 1996, An algorithm for $Q$-filtering: J. Seis. Expl., 5, 157-168.

Taner, M. T. and Coburn, K., 1981, Surface-consistent deconvolution: Presented at the 51st Ann. Internat. Mtg., Soc. Expl. Geophys.

Taner, M. T. and Koehler, F., Surface-consistent corrections: Geophysics, 46, 17-22.

Treitel, S. and Robinson, E. A., 1966, The dosign of high-resolution filters: Inst. Electr. Electron. Eng., GE-4, 1 .

Walden, A. T. and Hosken, J. W. J., 1984, An investigation of the spectral properties of primary reflections coefficients: Presented at the 46th Ann. Mtg. Eur. Assoc. Expl. Geophys.

Waters, K. H., 1981, Reflection seismology: Second edition, John Wiley \& Sons.

Yilmaz, O., 1974, The problems of resolution and reverberations in reflection seismology: $\mathrm{J}$. Geophys. Soc. Turkey, $5,2$.

# 3 Velocity Analysis and Statics Corrections 

\begin{abstract}
- Introduction $\cdot$ Normal Moveout $\cdot$ NMO for a Flat Reflector $\cdot$ NMO in a Horizontally Stratified Earth $\cdot$ FourthOrder Moveout $\cdot$ NMO Stretching $\cdot$ NMO for a Dipping Reflector $\bullet$ NMO for Several Layers with Arbitrary Dips $\cdot$ Moveout Velocity versus Stacking Velocity $\cdot$ Velocity Analysis $\cdot$ The Velocity Spectrum $\cdot$ Measure of Coherency - Factors Affecting Velocity Estimates - Interactive Velocity Analysis - Horizon Velocity Analysis - Coherency Attribute Stacks - Residual Statics Corrections - Residual Statics Estimation by Traveltime Decomposition - Residual Statics Estimation by Stack Power Maximization - Traveltime Decomposition in Practice - Maximum Allowable Shift $\cdot$ Correlation Window $\bullet$ Other Considerations $\bullet$ Stack-Power Meximization in Practice $\bullet$ Refraction Statics Corrections $\cdot$ First Breaks $\cdot$ Field Statics Corrections $\cdot$ Flat Refractor $\cdot$ Dipping Refractor $\cdot$ The PlusMinus Method $\bullet$ The Generalized Reciprocal Method $\bullet$ The Least-Squeres Method $\bullet$ Processing Sequence for Statics Corrections $\cdot$ Model Experiments $\cdot$ Field Data Examples $\cdot$ Exercises $\cdot$ Appendix C: Topics in Moveout and Statics Corrections $\cdot$ The Shifted Hyperbola $\cdot$ Moveout Stretch $\cdot$ Equations for a Dipping Reflector $\cdot$ Traveltime Decomposition for Residual Statics Estimation $\bullet$ Depth Estimation from Refracted Arrivals $\bullet$ Equations for a Dipping Refractor $~$ The Plus-Minus Times $\cdot$ Generalized Linear Inversion of Refracted Arrivals - Refraction Traveltime Tomography $L_{1}$-Norm Refraction Statics $\cdot$ References
\end{abstract}

### 3.0 INTRODUCTION

A sonic $\log$ represents derect measurement of the velocity with which seismic waves travel in the earth as a function of depth. Seismic data, on the other hand, provide an indinect measurement of velocity. Based on these two types of information, the exploration seismologist derives a large number of different types of velocity - interval, apparent, average, root-mean-square (rms), instantaneous, phase, group, normal moveout (NMO), stacking, and migration velocities. However, the velocity that can be derived reliably from seismic data is the velocity that yields the best stack.

Assuming a layered media, stacking velocity is re- lated to normal-moveout velocity. This, in turn, is related to the root-mean-squared (rms) velocity, from which the average and interval velocities are derived. Interval velocity is the average velocity in an interval between two reflectors.

Several factors influence interval velocity within a rock unit with a certain lithologic composition:

(a) Pore shape,

(b) Pote pressure,

(c) Pore fluid saturation,

(d) Conftning pressure, and

(e) Temperature.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0291.jpg?height=319&width=331&top_left_y=134&top_left_x=94)

## Conflning Pressure (kbar)

FIG. 3.0-1. Change of $P$ - and $S$-wave velocities as a function of confining pressure observed in dry and watersaturated Bedford hmestone samples with pores in the form of microcracks. Fluid volume has been kept constant duting measurements. Here, $S=$ saturated, $D=\mathrm{dry}, v_{p}=$ $P$-wave velocity, and $v_{S}=S$-wave velocity. (Adapted from Nur, 1981.)

These factors have been investigated extensively under laboratory conditions. Figure 3.0-1 shows laboratory measurements of velocity as a function of the confining pressure in a Bedford limestone sample with pores in the form of microcracks. The experiment was conducted using enclosed samples to control the pore fluid pressure independent of the confining pressure. tions:

From Figure 3.0-1, we make the following obsetva-

(a) Both compressional $(P)$ and shear $(S)$ wave velocities increase with increasing confining pressure. More specifically, velocity generally increases rapidly with confining pressure at small confining pressures, then gradually levels off at high confining pressures. The reason for this is that as the confining pressure increases, pores close. However, at a high confining pressure, not much deformable pore space is left. Therefore, any further increase in the confining pressure will not cause i significant increase in velocity.

(b) Note that, regardless of confining pressure, $P$-wave velocity is greater than $S$-wave velocity. This is true for any rock type.

(c) The saturated rock sample has a higher $P$-wave velocity than the dry sample at low confining pressure. At bigh confining pressures, $P$-wave velocity

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0291.jpg?height=270&width=425&top_left_y=139&top_left_x=507)

## Confining Pressure (kbar)

FIG. 3.0-2. Change of $P$ - and $S$-wave velocities as a function of confining pressure observed in Berea sandstone sarnples with rounded pores. Fluid volume has been kept constant during measurements. Here, $v_{p}=P$-wave velocity and $v_{S}=S$.wave velocity. (Adepted from Nur, 1981.)

in the dry sample approaches the magnitude of the $P$-wave velocity in the saturated sample.

(d) Note also that the $P$-wave velocity in the saturated sample does not change as rapidly as in the dry sample. This is because the fluid is almost as incompressible as the rock. Whether the pores are filled with fluid or not has little effect on $S$-wave velocity, since fluids cannot support shear-wave propagation.

We now examine velocity as a function of confining pressure for an enclosed sample of Berea sandstonc with rounded pores (Figure 3.0-2). Again, note the increase in velocity with increasing confining pressure. The important difference between this sample and the one in Figure 3.0-1 is the range of magnitude of the velocity. The rock with microcracks has a higher velocity than the rock with rounded pores at any given confining pressure. The reason for this is that it is easier to close the pores formed as microcracks than it is to close those that are round.

The most prominent factor influencing velocity in a rock of given lithology and porosity probably is confining pressure. This type of pressure arises from the overburden and increases with depth. It is generally true that velocity increases with depth. However, because of factors such as pore pressure, there may be inversion in the velocity within a layer.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0292.jpg?height=385&width=444&top_left_y=124&top_left_x=73)

FIG. 3.0-3. Velocity range for rocks of different lithologic compasitions at different depths of burial. (Adapted from Sheriff, 1976; courtesy American Association of Petroleum Geologists.)

Figure 3.0-3 shows the variation of velocity with depth for various types of lithology. We make the following observations:

(a) Tertiary clastics, which usually are less indurated than other rocks, occupy the low-velocity end of the graph. They generally start out with a velocity that ranges from 1.5 to $2.5 \mathrm{~km} / \mathrm{s}$ at or near the surface, then gradually increase to from 4.5 to 5.5 $\mathrm{km} / \mathrm{s}$ at depths greater than $5 \mathrm{~km}$.

(b) Carbonates with high porosity occupy the central portion of the graph, starting at about $3 \mathrm{~km} / \mathrm{s}$ and increasing to nearly $6 \mathrm{~km} / \mathrm{s}$.

(c) Carbonates with low porosity, on the other hand, have a smaller range of variation in velocity. If there is not much pore space to close, then the confining pressure cannot cause much of an increase in velocity.

This chapter discusses ways to estimate velocities from seismic data. Velocity estimation requires the data recorded at nonzero offsets provided by commonmidpoint (CMP) recording. With estimated velocities, we can correct reflection traveltimes for nonzero offset and compress the recorded data volume (in midpointoffset-time coordinates) to a stacked section (Figure 1.5$1)$.

For a single constant-vclocity horizontal layer, the reflection traveltime curve as a function of offet is a hyperbola (Section 3.1). The time difference between traveltime at a given offset and at zero offset is called normal moveout (NMO). The velocity required to correct for normal moveout is called the normal moveout velocaty. In the case of an earth model with a single horizontal reflector, the NMO velocity is equal to the velocity of the medium above the reflector. In the case of an earth model with a single dipping reflector, the NMO velocity is equal to the medium velocity divided by the cosine of the dip angle. When the dipping reflector is viewed in three dimensions, then the azimuth angle (between the dip direction and the profiling direction) becomes an additional factor. Traveltime as a function of offset for a series of horizontal isovelocity layers is approximated by a hyperbola. This approximation is better at small offsets than large offsets. For short offsets, the NMO velocity for a horizontally layered earth model is equal to the rms velocity down to the layer boundary under consideration. In a medium composed of layers with arbitrary dips, the traveltime equation gets complicated. However, in practice, as long as dips are gentle and the spread is small (less than reflector depth), the hyperbolic assumption still can be made. For layer boundaries with arbitrary shapes, the hyperbolic assumption breaks down.

There is a difference between the NMO and stacking velocities that often is ignored in practice. The NMO velocity is based on the small-spread hyperbolic traveltime (Tarer and Koehler, 1969; Al-Chalabi, 1973), while stacking velocity is based on the hyperbola that best fits data over the entire spread length. Nevertheless, stacking velocity and NMO correction velocity generally are considered equivalent.

Conventional velocity analysis is based on the hyperbolic assumption. Various methods for velocity analysis are discussed in Section 3.2. The hyperbolic travcltime equation is linear in the $t^{2}-x^{2}$ plane, where $t$ is the two-way traveltime and $x$ is the source-recciver offset. Zero-offset time and stacking velocity for a given reflector can be estimated from the line that best fits the traveltime picks plotted on the $t^{2}-x^{2}$ plane. Another way to estimate the NMO velocity is to apply different NMO corrections to a CMP gather using a range of constant velocity values, then display them side by side. The velocity that best flattens each event as a function of offset is picked as its NMO velocity. Alternatively, a small portion of a line can be stacked with a range of constant velocity values. These constant-velocity stacks (CVS) can be plotted in the form of a panel. Stacking velocities that yield the desired stack then can be picked from the CVS panel.

Another commonly used velocity analysis technique is based on computing the velocity spectrum (Taner and Kochler, 1969). The idea is to display some
measure of signal coherency on a graph of velocity versus two-way zero-offset time. The underlying principle is to compute the signal coherency on the CMP gather in small time gates that follow a trajectory in offset. Stacking velocities are interpreted from velocity spectra by choosing the velocity function that produces the highest coherency at times with significant event amplitudes.

Occasionally the stacking velocity variation needs to be determined in detail along a particular reflector. Horizon-consistent velocity analysis provides the stacking velocity variation in the lateral direction along a particular horizon of interest.

Reflection traveltimes are not always hyperbolic in horizontally layered media. One reason that traveltine often deviates from a perfect hyperbola is the presence of static time shifts caused by near-surface velocity variations. Statics carl severely distort the reflection hyperbola when there are large surface elevation changes or when the weathering layer varies horizontally. Shown in Figure 3.0-4 is a stacked section that exhibits severe distortions of reflection traveltimes in the susburface, which is known to have generally flat layers, caused by the complexity in the near-surface that is composed of glacia] tills with irregular shapes. The traveltime distortions caused by the near-surface also are observed in the CMP gather shown in Figure 3.0-5a. The velocity spectrum derived from the CMP gather that has not been corrected for the near-surface does not exhibit a reliable stacking velocity trend (Figure 3.0-6a). By estimating a model for the near-surface and correcting for its effects on the reflcction traveltimes in the subsurface using the refracted arrivals from the near-surface, the resulting CMP gathor (Figure $3.0-5 \mathrm{~b}$ ) yields a more accurate estimate of stacking velocities (Figure 3.0-6b). The CMP stack derived from the CMP gathers with statics corrections exhibits reflection traveltimes free of the near-surface distortions (Figure 3.0-7). A close-up of portions of the CMP stack without (Figure 3.0-4) and with (Figure 3.0-7) statics corrections clearly demonstrates the improvement achieved by the statics corrections as shown in Figure 3.10-8.

Residual statics variations usually remain in the data even after initial corrections for estimated weathering layer variations and elevation changes (field statics) (Section 3.4). Corrections for residual statics normally must be estimated and applied to CMP gathers before stacking. Estimation is done after a preliminary NMO correction using either a regional velocity function or information from a series of preliminary velocity analyses along the line. Following the residual statics corrections, velocity analyses usually are repeated to revise the velocity picks for stacking. Various aspects of residwal statics corrections are discussed in Sections 3.3 and 3.4 .
As a final note, velocities required by stacking and migration are not necessarily the same. In fact, for data collected parallel to the dip direction of a single dipping reflector, stacking velocity is the velocity of the medium above the reflector divided by the cosine of the dip angle, while migration velocity is the velocity of the medium itself. In other words, stacking velocity is dipdependent, while migration velocity is not. Migration velocity estimation is discassed in Section 5.4.

### 3.2 NORMAL MOVEOUT

Consider a reflection event on a CMP gather. The difference between the two-way time at a given offset and the two-way zero-offset time is called normal moveont (NMO). Reflection traveltimes must be corrected for NMO prior to summing the traces in the CMP gather along the offset axis. The normal moveout depends on velocity above the reflector, offset, two-way zero-offset time associated with the reflection event, dip of the reflector, the source-receiver azimuth with respect to the true-dip direction, and the degree of complexity of the near-surface and the medium above the reflector.

## NMO for a Flat Reflector

Figure 3.1-1 shows the simple case of a single horizontal layer. At a given midpoint location $M$, we want to compute the reflection traveltime $t$ along the raypath from shot position $S$ to depth point $D$ then back to receiver position $G$. Using the Pythagorean theorem, the traveltime equation as a. function of offset is

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v^{2}}
$$

where $x$ is the distance (offset) between the source and receiver positions, $v$ is the velocity of the medium above the reflecting interface, and $t_{0}$ is twice the traveltime along the vertical path $M D$. Note that vertical projection of depth point $D$ to the surface, along the normal to the reflector, coincides with midpoint $M$. This occurs only when the reflector is horizontal.

Equation (3-1) describes a hyperbola in the plane of two-way time versus offset. Figure 3.1-2 is an example of traces in a common-midpoint (CMP) gather. The figure also represents a common-depth-point (CDP) gather, since all the raypaths associated with each source-receiver pair reflect from the same subsurface depth point $D$. The offset range in Figure 3.1-2 is 0 to $3150 \mathrm{~m}$, with a $50-\mathrm{m}$ trace separation. The medium velocity above the reflector is $2264 \mathrm{~m} / \mathrm{s}$. All of the traces

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0294.jpg?height=1054&width=810&top_left_y=163&top_left_x=113)

3770
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=400&width=370&top_left_y=146&top_left_x=138)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=55&width=308&top_left_y=534&top_left_x=147)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=37&width=313&top_left_y=569&top_left_x=149)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=38&width=360&top_left_y=598&top_left_x=143)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=28&width=313&top_left_y=624&top_left_x=151)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=47&width=316&top_left_y=639&top_left_x=146)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=52&width=363&top_left_y=670&top_left_x=144)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=36&width=310&top_left_y=709&top_left_x=145)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=50&width=306&top_left_y=726&top_left_x=149)

Primpthenther

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=27&width=366&top_left_y=779&top_left_x=139)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=37&width=318&top_left_y=800&top_left_x=148)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=49&width=319&top_left_y=828&top_left_x=145)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=33&width=314&top_left_y=860&top_left_x=149)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=27&width=352&top_left_y=876&top_left_x=151)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=24&width=309&top_left_y=894&top_left_x=153)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=29&width=312&top_left_y=910&top_left_x=151)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=34&width=355&top_left_y=930&top_left_x=149)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=26&width=362&top_left_y=955&top_left_x=143)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=33&width=310&top_left_y=974&top_left_x=149)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=32&width=314&top_left_y=1000&top_left_x=149)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=28&width=315&top_left_y=1031&top_left_x=148)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0295.jpg?height=902&width=373&top_left_y=130&top_left_x=517)

(b)

FIG. 3.0-5. A CMP gather associated with the stacked section in Figure 3.0-4 (a) without, and (b) with statics corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0296.jpg?height=654&width=397&top_left_y=108&top_left_x=145)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0296.jpg?height=647&width=344&top_left_y=112&top_left_x=536)

(b)

FIG. 3.0-6. Velocity spectra derived from the CMP gather shown in Figure 3.0-5 (a) without, and (b) with statics corrections,

in this CMIP gather contain a refiection from the same depth point.

From equation (3-1), we see that velocity can be computed when offset $x$ and two-way times $t$ and $t_{0}$ are known. Once the NMO velocity is estimated, the traveltimes can be corrected to remove the effect of offset as shown in Figure 3.1-3. Traces in the NMO-corrected gather then are summed to obtain a stack trace at the particular CMIP location.

The numerical procedure involved in hyperbolic moveout correction is illustrated in Figute 3.1-4. The idea is to find the amplitude value at $A^{\prime}$ on the NMOcorrecterl gather from the amplitude value at $A$ on the original CMP gather. Given quantities $t_{0}, x$, and $v_{N M O}$, compute $t$ from equation (3-1). Assume that this is 1003 mas. If the sampling interval were $4 \mathrm{~ms}$, then this time is exuivalent to the 250.25 sample index. The amplitude value at this time can be computed using the ampli- tudes at the neighboring integer sample valus, two on each side at $248,249,251$, and 252 sample indexes. This is done by an interpolation scheme that involves the four samples.

An alternative numerical method for mapping trace amplitudes from a nonzero-offset to zero offset involves a nearest-neighbor sample as the output value. Accurate implementation of this method requires, first, oversampling the tracts in a CMP gather along the time axis. Specifically, for each trace in the CMP gather, perform 1-D Fourier transform and pad the frequency axis with zeroes, usually by a factor of eight. Then, inverse transform back to the time domain and obtain a trace which has eight times as many samples at a sampling interval that is one-eighth of the original sampling rate. Now, given quantitics $t_{0}, x$, and $v_{N M O}$, again, compute $t$ from equation (3-1). Assume that this is $t=1003.4$ ms. If the original sampling interval were 4 ms, after

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0297.jpg?height=1061&width=791&top_left_y=161&top_left_x=122)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0298.jpg?height=728&width=412&top_left_y=117&top_left_x=106)

(a)
2727029290313103333035350373703939041410

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0298.jpg?height=679&width=391&top_left_y=167&top_left_x=528)

(b)

FIG. 3.0-8. A close-up of portions of the CMP stacks shown in (a) Figure 3.0-4 and (b) Figure 3.0-7.

oversampling, the new sampling interval is $0.5 \mathrm{~ms}$. Then the amplitude at $t=1003.4 \mathrm{~ms}$ can be borrowed from the nearest-neighbor sample with an index of 2006 without much sacrifice in accuracy.

The NMO correction is given by the difference between $t$ and $t_{0}$ :

$$
\Delta t_{N M O}=t-t_{0}
$$

or, by way of equation (3-1),

$$
\Delta t_{N M O}=t_{0}\left[\sqrt{1+\left(\frac{x}{v_{N M O} t_{0}}\right)^{2}}-1\right] .
$$

Table 3-1 shows the moveout corrections for two different offset values using a realistic velocity function that increases with reflector depth.

From Table 3-1, note that the NMO increases with offset and decreases with zero-offset time, hence, with depth. The NMO also is smaller for higher velocities, and the combined effect of higher velocities at larger depths makes it much smaller.

For a flat reflector with an overlying homogeneous medium, the reflection hyperbola can be corrected for offset if the correct medium velocity is used in the NMO equation. From Figure 3.1-5, if a velocity higher than the actual medium velocity $(2264 \mathrm{~m} / \mathrm{s})$ is used, then

Table 3-1. NMO correction as a function of offset $x$ and two-way zero-offset time $t_{0}$ for a given velocity function $v_{N M O}$

|  |  | $\Delta t_{N M O}$, in s <br> $x=1000 \mathrm{~m}$ | $\Delta t_{N M O}$, in s <br> $x-2000 \mathrm{~m}$ |
| :--- | :---: | :---: | :---: |
| 0.25 | 2000 | 0.309 | 0.780 |
| 0.5 | 2500 | 0.140 | 0.443 |
| $\mathbf{1}$ | 3000 | 0.054 | 0.201 |
| 2 | 3500 | 0.020 | 0.080 |
| $\mathbf{4}$ | 4000 | 0.008 | 0.031 |

the hyperbola is not flattened completely. This is called undercorrection. On the other hand, if a lower velocity is used, then overcorrection results.

Figure 3.1-5 also illustrates the basis of conventional velocity analysis. NMO correction is applied to the input CMP gather using a number of trial constant velocity values in equation (3-2b). The velocity that best flattens the reflection hyperbola is the velocity that best corrects for NMO before stacking the traces in the gather. Furthermore, for a simple case of a single horizontal reflector, this velocity also is equal to the velocity of the medium above the reflector.

## NMO in a Horizontally Stratified Earth

We now consider a medium composed of horizontal isovelocity layers (Figure 3.1-6). Each layer has a certain thickness that can be defined in terms of twoway zero-offset time. The layers have interval velocities $\left(v_{1}, v_{2}, \ldots, v_{N}\right)$, where $N$ is the number of layers. Consider the raypath from source $S$ to depth point $D$, back to receiver $R$, associated with offset $\tau$ at midpoint location M. Taner and Kohler (1969) derived the traveltime equation for this path as

$$
t^{2}=C_{0}+C_{1} x^{2}+C_{2} x^{4}+C_{3} x^{6}+\cdots
$$

where $C_{0}=t_{0}{ }^{2}, C_{1}=1 / v_{r m g}^{2}$, and $C_{2}, C_{3}, \cdots$ are complicated functions that depend on layer thicknesses and interval velocitiss (Section C.1). The rms velocity $t_{\tau+n s}$ down to the reflector on which depth point $D$ is situated is defined as

$$
v_{r m s}^{2}=\frac{1}{t_{0}} \sum_{i}^{N} v_{i}^{2} \Delta \tau_{2}
$$

where $\Delta \tau_{1}$ is the vertical two-way time through the ith layer and $t_{0}=\sum_{t-1}^{N} \Delta \tau_{z}$. By making the small-spread approximation (offset small compared to depth), the series in equation (3-3) can be truncated to obtain the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0299.jpg?height=225&width=396&top_left_y=124&top_left_x=556)

FIC. 3.1-1. The NMO geometry for a single horizontal reflector. The trave'time is described by a hyperbola represented by equation (3-1).

familiar hyperbolic form

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v_{r m s}^{2}}
$$

When equations (3-1) and (3-4b) are compared, we see that the velocity required for NMO correction for a horizontally stratified medium is equal to the rms velocity, provided the small-spread approximation is made.

How much error is caused by dropping the higher order terms in equation (3-3)? Figure 3.1-7a shows a CMP gather based on the velocity model in Figure 3.18. Traveltimes to all four reflectors were computed by the raypath integral equations (Grant and West, 1965) that exactly describe wave propagation in a horizontally layered earth model with a given interval velocity function. We now replace the layers above the second shallow event at $t_{0}=0.8 \mathrm{~s}$ with a single layer with a velocity equal to the rms velocity down to this reflector

$2264 \mathrm{~m} / \mathrm{s}$. The resulting traveltime curve, computed using equation (3-4b), is shown in Figure 3.1-7b. This procedure is repeated for the deeper events at $t_{0}=1.2$ and $1.6 \mathrm{~s}$ as shown in Figures $3.1-7 \mathrm{c}$ and $\mathrm{d}$. Note that the traveltime curves in Figures 3.1-7b, $c$, and $d$ are perfect lyperbolas. How different are the traveltime curves in Figure 3.1-7a from these hyperbolas? After careful examination, note that the traveltimes are slightly different for the shallow events at $t_{0}=0.8$ and $1.2 \mathrm{~s}$ only at large offsets ${ }_{\text {particularly beyond }} 3 \mathrm{~km}$. By dropping the higher order terms, we approximate the reflection times in a horizontally layered earth with a small-spread hyperbola.

## Fourth-Order Moveout

A review of the moveout equation (3-3) to attain higher accuracy at, far offsets is given in Section C.1. At first,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0300.jpg?height=808&width=361&top_left_y=128&top_left_x=105)

FIG. 3.1-2. Systhetic CMP gather associated with the geometry in Figure 3.1-1. Traveltime curve for a flat reflector is a hyperbola with its apex at zero-offset trace.

it serms that including the terms up to the fourth-order in equation (3-3) should achieve this objective:

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v_{r m s}^{2}}+C_{2} x^{4}
$$

Nevertheless, to compute a velocity spectrum using this equation requires scanning for two parameters $v_{r m s}$ and $C_{2}$; thus, making equation (3-5a) cumbersome to use for velocity analysis. Below, a practical scheme to

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0300.jpg?height=361&width=416&top_left_y=125&top_left_x=538)

(a)

FIG. 3.1-3. NMO correction (equation 3-2a) involves mapping nonzero-offset traveltime $t$ onto zero-offset traveltime $t_{0}$. (a) Before and (b) after NMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0300.jpg?height=288&width=409&top_left_y=634&top_left_x=536)

FIG. 3.1-4. Computational description of NMO correction. For a given integer value for $t_{0}$, and velocity $v$ and offset $x$, compute $t$ using equation (3-1). The amplitude at time $t$, denoted by $A$, does not necessarily fall onto an input integer sample location. By using two samples on each side of $t$ (denoted by solid dots), we can interpolate between the four amplitude values to compute the amplitude value at $t$. This amplitude value then is mapped onto output integer sample $t_{0}$ denoted by $A^{\prime}$ at the corresponding offset.

compute a velocity spectrum using equation (3-5a) is suggested:

(a) Drop the fourth-order term to get the small-spread hyperbolic equation (3-4b). Compute the conven-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0301.jpg?height=441&width=229&top_left_y=127&top_left_x=102)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0301.jpg?height=434&width=194&top_left_y=135&top_left_x=326)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0301.jpg?height=434&width=186&top_left_y=135&top_left_x=526)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0301.jpg?height=442&width=226&top_left_y=127&top_left_x=715)

(d)

FIG. 3.1-5. (a) CMP gather containing a single event with a moveout velocity of $2264 \mathrm{~m} / \mathrm{s}$, (b) NMO-corrected gather using the appropriate moveout velocity, (c) overcorrection because too low a velocity ( $2000 \mathrm{~m} / \mathrm{s}$ ) was used in equation (3-2b), and (d) undercorrection because too high a velocity ( $2500 \mathrm{~m} / \mathrm{s}$ ) was used in equation (3-2b).

tional velocity spectrum (Section 3.2) by varying $v_{r m s}$ in equation (3-4b), and pick an initial velocity function $v_{r m s}\left(t_{0}\right)$.

(b) Use this picked velocity function in equation (35a) to compute a velocity spectrum by varying the parameter $C_{2}$, and pick a function $C_{2}\left(t_{0}\right)$.

(c) Use the picked function $C_{2}\left(t_{0}\right)$ in equation (3-5a) to recompute the velocity spectrum by varying $v_{r m s}$. Finall $y_{2}$ pick an updated velocity function $v_{r m s}\left(t_{0}\right)$ from this velocity spectrum.

Castle (1994) shows that a time-shifted hyperbola of the form

$$
t=t_{0}\left(1-\frac{1}{S}\right)+\sqrt{\left(\frac{t_{0}}{S}\right)^{2}+\frac{x^{2}}{S v_{r m s}^{2}}} \quad(3-5 b)
$$

is an exact equivalent of the fourth-order moveout equa tion (3-5a). Here, $S$ is a constant (Section C.1). For $S=1$, equation (3-5b) reduces to the conventional small-spread moveout equation (3-4b).

As for the fourth-order moveout equation (3-5a), the time-shifted hyperboiic cquation (3-5b) can, in principle, be used to conduct velocity analysis of CMP gathers.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0301.jpg?height=341&width=416&top_left_y=761&top_left_x=538)

FIG. 3.1-6. A hormontally layered earth model geometry. The traveltume to the deepest reflector is described by equation (3-3). An approximate form of this equation used in practice is given by equation (3-4b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0302.jpg?height=454&width=841&top_left_y=122&top_left_x=101)

(a)

(b)

(c)

(d)

FIG. 3.1-7. (a) A synthetic CMP gather derived from the velocity function depicted in Figure 3.1-8; (b), (c), and (d) are CMP gathers derived from the rms velocities (indicated at the top of each gather) associated with the second, third, and fourth reflectors from the top The traveltimes in (a) were derived using the raypath integral equations for a horizontally layered earth model.

(a) Set $S=1$ in equation (3-5b) to get equation (3-4b). Compute the velocity spectrum by varying $v_{r m s}$ in equation (3-4b), and pick an initial velocity function $v_{r m s}\left(t_{0}\right)$.

(b) Use this picked volocity function in equation (35b) and compute a velocity spectrum by varying the parameter $S$. Pick a function $S\left(t_{0}\right)$, and

(c) use it in equation (3-5b) to recompute the velocity spectrum by varying $v_{r m s}$. Finally, pick an updated velocity function $v_{r m s}\left(t_{0}\right)$ from this velocity spectrum.

De Bazelaire (1988) offers an alternative moveout equation to achieve higher-order accuracy at far offsets:

$$
t=\left(t_{0}-t_{p}\right)+\sqrt{t_{p}^{2}+\frac{x^{2}}{v_{s}^{2}}}
$$

where $t_{0}$ is the two-way zero-offset time, $t_{p}$ is related to the time at which the asymptotes of the hyperbolic traveltime trajectory converge (Section C.1), and $v_{s}$ is the reference velocity assigned to the layer below the recording surface (not the near-surface layer). When $t_{p}=t_{0}$, cquation (3-5c) reduces to the small-spread hyperbolic equation (3-4b).

Thore and Kelly (1992) demonstrate the use of equation (3-5c) to obtain a stacked section with a higher stack power compared to the conventional stack de rived from the small-spread moveout equation (3-4b). To use equation (3-5c) for velocity analysis, choose a fixed value of reference velocity $v_{s}$. Then, for each output time $t_{0}$ and for each offset $x$, apply time shift $t_{p}$ to traces in the CMP gather and compute the input time $t$ for the offset under consideration. Compute a velocity spectrum for a range of $t_{p}$ values. Finally, pick a function $t_{p}\left(t_{0}\right)$ from the velocity spectrum.

## NMO Stretching

Figure 3.1-9b shows the CMP gather in Figure 3.1$7 \mathrm{a}$ after $\mathrm{NMO}$ correction. The rms velocity function shown in Figure 3.1-8 was used in equation (3-2b) for this correction. As a result of the NMO correction, a frequency distortion occurs, particularly for shallow events and at large offsets. This is called NMO stretching and is illustrated in Figure 3.1-10. The waveform with a dominant period $T$ is stretched so that its period $T_{0}$, after NMO correction, is greater than $T$. Stretching is a frequency distortion in which events are shifted to lower frequencies. Stretching is quantified by

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0303.jpg?height=388&width=386&top_left_y=118&top_left_x=102)

FIG. 3.1-8. A hypothetical velocity function used in generating the synthetic CMP gather in Figure 3.1-7a.

$$
\frac{\Delta f}{f}=\frac{\Delta t_{N M O}}{t_{0}}
$$

where $f$ is the dominant frequency, $\Delta f$ is the change in frequency, and $\Delta t_{\text {NMO }}$ is given by equation (3-2b). The derivation of equation (3-6) is given in Section C.1.

Table 3-2 lists the percent frequency changes caused by the NMO stretching associated with the velocity function in Table 3-1. Note that stretching is confined mainly to large offsets and shallow times. For $\mathrm{cx}$ ample, a wavcform with a $30-\mathrm{Hz}$ dominant frequency at $2000-\mathrm{m}$ offset and $t_{0}=0.25 \mathrm{~s}$ shifts to nearly $10 \mathrm{~Hz}$ after $\mathrm{NMO}$ correction.

Because of the stretched waveform at large offsets, stacking the NMO-corrected CMP gather (Figure $3.1-9 b$ ) will severely damage the shallow events. This problem can be circunvented by muting the stretched zones in the gather. Autonatic muting is done by using the quantitative definition of stretching given by equation (3-6). Figures 3.1-9c and $d$ show two versions of the CMP gather after NMO correction and muting; one version has a stretch linit of 50 percent, while the other has a stretch limit of 100 percent. The 50 -percent stretch limit does not show significant frequency distortion. However, the stretch limit can be extended to 100 percent because we want to include as much of the CMP gather in the stack as possible without degradation.

A trade-off exists between the signal-to-noise ratio and mute. In particular, if the signal-to-noise ratio is good, then it may be preferable to mute more than stretch tnute requirements to preserve signal bandwidth. On the other band, if the signal-to-noise ratio is
Table 3-2. NMO stretching

|  |  | $\% \Delta f / f$ for | $\% \Delta f / f$ for |
| :--- | :---: | :---: | :---: |
| $t_{0}, \mathrm{~s}$ | $v_{\text {NMO }}, \mathrm{m} / \mathrm{s}$ | $\%=1000 \mathrm{~m}$ <br> $x-2000 \mathrm{~m}$ |  |
| 0.25 | 2000 | 123 | 312 |
| 0.5 | 2500 | 28 | 89 |
| 1 | 3000 | 5 | 20 |
| 2 | 3500 | 1 | 4 |
| 4 | 4000 | 0.2 | 0.8 |

poor, it may be necessary to accept a large antount of stretch to get any events on the stack. A real data example is provided in Figure 3.1-11. Here, the stretched zone is sen as the low-frequency zone at the shallow part of the CMP gathers without mute applied.

Another method for optimurn selection of the mute zone is to progressively stack the data. Figure 3.1-12a is an NMO-corrected CMP gather without mute applied. Figure 3.1-12b shows the stack traces derived from the CMP gather (Figure 3.1-12a). The far right trace is the same as the far right trace in the input CMP gather. The second trace from the right is the sum of the two near-offsct traces, and so on, progressively increasing the stacking fold. The far left trace is the full-fold stack of the input CMP gather. By following the waveform along a certain event and observing where changes occur, the mute zone is derived as shown in Figure 3.1-12b. A similar procedure can be followed to determine an inside mute. This time, the stacking fold is progressively increased in the near-offset direction.

Aside from the signal-to-noise ratio, attenuation of multiples dictates the choice of a suitable mute pattern. Specifically, large offsets often are needed to attenuate multiple reflections based on moveout discrimination between primaries and multiples. An inside mute may be needed in addition to the application of a multiple attenuation technique to alleviate the small moveout discrimination between primaries and multiples at small offsets. An inside mute also may be applied to lend records to suppress ground-roll energy and air waves associated with surface sources.

Muting also is dependent upon the ultimate use of the stacked data. If the stacked data are iutended as input to amplitude inversion, you may want to apply a harsh mute to minimize the angle-dependency of reflection amplitudes inferred by the Zoeppritz equations (Section 11.3). If the stacked data are intended as input to poststack depth migration, then a limited-offset stack may be needed to minimize the amplitude and traveltine distortions caused by the nonhyperbolic noveout

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0304.jpg?height=467&width=243&top_left_y=134&top_left_x=74)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0304.jpg?height=466&width=200&top_left_y=136&top_left_x=310)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0304.jpg?height=463&width=194&top_left_y=138&top_left_x=505)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0304.jpg?height=466&width=237&top_left_y=136&top_left_x=696)

(d)

FIG. 3.1-9. (a) Same gather as in Figure $31-7 a_{1}$ (b) after moveout correction using the rms velocty function depicted in Figure $31-8$, (c) and (d) after muting using threshold stretch linits of 50 and 100 percent, respectively.

associated with reflections below conplex overburden structures (Section 8.0).

## NMO for a Dipping Reflector

Figure 3.1-13 depicts a medium with a single dipping reflector. We want to compute the traveltime from source location $S$ to the reflector at depth point $D$, then back to receiver location $G$. For the dipping reflector, midpoint $M$ is no longer a vertical projection of the depth point to the surface. The terms $C D P$ gather and $C M P$ gather are equivalent only when the earth is horizontally stratified. When there is subsurface dip or lateral velocity variation, the two gathers are different. Midpoint $M$ and the normal-incidence reflection point $D^{\prime}$ remain common to all of the source-receiver pairs within the gather, regardless of dip. Depth point $D$, however, is different for each source-receiver pair in a CMP gather recorded over a dipping reflector.

Levin (1971), using the geometry of Figure 3.1-13, derived the following two-dimensional (2-D) traveltime

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0304.jpg?height=385&width=374&top_left_y=760&top_left_x=559)

(a)

FIG. 3.1-10. A signal (a) with a period of $T$ is stretched to a signal (b) with a period of $T_{0}>T$ after NMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0305.jpg?height=563&width=290&top_left_y=126&top_left_x=92)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0305.jpg?height=561&width=272&top_left_y=127&top_left_x=384)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0305.jpg?height=565&width=293&top_left_y=125&top_left_x=659)

(c)

FIG. 3.1-11. NMO correction and muting of a stretched zone on field data, (a) CMP gathers, (b) NMO correction, and (c) mute.

equation for a dipping reflector (Section C.3):

$$
t^{2}=t_{0}^{2}+\frac{x^{2} \sin ^{2} \alpha}{v^{2}}
$$

where the two-way traveltime $t$ is associated with the nonzero-offset raypath $S D G$ from source $S$ to reflection point $D$ to receiver $G$, the two-way zero-offset time $t_{0}$ is associated with the normal-incidence raypath $M D^{\prime}$ at midpoint $M$, and $\alpha$ is the angle between the normal to the dipping reflector and the direction of the line of recording (Figure 3.1-13). The moveout velocity is then given by

$$
t_{N M O}=\frac{v}{\sin \alpha}
$$

For the 2-D geometry of the dipping reflector shown in Figure 3.1-13, note that

$$
\sin \alpha=\cos \phi
$$

where $\phi$ is the dip angle of the reflector. Hence, equations (3-7) and (3-8) are written in terms of the reflector $\operatorname{dip} \phi$

$$
t^{2}=t_{0}^{2}+\frac{x^{2} \cos ^{2} \phi}{v^{2}}
$$

and

$$
v_{N M O}=\frac{v}{\cos \phi} .
$$

The traveltime equation (3-10) for a dipping reflector represents a hyperbola as for the flat reflector (equation 3-1). However, the NMO velocity now is given by the medium velocity divided by the cosine of the dip angle as defined by equation (3-11). This equation indicates that proper stacking of a dipping event requires a velocity that is greater than the velocity of the medium above the reflector.

Table 3-3. NMO velocity for various earth models.

| Model | NMO Velocity |
| :---: | :---: |
| Single Horizontal <br> Layer | Velocaty of the medaum above <br> the reflectang interjace |
| Horizontally Stratified <br> Earth | The rms velocity function <br> proved the spread is small |
| Single Dipping Layer | Medium velocuty duvded by <br> cosine of the dip angle |
| Multilayered Earth <br> with Arbitrary Dips | The rms velocity function <br> pronded the spread is small <br> and the dips are gentle |

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0306.jpg?height=578&width=228&top_left_y=465&top_left_x=177)

(a)

(b)

FIG. 3.1-12. Optimum mute selection. Starting with the NMO-corrected CMP gather in panel (a), a substack gather (b) is obtained. The far right trace $m$ this gather is the same as that in the orignnal gather. The second trace from the right is the stack of the two near traces of the original gather. Finally, the far left trace is the full-fold stack obtenned from the original gather. The area above the dotted line in (b) is the mute zone.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0306.jpg?height=242&width=426&top_left_y=118&top_left_x=538)

FIG. 3.1-13. Geometry for NMO of a single dipping reflector. See text for details.

In conclusion, the NMO velocity for a dipping reflector depends on the dip angle. The larger the dip angle, the higher the moveout volocity, hence the smaller the moveout. There is a 4 percent difference between moveout velocity $v_{N M O}$ and medium velocity $v$ for a 15 degree dip. The difference is 50 percent at a 30 -degree dip and rapidly increases at steep dips. An accompanying observation is that a horizontal layer with a high velocity can yield the same moveout as a dipping layer with a low velocity, as illustrated in Figure 3.1-14.

## NMO for Several Layers with Arbitrary Dips

Figure 3.1-15 shows a 2-D subsurface geometry that is composed of a number of layers, each with an arbitrary dip. We want to compute the traveltime from source location $S$ to depth point $D$, then back to receiver location $G$, which is associated with midpoint $M$. Note that the CMP ray from midpoint $M$ hits the dipping interface at normal incidence at. $D^{\prime}$, which is not the same as $D$. The zero-offset time is the two-way time along the raypath from $M$ to $D^{\prime}$.

Hubral and Krey (1980) derived the expression for traveltime $t$ along $S D G$ as

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v_{N M O}^{2}}+\text { higher order terms, } \quad(3-12)
$$

where the NMO velocity is given by

$$
v_{N M O}^{2}=\frac{1}{t_{0} \cos ^{2} \beta_{0}} \sum_{i=1}^{N} v_{2}^{2} \Delta t_{\imath} \prod_{k=1}^{i-1}\left(\frac{\cos ^{2} \alpha_{k}}{\cos ^{2} \beta_{k}}\right)
$$

The angles $\alpha$ and $\beta$ are defined in Figure 3.1-15. For a single dipping layer, equation (3-13) reduces to equation (3-8). Moreover, for a horizontally stratified earth, equation (3-13) reduces to equation (3-4), As Iong as

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0307.jpg?height=220&width=140&top_left_y=116&top_left_x=93)

(a)
Offset $\rightarrow$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0307.jpg?height=167&width=121&top_left_y=165&top_left_x=228)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0307.jpg?height=169&width=121&top_left_y=160&top_left_x=356)

(c)

FIG. 3.1-14. Moveout for low-volocity event (a) is larger than for high-velocity event (b). Moveout for low-velocity dipping event (c) may not be distinguishable from highvelocity horizontal event (b). These observations are direct consequences of equation (3-7).

the dips are gentle and the spread is small, the traveltime equation is approxinately represented by a hyperbola (equation 3-5), and the velocity required for NMO correction is approximately the rms volocity function (aquation 3-4).

## Moveout Velocity versus Stacking Velocity

Table 3-3 summarizes the NMO velocity obtained from various earth models. After making the small-spread and small-dip approximations, moveout is hyperbolic for all cases and is given by

$$
t^{2}(x)=t^{2}(0)+\frac{x^{2}}{v_{N M O}^{2}}
$$

The byperbolic moveout velocity should be distinguished from the stacking velocity that optimally allows stacking of traces in a CMP gather. The hyperbolic form is used to define the best stacking path $t_{s t k}$ as

$$
t_{s t k}^{2}(x)=t_{s t k}^{2}(0)+\frac{x^{2}}{v_{s t k}^{2}}
$$

where $v_{s t k}$ is the velocity that allows the best fit of the traveltime trajectory on a CMP gather to a hyperbola within the spread length.

The optimum stacking hyperbola described by equation (3-15) is not necessarily the small-spread hyperbola given by equation (3-14). Refer to the traveltimes illustrated in Figure 3,1-16 and note the following:

(a) The observed two-way zero-offset time $O C=t(0)$ in equation (3-14) can be different from the twoway zero-offet time $O B=t_{s t k}(0)$ associated with the best-fit hyperbola (equation 3-15). This occurs,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0307.jpg?height=549&width=416&top_left_y=114&top_left_x=538)

FIG. 3.1-15. Geometry for the moveout for a dipping interface in an earth model with layers of arbitracy dips (Adapted from Hubral and Krey, 1980.)

for example, if some heterogeneity exists in the velocity layers above a reflector under consideration.

(b) The difference between the stacking velocity $v_{\text {stk }}$ and NMO velocity $v_{N M O}$ is called spread-length bas (Al-Chalabi, 1973; Hubral and Krey, 1980). From equations (3-14) and (3-15), the smaller the spread length, the closer the optimum stacking hyperbola to the small-spread hyperbola, hence the smallor the difference between $v_{s t k}$ and $v_{N M O}$.

In practice, when we refer to stacking velocity and the zero-offset time associated with the optimum stacking hyperbola described by equation (3-15), we almost always think of the moveout velocity and the zero-offset time associated with the small-spread hyperbola given by equation (3-14).

### 3.2 VELOCITY ANALYSIS

Normal moveout is the basis for determining velocities from seismic data. Computed velocities can in turn be

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0308.jpg?height=425&width=427&top_left_y=126&top_left_x=80)

FIG. 3.1-16. The equation for moveout velocity is derived by assuming a small-spread hyperbola (equtation 3-14). On the other hand, stacking velocity is derived from the bestfit hyperbola over the entire spread length (equation 3-15). Here, (a) is the actual traveltime, (b) is best-fit hyperbola over the offset range $O A$, and (c) is small-spread hyperbola. (Adapted from Hubral and Krey, 1980.)

used to correct for NMO so that reflections are aligned in the traces of a CMP gather before stacking. From equation (3-15), we can develop a practical way to determine stacking velocity from a CMP gather. Equation (3-14) describes a line on the $t^{2}-x^{2}$ plane. The slope of the line is $\left(1 / v_{N M O}^{2}\right)$ and the intercept value at $x=0$ is $t_{0}$. The synthetic gather in Figure 3.2-1 was derived from the velocity model in Figure 3.1-8. The far right frame of Figure 3.2-1 shows the picked traveltimes of four events at a number of offsets plotted on the $t^{2}-x^{2}$ plane. To find the stacking velocity for a given event, the points corresponding to that event have been connected by a straight line. The inverse of the slope of the line is the stacking velocity. (In practice, least-squares fitting can be used to define the line slopes.) A comparison between the computed stacking velocitics and the actual rms velocities is made in Table 3-4.

The $t^{2}-x^{2}$ velocity analysis is a reliable way to estimate stacking velocities. The accuracy of the method depends on the signal-to-noise ratio, which affects the quality of picking. In Figure 3.2-1, results are compared with the velocity spectrum (center frame) approach, which is discussed later in the section.

A real data example is shown in Figure 3.2-2. Velocities estimated from the $t^{2}-x^{2}$ analysis are shown by triangles on the velocity spectrum. Note that
Table 3-4. Computed stacking and actual rms velocities for the synthetic model in Figure 3.2-1.

| t $t_{0}, \mathrm{~s}$ | Computed Stacking <br> Vclocities, $\mathrm{m} / \mathrm{s}$ | Actual $\mathrm{rms}$ <br> Velocities, m/s |
| :---: | :---: | :---: |
| 0.4 | 2000 | 2000 |
| 0.8 | 2264 | 2264 |
| 1.2 | 2519 | 2533 |
| 1.6 | 2828 | 2806 |

agrement between the $t^{2}-x^{2}$ approach and the picks from the velocity spectrum are satisfactory.

Claerbout (1978) proposed a way to determine interval velocities manually from CMP gathers. The basic idea is illustrated in Figure 3.2-3. First, measure the slope along a slanted path that is tangential to both the top and bottom reflections of the interval of interest (slope 1). Then, connect the two tangential points and measure the slope of this line (slope 2). The interval velocity then is equal to the square root of the product of the two slope values. The accuracy of this method primarily depends on the signal-to-noise ratio.

The method of constant velocity scans of a CMP gather is an alternative technique for velocity analysis. Figure $3.2-4$ b shows a CMP gather which has been NMO corrected repeatedly using a range of constant velocities between 1500 and $4500 \mathrm{~m} / \mathrm{s}$. Scan the constant-velocity moveout-corrected gathers displayed to the right of the original gather (b) starting from the low-velocity end and identify flat events. A velocity function can be composed by noting the velocity-time pairs that correspond to the flat events (Table 3-5). By using this velocity function, the CMP gather (Figure 3.2-4b) is moveout corrected for stacking (Figure 3.24a).

Accuracy in velocity picking depends on cable length, the two-way zero-offset time associated with the reflection event, and the velocity itsolf. The higher the velocity, the deeper the reflector and the shorter the cable length, the poorer the velocity resolution. The resolution in velocity picking also depends on the signal bandwidth; the more compact the wavelet is along the reflection traveltime trajectory in the CMP gather, the more accurate is the velocity pick. Prestack deconvolution (Section 2.5) prior to velocity analysis aimed at wavelet compression helps to improve velucity resolution.

Whle Figure 3.2-4 exhibits primary reflection events before 3 s, Figure 3.2-5 exhibits primary reflections bclow $3 \mathrm{~s}$. Follow the NMO for event $A$. Note
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0309.jpg?height=624&width=858&top_left_y=124&top_left_x=94)

FIG. 3,2-1. The $t^{2}-x^{2}$ velocity analysis applied to the synthetic gather derived from the velocity function depicted in Figure 3.1-8. The center panel is the velocity spectrum based on equation (3-19b).

that this event is overcorrected at low velocities and undercorrected at high velocities. The evert is flat on the NMO-corrected gather that corresponds to the 2500 $\mathrm{m} / \mathrm{s}$ volocity; thus, this is the optimun st acking velocity for event $A$. Event $B$ is flat on the NMO-corrected gather that corresponds to the $2800 \mathrm{~m} / \mathrm{s}$ velocity. $\mathrm{Nev}-$ ertheless, there is a range of velocities around $2800 \mathrm{~m} / \mathrm{s}$ which exhibits nearly flat character for event $B$. This results in an uncertainty in making an accurate velocity pick.

The most important reason to obtain a reliable velocity function is to get the best quality stack of signal. Therefore, stacking velocities often are estimated from data stacked with a range of constant velocities on the basis of stacked event amplitude and continuity. Figure 3.2-6 illustrates this approach. Herc, a portion of a line containing $100 \mathrm{CMP}$ gathers has been NMO-corrected and stacked with a range of constant velocities. The resulting constant-velocity CMP stacks then were dis- played as a panel. Stacking velocities are picked directly from the constant-velocity st ack (CVS) panel by choosing the velocity that yields the best stack response at a selected event time.

The pand of constant-velocity stacks in Figure 3.27 demonstrates how velocity resolution decreases with increasing depth. The doep event at $3.6 \mathrm{~s}$ seems to stack at a wide range of velocity values.

A variation of CVS analysis is a panel of CMP stacks using a family of velocity functions that are a fixed percentage higher and lower than a base velocity function (Figure 3.2-8). This type of velocity analysis pand usually is used in combination with a velucity spectrum computed at the central CMP location to pick an optimum stacking velocity function.

The constant velocities used in the CVS method described above should be chosen carefully. There are two issues to consider besides the expected range of actual velocities in the subsurface: (a) the range of ve-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0310.jpg?height=748&width=868&top_left_y=118&top_left_x=84)

FIG. 3.2-2. The $t^{2}-x^{2}$ velocity analysis applied to \& CMP gather. The triangles on the velocity spectrum (center panel based on equation 3-19b) represent velocity values derived from the slopes of the lines shown on the graph at the right.

Table 3-5. Velocity function derived from the constantvelocity panel of Figure 3.2-4.

| Two-way Zero-Ofset | RMS Velocity |
| :---: | :---: |
| time, $\mathrm{ms}$ | Picked, $\mathrm{m} / \mathrm{s}$ |


| 0 | 1500 |
| ---: | ---: |
| 100 | 1500 |
| 760 | 1900 |
| 1400 | 2700 |
| 1800 | 3000 |
| 2150 | 3600 |
| 5000 | 4000 |

locities needed to stack the data and (b) the spacing between trial stacking velocities. In choosing a range, consideration should be given to the fact that dipping events and useful out-of-plane reflections may have anomalously high stacking velocities. In choosing the spacing of constant velocities, keep in mind that it is moveout, not velocity, that is the basis for velocity estimation. Thus, it is better to scan in increments of equal $\Delta t_{N M O}$ than equal $v_{N M O}$. This prevents oversampling of the high-velocity events and undersampling of the low-volocity events. A good way to choose $\Delta\left(\Delta t_{N M O}\right)$ is to pick it so that the moveout difference between adjacent trial velocities at the maxinum offset to be stacked

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0311.jpg?height=802&width=412&top_left_y=119&top_left_x=85)

FIG. 3.2-3. The interval velocity between two reflectors is equal to the square-root of the products of the slope values measured as shown above. This is the same gather as in Figure 3.1-7a. Trace spacing is $50 \mathrm{~m}$, slope $1=3150 / 043$, slope $2=550 / 0.44$, and thus, the interval velocity between 08 and $1.2 \mathrm{~s}$ is $3026 \mathrm{~m} / \mathrm{s}$.

is approximately $1 / 3$ of the dominant period of the data (S. Doberty, 1986, personal communication). Shallow data have short maximum offsets because of muting, while deep data have large dominant periods. Thus, the number of trial stacking velocities needed to adequately sample the data can be reduced considerably.

The CVS method is especially useful in areas with complex structure (Exercise 3-5). In such areas, this method allows the interpreter to directly choose the stack with the best possible event continuity. (Often the stacking velocities themselves are of minimal importance.) Constant-velocity stacks often contain many CMP traces and sometimes consist of an entire line.

The velocity spectrum method is described in the next section. Unlike the CVS method, it is based on the crosscorrelation of the traces in a CMP gather and not on lateral continuity of the stacked events. Because of this, when compared to the CVS method, it is more suitable for data heavily contaminated with multiple reflections and somewhat less suitable for data associated with complex structures.

## The Velocity Spectrum

The input CMP gather in Figure 3.2-9a contains a single reflection hyperbola from a flat interface. The medium velocity above the reflector is $3000 \mathrm{~m} / \mathrm{s}$. Suppose that this gather is NMO-corrected and stacked, repeatedly, using a range of constant velocities from 2000 to 4300 $\mathrm{m} / \mathrm{s}$. Figure $3.2-9 \mathrm{~b}$ displays the resultant stack traces for each velocity side by side on a plane of velocity versus two-way zero-offset time. This is called the velocity spectrum (Taner and Koehler, 1969). We have transformed the data from the offset versus two-way time domain (Figure 3.2-9a) to the stacking velocity versus two-way zero-offset time domain (Figure 3.2-9b)

The highest stacked amplitude occurs with a velocity of $3000 \mathrm{~m} / \mathrm{s}$. This is the velocity that should be used to stack the event in the input CMP gather. The lowamplitude horizontal streak on the velocity spectrum results from the contribution of small offsets, while the large-emplitude region on the spectrum is due to the contribution of the full range of offsets (Sherwood and Poe, 1972). Hence, we need Iong offsets for good resolution on the velocity spectrum. A way to minimize the streak effect of finite-cable length on the velocityspectrum is to transform the CMP gather from offset to velocity domain by way of discrete Radon transform (Section 6.4).

A CMP gather associated with a layered earth model is shown in Figure 3.2-10a. Based on the stacked amplitudes, the following picks for stacking velocity function are made from the velocity spectrum (Figure $3.2-10 \mathrm{~b}) ; 2700,2800$, and $3000 \mathrm{~m} / \mathrm{s}$. These picks correspond to the shallow, middle, and deep events, respectively. The velocity spectrum not only can provide the stacking velocity function, but it also allows one to distinguish between primary and multiple reflections.

The quantity displayed on the velocity spectra in Figures $3.2-9 \mathrm{~b}$ and $3.2-10 \mathrm{~b}$ is the stacked amplitude.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0312.jpg?height=1041&width=619&top_left_y=162&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0313.jpg?height=1036&width=627&top_left_y=167&top_left_x=233)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0314.jpg?height=654&width=784&top_left_y=130&top_left_x=125)

FIG. 3.2-5. Constant-velocity moveout corrections applied to a CMP gather using a velocity range of $1500-4200 \mathrm{~m} / \mathrm{s}$ with an increment of $100 \mathrm{~m} / \mathrm{s}$. Events $A$ and $B$ are discussed in the text.

When the signal-to-noise ratio of the input data is poor, then the stacked amplitude may not be the best display quantity. The aim in velocity analysis is to obtain picks that correspond to the best coherency of the signal along a hyperbolic trajectory over the entire spread length of the CMP gather. Neidell and Taner (1971) described various types of coherency measures that can be used as attributes in computing velocity spectra,

## Measure of Coherency

Consider the CMP gather with a single reflection sketched in Figure 3.2-11. Stacked amplitude $S$ at two- way zero-olfiset time $t_{0}$ is defined as

$$
S=\sum_{i=1}^{M} f_{i, t(i)}
$$

where $f_{i, t(i)}$ is the amplitude value on the $i$ th trace at two-way time $t(i)$, and $M$ is the number of traces in the CMP gather. Two-way time $t(i)$ lies along the stacking hyperbola associated with a trial velocity $v_{s t k}$ :

$$
t(i)=\sqrt{t_{0}^{2}+\frac{x_{i}^{2}}{v_{s t k}^{2}}}
$$

Normalized stacked amplitude is defined as

$$
N S=\frac{\sum_{i-1}^{M} f_{i, t(i)}}{\sum_{i=1}^{M}\left|f_{i, t(i)}\right|}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0315.jpg?height=1014&width=575&top_left_y=178&top_left_x=263)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0316.jpg?height=986&width=618&top_left_y=192&top_left_x=174)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0317.jpg?height=1003&width=575&top_left_y=181&top_left_x=252)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0318.jpg?height=644&width=824&top_left_y=128&top_left_x=106)

FIG. 3.2-7. Constant-velocity stacks of 24 CMP gathers using a range of velocities $1500-4400 \mathrm{~m} / \mathrm{s}$ with an increment of 100 $\mathrm{m} / \mathrm{s}$.

where the range of $N S$ is $0 \leq N S \leq 1$. As for the stacked amplitude given by equation (3-16), the normalized stacked amplitude given by equation (3-18) is defined at two-way zero-offiset time.

Another quantity that is used in velocity spectrum calculations is the unnormalized crosscorrelation sum within a time gate $T$ that follows the path corresponding to the trial stacking hyperbols across the CMP gather. The expression for the unnormalized crosscorrelation sum is given by

$$
C C=\frac{1}{2} \sum_{t}\left\{\left[\sum_{i=1}^{M} f_{i, t(i)}\right]^{2}-\sum_{i=1}^{M} f_{i, t(i)}^{2}\right\}, \quad(3-19 a)
$$

or, by way of equation (3-16),

$$
C C=\frac{1}{2} \sum_{t}\left[S_{t}^{2}-\sum_{i=1}^{M} f_{i, t(0)}^{2}\right], \quad(3-19 b)
$$

where $C C$ can be interpreted as half the difference between the output energy of the stack and the input energy. The outer summation is over the two-way zerooffset time samples $t$ within the correlation gate $T$.

A normalized form of $C C$ is another attribute that often is used in velocity spectrum calculations and is given by

$$
N C=M F \sum_{t} \sum_{k=1}^{M-1} \sum_{i=1}^{M-k} \frac{f_{i, t(i)} f_{i+k, t(i+k)}}{\sqrt{\sum_{t} f_{i, t(i)}^{2} \sum_{t} f_{i+k, t(i+k)}^{2}}},
$$

where $M F=2 /[M(M-1)]$.

Another coherency messure used in computing velocity spectrum is the energy-normalized crosscorrelation sum

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0319.jpg?height=1029&width=754&top_left_y=134&top_left_x=138)

FIG. 3.2-8. Stacks of $100 \mathrm{CMP}$ gathers using seven velocity functions which are a percent apart from a central function.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0320.jpg?height=370&width=404&top_left_y=128&top_left_x=83)

FIG. 3.2-9. Transformation of a synthetic CMP gather containing a single reflection event from offset to velocity domain. Each trace in the velocity-stack gather (b) is a stack of the traces in the CMP gather (a) using a constant-velocity NMO correction.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0320.jpg?height=428&width=428&top_left_y=711&top_left_x=72)

FIG. 3.2-10. Transformation of a synthetic CMP gather containing three reflection events from offset to velocity domain. Each trace in the velocity-stack gather (b) is a stack of the traces in the CMP gather (a) using a constant-velocity NMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0320.jpg?height=394&width=414&top_left_y=115&top_left_x=539)

FIG. 3.2-11. Stacked amplitude along a hyperbolic trajectory. Amplitudes $f_{2, t(1)}$ along the best-fit hyperbola (equation 3-17) defined by optimum stacking velocity $v_{s i k}$ are summed to get the stacked amplitude $S$ (equation 3-16).

$$
E C=\frac{2}{(M-1)} \frac{C C}{\sum_{t} \sum_{t=1}^{M} f_{\imath, t(2)}^{2}}
$$

The range of $E C$ is $[-1 /(M-1)]<E C \leq 1$.

Finally, semblance, which is the normalized outputto-input energy ratio, is given by

$$
N E=\frac{1}{M} \frac{\sum_{t} \sum_{t=1}^{M} f_{t, t(t)}}{\sum_{t} \sum_{t=1}^{M} f_{t, t(t)}^{2}}
$$

The following expression shows the relation of $N E$ to EC:

$$
E C=\frac{1}{M-1}(M \times N E-1)
$$

The range of $N E$ is $0 \leq N E \leq 1$.

Table 3-6 shows the values of the attributes defined by equation (3-16) and equations (3-18) through (3-22) for the special case of a two-fold CMP gather where the second trace is a scaled version of the first as follows:

$$
\begin{array}{ll}
f_{1, t}=f_{t}, & (3-23 a) \\
f_{2, t}=a f_{t} . & (3-23 b)
\end{array}
$$

Table 3-6. Various measures of coherency as applied to the two-fold case given by equation (3-23).

| Attribute | $a=0.5$ | $a=-0.5$ |
| :---: | :---: | :---: |
| Stacked Amplitude <br> $S$ (equation 3-16) | $1.5 f(t)$ | $0.5 f(t)$ |
| Normalized <br> Stacked Amplitude <br> NS (equation 3-18) | 1 | 0.333 |
| Unnormalized <br> Crosscorrelation Sum <br> $C C$ (equation 3-19b) | $0.5 \sum_{t} f^{2}(t)$ | $-0.5 \sum_{t} f^{2}(t)$ |
| Normalized <br> Crosscorrelation Sum <br> $N C$ (equation $3-20$ ) | 1 | 1 |
| Energy-Normalized <br> Crosscorrelation Sum <br> $E C$ (equation 3-21) | 0.8 | -0.8 |
| Semblance <br> $N E$ (equation 3-22a) | 0.9 | 0.1 |

Several conclusions can be made from the results shown in Table 3-6. Note that stacked amplitude is sensitive to trace polarity. The unnormalized crosscorrelation offers a better standout of the strong reflections on the velocity spectrum, while the normalized or energynormalized crosscorrelation brings out weak reflections on the velocity spectrum. As equation (3-22b) implies, semblance is a bissed version of the energy-normalized crosscorrelation sum.

The velocity spectrum normally is not displayed as shown in Figures 3.2-9b or 3.2-10b. Instead, two popular types of displays are used to pick velocities in the form of a gated row plot or a contour plot as shown in Figure 3.2-12. Another quantity that helps picking is the maxima of the coherency values from each time gate displayed as a function of time next to the velocity spectrum, as shown in Figure 3,2-12. Unless otherwise indicated, the unnormalized correlation was used to construct the velocity spectrum of the synthetic CMP gather (Figure 3.2-12a) that is used in subsequent discussions.

## Factors Affecting Velocity Estimates

Velocity estimation from seismic data is limited in accuracy and resolution for the following reasons: (a) Spread length,

(b) Stacking fold,

(c) signal-to-noise ratio,

(d) Muting,

(e) Time gate length,

(f) Velocity sampling,

(g) Choice of coherency measure,

(h) True departures from hyperbolic moveout, and

(i) Bandwidth of data.

Figure 3.2-13 shows a synthetic CMP gather with velocity spectra generated by using gradually decreasing spread lengths. Lack of large-offset information means lack of the significant moveout required for velocity discrimination. Note the loss in sharpness of the peaks in the velocity spectra computed from the smallspread portion of the CMP gather. Resolution decreases first in the deeper part of the spectrum where there is little moveout (Table 3-1).

Figure 3.2-14 shows velocity spectra computed from a real data set using spread lengths as indicated. The broadened peaks caused by the use of smaller spreads indicate loss of resolution in the velocity spectrum. This problem may be compounded by the poor signal-to-noise ratio or residusl static shifts. An example of residual statics effect is shown in Figure 3.2-15. Velocity spectrum computed from a spread length that includes small offets (center panel) infers an incorrect velocity function. As the spread length is made smaller (right panel), the velocity trend becomes indistinct.

What if only the far offsets are included when computing the velocity spectrum? Although far-offset data are needed to better resolve the velocity picks, there is a stretching problem in the far-offset region. Therefore, a velocity spectrum computed on the basis of only the faroffset region of a CMP gather suffers from the effects of muting at shallow times. This problem is demonstrated in Figure 3.2-16, where the spread is increasingly confined to the far-offset region of the input CMP gather. Note the loss of coherency peaks from the shallow events because of muting, and the further degradation of the coherency peaks corresponding to deeper events. Thus, adequate resolution in the velocity spectrum can only be obtaned with a sufficrently large spread that spans both near and far offsets. This is analogous to the lesson learned in Section 1.1 on temporal resolution, which requires both low and high frequencies.

Stacking fold plays a significant part in the degree of resolution achieved from velocity spectra. In contemporary seismic data acquisition, it is common to record data with 240 or more channels. For computational savings, high-fold data sometimes are reduced to a low-fold equivalent gather by partial stacking. The idea is to

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0322.jpg?height=509&width=258&top_left_y=166&top_left_x=104)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0322.jpg?height=536&width=279&top_left_y=134&top_left_x=368)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0322.jpg?height=531&width=279&top_left_y=134&top_left_x=654)

(c)

FIG. 3.2-12. (a) A CMP gather, and two ways of displaying velocity spectrum computed from this gather: (b) gated raw plot, and (c) contour plot.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0322.jpg?height=372&width=871&top_left_y=809&top_left_x=83)

FIG. 3.2-13. Effect of spread length on velocity resolution. Lack of long offets causes loss of resolution, especially at later times.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0323.jpg?height=438&width=854&top_left_y=130&top_left_x=92)

FIG. 3.2-14. Missing large-offset traces cause loss of resolution in the velocity spectra, especially at later times.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0323.jpg?height=438&width=850&top_left_y=704&top_left_x=93)

FIG. 3.2-15. Velocity spectra can be distorted severely, particularly in areas with statics problems. When coupled with a lack of long-offset traces, the velocity function that is derived can be misleading (center and right).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0324.jpg?height=360&width=892&top_left_y=208&top_left_x=80)

FIG, 3.2-16. Lack of short-offset traces can degrade the velocity spectrum. Note the loss of information at shallow times and poor picks at later times.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0324.jpg?height=389&width=876&top_left_y=702&top_left_x=90)

FIG, 3.2-17. Partial stacking can reduce computational cost. However, do not use partial stacking if it could degrade the velocity spectrum, (In this example, 8-fold partial stacking is too much.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0325.jpg?height=500&width=902&top_left_y=208&top_left_x=74)

FIG, 3.2-18. The synthetic CMP gather derived from the velocity function depicted in Figure $31-8$ and the same gather with nose added at various strengths. The numbers on top represent the ratio of peak signal amplitude to peak noise amplitude.

stack a number of traces in a CMP gather from adjacent offsets to produce a CMP gather with lower fold. For example, a reduction of fold from 64 to 16 amounts to producing one output trace for each set of four adjacent input traces. Partial stacking involves differential NMO application to each group of adjacent traces using a reasonable, previously estimated velocity function so that primaries are aligned before stacking. The CMP gather in Figure 3.2-17 was partially stacked down to 32-, 16and 8-fold gathers. Corresponding velocity spectra also are shown in Figure 3.2-17. No harm was done by reducing the fold to 32 . Even the 16 -fold data seem to produce accurate picks. However, use of lower fold significantly shifts the peaks in the spectrum. Reducing the fold by partial stacking merely to save computation must not be done at the expense of accuracy.
Noise in seismic data has a direct effect on the quality of a velocity spectrum. Add band-limited random noise to the CMP gather at increasingly higher levels of amplitude (Figure 3.2-18). The corresponding velocity spectra are shown in gated row piot form in Figure 3.2-19 and, for comparison, in contour form in Figure 3.2-20. The velocity spectrum distinguishes signal along hyperbolic paths even with high levels of random noise. (Refer to the velocity spectrum for SNR $=3$ in Figure 3.2-19.) This is because of the power of crosscorreletion in measuring coherency. The accuracy of the velocity spectrum is limited when the signal-to-noise ratio is poor. Refer to SNR = 1 in Figures 3.2-19 or 3.2-20. The event at $0.8 \mathrm{~s}$ still can be picked, but the others are difficult to distinguish.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0326.jpg?height=458&width=448&top_left_y=126&top_left_x=82)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0326.jpg?height=407&width=206&top_left_y=130&top_left_x=537)

3

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0326.jpg?height=402&width=213&top_left_y=135&top_left_x=749)

1

FIG. 3.2-19. Velocity spectra derived from the CMP gathers in Figure 32-18 The display mode is gated row.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0326.jpg?height=412&width=468&top_left_y=698&top_left_x=72)

Peak SNR

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0326.jpg?height=402&width=215&top_left_y=708&top_left_x=538)

3

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0326.jpg?height=402&width=215&top_left_y=706&top_left_x=759)

1

FIG. 3.2-20. Velocity spectra derived from the CMP gathers in Figure 3.2-18. The display mode is contour. See Figure 3.2-19 for the gated row plots of the same spectra for comparison.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0327.jpg?height=570&width=488&top_left_y=136&top_left_x=84)

(a)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0327.jpg?height=570&width=386&top_left_y=136&top_left_x=566)

(c)

FIG. 3.2-21. Muting effect on correlation values: (a) CMP gather, (b) mute compensated, (c) no compensation.

As a result of moveout correction, the waveform along a reflection hyperbola is stretched (Section 3.1). Stretching is more severe in the shallow part of the moveout-corrected gather, especially at large offsets. The stretched zone must be muted to prevent degradation of the stacked amplitudes associated with shallow events. However, muting reduces fold in the stacking process for shallow data (Figure 3.1-11c). It also has an adverse effect on the velocity spectrum, for it canses weakening of the peak amplitude that falls within the mute zone, as demonstrated in Figure 3.2-21. These peaks must be corrected for the weakening effect of the muting process. This is done by multiplying stacked amplitudes by a scale factor equal to the ratio of the actual multiplicity to the number of live traces in the mute zone.
The velocity spectrum is computed along hyperbolic search paths for a range of constant velocity values, or constant $\Delta t_{N M O}$ (equation 3-2a). The hyperbolic path spans a two-way time gate specified at zerooffset. Figure 3.2-22 shows velocity spectra computed with four different gate lengths. If the gate length chosen is too coarse, the spectrum suffers especially from lack of temporal resolution. This becomes more evident on the same spectra displayed in contour form in Figure 3.2-23. In practice, the gate length is chosen between one-half and one times the dominant period of the signal, typically 20 to $40 \mathrm{~ms}$. Since the dominant period can be time-variant (small in early and large in late times), the gate length can be specified accordingly.

The velocity range used in the analysis must be chosen carefully; it should span the velocities that correspond to those of primary reflections present in the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0328.jpg?height=376&width=870&top_left_y=131&top_left_x=74)

FIG. 3.2-22. Too large a correlation gate length can lower resolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0328.jpg?height=384&width=868&top_left_y=661&top_left_x=74)

FIG. 3.2-23. The same velocity spectra as in Figure 3.2-22 displayed using the contour display mode for comparison.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0329.jpg?height=377&width=862&top_left_y=155&top_left_x=82)

FIG. 3.2-24. The CMP gathers associated with six neighboring midpoint locations. The reflectors have a gentle downdip from left to right.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0329.jpg?height=498&width=278&top_left_y=632&top_left_x=106)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0329.jpg?height=498&width=258&top_left_y=632&top_left_x=400)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0329.jpg?height=491&width=265&top_left_y=633&top_left_x=665)

(c)

FIG. 3.2-25. (a) Velocity spectrum derived from a single CMP gather (CMP 1) in Figure 3.2-24, (b) from the sum of six CMP gathers in Figure 3.2-24, and (c) from the sum of six individual velocity spectra.

Table 3-7. Acceptable velocity errors (after Schnejder, 1971).

| Use of Velocity | \% Error \% Error <br> for rms for Interval |  |
| :--- | :---: | :---: |
| NMO corrections for <br> conventional stack | $2-10$ | - |
| Structural anomaly detection: <br> $30-\mathrm{m}$ anomaly at $3000-\mathrm{m}$ depth | 0.5 | - |
| Gross lithologic identification: <br> 300-m interval at $3000-\mathrm{m}$ depth | 0.7 | 10 |
| Stratigraphic detailing: <br> 150-m interval at $3000-\mathrm{m}$ depth | 0.1 | 3 |

CMP gather. The velocity increment must not be too coarse, for it can degrade the resolution, ospecially for high-velocity events.

Several options are considered in constructing the velocity spectrum. Partial stacking is one option that already was discussed. Band-pass filtering and automatic gain control (AGC) sometimes can improve the crosscorrelation process, especially when the input gather has poor signal-to-noise ratio.

Another way to improve the quality of a velocity spectrum is to use several neighboring CMP gathers in the analysis. Figure 3.2-24 shows six neighboring CMP gathers. By using the first CMP gather in the group, we get the velocity spectrum in Figure 3.2-25a. There are two ways to analyze these gathers as a group. One way is to sum the gathers and compute the velocity spectrum from the sum. This is shown in Figure 3.2-25b. Another way is to compute the velocity spectra from each individual gather and sum the spectra as shown in Figure 3.2-25c. Clearly, the former is more cost-effective than the latter. In practice, the number of CMP gathers that may be used must be chosen so that there is negligible dip across the gathers under consideration. If the structural dip is significant, then the number of CMP gathers included in the velocity analysis must be kept small. Note that the peak corresponding to the shallow event in Figure 3.2-25b is smaller than its counterpart in Figure $3.2-25 \mathrm{c}$. Look closely at the CMP gathers in Figure 3.2-24 and note the slight difference in traveltimes from gather to gather, especially for the shallow event. Summing these gathers distorts the hyperbolic path and causes degradation in the velocity spectrum.

When the input gather has a significant noise level, some smoothing may be done on the velocity spectrum matrix by averaging over vclocity or time gates, or by some combination of the two. Another way to suppress small-amplitude correlation peaks that may be related to the ambient noise level in the data is to apply some percentage of bias to the correlation values. Biasing refers to subtracting a constant value from the correlation values over the entire velocity spectrum. Various combinations of averaging and biasing of correlation values also are used in practice. Finally, for computational efficiency, correlation values may be computed within a specified velocity corridor. The corridor must be chosen so that it spans the velocity variations vertically and laterally in the survey area.

Experience in a survey area helps when picking appropriate stacking velocities for primary reflections from velocity spectra. Acceptable velocity errors vary depending on use of the estimated velocities (Tablo 37).

## Interactive Velocity Analysis

With the availability of powerful workstations, efficiency in seismic data analysis at large has increased enormously. Applications that involve numerically intensive computations and large input-output operations are performed using multiprocessor servers, and results are viewed and evaluated using highperformance graphics workstations. Interactive date analysis enables efficient parameter testing that is needed for many of the steps in a processing sequence, such as filtering, deconvolution, and gain. Additionally, interactive analysis provides efficiency in picking events - first breaks on shot records for refraction statics, reflection times on migrated sections, and velocity functions from velocity spectra.

Figure 3.2-26 shows a CMP gather and its velocity spectrum displayed in color. Note the distinct velocity trend with changes in vertical gradient at 600 , 1400 , and $2000 \mathrm{~ms}$. Color display of velocity spectra is used for interactive picking of semblance peaks, whereas the contour and gated row plots are used for the traditional paper display of velocity spectra. Figure 3.227 shows the sanne velocity spectrum as in Figure 3.226 with the velocity picks associated with primary reflections. The hyperbolic traveltime trajectories that correspond to the velocity picks are superimposed on the CMP gather to observe any discrepancy between the modeled and the actual traveltimes, and thus verify the accuracy of the velocity picks. Further verification of the picks can be made by applying moveout correction and cxamining the flatness of events on the

CMP gather as shown in Figure 3.2-27. The undercorrected event at about $800 \mathrm{~ms}$ is the water-bottom multiple; this event is represented in the velocity spectrum by the isolated peak to the left of the velocity trend.

Figure 3.2-28 shows the same gather and velocity spectrum as in Figure 3.2-27 but with a velocity function erroneousiy picked along a bigh-velocity trend to cause undercorrection of the refections. Note the discrepancy between the modeled and actual traveltimes on the CMP gather before moveout correction, and the misalignment of the reflections after moveout correction. The case of overcorrection caused by erroneously low velocities is demonstrated in Figure 3.2-29.

A localized mispick along a velocity trend yields a physically implausable interval velocity value as illstrated in Figures 3.2-30 and 3.2-31. The strategy for picking velocities from velocity spectra is based on tracking the velocity trend that coincides with semblance peaks associated with the primary reflections. Whether these reflections are associated with key geological markers or not is irrelevant - as many picks as necessary should be picked so as to honor changes in vertical velocity gradients and thus obtain the best stack. However, picks at too close time intervals can yield anomalous interval velocities from Dix conversion (Section J.4); therefore, they should not be used for deriving interval velocities. (Chapter 9, in addition to Dix conversion, is devoted to several techniques for estimating interval velocities.)

To derive plausable interval velocities from the picked rms velocity functions, first intersect the time horizons picked from the time-migrated volume of data. with the velocity functions at analysis locations and extract horzon-consistent rms velocity functions. Then, perform spatial interpolation to derive horizon-consistent rms velocity profiles along line traverses or maps over the survey area. Next, perform Dix conversion of the horizon-consistent rms velocities to interval velocities $v_{\text {ent }}$ (Dix, 1955):

$$
v_{n t}=\sqrt{\frac{v_{n}^{2} t_{n}-\overline{v_{n-1}^{2} t_{n-1}}}{t_{n}-t_{n-1}}}
$$

where $v_{n}$ and $v_{n-1}$ are the rms velocities at the layer boundaries $n$ and $n-1$, respectively; and $t_{n}$ and $t_{n-1}$ are the horizon times at these layer boundaries. An alternative mothod for deriving horizon-consistent rms velocities is presented next.

## Horizon Velocity Analysis

One way to estimate velocitios with the accuracy required for detailed structural or stratigraphic studies is to analyze the particular horizon of interest, continuously. Such a detailed velocity estimation is called horizon velocity analysis (HVA). Horizon velocity analysis is an efficient way to get velocity information at every CMP location along selected key horizons, as opposed to the conventional velocity analysis that provides veIocity information at every time gate at selected CMP locations. The underlying principle is the same as that of the velocity spectrum. The output coherency values derived from hyperbolic time gates are displayed as a function of velocity and CMP position. Correlation values are computed from a gate that includes the horizon of interest. Horizon times are digitized and input to the horizon velocity analysis. Figures 3.2-32 shows a stacked section and Figure 3.2-33 shows HVA semblance spectra over five horizons. Note the short-wavelength variations of stacking velocities along the line traverse such variations ordinarily are not captured by velocify analyses conducted at sparse CMP intervals. These semblance spectra can be picked to obtain horizonconsistent rms velocities which are then used to derive interval velocities (equation 3-24). Similar types of computational details, such as smoothing and biasing, are considered applicable to velocity spectrum.

Whenever there are structural discontinuities on a stacked section, HVA is carried out on segments of the horizon that are separated by faults. Horizon velocity analysis can improve a stacked section in areas with complex overburden structure that may cause nonhyperbolic moveout. This is somewhat surprising, since HVA still is based on hyperbolic moveout. Nevertheless, in practice, HVA provides the detailed lateral velocity variations along a marker horizon, which may be missed by conventional velocity analysis locations that are sparsely spaced along the line. Consider horizon $\boldsymbol{A}$ in Figure 3.2-34, which is below the salt dome $S$. The salt dome behaves as a complex overburden, causing the raypaths that are associated with the underlying reflectors to bend. Note the rapid lateral changes in velocity and the improvement in the CMP stack after using the HVA picks. The rapid change in stacking velocity associated with the base of the salt is typical. Starting on the left, the reflector is deep in time and flat. Then it dips; hence, the higher stacking velocity. Then it gets shallower; hence, the lower stacking velocity. Then it dips again, yielding a higher stacking velocity. Finally, it becomes flat; hence, a decrease in velocity.

A velocity section derived from HVA is structureconsistent, whereas a velocity section derived from vertical velocity functions picked at selected analysis locations along a line traverse is, in general, structureindependent. Consider the stacked section in Figure 3.2-35 with interpreted time-horizon segments associated with subsurface geological markers. The semblance

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0332.jpg?height=467&width=575&top_left_y=145&top_left_x=231)

FIG. 3.2-26. A CMP gather and its velocity spectrum.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0332.jpg?height=466&width=820&top_left_y=682&top_left_x=112)

FIG. 3.2-27. The same CMP gather and its velocity spectrum (left and center penels) as in Figure 3.2-26 with the picked velocities denoted by + marks coincident with the semblance peaks. The curve to the right of the semblance penks is the interval velocity function derived from the picked rms velocity function. The far right panel shows the CMP gather after moveout correction using the picked rms velocity function.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0333.jpg?height=435&width=787&top_left_y=145&top_left_x=112)

FIG. 3.2-28. The same CMP gather and its velocity spectrum (left and center panels) as in Figure $3.2-26$ with the erroneously piched velocities denoted by + marks. The curve to the right of the semblance peaks is the interval velocity function derived from the picked rms velocity function. The right-hand panel shows the CMP gather after moveout correction using the picked rms velocity function. Note the undercorrection of events caused by the erroneously too high moveout velocities.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0333.jpg?height=432&width=760&top_left_y=710&top_left_x=138)

FIG. 3.2-29. The same CMP gather and its velocity spectrum (left and center penels) as in Figure 3.2-26 with the erroneously picked velocities denoted by + marks. The curve to the right of the semblance peaks is the interval velocity function derived from the picked rms velocity function. The right-hand panel shows the CMP gather after moveout correction using the pickud rms velocity function. Note the overcorrection of events caused by the erroneousiy too low moveout velocities.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0334.jpg?height=463&width=573&top_left_y=140&top_left_x=232)

FIG. 3.2-30. The same CMP gather and its velocity spectrum as in Figure $3.2-26$ with an erroneously picked velocity at $1875 \mathrm{~ms}$. The curve to the right of the semblance peaks is the interval velocity function derived from the picked rms velocity function. Note the anomalous interval velocity derived from the erroneously picked interval velocity.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0334.jpg?height=460&width=574&top_left_y=705&top_left_x=229)

FIG. 3.2-31. The same CMP gather and its velocity spectrum as in Figure 3.2-26 with an erroneously picked velocity at $1875 \mathrm{~ms}$. The curve to the right of the semblance peaks is the interval velocity function derived from the picked rms velocity function. Note the anomalous interval velocity derived from the erroneously picked interval velocity.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0335.jpg?height=455&width=604&top_left_y=115&top_left_x=211)

FIG. 3.2-32. A stacked section with five marker horizons as indicated.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0335.jpg?height=574&width=616&top_left_y=614&top_left_x=210)

FIG. 3.2-33. Horizon velocity analyses along five marker horizons indicated in Figure 3.2-32. The vertical and horizontal axes in each panel are stacking velocity and CMP axis, respectively.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0336.jpg?height=701&width=746&top_left_y=120&top_left_x=143)

FIG. 3.2-34. A CMP-stacked section obtained by sparsely spaced conventional velocity anslysis (top) and the stacked section (bottom) obtained by using velocities derived from horizon velocity analyds (HVA) (middle). The HVA for horizon $A$ below the salt dome $S$ is shown in the center.

spectra associated with the eight horizons picked from the stacked section computed by HVA are shown in Figure 3.2-36. The top spectrum corresponds to the shallowest time horizon (dark blue) after the waterbottom horizon. These spectra were picked to obtain the horizon-consistent rms velocity profiles, which were then used to derive the rms velocity section shown in Figure 3.2-37 (top). The time horizons picked from the stacked section (Figure 3.2-35) are superimposed on the velocity section. Compare the velocity sections in Figure 3.2-37 derived from HVA (top) and vertical functions (bottom), and note that the HVA-based velocity section is more consistent with the subsurface structure. Hence, the HVA results are more appropriate to use in Dix conversion to derive structure-consistent in- terval velocities with meaningful magnitudes (equation 3-24),

What about the quality of stacks (Figure 3.2-38) obtained from the velocity sections (Figure 3.2-37) derived from HVA and vertical functions? Two sets of details from the stacked sections shown in Figures 3.2-39 and 3.2-40 reveal that, indeed, there can be more than marginal differences. While the HVA-based stack shows better continuity of reflections, it is inferior to the conventional stack with regard to diffractions. This should be expected since the HVA analysis is done along reflection events and not diffractions (Figure 3.2-35).

In conclusion, if the objective is to obtain an optimum CMP stack with the highest stack power possible, conventional velocity analysis at selected CMP

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0337.jpg?height=517&width=838&top_left_y=145&top_left_x=102)

FIG. 3.2-35. A CMP-stacked section with interpreted time horizon segments associated with goological markers.

locations along the line traverse or over the 3-D survey area yields a robust velocity section. If, on the other hand, the objective is to derive interval velocities from Dix conversion, then horizon-consistent velocity analysis yiclds structure-consistent results that are geologically plausable.

## Coherency Attribute Stacks

The various measures of coherency discussed in this section to compute velocity spectrum can also be used to generate coherency attribute stacks. These stacks are obtained as follows:

(a) Choose a specific measure of coherency stacked amplitude (equation 3-16), normalized stacked amplitude (equation 3-18), unnormalized crosscorrelation sum (equation 3-19), normalived crosscorrelation sum (equation 3-20), energy-normalized crosscorrelation sum (equation 3-21), or semblance (equation 3-22).

(b) Compute velcoity spectra at selected CMP locations along the line and pick rms velocity functions. (c) By interpolating between the vertical functions, derive an rms velocity section.

(d) Extract vertical $\mathrm{rms}$ velocity functions from the velocity section at each CMP locution along the line traverse.

(e) Apply moveout correction to CMP gathers using the extracted vertical functions.

(f) Now, compute not just the stacked amplitudes (equation 3-16), but also the coherency attributes using equations (3-18) through (3-22) and thus obtain the coherency attribute sections.

Figure 3-2.41 shows portions of coherency attribute sections associated with a field data set. These sections, in conjunction with conventional stack, may be useful in enhancing fault patterns associated with structural plays and identifying amplitude anomalies associated with stratigraphic plays. Note the discriminating power of semblance for the most coherent reflection events in the section. Conventional CMP stacking seems to yicld the most robust section that preserves reflections and diffrations. The coherency attribute sections based on croscorrelation show an apparent higher frequency content compared to the stacked and normalized starkerl sections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0338.jpg?height=1031&width=682&top_left_y=138&top_left_x=167)

FIG. 3.2-36. Semblance spectra computed along the time horizons in Figure 3.2-35. The top spectrum corresponds to the shallowest time horizon in dark blue.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0339.jpg?height=962&width=766&top_left_y=180&top_left_x=133)

FIG. 3.2-37. Top: the velocity section derived from the HVA-based semblance spectra shown in Figure 3.2-36; bottom: the velocity section derived from the interpolation of the vertical rms velocity functions picked at selected CMP locations along the line travense. Superimposed on these sections are the time horizon segments interpreted from the stacked section in Figure $3.2-35$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0340.jpg?height=1012&width=824&top_left_y=140&top_left_x=106)

FIG. 3.2-38. Top: the CMP-stacked section derived from the HVA-based velocity section shown in Figure 3.2-37 (top); bottom: the CMP-stacked section derived from the velocity section shown in Figure 3.2-37 (bottom) derived from the interpolation of the vertical rms velocity functions picked at selected CMP locations along the line traverse.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0341.jpg?height=1024&width=754&top_left_y=126&top_left_x=144)

FIG. 3.2-39. A detaled portion of the sections in Figure 3.2-38.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0342.jpg?height=1030&width=754&top_left_y=128&top_left_x=80)

FIG. 3.2-40. A detailed portion of the sections in Figure 3 2-38.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0343.jpg?height=622&width=850&top_left_y=122&top_left_x=94)

FIG. 3.2-41. Coherency attribute sections: (a) stack (equation 3-16), (b) normalized stack (equation 3-18), (c) unnormalized crosscorrelation (equation 3-19), (d) normalized crosscorrelation (equation 3-20), (e) energy-normalized crosscorrelation (equation 3-21), and (f) semblance (equation 3-22).

### 3.3 RESIDUAL STATICS CORRECTIONS

Reflection times often are affected by irregularities in the near-surface. This is best demonstrated by the real data example in Figure 3.3-1. While the shot gathers on the left contain reflections that exhibit nearly hyperbolic moveout, those on the right have reflections that significantly depart from hyperbolic moveout. Although such distortions can be caused by a structural complexity deeper in the subsurface, more often they result from near-surface irregularities.

For land data, reflection traveltimes are reduced to a common datum level, which may be flat or vary (floating datum) along the line. Reduction of traveltimes to a datum usually requires correction for the near-surface weathering layer in addition to differences in elevation of source and receiver stations. Estimation and correction for the near-surface effects usually are performed using refracted arrivals associated with the base of the weathering layer (Section 3.4).

Traveltime corrections to account for the irregular topography and near-surface weathering layer are commonly known as field statics or refraction statics corrections (Section 3.4). These corrections remove a significant part of the traveltime distortions from the data - specifically, long-wavelength anomalies. Nevertheless, these corrections usually do not account for rapid changes in elevation, the base of weathering, and weathering velocity.

Removal of near-surface distortions on reflection times associated with deeper reflectors is routinely done by lowering the shots and receivers along vertical ray-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0344.jpg?height=379&width=828&top_left_y=116&top_left_x=103)

FIG. 3.3-1. Common-shot gathers from a land profile. Note the departures from hyperbolic traveltimes on the gathers at the right.

paths from the surface to a datum below the weathering layer. The positioning of shots and receivers to a datum along vertical raypaths amounts to static time corrections in a surface-consistent manner (Taner et al., 1974). The term static implies that it is a constant time shift for an entire trace, and the term surface-consistent implies that the time correction depends only on the surface location of the shot and receiver associated with the trace.

Figures 3.3-2a and 3.3-3a are selected CMP gathers (with field statics corrections) which were NMO corrected using a set of preliminary velocity picks derived from the velocity analyses in Figure 3.3-4. Deviations from the hyperbolic trends on the CMP gathers significantly degrade the quality of some of the velocity spectra. For instance, velocity analysis at CMP location 188 yields relatively poner quality picks than those from other velocity analyses. The CMP gathers in the neighborhood of CMP location 188 have more traveltime distortions compared to some other CMP gathers (Figure 3.3-2a). The resulting stacked section could be misleading in that residual statics may cause dim spots along the reflection horizons as well is false structures (Figure 3.3-5a), particularly between midpoints 101 to 245. False structures also are apparent on the rms AGC gained stack (Figure 3.3-6a) in which dim spots may not be apparent.

Obviously a more correct picture of the subsurface should be attained from data corrected for rapidly varying near-surface effects. After making these ressdualstatics corrections, the CMP gathers with traveltime deviations show better alignment of reflections (Figwe 3.3-2b), while those that did not require such corrections are essentially unchanged (Figure 3,3-3b). After the residual statics corrections, the ungained (Figure 3.3-5b) and gained stacked sections (Figure 3.3-6b) show improvement in the entinuity of reflections as well as significant elimination of false structures (refer to the segment between midpoints 101 to 245 ).

Following the residual statics corrections, velocity analyses almost always are repeated to update the velocity picks (Figure 3.3-7). Comparison of Figures 3.3-4 and 3.3-7 shows that residual statics corrections have improved the velocity analysis. The same CMP gathers after NMO corrections using the updated velocity picks are shown in Figures $3.3-8 a$ and $3.3-9 a$, while the same gathers after residual statics corrections are shown in Figures 3.3-8b and 3.3-9b. Comparison of the CMP gathers before and after residual statics corrections shows significant elimination of time deviations. The resulting stacked sections using the revised velocity estimates are shown in Figure 3.3-10, while the gained stacks are shown in Figure 3.3-11.

Compare the stacked sections in Figures 3.3-6a,b and 3.3-11a,b, and observe the gradual improvement in the following order:

(a) CMP stack based on preliminary velocity picks (Figure 3.3-4) but with no residual statics corrections applied (Figure 3.3-6a),

(text contznues on p. 936 )

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0345.jpg?height=381&width=745&top_left_y=218&top_left_x=146)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0345.jpg?height=361&width=723&top_left_y=666&top_left_x=145)

(b)

FIG. 3.3-2. CMP gathers from a land profile: (a) before residual statics corrections, (b) after residual statics corrections. (Shot gathers are shown in Figure 33 -1.) NMO correction was applied using preliminary velocity picks derived from the spectra in Figure 3.3-4. The CMP stacks are shown in Figure 3 3-5.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0346.jpg?height=382&width=693&top_left_y=214&top_left_x=176)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0346.jpg?height=363&width=667&top_left_y=665&top_left_x=169)

(b)

FIG. 3.3-3. CMP gathers from the same land line as in Figure 3.3-2 (a) before and (b) after residual statics corrections. This part of the line does not have as severe a statics problem as that shown in Figure 3.3-2. The NMO correction was appled using proliminary velocity picks derived from the spectra in Figure 3.3-4.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0347.jpg?height=504&width=840&top_left_y=306&top_left_x=94)

FIG. 3.3-4. Velocity analyges before residual statics corrections along the land line shown in Figure 3.3-5. Figures 3.3-2 and 3.3-3 show selected CMP gathers-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0348.jpg?height=383&width=778&top_left_y=221&top_left_x=131)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0348.jpg?height=358&width=746&top_left_y=678&top_left_x=134)

(b)

FIG. 3.3-5. CMP stacks derived from gathers in Figures 3.3-2 and 3.3-3. Stack (a) before and (b) after residual statics corrections, NMO correction was applied using preliminary velocity picks derived from the spectra in Figure 3.3.4.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0349.jpg?height=379&width=775&top_left_y=231&top_left_x=134)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0349.jpg?height=358&width=755&top_left_y=678&top_left_x=133)

(b)

FIG. 3.3-6. The same CMP stacks as in Figure 3.3-5 with rms gain applied. Gained stacks (a) before and (b) after residual statics corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0350.jpg?height=504&width=852&top_left_y=304&top_left_x=91)

FIG. 3.3-7. Velocity analyses after residual statics corrections along the line shown in Figure 3.3-5. Figures 3.3-8 and 3.3-9 show selected CMP gathers.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0351.jpg?height=380&width=745&top_left_y=233&top_left_x=146)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0351.jpg?height=362&width=723&top_left_y=655&top_left_x=145)

(b)

FIG. 3.3-8. CMP gathers from the land line shown in Figure 3.3-10. CMP gathers (a) without and (b) with residual statics corrections. (Figure 3.3-1 shows the shot gathers from the same line.) NMO correction was applied using final velocity picks derived from the spectra in Figure 3.3-7.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0352.jpg?height=383&width=699&top_left_y=233&top_left_x=169)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0352.jpg?height=368&width=667&top_left_y=656&top_left_x=169)

(b)

FIG. 3.3-9. CMP gathers from the same land line as in Figure 3.3-8. CMP gathers (a) without and (b) with residual statics corrections. This part of the line does not have as severe a statics problem as the part in Figure 3.3-8, NMO corrention was applied using final velocity picks derived from the spectra in Figure 3.3-7.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0353.jpg?height=393&width=778&top_left_y=232&top_left_x=124)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0353.jpg?height=369&width=754&top_left_y=667&top_left_x=126)

(b)

FIG. 3.3-10. CMP stacks derived from the gathers in Figures 3.3-8 and 3.3-9. Stack (8) before and (b) after residual statics corrections and using revised velocity estimates from Figure 3.3.7.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0354.jpg?height=379&width=764&top_left_y=243&top_left_x=134)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0354.jpg?height=365&width=748&top_left_y=659&top_left_x=134)

(b)

FIG. 3.3-11. The same CMP stacks as in Figure 3.3-10 with rms gain applied. Gained stacks (s) before and (b) after residual statics corrections and using revised velocity estimntes from Figure 3.3-7.

## 1. CMP Gathers with Field Statics Applied

2. Velocity Analysis

## 3. NMO Correction using Preliminary Picks

## 4. Compute and Apply Residual Statics

## 5. Inverse NMO Correction

## 6. Velocity Analysis <br> 7. NMO Correction using Final Picks

## 8. Stack

FIG. 3.3-12. Processing flowchart with residual statics corrections.

(b) stack based on preliminary velocity picks (Figure 3.3-4) and with residual statics corrections applied (Figure 3.3-6b),

(c) stack based on final velocity picks (Figure 3.3-7) but with no residual statics corrections applied (Figure 3.3-11a), and

(d) stack based on final velocity picks (Figure 3.3-7) and with residual statics corrections applied (Figure 3.3-11b).

Here, the velocity picks made from CMP gathers with no residual statics corrections applied are referred to as prehminary and those made from CMP gathers with residual statics corrections applied are referred to as final.

Residual statics corrections usually are discussed in terms of applications to land data. However, in certain cases, residual statics corrections have produced dramatic improvement in marine data. Areas with irregular water-bottom topography in shallow water (less than $25 \mathrm{~m}$ ), and areas with rapidly varying velocity in the sediments near the water bottom are places where statics corrections have been successfinl.
Figure 3.3-12 shows a commonly used flowchart for residual statics corrections and velocity analysis aimed at producing an optimum stacked section. Start with CMP gathers with field statics or refraction statics corrections applied (Section 3.4), and perform velocity analysis, usually no more than a few locations along the line. Then, apply NMO correction with the preliminary velocity picks and compute residual static shifts. Apply these corrections to the original gathers, and repeat the velocity analysis this time at all necessary locations along the line. Finally, apply NMO correction and stack the data. In some cases, there may be more than one iteration of estimating and applying the residual statics corrections.

In practice, the flowchart in Figure 3.3-12 usually is augmented with additional quality control steps. It often is necessary to examine CMP gathers and velocity analyses after residual statics corrections. Diagnostic tools allow determination of the magnitude of these corrections. For example, common-shot and common-receiver gathers indicate relative static shifts from one receiver location to another and from one shot location to another (Figures 3.3-13 and 3.3-14, respectively). Also, common-shot-point and common-receiverpoint stacks can be used in combination with commonreceiver and common-shot gathers, respectively. A common-shot-point stack (Figure 3.3-15) should indicate the range of magnitude of shot static shifts; a common-receiver-point stack (Figure 3.3-16) should indicate the range of magnitude of receiver static shifts along the line. These displays enable the determination of an optimum maximum allowable shift to consider for picking traveltime deviations from the moveoutcorrected CMP data for input to residual statics estiamtion algorithms. From the example in Figures 3.3-15 and $3.3-16$, the receiver component of static shifts is greater than the shot component.

## Residual Statics Estimation by Traveltime Decomposition

Static deviations from a hyperbolic traveltime trajectory are illustrated in Figure 3.3-17. After NMO correction, the misalignment of the wavelet associated with a reflection time horizon $h$ along the offset axis in the CMP gather will yield a poor stack trace. We want to estimate the time shifts from the time of perfect alignment and correct for these time shifts. To do this, a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0356.jpg?height=376&width=701&top_left_y=246&top_left_x=167)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0356.jpg?height=358&width=701&top_left_y=665&top_left_x=167)

(b)

FIG. 3.3-13. Moveout-corrected common-shot gathers from the same land line as in Figure 3.3-1. Common-shot gathers (B) before and (b) after residual statics corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0357.jpg?height=383&width=753&top_left_y=241&top_left_x=137)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0357.jpg?height=368&width=724&top_left_y=660&top_left_x=138)

(b)

FIG. 3.3-14. Moveout-corrected common-receiver gathers from the same land line as in Figure 3.3-13. Common-receiver gathers (a) before and (b) after residual statics corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0358.jpg?height=388&width=764&top_left_y=232&top_left_x=135)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0358.jpg?height=355&width=763&top_left_y=661&top_left_x=136)

(b)

FIG. 3.3-15. A diagnostic display for residual statics corrections. Common-shot-point (CSP) stack (a) before and (b) after residual statics corrections. Note the missing shots between CMP 151 and 243. The CSP stack can be used to estimate the magnitude and spatial variation of shot statics along a line.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0359.jpg?height=389&width=755&top_left_y=230&top_left_x=144)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0359.jpg?height=363&width=754&top_left_y=661&top_left_x=144)

(b)

FIG. 3.3-16. A diagnoetic display for residual statics corrections. Common-receiver-point (CRP) stack (a) before and (b) after residual statics corrections. The CRP stack can be used to estimate the magnitude and spatial variation of receiver statics along a line.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0360.jpg?height=272&width=394&top_left_y=127&top_left_x=93)

FIG. 3.3-17. Plcking traveltime deviations from NMOcorrected gathers.

model is needed for the moveout-corrected traveltime from a source location to a depth point on a reflecting horizon, then back to a receiver location. Figure 3.3-18 shows the geometry and notation that will be used in defining this model. The key assumption in the comnonly used traveltime model discussed here is that residual statics are surface-consistent (Hileman et al., 1968; Taner et al., 1974). This means that static shifts are time delays that depend solely on source or receiver locations at the surface, not on raypaths in the subsurface. Such an assumption is valid if all raypaths, regardless of source-receiver offset, are vertical within the near surface layer. The surface-consistent assumption usually is a good one, because the weathering layer often has very low velocity and a strong refraction at its base tends to make travel paths vertical. The assumption may not be good for a high-velocity permafrost layer that causes rays to bend away from vertical.

The picked traveltime $t_{y}$ that corresponds to the $j$ th source station, the $i$ th receiver station, and the $k$ th midpoint $[k=(i+j) / 2]$ along a specific reflection time horizon $h$ (Figure 3.3-17) can be approximately modeled by the following equation (Taner et al., 1974; Wiggins et al., 1976):

$$
t_{i j}^{\prime}=s_{j}+r_{i}+G_{k}+M_{k} x_{i j}^{2},
$$

where $s$, is the residual static time shift associated with the $j$ th source station, $r_{2}$ is the residual static time shift associated with the $i$ th receiver station, and $G_{k}$ is the difference in two-way time at a reference CMP location and the traveltime at the $k$ th CMP location along the $h$ th horizon. This term refers to structural variations along the horizon and is called the structure term. The term $M_{k} x_{i j}^{2}$ is the residual moveout which is assumed to he parabolic. It accounts for the imperfect moveout correction within the specific tine gate that includes

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0360.jpg?height=230&width=436&top_left_y=127&top_left_x=528)

FIG. 3.3-18. Surface-consistent statics model to establish the traveltime model equation (3-25). Here, $T=$ topographic layer, $B=$ base of weathering layer, $D=$ datum to which static corrections are made, $R=$ deep reflector, $j=$ shot st $u$ tion index, $t=$ receiver station index, $k=$ midpoint location index, $x_{2 j}=$ offiset between the shot and receiver stations.

the reflection time horizon $h$. The coefficient $M_{k}$ has the dinensions of (time / distance ${ }^{2}$ ).

To be specific in an analysis of the system of equetions implied by equation (3-25), assume $n_{\theta}$ shot locations, $n_{r}$ receiver locations, and $n_{G}$ CMP locations. Then define the fold as $n_{f}$. The purpose is to decompose the observed traveltimes estimated (picked) from the data $t_{12}$ to their individual components as defined on the right side of equation (3-25). The number of time picks (or individual equations) is equal to $n_{G} \times n_{f}$. The number of unknowns is $n_{s}+n_{F}+n_{G}+n_{G}$. Typically, $\left(n_{G} \times n_{f}\right)>\left(n_{g}+n_{+}+n_{G}+n_{G}\right)$; hence, there are more equations than unknowns.

We can formulate a least-squares problem in which we must minimize the sum of the least-squares error energy between the observed traveltime picks $t_{3,}$ and the modeled traveltimes $t_{t}$ :

$$
E=\sum_{i j}\left(t_{i j}-t_{i j}^{\prime}\right)^{2}
$$

Residual statics corrections involve three phases:

(1) Picking traveltime deviations $t_{1}$, based on crosscorrelation of traces in a CMP gather with a reference or pilot trace that needs to be defined in some fashion,

(2) Modeling $t_{2 j}$ by way of equation (3-25) and decomposing it into its components: source and receiver statics, structural and residual moveout terms, and

(3) Applying the derived source and receiver terms $s_{3}$ and $r_{2}$, respectively, to traveltimes on the preNMO-corrected CMP gathers.

The picking phase relates to estimating traveltimes $t_{i}$ from the data. Several picking schemes are in use in the industry. The one described here often is known as a pilot trace scheme. Starting with the CMP gathers that are NMO-corrected using a preliminary velocity function(s), trace amplitudes are scaled to a common rms amplitude in the time gate(s) to be used for picking. For ciarity, consider a time gate over the $k$ th midpoint gather as illustrated in Figure 3.3-17. (It is preferable to start with a gather that has a good signal-to-noise ratio.) A stack trace then is constructed within the time gate $h$. Each individual trace in the gather is crosscorrelated with the stack trace. Time shifts $t_{13}$, which correspond to maximum crosscorrelations, are picked. A preliminary pilot trace is constructed by stacking the time-shifted traces in the gather. This preliminary pilot trace is, in turn, crosscorrelated with the original traces in the gather and new values for $t_{1 j}$ are computed. A final pilot trace is constructed again by stacking the original traces shifted by the new values for $t_{i v}$. This final pilot trace is crosscorrelated with the traces of the next gather to construct the preliminary pilot trace for that gather. The process is performed this way on all CMP gathers moving to the left and right from the starting point. The picked time deviations $t_{y,}$ are passed on to the next phase, which involves decomposing these time picks into components as defined by equation (3-25).

Several practical issues are involved in the picking phase. Band-pass filtering often helps to estimate a reliable time shift that corresponds to the peak crosscorrelation value. Selection of the time window used for crosscorrelation is another important factor. If needed, the window should be allowed to change laterally so that it follows the marker horizon(s). A maximum threshold for the correlation shift can be imposed to prevent unrealistically large time deviations from being passed on to the decomposition phase. Any time deviations greater than a specified maximum allowable shift can be set to that shift, or rejected altogether. Alternatively, the rejected shift can be replaced by a secondary correlation peak value. Finally, the input CMP gathers must be NMO-corrected by using a regional velocity function or velocities derived from a preliminary velocity analysis. These parameters are discussed in detail later in the section.

The next step in residual statics corrections involves least-squares decomposition of the time picks $t_{43}$. For a basic understanding of this step, consider the following special problem. Suppose there are four observations $t_{i}$, measured at receiver locations $x_{2}$, where $\imath=1,2,3,4$. We want to fit the observed data into a straight line $t=a+b x$, which is best in a least-squares error sense. Start with the following set of equations:

$$
\begin{aligned}
& t_{1} \approx a+b \tau_{1} \\
& t_{2} \approx a+b x_{2} \\
& t_{3} \approx a+b x_{3} \\
& t_{4} \approx a+b x_{4}
\end{aligned}
$$

There are two unknowns, $a$ and $b$, and four equations. This problem is similar to decomposing the time picks into various components as described by equation (325). We define the error series $e_{n}$, such that

$$
\begin{aligned}
& -t_{1}+a+b x_{1}=e_{1} \\
& -t_{2}+a+b x_{1}=e_{2} \\
& -t_{3}+a+b x_{1}=e_{3} \\
& -t_{4}+a+b x_{1}=e_{4} .
\end{aligned}
$$

We want to minimize the energy of the cumulative errors as defined by

$$
E=\sum_{1} e_{1}^{2}
$$

The energy for the $i$ th error is computed by squaring both sides of equation (3-28)

$$
e_{i}^{2}=\left(-t_{4}+a+b x_{7}\right)^{2}
$$

By substituting into equation (3-29a) and summing over $i=1,2,3,4$, we obtain

$$
\begin{aligned}
E= & \sum_{i} t_{i}^{2}+4 a^{2}+b^{2} \sum_{i} x_{s}^{2}-2 a \sum_{i} t_{i} \\
& -2 b \sum_{i} x_{i} t_{i}+2 a b \sum_{i} x_{i} .
\end{aligned}
$$

To find the best line, we want to determine un knowns $a$ and $b$ so that error energy $E$ is minimal. The sum $E$ of the squared errors will attain a minimum if $a$ and $b$ are chosen so that

$$
\frac{\partial E}{\partial a}=8 a-2 \sum_{2} t_{2}+2 b \sum_{3} x_{2}=0, \quad(3-31 a)
$$

and

$$
\frac{\partial E}{\partial b}=2 b \sum_{i} x_{\tau}^{2}-2 \sum_{1} x_{1} t_{2}+2 a \sum_{i} x_{1}=0 .
$$

We now have two equations with two unknowns that can be put into a matrix form

$$
\left(\begin{array}{cc}
4 & \sum_{1} x_{2} \\
\sum_{t} x_{2} & \sum_{1} x_{2}^{2}
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
\sum_{i} t_{2} \\
\sum_{2} x_{2} t_{2}
\end{array}\right) .
$$

Equation (3-32) can be solved for the unknowns $a$ and $b$. The minimum energy between the estimated model and the actual data values then can be computed by solving for $a$ and $b$ and substituting into equation (3-30).

Table 3-8. Time picks $t_{q}$ at various $x_{t}$ locations.

| $i$ | $x_{i}$ | $t_{i}^{\prime}$ |
| :--- | :--- | :--- |
| 1 | 1 | 2.4 |
| 2 | 2 | 2.9 |
| 3 | 3 | 3.6 |
| 4 | 4 | 4.1 |

Consider the time values at various $x$ locations specified in Table 3-8. Using these time picks, the elements of the coefficient matrix on the left side and the column matrix on the right side of equation (3-32) are

$$
\left(\begin{array}{cc}
4 & 10 \\
10 & 30
\end{array}\right)\left(\begin{array}{l}
a \\
b
\end{array}\right)=\left(\begin{array}{c}
13 \\
35.4
\end{array}\right)
$$

The solution for equation (3-33) is $a=1.8$ and $b=0.58$. Note that we are not constrained by the number of observations when setting up the least-squares problem. This problem involves more equations (3-27) than unknowns, $a$ and $b$.

The least-squares approach has a wide range of applications in applied geophysics. We also formulate the inverse filtering used in deconvolution based on a least-squares procedure (Section B.5). The Wiener filter itself is based on a least-squares estimation of a future sample point in a given time series. Here, we discussed another application of the least-squares method - residual statics estimation by traveltime decomposition, which involves more equations than unknowns. In Chapter 9, when discussing 2-D surface data processing, we encounter the problem of fitting irregularly spaced observations into a uniform grid. This involves least-squares fitting to a local plane (Section J.5).

We now return to the problem of residual statics estimation and refer to equation (3-26). We have the observed traveltime deviations $t_{i j}$ picked from moveoutcorrected CMP gathers within a specified time gate that includes a strong reflection. We want to estimate the parameters - the surface-consistent source and receiver static shifts, $s_{3}$ and $r_{1}$, respectively. These parameters are related to the modeled traveltime deviations $t_{v}^{\prime}$, by way of the model equation (3-25). If there are 50000 picks, then you have $\mathbf{5 0} \mathbf{0 0 0}$ model equations.

Substitute for $t_{i}$ from equation (3-25) and minimize the error energy $E$ in equation (3-26) by requiring

$$
\frac{\partial E}{\partial s_{j}}=\frac{\partial E}{\partial r_{\imath}}=\frac{\partial E}{\partial G_{k}}=\frac{\partial E}{\partial M_{k}}=0,
$$

which yields $n_{\theta}+n_{r}+n_{G}+n_{G}$ equations and that many unknowns.

These equations can be solved for the residual statics associated with $n_{\text {, }}$ source locations, $n_{r}$ receiver locations, $n_{G}$ structural terms, and $n_{G}$ residual moveout terms. For a real data set, the number of these terms can be large. It is easy to solve the problem with the two parameters given by equation (3-34). However, when dealing with a large number of linear equations, the solution must be done accurately and efficiently. Wiggins et al. (1978) used the Gauss-Seidel iterative procedure to solve for equations (3-34) (Section C.4).

The Gauss-Seidel method is best described by roturning to the earlier line fitting example and solving for $a$ and $b$ in equation (3-33). When written as normal equations, we have

$$
4 a+10 b=13
$$

and

$$
10 a+30 b=35.4
$$

These equations are rearranged as

$$
a=3.25-2.5 b
$$

and

$$
b=1.18-0.333 a .
$$

Since the Gauss-Seidel technique is iterative, starting values are needed. To start the iteration, set $a=b=0$. Substituting $b=0$ in equation (3-36a), we obtain $a=$ 3.25. Putting this updated solution into equation (336b) gives $b=0.0977$. At the end of the first iteration, $a=3.25$ and $b=0.0977$. For the second iteration, put $b=0.0977$ into equation (3-36a) to get $a=3.0075$. Put $a=3.0075$ into equation (3-36b) to get $b=0.1785$. This iterative procedure is continued in Table 3-9.

The solution from the iterative procedure slowly converges toward the actual values, $a=1.8, b=0.58$. Convergence is not always guaranteed. Nevertheless, convergence can be attained with the Gauss-Seidel method, provided the unknowns are ordered properly; that is, iteration starts with the correct unknown. This

Table 3-9. Gauss-Seidel iteration for solving equation (3-33) for $a$ and $b$. (Values were rounded off for tabulation.)

Actual values: $a=1.8, b=0.58$.

Iteration

$a$

$b$

1

3.25

0.0977

$\begin{array}{lll}5 & 2.4918 & 0.3502\end{array}$

$\begin{array}{lll}10 & 2.0712 & 0.4902\end{array}$

$\begin{array}{lll}15 & 1.9031 & 0.5462\end{array}$

$\begin{array}{lll}20 & 1.8358 & 0.5686\end{array}$

$\begin{array}{lll}25 & 1.8090 & 0.5779\end{array}$

$\begin{array}{lll}29 & 1.7997 & 0.5807\end{array}$
problem is addressed in Exercises 3-11 and 3-12. The advantage of the Gauss-Seidel method is its ability to solve the large number of simultaneous equations rapidly.

The question of when to terminate the iterations remains. The rate at which the solution changes can be examined after each iteration. The computation is stopped when this rate falls below a specified threshold value.

The starting values for solving the normal equations (3-34), can be chosen as $s_{j}=r_{1}=G_{k}=M_{k}=\mathbf{0}$, as in the simple numerical example. To some extent, the best order of iteration depends on the exact nature of the statics problem at hand. One order of iteration that is commonly in use follows: Compute the structure term $G_{1}$ the residual moveout term $M_{\text {, the }}$ the static shift associated with source location $s$, then the static shift associated with receiver location $r$. The procedure cycles back to $G$ in the next iteration and continues until convergence is satisfactory. The order in which the individual terms are computed theoretically can be interchanged. However, the above order forces long-wavelength variations of the time picks to be concentrated mainly in the structure term. This leads to a lesser number of iterations (typically 2 or 3 ) for wavelength components of the statics that are less than half the largest data offset. A large number of iterations are required to handle static variations that are greater than the maximum offset,

After computing the individual static shifts associated with each source and receiver location, these shifts are passed on to the application phase, whereby the shifts are applied to the pre-NMO-corrected gather traces (Figure 3.3-13). In areas with extremely poor signal-to-noise ratio or complicated near-surface variations, multiple passes of residual statics corrections may be necessary. In other words, output from the first pass may be NMO-corrected, new picks estimated, decomposed, and applied, and so on.

The question remains as to whether equations (325) are independent of each other. This is important, for it tells whether the solution is unique or not. For simplicity, consider the case of zero structure and zero residual moveout. In that cese, equations (3-25) take the form

$$
t_{z j}=s_{j}+r_{z} .
$$

Consider only four unknowns: $s$, where $j=1,2$, and $r_{4}$, where $i=1,2$, which yicld four equations:

$$
\begin{aligned}
& t_{11}=s_{1}+r_{1} \\
& t_{12}=s_{2}+r_{1} \\
& t_{21}=s_{1}+r_{2} \\
& t_{22}=s_{2}+r_{2}
\end{aligned}
$$

However, from a close examination of equations (3-37b), we note that

$$
t_{11}+t_{22}=t_{12}+t_{21}
$$

Therefore, one of the four equations (3-37b) is redundant, leaving three independent equations for four unknowns.

This simple exercise shows that the statics solution obtained by solving equations (3-34) suffers from an uncertainty. In particular, the solution obtained by, say, the Gauss-Seidel iteration, is nonunique. It is but one of many possible solutions. In fact, the solution may not even be physically reasonable. Because of the problem of fewer independent equations than unknowns, it may be necessary to impose a constraint on the solution from the traveltime decomposition (equation 3-25):

(a) A plausable constraint is that the difference between shot and receiver statics be minimal (Gulunay, 1985). It can be argued that this may not be valid, as is the case with dynamite data in which shots and receivers do not occupy the same physical locations.

(b) Other possible constraints can be in the form of restrictions on the spatial variation of structure, moveout, or statics terms themselves; all are used in various practical implementations. For instance, one may postulate a model equation for the residual statics problem, where the structure term has been omitted. Then, you have to design your picking strategy accordingly, such that you do not accumulate the traveltimes as you go from one CMP location to another. This may be preferable in areas with very low-relief structures.

(c) We may want to impose the surface-consistency rule in a strict sense, and assign the same static shift to a shot and receiver if they occupy nearly the same physical location.

(d) We may also opt to set the residual cnoveout coefficient $M$ to a constant across the line if we are fairly confident of the velocity control. This then gives us fewer parameters to estimate, thus making the residual statics solution more likely to be stable and physically plausable.

## Residual Statics Estimation

by Stack-Power Maximization

Estimation of traveltime deviations from NMOcorrected CMP gathers may fail with land data which have low fold and poor signal-to-noise ratio. As a result, residual statics solution by traveltime decomposition can be erratic and unstable. A more robust alternative for surface-consistent estimates of shot and residual
static shifts is based on minimizing the difference between modeled and actual traveltime deviations (equation 3-26) associated with a reflection event on moveoutcorrected gathers. Specifically, surface-consistent static shifts also can be determined by maximizing the power of stacked traces (Ronen and Claerbout, 1985).

The conceptual basis of the method of stack power maximization is intuitively simple. Consider determining the residual static at a shot station. As in the case of residual statics estimation by traveltime decomposition, this method also is applied to moveout-corrected data.

(a) Apply a static shift to all the traces in the commonshot gather associated with the station under consideration.

(b) Stack over a time gate the CMP gathers that inciude traces from that shot gather.

(c) Compute the cumulative energy of the stacked traces from step (b) by summing the squared amplitudes.

(d) Repeat steps (a), (b), and (c) for a range of static shifts.

(e) Choose the static shift that yields the highest stack power and assign it to the shot location under consideration.

(f) Apply the shot residual static shift associated with the highest stack power to all the traces in the shot gather.

(g) Stack the CMP gathers that include traces from this shot gather.

(h) Move to the next shot station and repeat steps (a) through (g).

The process is then repeated for the receiver stations using common-receiver gathers.

This formal recipe for stack-power maximization is intensive both computationally and in terms of data movement. A practical alternative involves creating two supertraces - one from the traces of the common-shot or common-receiver gather under consideration, and a second one from the traces of the stacked traces associated with the common-shot or common-receiver gather (Ronen and Claerbout, 1985). A supertrace is created by augmenting the individual segments of traces within the specified time gate in a gather, one followed by the other with a zone of zero-amplitude samples between them. The subtlcty of the method to kcep in mind is that the stack supertrace does not include the contribution of the traces from the common-shot or commonreceiver gather.

Define the shot and stack supertraces by the time series $F(t)$ and $G(t)$, respectively. The stack power defined as the power of the sum of these two traces over the time gate $t$ is

$$
P(\Delta t)=\sum_{t}[F(t-\Delta t)+G(t)]^{2}
$$

where $\Delta t$ is the trial static shift applied to the shot supertrace $F(t)$. By expanding the squared term, we obtain

$P(\Delta t)=\sum_{t} F^{2}(t-\Delta t)+\sum_{t} G^{2}(t)+2 \sum_{t} F(t-\Delta t) G(t)$.

The first two terms are the powers of the two supertraces that can be defined by a constant, and the third term is the crasscorelation of the two supertraces. Therefore, maximizing the stack power is equivalent to maximizing the crosscorrelation (Ronen and Claerbout, 1985).

Now, consider, again, determining the residual static at a shot station.

(a) Create the shot supertrace. To circumvent end effects in step (c), place zero-amplitude samples between the trace segments when creating the supertraces.

(b) Create the stack supertrace.

(c) Crosscorrelate the two supertraces.

(d) Determine the correlation lag associated with the peak crosscorrelation value - this is the shot residual static shift.

(f) Apply the shot residual static shift associated with the highest correlation value to all the traces in the shot gather.

(g) Stack the CMP gathers that include traces from this shot gather.

(h) Move to the next shot station and repeat steps (a) through (g).

(i) Repeat steps (a) through (h) for all receiver stations.

Steps (a) through (i) usually are applied iteratively to converge to a solution of shot and residual static shifts.

## Traveltime Decomposition in Practice

As stated early in this section, residual statics estimation by traveltime decomposition consists of three stages: picking, decomposing, and applying residual static shifts. The picking phase, in which traveltime deviations are derived from trace erosscorrelations, determines the effectiveness of residual statics corrections. We now examine various parameters involved in the picking phase.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0365.jpg?height=484&width=406&top_left_y=126&top_left_x=82)

FIG. 3.3-19. CMP-stacked section associated with a synthetic data set. Shot and receiver statics were applied on moveout-corrected gathers in a surface-consistent manner, while the structure term was applied in a subsurfaceconsistent manner. These terms are plotted above the stacked section. Random noise whs added to prestack data with a spatially varying signal-to-noise ratio.

## Maximum Allowable Shift

Consider the CMP-stacked section in Figure 3.3-19 associated with a synthetic data set. This data set was created by using the field geometry of a real seismic line. The CMP traces were derived from the first trace of the first CMP location from that real line. This trace first was zeroed out within selected time gates, then treated with the shot and receiver static shifts in Figure 3.3-19 in a surface-consistent manner and with a structure term that only depended on midpoint location (subsurface-consistent). The shot and receiver static shifts were varied from +32 to $-32 \mathrm{~ms}$. Finally, the synthetic traces were blended with a band-limited random noise, whcse strength varied spatially. (The noise level was set to zero at both ends of the profile and to maximum at the center.) The stacked section constructed from data before treatment with synthetic shot and receiver static shifts is shown in Figure 3.3-20. Once residual statics corrections are made, the stacked section in Figure 3.3-19 should resemble that in Figure 3.3-20.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0365.jpg?height=262&width=384&top_left_y=126&top_left_x=549)

FIG. 3.3-20. CMP-stacked section associated with the synthetic data set as in Figure 3.3-19, but without synthetic shot or receiver statics applied. Once residual statics correotions are applied to the data set associated with the stacked section in Figure 3.3-19, the resulting stacked section should resemble the section shown here.

Note how degrading the effect of the synthetic shot and receiver static shifts is on the continuity of reflections in Figure 3.3-19. The sole effect of random noise is seen in Figure 3.3-20.

Consider three different tests of residual statics corrections: one with a small maximum allowable shift (24 $\mathrm{ms}$ in Figure 3.3-21), one with a moderately sized shift (80 $\mathrm{ms}$ in Figure 3.3-22), and one with a fairly large shift (192 ms in Figure 3.3-23). All three tests had the same input CMP gathers. All three were run using the same set of parameters except for the maximum allow. able shift.

The maximum value of combined shot and receiver static shifts for any given trace implied by the model in Figure 3.3-19 is $\mp 64 \mathrm{~ms}$. When the maximum allowable shift is insufficient (a value of less than $64 \mathrm{~ms}$ ), then the derived static shifts (Figure 3.3-21) are significantly smaller than the actual shifts (Figure 3.3-19). Thus, stack quality, although significantly improved when compared to that in Figure 3.3-19, is far from the quality of the section shown in Figure 3.3-20.

When the maximum allowable shift is sufficient, then the derived static shifts (Figure 3.3-22) are like the actual shifts imposed on the input model shown on the graph in Figure 3.3-19. Also, stacking quality (Figure 3.3-22) improved so that it now is comparable to the no-static model (Figure 3.3-20).

Reasonable results (Figure 3.3-23) also were obtained for the case allowing excessively large maximum allowable shift, up to $192 \mathrm{~ms}$. However, this result does not imply that we can be liberal on the upper bound
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0366.jpg?height=500&width=414&top_left_y=130&top_left_x=82)

FIG. 3.3-21. CMP-stacked section associated with the synthetic data set as in Figure 3.3-19 with residual statics corrections. The derived shot, reociver, and structure terms are plotted at the top. Compare these estimates with the actual values in Figure 3.3-19. The maximum allowable shift is 24 ms. Also compare the resulting stacked section with that shown in Figure 3.3-20.

of maximum shift in real data situations. In the presence of short-period multiple or reverberation energy, or data with a narrow bandwidth or high noise level, crosscorrelation can yield a multiple number of peaks and cause uncertainty in the estimated time shifts (cycle skipping). In this case, a large maximum allowable shift could cause anomalously large time shifts to be picked.

Based on the tests shown in Figures 3.3-21 through 3.3-23, the maximum allowable shift used in the picking phase should be greater than all possible combined shot and receiver static shifts at any given location along the profile. On the other hand, jumping a leg in correlating events from trace to trace in a CMP gather, commonly known as cycle skip, especially in poor signal-to-noise ratio conditions, also is more likely to occur if the maximum allowable shift is greater than the dominant period of the data.

We may argue that the result of cascading a number of small-shift residual statics solutions is as good as a single-step large-shift solution. This approach might
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0366.jpg?height=504&width=416&top_left_y=128&top_left_x=538)

FIG. 3.3-22. CMP-stacked section associated with the synthetic data set as in Figure 3.3-19 with residual statics corrections. The derived shot, reociver, and structure terms are plotted at the top. Compare these estimates with the actual values in Figure 3.3-19. The maximum allowable shift is 80 ms. Also compare the resulting stacked section with that shown in Figure 3.3-20.

have the same effectiveness as the large-shift solution, while avoiding the possibility of cycle skipping. Unfortunately, cascading small-shift solutions does not work. Starting with the CMP gathers associated with the stack in Figure 3.3-19, we get the CMP gathers corrected for shot and receiver statics based on a 24 -ms shift (first pass). The stack is shown in Figure 3.3-21. Using these gathers, a new statics solution was derived and applied to the data (second pass). This process was repeated for the third and fourth times. The result of this last iteration (Figure 3.3-24) does not have the quality of the solution derived with the $80-\mathrm{ms}$ shift (Figure 3.3-22).

Now consider maximum allowable shift tests on the field data as in Figure 3.3-2. Figure 3.3-25 shows CMP gathers from the problem zone of the profile in Figure 3.3-5. Refer to the panels for 24 - and $40-\mathrm{ms}$ shifts in Figure 3.3-25, and note that an insufficient maximum allowable shift does not completely correct for all static
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0367.jpg?height=498&width=420&top_left_y=346&top_left_x=81)

FIG. 3.3-23. CMP-stacked section associated with the synthetic data set as in Figure 3.3-19 with residual statics corrections. The derived shot, receiver, and structure terms are plotted at the top. Compare these estimates with the actual values in Figure 3.3-19. The maximum allowable shift is 192 ms. Also compare the resulting stacked section with that shown in Figure 3.3-20.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0367.jpg?height=504&width=418&top_left_y=319&top_left_x=537)

FIG. 3.3-24. CMP-stacked section associated with the synthetic data set as in Figure 3.3-19 with residual statics corrections. The derived shot, receiver, and structure terms are plotted at the top. This is the output from the four iterstive passes of the statics estimation and application. Compare these estimates with the actual values in Figure 3.3-19. First-pass results are shown in Figure 3.3-21. The maximum allowable shift is $24 \mathrm{~ms}$ on each pass. Also compare the resulting stacked section with that shown in Figure 3.3-20.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0368.jpg?height=800&width=787&top_left_y=259&top_left_x=122)

FIG. 3.3-25. Test of maximum allowable shift. CMP gathers after residual statics corrections using five different maximum allowable shifts. Figure 3.3-28 shows the CMP stacks.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0369.jpg?height=794&width=772&top_left_y=270&top_left_x=116)

FIG. 3.3-26. Diagnostics for maximum allowable shift tests (Figure 3.3-25) showing common-shot-point-stacked data.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0370.jpg?height=836&width=796&top_left_y=249&top_left_x=102)

FIG. 3.3-27. Diagnostics for maximum allowable shift tests (Figure 3.3-25) showing corrmon-receiver-point-stacked data.

## $\begin{array}{lllll}245 & 197 & 149 & 101 & 53\end{array}$ CMP

1 ind Stack with No Corrections

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=263&width=359&top_left_y=273&top_left_x=527)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=25&width=357&top_left_y=538&top_left_x=164)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=59&width=359&top_left_y=555&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=42&width=353&top_left_y=598&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=54&width=353&top_left_y=629&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=23&width=364&top_left_y=536&top_left_x=519)
$=0$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=48&width=358&top_left_y=702&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=48&width=353&top_left_y=734&top_left_x=166)
Maximum Shift $=24 \mathrm{~ms}$ tieterite 24
$m=1$
$120 \mathrm{~ms} m$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0371.jpg?height=266&width=722&top_left_y=803&top_left_x=165)

FIG. 3.3-28. Test of maximum allowable shift: CMP stacks after residual statics corrections using five different maximum allowable shifts. Figure 3.3-25 shows selected CMP gathers.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0372.jpg?height=801&width=786&top_left_y=257&top_left_x=127)

FIG. 3.3-29. Test of correlation window: CMP gathers after residual statice corrections using five different correlation windows. Figure 3.3-32 shows the CMP stacks.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0373.jpg?height=246&width=772&top_left_y=272&top_left_x=138)

## CSP Stack with No Corrections,

## Optimum Window $=800-2300 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0373.jpg?height=530&width=754&top_left_y=536&top_left_x=156)

FIG. 3.3-30. Dragnostics for correlation window tests (Figure 3.3-29) showing common-shot-point-stacked data.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0374.jpg?height=798&width=754&top_left_y=269&top_left_x=147)

FIG. 3.3-31. Diagnostics for correlation window tests (Figure 3 3-29) showing common-receiver-point-stacked data.

## $245 \quad 197 \quad 149 \quad 101 \quad 53 \leftarrow$ CMP

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0375.jpg?height=266&width=734&top_left_y=269&top_left_x=154)

Stack with No Corrections Etities Optlmum Window $=800-2300 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0375.jpg?height=531&width=730&top_left_y=536&top_left_x=159)

FIG. 3.3-32. Test of correlation window: CMP stacks after residual statics corrections using five different correlation windows. CMP gathers are shown in Figure 3.3-29.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0376.jpg?height=798&width=783&top_left_y=260&top_left_x=127)

FIG. 3.3-33. Test of correlation window: CMP gathers after residual statics corrections using five different correlation windows. CMP stacks are shown in Figure 3.3-36.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0377.jpg?height=796&width=780&top_left_y=272&top_left_x=128)

FIG. 3.3-34. Dlagnostics for correlation window tests (Figure 3.3-33) showing common-shot-point-stacked data.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0378.jpg?height=528&width=770&top_left_y=272&top_left_x=74)

Window $=400-1200 \mathrm{~ms}$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0378.jpg?height=292&width=506&top_left_y=774&top_left_x=339)

FIG. 3.3-35. Diagnostics for correlation window tests (Figure 3.3-33) showing common-receiver-point-stacked data.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0379.jpg?height=820&width=769&top_left_y=249&top_left_x=134)

FIG. 3.3-36. Test of correlation window: CMP stacks after residual statics corrections using five different correlation windows. CMP gathers are shown in Figure 3.3-33.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0380.jpg?height=646&width=894&top_left_y=134&top_left_x=73)

FIG. 3.3-37. Pilot traces (bottom) and shot and receiver statics solutions (top) for the 80-ms shift and the 400- to 1200-ms window. CMP stack is shown in Figure 3.3-36.

shifts. Excessively large shifts, however, such as 120 - or 160 -ms, do not seem to harm this particular data set. While common-shot-point (CSP) stacks (Figure 3.3-26) indicate small shot-static shifts, common-receiver-point (CRP) stacks (Figure 3.3-27) indicate a zone of significant reotiver-static shifts. Again, small maximum allowable shifts have not corrected completely for these statics anomalies.

The ultimate judgment is made by examining the stack response and plots of the estimated statics themselves. From Figure 3.3-28 (ungained stack responses), it is clear that the maximum allowable shift must be adequate to accommodate the combined shot and receiver statics present in the data at any location along the profile.

## Correlation Window

From the same field data example (Figure 3.3-5), the results of residual statics corrections (for the right half of the stacked section) are examined by using different correlation windows while keeping all other parameters constant. The maximum allowable shift was $80 \mathrm{~ms}$ in these tests. From Figure 3.3-29, note that a correlation window confined to the mute zone ( 400 to $1200 \mathrm{~ms}$ ) is not desirable. It does not provide sufficient statistics because of the low fold of coverage and the shortness of the data window available for crosscorrelation with the pilot traces.

With high-fold data, the mute zone problem is handled to a degree by limiting the correlation to small
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0381.jpg?height=482&width=406&top_left_y=127&top_left_x=82)

FIG. 3.3-38. CMP-stacked section associated with the synthetic data set as in Figure 3.3-19. In addition to the surfaceconsistent shot and receiver statics and the subsurfaceconsistent structure term, residual moveout shifts were introduced to the CMP gathers used in Figure 3.3-19.

offsets. In this particular part of the profile, a large window including both the mute zone and deep data ( 800 to $2300 \mathrm{~ms}$ ), a deep window ( 1700 to $2300 \mathrm{~ms}$ ), a deep large window ( 1400 to $2800 \mathrm{~ms}$ ), or a deep narrow window (1500 to $1700 \mathrm{~ms}$ ) made no difference. This is probably because of the good signal-to-noise ratio in this part of the profile.

These observations are verified by the diagnostics based on the CSP and CRP stacks in Figures 3.3-30 and 3.3-31. Ungained stack responses are shown in Figure 3.3-32. In particular, note the relatively poor stack response using a window confined to the mute zone (4nn) to $1200 \mathrm{~ms}$ ).

The choice of the correlation window is more critical in conditions of poor signal-to-noise ratio. Refer to the same diagnostics for the left half of the stacked section in Figure 3.3-5. These diagnostics are shown in Figures 3.3-33 through 3.3-36. Again, a correlation window confined to the mute zone not only provides an inadequate solution, as in the previous case (Figure 3.3-29), but also can be devastating, as shown in Figure 3.3-33. In this case, the CMP gathers with no corrections have better signal quality. It now is apparent that a narrow window, even if it is outside the mute zone (such as
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0381.jpg?height=502&width=418&top_left_y=124&top_left_x=536)

FIG. 3.3-39. CMP-stacked section associated with the synthetic data set as in Figure 3.3-38 after the application of residual statics corrections. Compare the results with those in Figure 3.3-22.

the 1500 to $1700 \mathrm{~ms}$ window), may not provide suffcient statistics. The CSP stacks (Figure 3.3-34) and the CRP stacks (Figure 3.3-35) show the undesirable aspects of choosing a window within the mute zone or choosing a window that is too narrow. The ungained stacked sections (Figure 3.3-36) clearly demonstrate the adverse effects of an improper choice of correlation window. Moreover, note the poor quality pilot traces for each CMP gather in Figure 3.3-37 (to the left of midpoint 377). The shot and receiver static solutions shown in the graphs above the pilot traces are totally unreliable.

These test results suggest choosing a correlation window that (a) contains as much signal as possible to improve correlation values, and (b) is large enough and is outside the mute zone whenever possible.

## Other Considerations

The synthetic data set in Figure 3.3-38 is the same as that in Figure 3.3-19, with the addition of residual

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0382.jpg?height=375&width=775&top_left_y=216&top_left_x=127)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0382.jpg?height=367&width=775&top_left_y=655&top_left_x=127)

(b)

FIG. 3.3-40. First portion of a land line illustrating the improvement in CMP stacking as a result of residual statics corrections. Stack $A$ (a) before residual statios corrections and using preliminary velocity picks and (b) after two passes of residual statics corrections and using final velocity picks.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0383.jpg?height=373&width=733&top_left_y=217&top_left_x=148)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0383.jpg?height=376&width=733&top_left_y=648&top_left_x=148)

(b)

FIG. 3.3-41. Second portion of the land line shown in Figure 3.3-40 illustrating the improvement in CMP stacking as a result of residual statics corrections. Stack $B$ (a) before residual statics corrections and using preliminary velocity picks and (b) after two passes of residual statics corrections and using final velocity picks.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0384.jpg?height=396&width=436&top_left_y=136&top_left_x=73)

FIG. 3.3-42. Diagnostics for segment $A$ from the residual statics corrections applied on the first portion of the land line in Figure 3 3-40.

moveout shifts. Residual moveout was introduced into the data by inverse NMO correcting the CMP gathers associated with the stack in Figure 3.3-19 using a velocity function $v_{1}(t)$, then by NMO correcting using a velocity function $v_{2}(t) \neq v_{1}(t)$. The solution (Figure 3.3-39) implies some traveltime distortion at the edges of the stacked section caused by low fold of coverage. (Compare this with the solution in Figure 3.3-22). Otherwise, stack response seems to be satisfactory. As long as the residual moveout variations are not large within the correlation window, the computed residual statics solution should be adequate. Use of more than one small correlation window during the picking phase may help minimize the time-dependent effect of residual moveout.

In some areas, the signal-to-noise ratio is so poor that a second pass of residual statics corrections must be done. The idea is that the first pass of residual statics corrections improves the signal to such a degree that a second pass should remove the residuals remaining from the first pass. For the second pass, the steps in Figure 3.3-12 must be repeated, such that the input are CMP gathers that already were corrected for residual statics. Velocity estimates must be revised between passes. Figures 3.3-40 and 3.3-41 show two different segments of a section before and after residual statics corrections that were done in two passes. Diagnostic plots of the shot and receiver statics shown in Figures 3.3-42 and 3.3-43 indicate that the first pass has taken out a significant part of the static shifts in the first segment. On

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0384.jpg?height=85&width=384&top_left_y=135&top_left_x=558)

Recaiver Statica (FIrst Pasa)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0384.jpg?height=67&width=382&top_left_y=263&top_left_x=558)

Shot Statics (Second Pater)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0384.jpg?height=31&width=379&top_left_y=380&top_left_x=559)

Recalver Statles (Second Pasa)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0384.jpg?height=75&width=382&top_left_y=473&top_left_x=558)

FIG. 3.3-43. Diagnostics for segment $B$ from the residual statics corrections applied on the second portion of the land profile in Figure 3.3-41.

the other hand, the second pass was most effective in the second segment, where the signal-to-noise ratio is relatively poorer. Repeated estimation and application of the residual statics and velocity estimation is common in some processing systems. Use of a large number of trace correlations and multiple correlation peaks in a statics program tends to minimize the number of passes required.

## Stack-Power Maximization in Practice

The method of stack-power maximization can yield better stack compared to the method of traveltime decomposition in areas with poor signal-to-noise ratio. Figure 3.3-44 shows a CMP-stacked section along a land profile with field statics corrections applied (Figure 3.3-45). While the left-half of the section has a good signal-tonoise ratio, the right-half has a poor signal-to-noise ratio resulting from irregular topography and near-surface complexity (Figure 3.3-45). Note, for instance, the loss of continuity along the reflection events at 0.8 and 1.3 $s$ at the right-half of the section.

Selected CMP gathers shown in Figure 3.3-46 verify the presence of short-wavelength statics. Following residual statics corrections by stack-power maximization and the subsequent velocity analysis, the same

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0385.jpg?height=1061&width=683&top_left_y=157&top_left_x=165)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0386.jpg?height=770&width=454&top_left_y=280&top_left_x=285)

FIG. 3.3-45. The elevation profile (top), and the shot (middle) and receiver (bottom) field statics profiles for the stacked section shown in Figure 3.3-44.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0387.jpg?height=1017&width=685&top_left_y=178&top_left_x=123)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0387.jpg?height=877&width=62&top_left_y=252&top_left_x=835)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0388.jpg?height=1069&width=689&top_left_y=168&top_left_x=169)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0389.jpg?height=586&width=438&top_left_y=132&top_left_x=294)

FIG. 3.3-48. Shot (top) and receiver (bottom) residue] static shifts computed by stack-power maxmization. The resuiting CMP-stacked section is shown in Figure 3 3-47.

gathers indicate that short-wavelength statics have been targely resolved (Figure $3.3-46$ ), and thus, the resulting CMP stack shows significant improvement in the continuity of reflections in the right-hand side (Figure 3.3-47). The shot and receiver residual static shifts derived by using the supertrace scheme described above are shown in Figure 3.3-48. Note that mainly large residuals are in the right-half of the profile with irregular topography.

### 3.4 REFRACTION STATICS CORRECTIONS

An important question in estimating shot and receiver statics is accuracy of the results as a function of wavelengths of static anomalies. Figure $3.4-1$ is a synthetic data set that is identical to that in Figure 3.3-19, except for additional long-wavelength shot and receiver static components. (Compare the graphic displays in
Figures 3.3-19 and 3.4-1.) From the solution in Figure 3.4-2, note that the long-wavelength components of the statics were severely underestimated. A significant difference between the stacked sections, in terms of horizon times, is apparent in Figures 3.3-22 and 3.4-2.

The surface-consistent solution discussed in Section 3.3 resolves the short-wavelength static shifts (less than a spread length), which cause traveltime distortions in CMP gathers, and thus yield an improved stack response. However, merely improving the stack response by correcting for short-wavelength statics may not always be sufficient. The unresolved long-wavelength components are assigned to the structure term in equation (3-25). If the long-wavelength components are large, refector geometries inferred by the CMP stack can be distorted significantly. Field statics and refraction statics methods are used to correct for the longwavelength components.

The statics corrections require knowledge of the near-surface model. The near-surface often consists of
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0390.jpg?height=474&width=394&top_left_y=136&top_left_x=92)

FIG. 3.4-1. CMP-stached section associated with the synthetic data set as in Figure 3.3-19 contaminated with longperiod statics.

a low-velocity weathering layer. However, there are exceptions to this simplified model for the near-surface. Areas covered with glacial tills, volcanic stringers, and sand dunes often have a near-surface that may consist of more than one leyer with different velocities. Layer boundaries can vary significantly from a flat interface to an arbitrarily irregular shape. The single-layer assumption for the near-surface also is violated when there is a lateral change in rock composition associated with outcrops, pinchouts or a flood plain along a seismic profile. In areas covered with a permafrost layer, which has a significantly higher velocity than the underlying layer, the surface-consistency assumption for the near-surface corrections is not valid. Moreover, the base of the permafrost layer does not form a head wave and therefore is not detectable.

In practice, a single-layer near-surface model often is sufficient for resolving long-wavelength statics anomalies. Complexities in a single-layer near-surface model can be due to one or more of the following:

(a) Rapid variations in shot and receiver station elevations,

(b) Lateral variations in weathering velocity, and

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0390.jpg?height=504&width=418&top_left_y=128&top_left_x=536)

FIG. 3.4-2. CMP-stacked section associated with the synthetic data set as in Figure 3.4-1 after the application of residual statics corrections. Compare the results with those in Figure 3.3-22.

(c) Lateral variations in the geometry of the refractor, which, for refraction statics, is defined as the interface between the weathering layer above and the bedrock below.

Near-surface velocity-depth models often are estimated using refracted arrivals. The refracted energy is associated with the head wave that travels along the interface between the near-surface weathering layer and the underlying bedrock. If refracted arrivals are observable on common-shot gathers, it almost certainly implies that the near-surface has a simple geometry. Nevertheless, no ray-theoretical method can claim to estimate short-wavelength variations in the base of weathering that are much smaller than a cable length. These variations are left to be handled by subsequent residual statics corrections using traveltime distortions associated with reflections on moveout-corrected commonmidpoint (CMP) gathers (Taner et al., 1974).

The head wave is distorted in the presence of irregularities along the base of the weathering layer, and it turns into a diving wave when there is no sharp velocity contrast between the weathering layer and the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0391.jpg?height=411&width=427&top_left_y=191&top_left_x=83)

FIG. 3.4-3. A shot record with distinct first breaks.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0391.jpg?height=334&width=437&top_left_y=858&top_left_x=74)

FIG. 3.4-4. A shot record with a distinct refraction event.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0391.jpg?height=765&width=417&top_left_y=284&top_left_x=547)

FIG. 3,4-5. A shot record with a shallow and deep refractíon event.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0392.jpg?height=770&width=417&top_left_y=235&top_left_x=80)

FIG. 3.4-6. A shot record with noise-contaminated first breaks.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0392.jpg?height=391&width=425&top_left_y=167&top_left_x=528)

FIG. 3.4-7. A shot record with a distinct refraction event along the right-hand spread.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0392.jpg?height=334&width=432&top_left_y=796&top_left_x=530)

FIG. 3.4-8. A vibrosels shot record with not-so-distunct first breaks.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0393.jpg?height=621&width=405&top_left_y=118&top_left_x=83)

FIG. 3,4-9. A shot record in which the onset of the first arrivals is not clear.

substratum (Hill and Wuenschel, 1985). Such cases, if at all possible, may be handled by wave-theoretical modeling and inversion (Hill, 1987) or turning-wave tomography (Section 9.5 ).

## First Breaks

The refracted energy associated with the base of the weathering layer often constitutes the first arrivals on a shot gather. The onset of these first arrivals is referred to as the first break.

First breaks occur in varying degrees of quality depending on the source type and the near-surface conditions. The common-shot gather shown in Figure 3.43 has first breaks with clear onset. Deviations from the linear trend of the first-break times may largely be attributed to elevation differences along the shot profile.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0393.jpg?height=220&width=414&top_left_y=127&top_left_x=539)

FIG. 3.4-10. A near-surface model for statics corrections when shots are situated below the weathering layer. Here, $S$ $=$ shot, $E_{S}=$ elevation at the shot station on the ground, $R=$ receiver, $E_{R}=$ elevation at the receiver station on the ground, $T=$ surface topography, $B=$ base of weathering, $D$ $=$ datum, $E_{D}=$ datum elevation, $v_{w}=$ weathering velocity, and $v_{b}=$ bedrock velocity.

Figure 3.4-4 shows a record with first breaks associated with a prominent refractor. In Figure 3.4-5, note a shallow and a deep refractor. Figure 3.4-6 shows a shot record in which automated procedures would largely fail to pick the first breaks. Figure 3.4-7 shows a shot record with first breaks that can be detected easily by automated procedures. From the first breaks on the left, one can infer near-surface irregularity either in the form of a variable refractor shape or velocity variations in the near-surface layer. The right-hand side shows the presence of a distinct refractor. Figure 3.4-8 shows a shot gather recorded with a vibroseis source, which often produces poor first breaks compared to a dynamite source. A similar situation exists in the record shown in Figure 3.4-9 it is not simple to detect the first breaks. The remainder of the sidelobes from sweep correlation masks the onset of the first arrivals.

First-break picking can be done automatically, interactively, manually, or as a combination thereof. To make reliable picks, first apply linear moveout (LMO) to the data. Once picking is done, the LMO correction is reversed. Note that effectiveness of both reflection- and refraction-based methods of statics corrections depends on the reliability of the picking process. Apart from the signal-to-noise ratio, indistinct first breaks (such as in vibroseis) sometimes can make picking consistent first breaks difficult.

The first-break picks associated with the refracted arrival times are then used in an inversion scheme to estimate the near-surface model parameters. In this section, we discuss ray-theoretical methods such as plusminus and its generalized form, the reciprocal method, and the least-squares inversion methods. The basic assumption made is that the refractor is flat or nearly
flat, with a smoothly varying shape along the seismic profile. As demonstrated by the field data examples, these methods appear to remove medium- to long-wavelength statics anomalies associated with various types of near-surface models. Combined with the reflection-based residual statics corrections to resolve any remaining short-wavelength statics variations that affect the stack quality, we get a final stacked section ready for poststack processing.

## Field Statics Corrections

It is appropriate now to review various methods of field statics corrections. Consider the near-surface model depicted in Figure 3.4-10. If shots (denoted by $S$ ) are located below the weathering layer, then the total static correction to apply to the trace associated with midpoint $M$ is $t_{D}=t_{S}+t_{R}$, where $t_{S}$ and $t_{R}$ are the shot and receiver static corrections, respectively, down to a specified datum $D$. From the geometry of Figure 3.4-10, the field statics correction $\Delta \tau_{D}$ can be computed by

$$
\Delta_{T D}=-\frac{E_{S}-E_{D}-D_{S}}{v_{b}}-\frac{E_{R}-E_{D}-D_{R}}{v_{b}}-t_{U H}
$$

where $E_{D}$ is the datum elevation and $E_{S}$ and $E_{R}$ are the surface elevations at the shot and receiver stations, respectively, $D_{S}$ is the depth of the shot hole beneath the shot station, and $D_{R}$ is the depth of the shot hole near the receiver station, $t_{U H}$ is the uphole time measured at the receiver location (the time associated with the distance $D_{R}$ in Figure 3.4-3). Finally, $v_{b}$ is the bedrock (subweathering) velocity that may be derived from a deep uphole survey (to a point well below the weathering layer) conducted in the area.

An uphole survey involves placing shots down the hole at various depth levels, then recording the arrivals at the surface near the hole. Alternatively, shots and receivers can be reciprocated if there is a caving problem down the hole. The hole must be deep enough to reach below the weathering layer. This provides a plot of time versus depth from which the bedrock velocity is obtained.

In land surveys, shots are not always placed in the bedrock for economic reasons, especially in areas with a thick weathering layer. Also, impulsive sources are not always used. Instead, surface sources such as vibroseis often are used. When surface sources or sources in shallow holes are used, the refracted arrivals can, at least in theory, be used to compute the static correction $\Delta \tau_{D}$ down to a specified datum.

## Flat Refractor

Consider the refraction wavefront and raypath geometry in Figure 3.4-11a associated with a single-layer nearsurface model. On top, we see a plot of first-breaks. For simplicity, consider a flat surface and tat refractor. For the head wave to form, and thus the refraction to occur, the requirement is that the overburden velocity $\nu_{w}$ be smaller than the substratum velocity $w_{b}$.

The traveltime profile depicts the first breaks seen on the shot record in Figure 3.4-11b. Note that to the left of the crossover offset $x_{c}$ (glso known as critical distance) are the first breaks associated with the the direct arrivals. Also note that to the right of offset $x_{c}$ are the first breaks associated with the refracted arrivals. From the refraction theory (Dobrin, 1960; Grant and West, 1965), the inverse of the slope of the line associated with the refracted wave arrivals is equal to the bedrock velocity $v_{b}$. Also note that the inverse of the slope of the line associated with the direct wave arrivals is equal to the velocity of the weathering layer $v_{w}$.

By picking the first breaks, the weathering and bedrock velocities, $v_{w}$ and $v_{b}$ are estimated. By extending the line associated with the refracted arrivals to zero-offset, intercept time $t_{3}$, the time at $x=0$, is estimated. From these three parameters, it is easy to show that depth to the bedrock $z_{w}$ is given by

$$
z_{w}=\frac{v_{b} v_{w} t_{2}}{2 \sqrt{v_{b}^{2}-v_{w}^{2}}}
$$

We assume that $v_{b}>v_{w}$. Derivation of this formula is left to Section C.5.

Alternatively, we can measure the critical distance corresponding to the change from the direct arrival to the refracted arrival on the traveltime plot and use it in computing the depth to the bedrock. Equation (3-41a), in terms of the critical distance $x_{c}$, takes the form

$$
z_{w}=\frac{1}{2} \sqrt{\frac{v_{b}-v_{w}}{v_{b}+v_{w}}} x_{c}
$$

It may not be easy to measure the critical distance when depth to bedrock is small. In such cases, it is better to use the intercept time to compute the depth to the bedrock by way of equation (3-41a).

After computing $z_{w}$, the total static correction $\Delta \tau_{D}$ to the specified datum level can be applied by

$$
\Delta \tau_{D}=-\frac{2 z_{w}}{v_{w}}+\frac{2\left(E_{D}-E_{S}+z_{w}\right)}{v_{b}}
$$

where $E_{S}$ is the surface elevation. If there is a difference between the elevations of shot and receiver stations,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0395.jpg?height=777&width=439&top_left_y=130&top_left_x=81)

b
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0395.jpg?height=718&width=416&top_left_y=200&top_left_x=548)

d

FIG. 3.4-11. (a) Geometry for refracted arrivals. Here, $v_{w}=$ weathering velocity, $v_{b}=$ bedrock velocity, $z_{w}=$ depth to the refractor equivalent to the base of the weathering layer, $\theta_{c}=$ critical angle, and $x_{c}=$ crossover distance. The direct wave arrival has a slope equal to $1 / v_{w}$ and the refracted wave arrival has a slope equal to $1 / v_{b}$. (b) A shot record that exhibits the direct wave and the refracted wave depicted in (a). (c) Geometry for a dipping refractor with forward traveltime profile associated with the direct wave and refracted wave arrivals, and (d) with both forward and reverse traveltime profiles. See text for details.
then an additional elevation correction using the bedrock velocity is required. Moreover, if the shots are located in boreholes, then the measured uphole time also rust be incorporated into equation (3-42). The estimated statics correction given by equation (3-42) is an average value over a distance that can range from the critical distance to the spread length, depending on the number of traces used in estimating the bedrock velocity. Nevertheless, more than one shot-point is within a sprear length. Therefore, an adequate definition of the near-surface model can be achieved and datum corrections can be computed for the entire profile.

## Dipping Refractor

When the refractot is dipping, it turns out that the inverse slope of the refracted arrival is no longer equal to the bedrock velocity (Figure 3.4-11c). An extra parameter - the dip of the refractor, needs to be estimated (Section C.6). This requires reverse profiling as illustrated in Figure 3.4-11d. We have the refracted arrival in the forward direction and the refracted arrival in the reverse direction obtained by interchanging the shots with receivers. The traveltimes for the refracted arrivals of the forward and reverse profiles are expressed as

$$
t^{-}=t_{t}^{-}+\frac{x}{v_{b}^{-}}
$$

and

$$
t^{+}=t_{a}^{+}+\frac{x}{v_{b}^{+}}
$$

The inverse slopes are given by

$$
v_{b}^{-}=\frac{v_{w}}{\sin \left(\theta_{c}+\varphi\right)}
$$

and

$$
v_{b}^{+}=\frac{v_{w}}{\sin \left(\theta_{c}-\varphi\right)}
$$

where $\varphi$ is the refractor dip and $\theta_{c}$ is the critical angle of refraction given by

$$
\sin \theta_{c}=\frac{v_{u}}{v_{b}}
$$

Finally, the intercept times are given by the following relations:

$$
t_{i}^{-}=\frac{2 z_{w S} \cos \theta_{c} \cos \varphi}{v_{w}}
$$

and

$$
t_{\imath}^{+}=\frac{2 z_{w R} \cos \theta_{\mathrm{c}} \cos \varphi}{v_{w}}
$$

Derivation of the relations $(3-44 \mathrm{a}, \mathrm{b})$ and $(3-45 \mathrm{a}, \mathrm{b})$ are left to Section C.6.
To estimate the thickness of the near-surface layer, first we compute the refractor dip $\varphi$ from the slope measurements $-v_{w}, v_{b}^{-}$, and $v_{b}^{+}$. These measurconts are then inserted into the expression

$$
\varphi=\frac{1}{2}\left[\sin ^{-1} \frac{v_{w}}{v_{b}^{-}}-\sin ^{-1} \frac{v_{w}}{v_{b}^{+}}\right]
$$

Then, we compute the bedrock velocity $v_{b}$ using the expression

$$
v_{b}=\frac{2 \cos \varphi}{\left(\frac{1}{v_{b}^{-}}+\frac{1}{v_{b}^{+}}\right)}
$$

Finally, we compute the depth to the bedrock at shot/receiver stations

$$
z_{w}=\frac{v_{b} v_{u} t_{t}^{-}}{2 \cos \varphi \sqrt{v_{b}^{2}-v_{w}^{2}}}
$$

Again, equations ( $346 a, b, c$ ) are derived in Section C.6. By setting the refractor dip $\varphi=0$, equation (3-46c) reduces to equation (3-41a).

Keep in mind that, whether it is the flat refractor (equation 3-41a) or dipping refractor case (equation 346c), the depth to bedrock estimation at a shot-receiver station requires the knowledge of weathering velocity, bedrock velocity and intercept time. In the case of a flat refractor, these can be measured directly from shot profiles; whereas, in the case of a dipping refractor, they can be computed by way of equations (3-46a.b,c).

## The Plus-Minus Method

It often is difficult to usc first breaks to estimate the intercept time and velocitics for the weathering layer and bedrock. This is prinarily because the base of weathering typically is an undulating surface, which makes traveltime plots difficult to interpret. Traveltime plots also are affected by severe elevation changes. Additionally, a typical field cable layout does not provide a sufficient number of channeis inside the crossover distance $x_{c}$ (Figure 3.4-11a) for a reliable estimate of the weathering velocity or thickness. In most cases, $v_{w}$ cannot be measured and a reasonable value is assumed for it.

Hagedoorn (1959) formulated a method to indirectly estimate intercept time and bedrock velocity. The method still requires picking the first breaks. However, it does not require interpreting the traveltime profile (Figure 3.4-11a). (Interpretation means drawing the linear segments for the direct and refracted waves.) Fig12re 3.4-12a shows three raypaths associated with shotreceiver pairs $A D, D G$, and $A G$. The basis of Hagedoorn's method involves computing two time values, the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0397.jpg?height=724&width=834&top_left_y=126&top_left_x=101)

FIG. 3.4-12. (a) Geometry for the plus-minus mothod, (b) Geometry for the generalized reciprocal method. Here, $z_{w}$ is the depth to the refractor at the surface station where the plus-minus times as for (a) and intercept times as for (b) are to be estimated, $v_{w}$ is the weathering velocity, and $\theta_{c}$ is the critical angle of refraction.

plus and minus times given by

$$
t_{+}=t_{A B C D}+t_{D E F G}-t_{A B F G} \quad(3-47 a)
$$

and

$$
t_{-}=t_{A B C D}-t_{D E F G}+t_{A B F G} . \quad(3-47 b)
$$

The times given on the right side of these equations are the measured (picked) values from the first breaks for the three raypaths shown in Figure 3.4-12a. From the raypath configuration, we find that (Section C.7)

$$
t_{+}=\frac{2 z_{w} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}
$$

Rewrite equation (3-41a)

$$
t_{1}=\frac{2 z_{w} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}
$$

and note that the plus time $t_{+}$in equation (3-48a) is identical to the intercept time $t_{1}$ in equation (3-48b). Hence, instead of measuring $t_{1}$ directly from the shot record, Hagedoorn's method suggests estimating $t_{2}$ from the first break picks given by the right-hand terms in equation $(3-47 \mathrm{a})$.

By applying algebra (Scetion C.7), we find that minus time $t_{-}$is rolated to bedrock velocity $v_{b}$ by

$$
t_{-}=t_{+}+\frac{2 x}{v_{b}}
$$

where $x$ is the source-receiver separation $A D$.

Thus, Hagedoorn's plus-menus method involves:

(a) Picking the first breaks,

(b) Computing the plus-minus times, $t_{-}$and $t_{+}$(equations $3-47 \mathrm{a}$ and $3-47 \mathrm{~b}$ ),

(c) Deriving from the plus-minus times the intercept time $t_{3}$ (equations 3-48a and 3-48b) and bedrock velocity $v_{b}$ (equation $3-48 \mathrm{c}$ ),

(d) Assuming a value for weathering velocity $v_{\boldsymbol{w}}$,

(e) Computing the depth $z_{D}$ to bedrock below station $D$ (Figure 3.4-12a) from equation (3-41a), and

(f) Computing the shot-receiver static shift $\Delta \tau_{D}$ at that station by

$$
\Delta_{D}=-\frac{z_{D}}{v_{w}}+\frac{E_{D}-E_{S}+z_{D}}{v_{b}}
$$

where $E_{S}$ and $E_{D}$ are the surface and datum elevations at station $D$ (Figure 3.4-12a). If there is a shot at station $D, \Delta \tau_{D}$ represents the shot static, and if there is a receiver at station $D$, it represents the receiver static. Again, uphole and elevation corrections are needed before making the plus-minus statics corrections.

## The Generalized Reciprocal Method

In practice, raypaths that are suitable for first-break picking and are coincident at station $D$ are not always found. Palmer (1981) generalized Hagedoorn's method of using raypaths (Figure 3.4-12b). Palmer's technique, the generalized reciprocal method (GRM), takes into account offset separation $D_{1} D_{2}$ when computing the plus time

$$
t_{+}=t_{A B C D_{2}}+t_{D_{1} E F G}-t_{A B F G}-\frac{D_{1} D_{2}}{v_{b}} \cdot(3-50 a)
$$

The definition of the minus time remains the same as in equation (3-47b), except for accounting for the raypath geometry in Figure (3.4-12b):

$$
t_{-}=t_{A B C D_{2}}-t_{D_{1} E F G}+t_{A B F G}
$$

Note that more than one combination of raypaths associated with different separations of $D_{1} D_{2}$ can be used to measure (pick) the traveltimes on the right sides of equations ( $3-50 a, b)$. Consequently, there is more than one estimate of the plus-minus times at a given (shotreceiver) station $D$. By carefully editing the first breaks, these estimates can be refined and reduced to a single estimate for each station.
To derive the near-surface model, the generalized reciprocal method uses the observed traveltimes from refracted arrivals that are assumed to be associated with the base of weathering. A problem arises when a nearsurface model with more than one layer needs to be defined. This is the case in areas covered with glacial tills and sand dunes. Several specialized techniques based on generalized linear inversion (GLI) have been devised for these problems (Hampson and Russell, 1984; Schneider and $\mathrm{Kuo}, 1985$ ). The GLI technique is an iterative, model-based approach that provides flexibility in defining a near-surface moded consisting of arbitrarily parameterized multilayers. The process begins by computing the refracted arrival times from an assumed initial near-surface model. These computed traveltimes then are compared with the actual first-break picks (observed traveltimes). The procedure tries to minimize the difference between the computed and observed traveltimes by iteratively modifying model parameters for the near surface (such as velocities and thicknesses). A GLI method applicable to a single-layer near-surface model is presented next.

## The Least-Squares Method

We want to estimate the near-surface parameters weathering and bedrock velocities and thickness of the weathering layer at shot-receiver locations by leastsquares inversion of the observed (picked) refracted arrivals. Formulation of this problem using the leastsquares inversion leads to an estimate of the nearsurface parameters such that the difference between the observed arrivals and the modeled refracted arrivals is minimum in the least-squares sense. This method is not only applicable to 2 -D line shooting but also to 3-D swath shooting geometries.

There are several ways to paranteterize the nearsurface layer. The most general formulation would include varying weathering and bedrock velocities and the thickness of the weathering layer at all shot-receiver stations. This, however, would require lincarizing the problem and iterating over the estimated parameters. The problem also would have to be constrained to stabilize the inversion. In a simplified version of this general formulation, weathering velocity may be fixed and assumed to be known. This leaves the weathering thickness and bedrock velocity as spatially varying parameters.

As for any inversion problem, we shall need a model equation that relates the model parameters we want to estimate to the modeled refracted arrival times. Refer to the sketch of a near-surface model in Figure 3.4-13. If we let the weathering thickness vary as might be the case
in many field data applications, then we have a problem of not being able to write down an analytic expression for the refracted raypath. We would not even begin to anticipate how the head wave would behave or develop in case of a laterally varying refractor geometry.

Instead, to be able to make use of the first-break picks, we shall take a simpler approach. We want to describe the near-surface with minimal parameterization and consider the model with a flat refractor. Now, we can express the modeled traveltime $t_{2 j}^{\prime}$ for the critically refracted raypath from the source location $S_{3}$ to the receiver location $R_{\tau}$ (Figure 3.4-13) as

$$
t_{i j}^{\prime}=\frac{S_{3} B}{v_{1 v}}+\frac{D E-D B-C E}{v_{b}}+\frac{C R_{2}}{v_{w}}
$$

Keep in mind that we had to make the same assumption - that the refractor is flat or nearly-flat within the spread length, as in the generalized reciprocal method. The first and the third terms in equation (3-51a) are associated with the raypaths within the weathering layer, and the second term is associated with the raypath within the bedrock along the refractor. When the refractor dip is taken into account, the problem cannot be readily linearized.

By regrouping the terms in equation (351a), we get the expression

$$
t_{v_{2}}^{\prime}=\left(\frac{S, B}{v_{\mathrm{w}}}-\frac{D B}{v_{\mathrm{b}}}\right)+\left(\frac{C R_{\mathrm{t}}}{v_{\mathrm{u} 1}}-\frac{C E}{v_{b}}\right)+\frac{D E}{v_{b}} .
$$

Finally, rewriting in terms of the model parameters that we want to estimate $-v_{w}, v_{b}$, and $z_{w}$, we obtain the expression for the model equation for the refracted $a r-$ rivals:

$$
t_{t j}^{\prime}=\frac{z_{j} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}+\frac{z_{i} \sqrt{1 j_{b}^{2}}-v_{w}^{2}}{v_{b} v_{w}}+\frac{x_{z j}}{v_{b}}, \quad(3-51 c)
$$

In addition to assuming a flat refractor, we fix the bedrock velocity $v_{b}$ but retain it as a parameter to be estimated. We also assume that $v_{s}$ is known. Under these assumptions, the model cquation (3-51c) for the refracted arrivals can be written in the form (Farrell and Euwema, 1984)

$$
t_{i j}^{\prime}=T_{3}+T_{2}+s_{b} x_{i j},
$$

where $s_{b}=1 / v_{b}$ is the bedrock slowness, and

$$
\begin{aligned}
& T_{3}= \frac{z_{3} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}, \\
& T_{2}=\frac{z_{2} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}
\end{aligned}
$$

By comparing equations (3-53a,b) with equation (3-48b), note that $T$, and $T_{2}$ actually are (half) intercept

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0399.jpg?height=277&width=428&top_left_y=126&top_left_x=536)

FIG, 3.4-13. Geometry of refracted arrival used in deriving the least-squares solution for intercept times. Here, $S_{3}$ and $R_{2}$ are source end receiver stations, respectively; $\theta_{c}$ is the critical angle of refraction, $z_{j}$ and $z_{2}$ are depths to the bedrock at source and receiver locations, and $v_{t}$ and $v_{b}$ are weathering and bedrock velocities, respectively.

time values at the shot and receiver locations. Hence, for $n$ shot-receiver stations, the parameter vector contains $\left(T_{1}, T_{2}, \ldots, T_{n}: s_{b}\right)$.

Equation (3-52), which models refracted arrivals, is solved for the parameter vector in the same manner using the generalized linear inversion (GLI) theory (Section C.8) as for equation (3-25), which models traveltime deviations associated with residual statics (Section C.4). The generalized linear inversion solution is based on the objective of minimizing the least-squares difference between the observed refracted arrival times $t_{2 j}$ and the modeled times $t_{i j}^{\prime}$ defined by equation (3-52). Alternatively, the refraction statics solution can be obtained by using the minimization criterion that is based on the $L_{1}$ norm (Section C.10).

An extension of equation (3-52) to represent the refraction statics associated with each shot and receiver location in two parts - long- and short-wavelength components, is proposed by Taner et al. (1998). This is done by including two more terms in equation (352) to represent the shot and receiver short-wavelength variations in refraction statics caused by rapid changes in elevation and near-surface layer geometry. The conjecture for such an extension is to stabilize the longwavelength solution derived from equation (3-52). Albeit the extension includes short-wavelength terms for shots and receivers, you still would need to estimate residual staties and apply them to your data (equation 3-25).

Equation (3-52) describes a variable-thickness scheme since the weathering velocity is assumed to be
constant. Note that the traveltime model equation (352) suffers from uncertainty in the value for the weathering layer velocity, as was the case for the generalized reciprocal method. The estinated refractor shape using the variable-thickness scheme (whether it is based on the the generalized reciprocal or least-squares method) does not yield the true refractor shape. Instead, the uncertainty in weathering velocity significantly influences the implied refractor shape. Perhaps, uphole information can be used to calibrate the estimated thicknesses and thus an acceptable weathering velocity can be chosen accordingly.

Once the parameter vector is estimated, then the thickness of the weathering layer below shot and receiver locations can be computed using the expressions for the intercept time values (equations 3-53a,b).

Because equation (3-52) does not contain a structure term, any long-wavelength static anomaly is partitioned between the other terms. This is not the case for the reflection-based residual statics model that is based on equation (3-25). Thus, following the field statics corrections (to account for elevation changes), statics corrections are estimated and applied in two stages:

(a) Refraction-based statics corrections to remove long-wavelength anomalies, and

(b) Reflection-based residual statics corrections to remove any remaining short-wavelength static shifts.

Both the generalized reciprocal and least-squares methods are based on computing intercept time anomalies at shot-receiver stations. The generalized recipro$\mathrm{cal}$ method yjelds multi-valued intercept times for each shot-receiver station, which need to be reduced to a single-valued intercept time profile along the line before computing the shot-receiver statics. On the other hand, the least-squares method yields a unique intercept time value for each shot-receiver station based on the least-squares minimization.

The generalized reciprocal method requires a special combination of raypaths essociated with the traveltime picks that correspond to the terms in equations $(3-50 a, b)$ in estimating intercept times. These raypaths are not always attainable by $3-D$ swath shooting, and therefore, the generalized reciprocal method is most suitable for 2-D seismic profiles. On the other hand, the least-squares method yjelds intercept times for arbitrary shot-recelver locations associated with 2 -D or 3-D recording geometries. The important point to kecp in mind, however, is that neither method yields the true physical parameters for the near-surface - the variablethickness solution depends on the assumed value for the weathering velocity. However, with extra information such as from upholes, these solutions may be calibrated.

## Processing Sequence for Statics Corrections

It is important that we revisit the processing sequence in Figure 3.3-12 and the near-surface model depicted in Figure 3.4-10 for a rigorous description of moveout and statics corrections. Starting with unprocessed field records, a dctailed version of the processing sequence in Figure 3.3-12 is described below:

(a) Pick and edit first breaks from unprocessed field records.

(b) Assume or derive from uphole information a value for weathering velocity.

(c) For a downhole source, apply the uphole correction.

(d) Compute the bedrock velocity and intercept times at all shot and receiver stations using a refraction statics method, such as the generalized reciprocal or the least-squares technique.

(e) By using the weathering velocity, bedrock velocity and intercept times, compute the depth to bedrock at shot-receiver stations (equations 3-53a,b).

(f) Apply the shot and receiver statics to replace the weathering layer with the bedrock while placing the shot and receivers on a floating datum that corresponds to a smoothed form of the topographic surface. The static time shift $\Delta \tau_{2 j}$ to apply for a given source-receiver pair is (Figure 3.4-10)

$$
\begin{aligned}
\Delta \tau_{3} & =\left(z_{3}+z_{i}\right)\left(\frac{1}{v_{b}}-\frac{1}{v_{w}}\right) \\
& -\frac{1}{v_{b}}\left(E_{T,}-E_{F D_{j}}+E_{T_{3}}-E_{F D_{i}}\right),
\end{aligned}
$$

where $z_{3}$ and $z_{2}$ are the thickncss of the weathering layer at shot and receiver stations, $E_{T}$, and $E_{T 3}$ are the true shot and receiver elevations referenced to the topography, and $E_{F D_{3}}$ and $E_{F D_{i}}$ are the shot and receiver elevations referenced to the floating datum, respectivcly. The reason for moving the shots and receivers to a floating daturn close to the surface topography, rather than to a flat datum, is to be able to preserve the hyperbolicity of reflection times while placing the shot and receiver pairs associated with a CMP gather over the local datum level that is nearly flat within the spread length.

(g) Apply geometric spreading correction and deconvolution to shot records and sort to CMP gathers.

(h) Perform preliminary velocity analysis and apply moveout corrections.

(i) Apply datum corrections to move the shots and receivers from the floating datum as specified in step (f) to a flat datum $E_{D}$ to which the CMP stack
is referenced. Refer to Figure 3.4-10 and note that the datum correction $\Delta \tau_{\imath,}$ for a source-receiver pair is given by

$$
\Delta \tau_{\imath j}=\frac{2 E_{D}-\left(E_{F D_{3}}+E_{F D_{2}}\right)}{v_{b}}
$$

where $E_{F D}$, and $E_{F D t}$ are the shot and receiver elevations with respect to the floating datum specified in step (f)

(j) Estimate surface-consistent shot and residual static shifts using methods described in Section 3.3.

(k) Apply residual statics corrections to CMP gathers from step (i).

(1) Apply the inverse of step (i) to move the shots and receivers from the flat reference datum back to the floating datum.

(m) Apply inverse moveout correction using velocities from step (h).

(n) Perform velocity analysis and apply moveout correction.

(0) Apply datum corrections to move the shots and recejvers from the foating datum to the reference flat datum as in step (i).

(p) Apply mute and stack the data. The stacked section is referenced to the flat datum level $E_{D}$ specified in step (i).

## Model Experiments

We shall analyze the problem of near-surface model estimation using two sets of synthetic data. The near-surface model for the first data set comprises a single layer with an undulating refractor and a flat topography. The near-surface model for the second data set comprises multiple layers below an irregular topography. We shall examine the extent of resolving the long- and short-wavelength anonalies by way of the refraction and residual statics correction methods described in Sections 3.3 and 3.4.

Figure 3.4-14a shows an earth model that comprises a simple subsurface velocity-depth model and a near-surface model that comprises a single layer with an undulating refractor but flat surface topography. The refractor geometry has wavelength variations that range from short wavelengths that are less than a cable length to long wavelengths greater than a cable length. The weathering velocity is $1200 \mathrm{~m} / \mathrm{s}$ and the refractor velocity is $2000 \mathrm{~m} / \mathrm{s}$.

Figure 3.4-14b shows the zero-ofset section derived from the earth model in Figure 3.4-14a. Note the traveltime distortions associated with the flat refectors. Also, in this section we see the multiples from the refractor and the peglegs from reflector 1 . The zero-offset section is appropriately aligned with respect to the velocity-dept hodel in the lateral direction. The objective in this model experiment is, following the application of refaction and residual statics corrections, to obtain a stack response similar to this zero-offset section.

A two-way acoustic wave equation was used to model a total of 154 shot records along the line. Both shot and receiver group intervals are $50 \mathrm{~m}$, and the number of channels is 97 , including the zero-offsct trace. The split-spread recording geometry has a maximum offset of $2350 \mathrm{~m}$. Selected shot records shown in Figure 3.4-15 from the synthetic data set associated with the earth model exhibit traveltime distortions on the reflection events caused by the undulating refractor. Note also the distinct refracted arrivals and the ground-roll energy.

Figure 3.4-16a shows the CMP-stacked section with no statics corrections. Compare with the zero-offset section (Figure 3.4-14b) and note some differences. As a result of velocity discrimination, multiples have been attenuated to some extent by CMP stacking. Both the CMP-stacked and zero-offset sections have the imprint of the near-surface effects on reflection times, Note that CMP stacking has given rise to the spurious structural discontinuities on reflections below $1 \mathrm{~s}$ between CMP 100-200. Following residual statics corrections (Figure 3.4-16b), these short-wavelength anomalies appear to have been resolved. The moderate-to-long wavelength anomalies expressed by the reflection traveltime undulations, however, have remained in the section. These anomalies have been resolved by refraction statics corrections as shown in Figure 3.4-17a using, in this case, the generalized linear inverse (GLI) method to solve equation (3-52). Nevertheless, some residual anonalies still remain. After residual statics corrections based on the solution to equation (3-25), the remaining longwavelength anomalies are untouched, while the residual short-wavelength anomalies have been further resolved. Unfortunately, not all of the traveltime distortions due to the near-surface layer (the undulating refractor $R$ in Figure 3.4-14a) have been eliminated. Note, for instance, the slight undulations in Figure 3.4-17b on events at 0.5 and $1 \mathrm{~s}$ which correspond to horizons 1 and 2 in Figure 3.4-14a. Note also in Figure 3.4-17b the distorted structural high represented by the reflection between 1-1.5 s, which corresponds to horizon 3 in Figure 3.4-14a, and the sagging refection below 1.5 s, which corresponds to horizon 4 in Figure 3.4-14a.

The results of the GLI statics estimates are summarized in Figure 3.4-18. For the variable-thickness estimate (cquation 3-52), the weathering velocity was
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0402.jpg?height=858&width=866&top_left_y=227&top_left_x=80)

FIG. 3.4-14. (a) A velocity-depth model with a near-surface refractor ( $R$ ) and smple subsurface structure; (b) the corresponding zero-offset section with trace spacing of $50 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0403.jpg?height=1050&width=432&top_left_y=131&top_left_x=302)

FIG. 3.4-15. Selected shot records from the synthetic data set associated with the earth model in Figc on top of each record indicate the CMP location in the vicinity of the shot.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0404.jpg?height=486&width=614&top_left_y=125&top_left_x=210)

FIG. 3.4-16. CMP stack essociated with the model dats in Figure 3.4-14: (a) with no statics corrections, (b) section as in (a) after residual statics corrections. Datum level is $0 \mathrm{~m}$ in both sections.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0404.jpg?height=478&width=616&top_left_y=666&top_left_x=208)

FIG. 3.4-17. CMP stack associated with the model data in Figure 3.4-14 (a) with refraction statios corrections using the GLI solution, (b) section as in (a) after residual statics corrections. Datum level is $0 \mathrm{~m}$ in both sections, and the weathering velocity is assumed to be $1200 \mathrm{~m} / \mathrm{s}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0405.jpg?height=564&width=488&top_left_y=122&top_left_x=274)

FIG. 3.4-18. Surnmary of the variable-thickness GLI solution for refraction statics associated with the CMP stacked section in Figure 3.4-17a. See text for details. Plot direction is the same as that in Figure 3.4-17. Except in frame 1, shot attributes are denoted with $\times$ and receiver attributes are denoted with vertical bars. Estimated parameters from equation (C-54) are plotted in frame 1 with no distinction made between shot and receiver locations.

set to $1200 \mathrm{~m} / \mathrm{s}$ the correct velocity for the nearsurface layer. Frame 1 shows the estimated GLI parameters the intercept time anomalies (equations 3 $53 \mathrm{a}, \mathrm{b}$ ), as a function of the shot-receiver station number. Frame 2 shows the pick fold, namely the number of picks in each shot (dennted by $x$ ) and receiver (denoted by the vertical bars) gather. Note the tapering of the pick fold at both ends of the line.

A quantitative measure of the accuracy of the GLI solution to refraction statics is the sum of the differences between the observed picks $t_{i j}$ and the modeled traveltimes $t_{i j}^{\prime}$ (equation 3-52) over each shot and receiver gather. These rexidual time differences are plotted in frame 3 of Figure 3.4-18. Large residuals often are related to bad picks. Nevertheless, even with good picks, there may be large residuals attributable to inappropriateness of the model assumed for the near-surface.

Figure 3.4-18 also shows the estimated weathering thicknesses at all shot-receiver stations (frame 4). Fj- nally, the computed statics and the near-surface model are shown in frames 5 and 6 , respectively.

Uncertainty in the assumed value for weathering velocity is an important practical consideration in refraction statics. Figure 3.4-19 shows results of GLI statics solution using two different weathering velocities. Compare with the result using the correct weathering velocity (Figure 3.4-17a) and note that the GLI solution tolerates reasonable departures from the correct weathering velocity,

The ability of statics solutions to resolve the effect of the near-surface layer with the undulating refractor shown in Figure 3.4-14s is further tested by applying the generalized reciprocal method (GRM) described by equations $(3-50 \mathrm{a}, \mathrm{b})$. Compare the results of refraction statics corrections using the GLI method (Figure 3.417) and the GRM method (Figure 3.4-20), and note that, in this case, the differences are marginal. Nevertheless, it appears that neither of the statics solutions appear to have resolved the time anomalies caused by
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0406.jpg?height=480&width=612&top_left_y=124&top_left_x=212)

FIG. 3.4-19. CMP stack associated with the model dats in Figure 34-14 with refraction statics corrections using weathering velocity (a) $1000 \mathrm{~m} / \mathrm{s}$ and (b) $1400 \mathrm{~m} / \mathrm{s}$. Datum level is $0 \mathrm{~m}$ in both sections. Compare with the section in Figure 3.4-17a.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0406.jpg?height=474&width=606&top_left_y=694&top_left_x=210)

FIG. 3.4-20. CMP stack associated with the model data in Figure 3.4-14 generalized reciprocal method (GRM), (b) section ss in (s) after residual statics corrections. Compare with the GLI results in Figure 3.4-17.
the undulating near-surface layer, completely. Assumptions made about the near-surface model always limit the resolving power of all the statics corrections methods.

Although in most cases the near-surface often consists of a low-velocity weathering layer, in some exploration basins, a single-layer near-surface model may not be adequate. We shall examine the response of statics solutions to a multilayer near-surface model shown in Figure 3.4-21a. The zero-offset section at $z=0$ is free of the near-surface effects (Figure 3.4-21b) since the nearsurface anomalies are above $z=0$ in the model (Figure 3.4-21a). Following the application of refraction and residual statics corrections, ideally, we should like to obtain a stack response similar to this zero-offset section.

The near-surface consists of layers with irregular geometry and an irregular topography. A two-way acoustic wave equation was used to model a total of 154 shot records along the line. Both shot and receiver group intervals are $50 \mathrm{~m}$, and the number of channels is 97 , including that associated with the zero-offset trace. The split spread recording geometry has a maximum offset of $2350 \mathrm{~m}$. Selected shot records from the synthetic data set associated with the earth model (Figure 3.4-22) exhibit traveltime distortions on reflection events resulting from the complex near-surface model. Note also the distinct refracted arrivals and the ground-roll energy.

Figure 3.4-23a shows the CMP-stacked section with no statics corrections. Compare with the zero-offset section (Figure 3.4-21b) and note the significant differences. Note the severe time anomalies caused by the complexity of the near-surface layer. Some shortwavelength anomalies have been resolved by residual statics corrections (Figure 3.4-23b). Nevertheless, this stacked section is far from implying the simple subsurface structure (Figure 3.4-21a).

By using the near-surface model (Figure 3.4-21a), statics at all shot-receiver stations were calculated by hand and corrections were applied to the data. The resulting stacked section is shown in Figure 3.4-24a. Note that most of the long-wavelength anomalies have been removed. Remaining disortions on reflection times, particularly betwen CMP $300-400$, imply that correcting for the near-surface effects by statics shifts applied to CMP traces is a simplistic approach given the complexity of the near-surface model. Residual statics corrections do not help in removing the time anomalies that are beyond the limit of staties corrections (Figure 3.424b).

Now assume a near-surface model that comprises a single layer with constant velocity $(1400 \mathrm{~m} / \mathrm{s})$. The top and base of this layer are defined by the elevation curve and the flat datum at $z=0$, respectively. Then, compute the elevation statics at each shot-receiver station using the thickness of the constant-velocity layer, and apply them to the CMP traces. Figure 3.4-25 shows the CMP stack with elevation statics and the subsequent residual statics corrections. Compare with Figure 3.4-23 and note that much of the time anomalies are due to elevation differences along the line. Elevation statics corrections are basically a simple alternative to statics corrections based on an estimate of a near-surface model. Using the GLI solution based on equation (3-52), inversion of the refracted arrivals yields the stacked section in Figure 3.4-26a. Here, the near-surface model was assumed to consist of a single layer, as in the case of elevation statics corrections, but with varying refractor geometry. Note the improvement on reflection times on the stack associated with the GLI solution. Clearly, a more complicated, multi-layered near-surface model can, in principle, be estimated from inversion of refracted arrivals. However, the more complicated the model, the more parameters need to be specified. This in turn will require a more complicated inversion scheme. Generally, in practice, one should model the near-surface simply. If traveltime distortions are not resolved adequately by a simple near-surface model, it often means that the problem is not solvable by statics methods. Specifically, the near-surface corrections should not be done using vertical time shifts applied to CMP traces. Under those circumstances, very little can be achieved by residual statics corrections (Figure 3.4-26b). Instead, the problem should be characterized as dynamic and be solved by earth modeling in depth (Chapter 9).

The results of the GLI statics estimates are summarized in Figure 3.4-27. For the variable-thickness single-layer near-surface, the weathering velocity was assumed to be $1400 \mathrm{~m} / \mathrm{s}$. Frame 1 shows the estimated GLI parameters the intercept time anomalies (equation 3-53a,b), as a function of the shot-receiver station number. Frame 2 shows the pick fold, namely the number of picks in each shot (denoted by $x$ ) and receiver (denoted by the vertical bars) gather. Note the tapering of the pick fold at both ends of the line. The sum of the differences between the observed picks $t_{2}$, and the modeled traveltimes $t_{i j}^{\prime}$ (equation 3-52) over each shot and receiver gather is shown in frame 3. Large residuals, in this case, are attributable to the inappropriateness of the model assumed for the nearsurface. Figure 3.4-27 also shows the estimated weathering thicknesses at all shot-receiver stations (frame 4). Finally, the computed statics and the near-surface model are shown in frames 5 and 6 , respectively.

For comparison, the GRM statics solution for the multilayered near-surface model of Figure 3.4-21a is shown in Figure 3.4-28. While both the GLI (Figure 3.4-26a) and GRM (Figure 3.4-28a) solutions are comparable, it appears that neither of the statics solutions
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0408.jpg?height=964&width=896&top_left_y=178&top_left_x=70)

FIG. 3.4-21. (a) A velocity-depth model that comprises a multilayer near-surface with a strong refractor (R) and simple subsurface structure; (b) the corresponding zero-offset section with trace spacing of $50 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0409.jpg?height=1048&width=384&top_left_y=129&top_left_x=326)

FIG. 3.4-22. Selected shot records from the synthetic data set associated with the earth model in on top of each record indicate the CMP location in the vicinity of the shot.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0410.jpg?height=228&width=472&top_left_y=132&top_left_x=280)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0410.jpg?height=209&width=470&top_left_y=377&top_left_x=281)

(b)

FIG. 3.4-23. CMP stack associated with the model data in Figure 3.4-21 (a) with no statics corrections, (b) section as in (a) after residual statics corrections. Datum level is $0 \mathrm{~m}$ in both sections. Elevation curve is plotted on top of each section.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0410.jpg?height=233&width=472&top_left_y=688&top_left_x=281)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0410.jpg?height=209&width=475&top_left_y=935&top_left_x=281)

(b)

FIG. 3.4-24. CMP stack associated with the model data in Figure 3.4-21 (a) with statics corrections using hand calculated statics, (b) section as in (a) after residual statics corrections. Datum level is $0 \mathrm{~m}$ in both sections. Elevation curve is plotted on top of each section.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0411.jpg?height=238&width=480&top_left_y=126&top_left_x=273)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0411.jpg?height=212&width=478&top_left_y=373&top_left_x=274)

FIG. 3.4-25. CMP stack associated with the model dats in Figure 3.4-21 (a) with elevation statics corrections, (b) section as in (a) after residual staties corrections. Datum level is $0 \mathrm{~m}$ in both sections. Elevation curve is plotted on top of each section.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0411.jpg?height=236&width=480&top_left_y=689&top_left_x=273)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0411.jpg?height=214&width=478&top_left_y=935&top_left_x=274)

(b)

FIG. 3.4-26. CMP stack associated with the model data in Figure 3.4-21 (a) with refraction statics corrections using the GLI solution, (b) section as in (a) after residual statics corrections. Datum level is $0 \mathrm{~m}$ in both sections, and the weathering velocity is assumed to be $1400 \mathrm{~m} / \mathrm{s}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0412.jpg?height=594&width=522&top_left_y=354&top_left_x=253)

F1G. 3.4-27. Summary of the variable-thickness GLI solution for refraction statics associated with the CMP stacked section in Figure 3.4-26a. Plot direction is the same as that in Figure 3.4-26. Except in frame 1, shot attributes are denoted with $x$ and receiver attributes are denoted with vertical bars. Estimsted parameters from equation (C-54) are plotted in frame 1 with no distinction made between shot and receiver locations.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0413.jpg?height=316&width=663&top_left_y=322&top_left_x=187)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0413.jpg?height=293&width=661&top_left_y=659&top_left_x=188)

(b)

FIG. 3.4-28. CMP stack associated with the model data in Figure 3.4-21 - (a) with refraction statics corrections using the generalized reciprocal method (GRM), (b) section as in (a) after residual statics corrections. Compare with the GLI results in Figure 3.4-26,
appears to have resolved the time anomalies caused by the complex near-surface layer, completely. Again, assumptions made about the near-surface model always limit the resolving power of all the statics methods.

## Field Data Examples

We shall analyze field data with three different nearsurface characteristics. Specifically, near-surface models with combinations of irregular topography and refractor geometry are examined. Refraction statics solutions are based on the variable-thickness scheme based on equation (3-52) and residual statics solutions are based on equation (3-25), both solved by the generalized linear inversion schemes (Sections C. 4 and C.8).

The first field data example is from an area with nearly flat topography and presumably irregular base of weathering. Shown in Figure 3.429a is a CMP-stacked section based on elevation statics corrections that involved a flat datum and constant weathering velocity. Note the presence of traveltime distortions along the major reflections down to $2 \mathrm{~s}$ caused by the unresolved long-wavelength statics anomalies. We also note very short-wavelength traveltime distortions, much less than a cable length. This latter component of the statics can be resolved by surface-consistent residual statics corrections as shown in Figure 3.4-29b. Although the CMP stacking quality has been improved after the residual statics corrections, the long-wavelength statics anomalies remain unresolved.

Figure 3.4-30 shows plots of the first-break picks from the far-offset arrivels associated with the refracted energy. While most of the first-break picks consistently follow a linear moveout from shot to shot, note that there are some local deviations that indicate a moderate degree of complexity in the near surface. Figure 3.4-31 shows the CMP-stacked section after the application of refraction statics using the generalized reciprocal method. Compare with Figure 3.4-29a and note the significant elimination of long-wavelength statics. Also plotted are the intercept time anomalies at all shotreceiver stations. Recall that equations ( $3-50 a, b)$ yield multiple values of intercept time estimates at each station. These multiple values need to be reduced to unique intercept time values at each station so as to be able to estimate the thickness of the weathering layer at each station, uniquely. The statics solution at all shot and receiver stations shows that the generalized reciprocal method can correct for all wavelengths of statics caused by undulations along the base of the weathering layer. Any remaining (residual) very short-wavelength statics should be corrected for by using a reflection-based method (Section 3.3).
Figure 3.4-32a shows the CMP-stacked section after the application of refraction statics corrections based on the variable-thickness, least-squares scheme (equation 3-52a). Compare this result with Figure 3.4-29a and note that the long-wavelength statics anomalies have been removed. Also, note that both the generalized reciprocal method (Figure 3.4-31a) and the leastsquares method (Figure 3.4-32a) yield comparable results. The section in Figure 3.4-32a can further be improved by applying residual statics corrections to remove the short-wavelength staties components (Figure 3-4-32b).

The results of the least-squares statics estimates are summarized in Figure 3.4-33. The weathering velocity was assumed to be $450 \mathrm{~m} / \mathrm{s}$. Frame 1 shows the estimated intercept times as a function of the shot/receiver station number. Frame 2 shows the pick fold, namely the number of picks in each shot and receiver gather. Note the tapering of the pick fold at both ends of the line.

A quantitative measure of the accuracy of the leastsquares solution is the sum of the differences between the observed picks $t_{2 j}$ and the modeled traveltimes $t_{i j}^{\prime}$ (equation 3-52a) over each shot and receiver gather. These cumulative residual time differences over each shot and receiver are plotted in frame 3 of Figure 3.4-33. Large residuals often are related to bad picks. Nevertheless, even with good picks, there may be large residuals attributable to the inappropriateness of the model assumed for the near-surface.

Figure 3.4-33 also shows the estimated thickness of the weathering layer at all shot-receiver stations (frame 4). Finally, the computed statics and the near-surface model are shown in frames 5 and 6 , respectively.

The next field data example is from an area with irregular topography associated with a sand dune and presumably a near-flat base of weathering. Figure 3.434a shows the CMP-stacked section with elevation statics corrections. Note the severe distortions of the geometry of shallow reflections and a very poor signal-to-noise ratio in the central part of the section. Residual statics corrections (Figure 3.4-34b) cannot improve the interpretation, especially in the center of the line where the first breaks show significant departures from a consistent linear moveout (Figure 3.4-35).

Figure 3.4-36 shows the CMP-stacked section with the application of refraction statics corrections using the generalized reciprocal method. Again, note the multiple-valued intercept time values at shot/receiver stations. The statics solution based on the reduced intercept times shows a significant medium- to longwavelength variations. After the application of these

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0415.jpg?height=325&width=791&top_left_y=352&top_left_x=102)

$\mathbf{S}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0415.jpg?height=280&width=787&top_left_y=684&top_left_x=104)

FIG. 3.4-29. (a) A CMP stack with elevation statics corrections, (b) same as in (a) with residual statics corrections. (Data courtesy Nederlandse Aardolie Maatschappij B.V.)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0416.jpg?height=796&width=754&top_left_y=240&top_left_x=144)

โพม11\}\%s

FIG. 3.4-30 First-break picks associated with the data shown in Figure 3.4-29. The top and the bottom plots correspond to the left- and right-hand of the split-spread geometry. The results of the reiraction statics solution based on these picks are shown in Figures 34 41 to 3.4-33.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0417.jpg?height=538&width=804&top_left_y=306&top_left_x=117)

FIG.3.4-31. (a) A CMP stack with refraction statics applied using the generalized reciprocal method (compare with Figures 3.4-29a and Figure 3.4-32a), (b) estimated multiple intercept times at each shot-receiver station and the computed shot (open squares) and receiver (solid dots) statics.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0418.jpg?height=586&width=806&top_left_y=302&top_left_x=115)

FIG. 3.4-32. (a) A CMP stack with refraction statics applied using the least-squares method (compare with Figures 3.4-29a and Figure 3.4-31a), (b) same as in (a) with residual statics corrections.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0419.jpg?height=816&width=636&top_left_y=234&top_left_x=177)

FIG. 3.4-33. Results of the least-squares refraction statics estimated from and applied to the data in Figure 3 4-32. In each frame, shot attrubute is denoted by $x$ and receiver attribute is denoted by the vertical bars. $R$ is the refractor that represents the base of the weathering layer. See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0420.jpg?height=745&width=756&top_left_y=294&top_left_x=81)

FIG. 3,4-34. (a) A CMP stack with elevation statjes corrections, (b) same as in (a) with residual statics corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0421.jpg?height=405&width=840&top_left_y=132&top_left_x=104)

STATIONS

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0421.jpg?height=404&width=841&top_left_y=630&top_left_x=102)

## STATIONS

FIG. 3.4-35. First-break picks associated with the data shown in Figure 3.4-34. The top and the bottom plots correspond to the left- and right-hand of the split-spread geometry. The results of the refraction statics solution based on these picks are shown in Figures 3.4-36 to 3.4-38.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0422.jpg?height=846&width=767&top_left_y=224&top_left_x=136)

FIG. 3.4-36. (a) A CMP stack with refraction statics applied using the generalized reciprocal method (compare with Figures 34-348 and Figure 3.4-37a), (b) estimated multiple intercept times at each shot-receiver station and the computed shot (open squares) and receiver (solid dots) statics.
statics corrections, the near-surface effects on the reflector geometries have been largely removed (compare with Figure 3.4-34a).

Figure 3.4-37a shows the CMP-stacked section after the application of refraction statics corrections based on the least-squares method. Compare with Figure 3.4$34 \mathrm{a}$ and note the significant improvement in the center of the line. This section can be improved further by applying residual statics corrections and thus removing the short-wavelength statics components (Figure 3.437b).

The results of the least-squares statics estimates are summarized in Figure 3.4-38. The weathering velocity was assumed to be $800 \mathrm{~m} / \mathrm{s}$. (The description of the frames in Figure $3.4-38$ is the same as that of Figure 3.4-33.)

The third field data example is from an area with an abrupt change in topography and presumably surface-following the base of weathering. The CMPstacked section with elevation statics corrections is shown in Figure 3.4-39a. Residual statics corrections significantly imptove the stacking quality (Figure 3.439b); but the long-wavelength statics anomalies remain on the section and appear as spurious structural anomalies.

Figure 3.4-40 shows the first-break picks from the far-offset arrivals associated with the refracted energy. Figure 3.4-41 shows the CMP-stacked section with the refraction statics applied using the generalized reciprocal method and the first-break picks in Figure 3.4-40. Compare with Figure 3.4-39b and note the removal of the spurious structural discontinuity along the strong reflection just above $2 \mathrm{~s}$ on the left half of the section.

By using the first-break picks shown in Figure 3.440 , the variable-thickness least-squares parameters for the near-surface were computed (equation 3-52a). The corresponding CMP-stacked section is shown in Figure 3-4.27a. Note the elimination of the spurious structural discontinuities seen in Figure 3.4-39b between 1 and 2 s. The CMP stacked section can be improved further by applying residual statics corrections (Figure 3.4-42b).

The results of the least-squares statics estimates are summarized in Figure 3.4-43. For the variablethickness estimate, the weathering yelocity was assumed to be $900 \mathrm{~m} / \mathrm{s}$. (The description of the frames in Figure 3.4-43 is the same as that of Figure 3.4-33.)

Figure 3.4-44 is a stacked section with only the field statics applied. The pull-up at midpoint location $A$ probably is caused by a long-wavelength statics anomaly, Start with CMP gathers (Figure 3.4-45a) and apply linear-moveout (LMO) correction (Figure 3.4-45b). Assuming that the first breaks correspond to a near-surface refractor, we use the estimated velocity from the first breaks (usually from a portion of the cable) to apply the LMO correction. The CMP-refraction stack of the shallow part of the data after the LMO correction is shown in Figure 3.4-45c. This section is the equivalent of the pilot trace section that is associated with the reflection-based statics corrections. (An example of this is shown in Figure 3.3-37.)

Traveltime deviations are estimated from the LMO-corrected gathers (Figure 3.4-45b) and are docomposed into shot and receiver intercept time components based on equation (3-52a). These intercept times are used to compute shot and receiver static shifts, which are then applied to the CMP gathers shown in Figure 3.4-45a. A comparison of the CMP-refraction stack section with (Figure 3.4-45d) and without (Figure 3.4-45c) reftaction statics corrections clearly indicates removal of the significant long-wavelength statics anomaly centered at midpoint location $A$ (Figure 3.444). The CMP-stacked section after the refraction statics corrections shown in Figure 3.4-46 no longer contains the false structure (compare with Figure 3.4-44). This long-wavelength anomaly cannot be removed by reflection statics corrections alone (Figure 3.4-47). Nevertheless, the residual statics corrections resolved the shortwavelength statics components that were present in the data. By cascading the two corrections refraction and residual statics, we get the improved section in Figure 3.4-48.

The last field data example for refraction and residual statics corrections is from an overthurst belt with irregular topography and large elevation differences along the line traverse. Figures 3.4-49 and 3.4-50 show selected shot records. Note that the first breaks are very distinct, and the first arrivals do not manifest significant departures from linear moveout. Nevertheless, there are significant distortions along the reflection traveltime trajectories; these are largely attributed to the subsurface complexity associated with the overthrust tectonism in the area.

Figure 3.4-51 shows selected CMP gathers with elevation corrections applied and the data referenced to a flat datum of $1800 \mathrm{~m}$ above the topographic profile of the line. Following the normal-moveout correction (Figure 3.4-52), note that the CMP gathers exhibit shortwavelength deviations Iess than a cable length along the reflection traveltime trajectories. Velocity analysis and moveout correction were performed from a floating datun - a srnoothed version of the topographic profile. The CMP stack with elevation corrections is shown in Figure 3.4-53.

The same CMP gathers as in Figures 3.4-51 and 3.4-52 with refraction statics applied are shown in Figures 3.4-54 and 3.4-55. A comparison of these sets of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0424.jpg?height=707&width=747&top_left_y=304&top_left_x=145)

FIG. 3.4-37. (a) A CMP stack with refraction statics applied using the least-squares method (compare with Figures 3.4-34a and Figure 3.4-36a), (b) same as in (a) with residual statics corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0425.jpg?height=78&width=409&top_left_y=136&top_left_x=314)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0425.jpg?height=33&width=324&top_left_y=214&top_left_x=372)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0425.jpg?height=300&width=382&top_left_y=252&top_left_x=317)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0425.jpg?height=32&width=328&top_left_y=550&top_left_x=368)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0425.jpg?height=446&width=382&top_left_y=592&top_left_x=316)

STATIDN NUMBER

FIG. 3.4-38. Results of the least-squares refraction statics estimated from and applied to the data in Figure 3.4-37. In each frame, shot attribute is denoted by $\mathrm{x}$ and receiver attribute is denoted by vertical bar. $R$ is the refractor that represents the base of the weathering layer. See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0426.jpg?height=770&width=805&top_left_y=279&top_left_x=79)

FIG. 3.4-39. (a) A CMP stack with elevation statics corrections, (b) same as in (a) with residual staties corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0427.jpg?height=330&width=739&top_left_y=265&top_left_x=149)

STATIONS

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0427.jpg?height=334&width=735&top_left_y=661&top_left_x=147)

STATIONS

FIG. 3.4-40. First-break picks associated with the data shown in Figure 3.4-39. The top and the bottom plots correspond to the left- and right-hend of the split-spread geometry. The results of the refraction statics solution besed on these picks are shown in Figures 34-41 to 3.4-43.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0428.jpg?height=746&width=830&top_left_y=274&top_left_x=103)

FIG. 3.4-41. (a) A CMP stack with refraction statics applied using the generalized reciprocal method (compare with Figures 3.4-39a and Figure 3.4-42a), (b) estimated intercept times and the computed shot (open squares) and receiver (solid dots) statics.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0429.jpg?height=734&width=806&top_left_y=292&top_left_x=114)

FIG. 3.4-42. (a) A CMP stack with refraction statics applied using the least-squares method (compare with Figures 3.4-39a and Figure 3.441a), (b) same as in (a) with residual statics corrections

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0430.jpg?height=95&width=501&top_left_y=135&top_left_x=273)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0430.jpg?height=34&width=404&top_left_y=221&top_left_x=327)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0430.jpg?height=844&width=462&top_left_y=264&top_left_x=269)

FIG. 3.4-43. Results of the least-squares refraction statics estimated from and applied to the data in Figure 3.4-42. In each frame, shot attribute is denoted by $\mathrm{x}$ and receiver attribute is denoted by vertical bar. $R$ is the refractor that represents the base of the weathering layer. See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0431.jpg?height=594&width=781&top_left_y=306&top_left_x=128)

FIG, 3.4-44, A CMP stack with field statics applied. Note the unresolved long-wavelength statics manifested by the spurios structural high below midpoint A.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0432.jpg?height=673&width=739&top_left_y=310&top_left_x=153)

FIG. 3.4-45. (a) Selected CMP gathers from the section in Figure 3.4-44, (b) CMP gathers after linear-moveout (LMO) correction, (c) stack of the LMO-corrected gathers as shown in (b), and (d) stack of the LMO-corrected gathers after longperiod statics were semoved; compare with (c).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0433.jpg?height=564&width=785&top_left_y=239&top_left_x=126)

FIG. 3.4-46. The CMP stack associated with the data in Figure 3.4-45 after refraction statics corrections. Compare with Figure 3.4-44.

gathers indicates that the statics problem is primarily of residual nature differences between refraction and elevation statics are not significant. In other words, long-wavelength statics, in this case, are associated for the most part with irregular topography. Differences between the CMP stack with refraction statics (Figure 3.456) and the CMP stack with elevation statics (Figure 3.4-53) are marginal.
Short-wavelength traveltime deviations observed on the CMP gathers in Figures 3.4-54 and 3.4-55 have been resolved by residual statics corrections as shown in Figures 3.4-57 and 3.4-58. Reflection traveltimes in Figure 3.4-57 are much like hyperbolic and those in Figure 3.4-58 are reasonably flat after moveout correction. The corresponding CMP stack shown in Figure 3.4-59, when compared with Figure 3.4-56, clearly demonstrates the improvement attained by residual static corrections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0434.jpg?height=598&width=785&top_left_y=233&top_left_x=126)

FIG. 3.4-47. The CMP stack associated with the data in Figure 3.4-45 after field statics and residual statics corrections. Compare with Figure 3,4-44 and 3.4-46.

In areas with severely irregular topography and large elevation changes along line traverses, one may consider extrapolating the recorded data from the topographic surface to a flat datum above the topography by using the wave-equation datuming technique (Section 4.6). Beve (1997) applied this technique to the data as in Figures 3.4-49 and 3.4-50. You still will need to apply residual statics corrections to account for short- wavelength statics not associated with topography, but related to the near-surface layer geometry.

Finally, in the presence of a permafrost layer or a series of lava flows at the near-surface, the problem inherently is dynamic in nature. Specifically, under such circumstances, rays through the near-surface do not follow near-vertical paths, and thus the near-surface problem cannot be posed as a statics problem. Instead,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0435.jpg?height=551&width=776&top_left_y=214&top_left_x=133)

FIG. 3.4-48. The CMP stack associated with the data in Figure 3,4-45 after refraction and residual statics corrections. Compare with Figure $3.4-44$ and $3.4-46$.

one needs to estimate accurately a velocity-depth model that accounts for the near-surface complexity so as to honor ray bending through the near-surface layer.

Figure 3.4-60 shows a CMP-stacked section from an area with a permafrost layer at the near-surface. Note that refraction statics followed by residual statics corrections (Figure 3.4-61) yield a section with improved event continuity. Nevertheless, there still exist a number of spurious structural features that have to be accounted for. Figure 3.4-62 shows a CMP-stacked section from an area with lava flows at the near-surface. Al- though residual statics corrections have improved event continuity, spurious faults are troublesome (Figure 3.463). The traveltime distortions on the stacked sections in Figures 3.4-61 and 3.4-63 strongly suggest that they cannot be resolved by statics corrections alone. Additional work, such as velocity-depth modeling (Chapter 9) and imaging in depth (Chapter 8), is required to account for lateral velocity variations associated with near-surface complexities that result from lava flows and a permafrost layer.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0436.jpg?height=1067&width=597&top_left_y=153&top_left_x=207)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0437.jpg?height=1050&width=594&top_left_y=159&top_left_x=243)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0438.jpg?height=1049&width=597&top_left_y=159&top_left_x=187)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0439.jpg?height=830&width=586&top_left_y=151&top_left_x=241)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0440.jpg?height=1047&width=652&top_left_y=159&top_left_x=177)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0441.jpg?height=1044&width=521&top_left_y=163&top_left_x=230)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0442.jpg?height=832&width=590&top_left_y=155&top_left_x=196)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0443.jpg?height=1049&width=658&top_left_y=158&top_left_x=200)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0444.jpg?height=1054&width=527&top_left_y=162&top_left_x=198)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0445.jpg?height=1065&width=533&top_left_y=153&top_left_x=260)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0446.jpg?height=1028&width=745&top_left_y=170&top_left_x=146)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0447.jpg?height=1057&width=708&top_left_y=117&top_left_x=170)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0448.jpg?height=1065&width=706&top_left_y=154&top_left_x=152)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0449.jpg?height=1060&width=744&top_left_y=155&top_left_x=144)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0450.jpg?height=1066&width=722&top_left_y=155&top_left_x=159)

## EXERCISES

Exercise 3-1. Why does salt have anomalously high velocity $(4.5$ to $5.5 \mathrm{~km} / \mathrm{s})$ ?

Exercise 3-2. Measure the traveltimes corresponding to offset values of 1 and $3 \mathrm{~km}$ in Figure 3.1-2. Then compute the velocity above the reflector and verify that it is $2264 \mathrm{~m} / \mathrm{s}$. Note that the zero-offset trace is not recorded; therefore, $t_{0}$ normally is not a known quantity.

Exercise 3-3. The CMP gather in Figure 3.1-5a contains a hyperbola. Following NMO corrections and using 2000 (Figure 3.1-5c) and $2500 \mathrm{~m} / \mathrm{s}$ (Figure 3.1-5d) velocities, are the traveltime trajectories hyperbolic?

Exercise 3-4. Make velocity picks from the velocity panels in Figures 3.2-4, 3.2-5, 3.2-6, and 3.2-7.

Exercise 3-5. Make velocity picks from the CVS panel in Figure 3.E-1.

Exercise 3-6. Consider two intersecting lines. Would you expect that velocity analyses at the intersection point yield the same velocity function?

Exercise 3-7. Which is correct: velocity analysis from datum or velocity analysis from surface?

Exercise 3-8. Fill the missing elements in the following table. Average velocity $v_{n v g}$, which relates vertical traveltime to depth in a horizontally layered medium, is defined as

$$
v_{a v g}=\frac{\sum_{2=1}^{N} v_{1} \Delta t_{2}}{\sum_{t=1}^{N} \Delta t_{1}}
$$

where $\Delta t_{i}=\Delta z_{2} / v_{t}, \Delta z_{i}=$ layer thickness and $v_{t}=$ interval velocity, The rms velocity is given by equation (3-4).

| Layer <br> Thickness, <br> m | Interval <br> Velocity, <br> $\mathrm{m} / \mathrm{s}$ | RMS <br> Velocity, <br> $\mathrm{m} / \mathrm{s}$ | Average <br> Velocity, <br> $\mathrm{m} / \mathrm{s}$ |
| :---: | :---: | :---: | :---: |
| 200 | 2,000 |  |  |
| 300 | 3,000 |  |  |
| 400 | 4,000 |  |  |
| 350 | 3,500 |  |  |
| 500 | 5,000 |  |  |

Exercise 3-9. Explain why the velocity for horizon $A$ in Figure 3.2-34 behaves as shown in the HVA display below the salt dome $S$.
Exercise 3-10. Suppose you want to fit a set of observed traveltimes to a parabola of the form $t=a+$ $b x+c x^{2}$. The tabulated input values are given below.

|  |  | Observed |
| :---: | :---: | :---: |
| $i$ | $x_{i}$ | $t_{7}^{\prime}$ |
| 1 | 0 | 0.4 |
| 2 | 1 | 1.1 |
| 3 | 2 | 3.5 |
| 4 | 3 | 7.9 |
| 5 | 4 | 14.4 |

Set up the least-squares problem and solve for $a, b$, and $c$. You will have five equations and three unknowns.

Exercise 3-11. Solve the system

$$
\begin{aligned}
& x_{1}-2 x_{2}=1 \\
& x_{1}+4 x_{2}=4
\end{aligned}
$$

by the Gauss-Seidel iterative method. Verify the results by solving these equations by the method of substitution to obtain the correct solution: $x_{1}=2$ and $x_{2}=0.5$.

Exercise 3-12. Solve the system

$$
\begin{aligned}
& x_{1}+4 x_{2}=4 \\
& x_{1}-2 x_{2}=1
\end{aligned}
$$

by the Gauss-Seidel iterative method. Note that this is the same problem as in Exercise 3-11, except that the order of the equations is reversed. The solution should be the same. You will find that the solution cannot be obtained because the process of iteration will not converge. This demonstrates the importance of ordering the equations when solving by the Gauss-Seidel method.

Exercise 3-13. Write equation (3-37a) for $\imath=$ $1,2,3$, and $j=1,2,3$. You will find that there are six unknowns, but five independent equations.

Exercise 3-14. Can you use refraction-based statics techniques in permafrost areas?

Exercise 3-15. Which of the following adversely affects the quality of velocity spectrum longwavelength or short-wavelength (less than a cable length) statics anomalies?

Exercise 3-16. In what way does inside muting of a CMP gather affect the velocity spectrum?

5
1
2
3
4
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0452.jpg?height=292&width=762&top_left_y=150&top_left_x=107)

## $2400 \mathrm{~m} / \mathrm{s}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0452.jpg?height=692&width=766&top_left_y=496&top_left_x=102)

FIG. 3.E-1. Part 1: CVS panels for a line from an area with couplex structure sasociated with overthrust tectonics.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0453.jpg?height=1059&width=795&top_left_y=137&top_left_x=95)

FIG. 3.E-1. Part 2: CVS panels for a line from an area with complex structure associated with overthrust tectonics.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0454.jpg?height=1052&width=798&top_left_y=134&top_left_x=72)

FIG. 3.E-1. Part 3: CVS panels for a line from an area with complex structure associnted with overthrust tectonics.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0455.jpg?height=1055&width=796&top_left_y=134&top_left_x=94)

FIG. 3.E-1. Part 4: CVS panels for a line from an area with complex structure associated with overthrust tectonics.

## Appendix $\mathrm{C}$ <br> TOPICS IN MOVEOUT AND STATICS CORRECTIONS

## C. 1 The Shifted Hyperbola

The objective in this section is to review the higher-orler accuracy in normal movent for a horizontally layered earth model. Refer to the traveltime equation (3-3) by Taner and Koebler (1969):

$$
t^{2}=C_{0}+C_{1} x^{2}+C_{2} x^{4}+C_{3} x^{6}+\cdots, \quad(C-1)
$$

where $x$ is the offset, and

$$
C_{0}=t_{0}^{2}
$$

where $t_{0}$ is the two-way zero-offsct traveltime

$$
\begin{gathered}
C_{1}=\frac{1}{\mu_{2}} \\
C_{2}=\frac{1}{4} \frac{\mu_{2}^{2}-\mu_{4}}{t_{0}^{2} \mu_{2}^{4}}
\end{gathered}
$$

and

$$
C_{3}=\frac{2 \mu_{4}^{2}-\mu_{2} \mu_{6}-\mu_{2}^{2} \mu_{4}}{t_{0}^{4} \mu_{2}^{7}}
$$

with the arditional definitions of the terms (Castle, 1994)

$$
\mu_{j}=\frac{1}{t_{0}} \sum_{\imath=1}^{N} v_{\imath}^{J} \Delta \tau_{i}
$$

Note that

$$
\mu_{2}=v_{r m s}^{2}
$$

since

$$
v_{r \pi s}^{2}=\frac{1}{t_{0}} \sum_{\imath=1}^{N} v_{i}^{2} \Delta \tau_{1}
$$

where $\Delta \tau_{i}$ is the vertical two-way traveltime through the $i$-th layer, $v$ is the velocity, and $t_{0}=$ $\sum_{i=1}^{N} \Delta \tau_{i}$. Derivation of equation (C-I) is based on the parametric equations for traveltime and offet for a horizontally layered earth model (Slotnick, 1959; Grant and West, 1965) and is given by Castle (1994).

Drop higher-order terms in equation (C-1) to obtain the fourth-order moveout equation

$$
t^{2}=C_{0}+C_{1} x^{2}+C_{2} x^{4}
$$

Now, substitute for the coefficients from equations (C-2a). (C-2b) and (C-3a) to obtain

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v_{r m s}^{2}}+C_{2} x^{4}
$$

This equation can in principle be used to compute a velocity spectrum (Section 3.2). First, drop the fourth-order term to get the small-spread hyperbolic equation

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v_{r m s}^{2}}
$$

Compute the velocity spectrum using equation (C-6), and pick an initial velocity function $v_{r m a}\left(t_{0}\right)$. Then, use this picked velocity function in equation (C-5) and compute a velocity spectrum for the parameter $C_{2}$. Pick a function $C_{2}\left(t_{0}\right)$ and use in equation (C-5) to recompute the velocity spectrum. Finally, pick an updated velocity function $v_{\text {rnas }}\left(t_{0}\right)$ from this velocity spectrum.

The fourth-order moveout equation (C-4) can be expressed exactly by a time-shifted hyperbolic traveltime equation of the form (Castle, 1994)

$$
t=t_{0}\left(1-\frac{1}{S}\right)+\sqrt{\left(\frac{t_{0}}{S}\right)^{2}+\frac{x^{2}}{S v_{r m s}^{2}}}
$$

where $S$ is a constant of the form

$$
S=\frac{\mu_{4}}{\mu_{2}^{2}}
$$

For $S=1$, equation (C-7) reduces to the conventional moveout equation (C-6).

Figure C-I shows the traveltime trajectories of the hyperbolic moveout equation (C-6) and the time-shifted hyperbolic equation (C-7) where $\tau_{s}=t_{0}(I-1 / S)$. Note that the shifted hyperbola is a better match to the true traveltime trajectory at far offsets. The latter was computed for a horizontally layered earth model using the exact parametric equations for traveltime and offset (Slotnick, 1959; Grant and West, 1965).

The shifted hyperbola equation satisfies the requirements for a moveout equation:

(a) The traveltime trajectory is symmetric with respect to the time axis.

(b) The instantaneous velocity $d x / d t$ is never zero.

(c) For constant velocity, it reduces to the exact hyperbolic moveout equation.

As for the fourth-order moveout equation (C-5), this equation can, in principle, be used to conduct the velocity analysis of CMP gathers. First, set $S=1$ in equation (C-7) to get equation (C-6). Compute the velocity spectrum using equation ( $\mathrm{C}-6$ ), and pick an initial velocity function $v_{r m a}\left(t_{0}\right)$. Then, use this picked velocity function in equation (C-7) and compute a velocity spectrum for the parameter $S$. Pick a function $S\left(t_{0}\right)$ and use in equation (C-7) to recompute the velocity spectrum. Finally, pick an updated velocity function $v_{\mathrm{rms}}\left(t_{0}\right)$ from this velocity spectrum.

De Bazelaire (1988) offers an alternative moveout equation to achieve higher-order accuracy at far offsets:

$$
t=\left(t_{0}-t_{p}\right)+\sqrt{t_{p}^{2}+\frac{x^{2}}{v_{s}^{2}}}
$$

where $t_{0}$ is the two-way zero-offset time, $t_{p}$ is related to the time at which the asymptotes of the hyperbolic traveltime trajectory converge (Figure $\mathrm{C}$-2), and $v_{s}$ is the reference velocity assigned to the layer below the recording surface (not the near-surface layer). When $t_{p}=t_{0}$, equation (C-9) reduces to the small-spread hyperbolic equation (C-6).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0458.jpg?height=712&width=434&top_left_y=131&top_left_x=296)

FIG. C-1. Traveltime trajectories based on (top) the hyperbolic equation (C-23) and (bottom) the time-shifted hyperbolic equation (C-14). Compare with the true traveltime trajectory associated with a layered model (Castle, 1994).

## C. 2 Moveout Stretch

Refer to Figure 3.1-10 for a sketch of a wavelet before and after moveout correction. The moveout equation is

$$
t^{2}=t_{0}^{2}+\frac{x^{2}}{v^{2}}
$$

where $t$ is the two-way traveltime associated with a source-receiver separation $x, t_{0}$ is the two-way vertical traveltime - the time after moveout correction, and $v$ is the moveout velocity.

Consider a reflection event represented by a wavelet of dominant period $T$ with an arrival time $t$ at offset $x$. After normal-moveout correction, the dominant period becomes $T_{0}=T+\Delta T$. The moveout equation $(\mathrm{C}-10)$ is associated with the onset of the wavelet. Similarly, the moveout

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0459.jpg?height=275&width=321&top_left_y=126&top_left_x=358)

FIG. C-2. The traveltime trajectory associated with the moveout equation (3-5c) (De Bazelaire, 1988).

equation with the termination of the wavelet is expressed by

$$
(t+T)^{2}=\left(t_{0}+T+\Delta T\right)^{2}+\frac{x^{2}}{v^{2}}
$$

Expand the terms on both sides:

$$
t^{2}+2 t T+T^{2}=t_{0}^{2}+2 t_{0}(T+\Delta T)+(T+\Delta T)^{2}+\frac{x^{2}}{v^{2}}
$$

By making the substitution from equation (C-10), we obtain

$$
2 t T+T^{2}=2 t_{0}(T+\Delta T)+(T+\Delta T)^{2}
$$

Simplify and rearrange the terms

$$
2\left(t-t_{0}\right) T=2\left(t_{0}+T\right) \Delta T+\Delta T^{2}
$$

Now, ignore the second term on the right-hand side of the equation and observe that $\Delta t_{N M O}=$ $t-t_{0}$ to obtain

$$
\Delta t_{N M O} T=\left(t_{0}+T\right) \Delta T
$$

Assume that $t_{0}>T$ and rearrange the terms to obtain a relationship for change in the period of the wavelet as a result of moveout correction:

$$
\frac{\Delta T}{T}=\frac{\Delta t_{N M O}}{t_{0}}
$$

Now, we want to express equation ( $\mathrm{C}-13$ ) in terms of the dominant frequency $f$ of the wavelet. Start with the relation

$$
T=\frac{1}{f}
$$

and obtain

$$
\Delta T=-\frac{1}{f^{2}} \Delta f
$$

Finally, combine equations ( $\mathrm{C}-13$ ) and (C-15) to obtain the equation for the absolute value of frequency stretching:

$$
\frac{\Delta f}{f}=\frac{\Delta t_{N M O}}{t_{0}}
$$

This is the same as equation (3-6) in the main text.

## C. 3 Equations for a Dipping Reflector

We want to derive equation (3-7) of the main text using the geometry of a dipping reflector as shown in Figure C-3. (The derivation provided here is coutresy Zhiming $\mathbf{L i}, 1999$ ). The distance from source location $S$ to reflection point $R$ back to receiver location $G$ is given by $S R+R G=F R+R G=F G=v t$, whcre point $F$ is the mirror image of the source location $S$ $v$ is the velocity of the medium above the dipping reflector, and $t$ is the traveltime from $F$ to $G$.

To compute the traveltime $t$ associated with the distance $F G$, we shall need to compute the coordinates of $F:\left(x_{F}, z_{F}\right)$ and $G:\left\{x_{G}, z_{G}\right)$, so that

$$
(F G)^{2}=\left(x_{F}-x_{G}\right)^{2}+\left(z_{F}-z_{G}\right)^{2}
$$

From the geometry of Figure C-3, the coordinates of $F:\left(x_{F}, z_{F}\right)$ are

$$
x_{F}=O F \cos 2 \phi
$$

and

$$
z_{F}=O F \sin 2 \phi
$$

where $\phi$ is the dip angle of the reflector. Substitute the relation $O F=O S=O M+x / 2$ into the above equations to obtain

$$
\dot{x}_{F}=\left(O M+\frac{x}{2}\right) \cos 2 \phi
$$

and

$$
z_{F}=\left(O M+\frac{x}{2}\right) \sin 2 \phi
$$

Again, from the geometry of Figure C-3, the coordinates of $G:\left(x_{G}, z_{G}\right)$ are

$$
x_{G}=O M-\frac{x}{2}
$$

and

$$
z_{G}=0
$$

Substitute equations (C-18a,b) and (C-19a,b) into cquation (C-17)

$$
(F G)^{2}=\left[\left(O M+\frac{x}{2}\right) \cos 2 \phi-\left(O M-\frac{x}{2}\right)\right]^{2}+\left[\left(O M+\frac{x}{2}\right) \sin 2 \phi\right]^{2}, \quad(C-20 a)
$$

then use the trigonometric relation $\cos 2 \phi=2 \cos ^{2} \phi-1$ and apply some algebra to obtain

$$
(F G)^{2}=\left(O M+\frac{x}{2}\right)^{2}+\left(O M-\frac{x}{2}\right)^{2}-2\left[(O M)^{2}-\frac{x^{2}}{4}\right]\left(2 \cos ^{2} \phi-1\right) . \quad(C-20 b)
$$

Further algebraic manipulation yields

$$
(F G)^{2}=4(O M)^{2} \sin ^{2} \phi+x^{2} \cos ^{2} \phi
$$

Finally, note from the geometry of Figure $\mathrm{C}-3$ the relation

$$
M N=O M \sin \phi
$$

Subsitute equation (C-22) into equation (C-21), and use the relations $2 M N=v t_{0}$ und $F G=v t$ to obtain the desired expression for the reflection truveltime associated with a dipping reflector

$$
t^{2}=t_{0}^{2}+\frac{x^{2} \cos ^{2} \phi}{v^{2}}
$$

and the moveout velocity

$$
v_{N M O}=\frac{v}{\cos \phi}
$$

Equations (C-23a) and (C-23b) are the same as equations (3-10) and (3-11) of the main text.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0461.jpg?height=452&width=473&top_left_y=122&top_left_x=282)

FIC. C-3. Geometry of a dipping reflector used in deriving the equations in Section C.3.

## C. 4 Traveltime Decomposition for Residual Statics Estimation

We want to model traveltime deviations $t_{2}^{\prime}$ associated with a reflection event on moveoutcorrected CMP gathers by the following equation (Taner et al., 1974; Wiggins et al., 1976):

$$
t_{\imath 3}^{\prime}=s_{j}+r_{i}+G_{k}+M_{k} x_{\imath \jmath}^{2},
$$

where $s_{3}$ is the residual statics shift at the $j$ th source location, $r_{2}$ is the residual statics shift at the $i$ th recejver location, $G_{k}$ is the structure term at the $k$ th midpoint location, $[k=\langle i+j) / 2]$, $M_{k} x_{i}^{2}$ is the residual moveout at the $k$ th midpoint location.

For $m$ picks of $t_{z}$, and $n_{s}$ shot locations, $n_{r}$ receiver locations, $n_{G}$ midpoint locations, we have the following set of equations:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0461.jpg?height=244&width=411&top_left_y=898&top_left_x=312)

A more parsimonious parameterization can be achieved by an appropriate traveltime picking strategy such that the structure term can be set to zero. Additionally, the residual moveout term coeficient $M$ may be set to a constant. The model equation (C-24a) can be rewritten as

$$
t_{i j}^{\prime}=s_{j}+r_{i}+M x_{i j}^{2}
$$

Equation (C-24b) is modified, accordingly

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0462.jpg?height=199&width=375&top_left_y=156&top_left_x=294)

Whichever the preferred modeled traveltimes, write the respective equations ( $\mathrm{C}-24 \mathrm{~b}$ ) or (C-25b) in matrix notation as

$$
\mathrm{t}^{\prime}=\mathbf{L}_{\mathbf{p}}
$$

where $\mathbf{t}^{\prime}$ is the columin vector of $m$-length (number of traveltime picks) in equation (C-24b) or (C-25b), $\mathbf{L}$ is the sparse matrix in the same equations with dimensions $m \times\left(n_{s}+n_{r}+n_{G}+n_{G}\right)$ in case of equation (C-24b) and $m \times\left(n_{s}+n_{r}+1\right)$ in case of equation ( $\left.\mathrm{C}-25 \mathrm{~b}\right)$, and $\mathrm{p}$ is the column vector of $\left(n_{s}+n_{r}+n_{G}+n_{C}\right)$-length in case of equation (C-24b) and $\left(n_{s}+n_{r}+1\right)$-length in case of equation (C-25b) on the right-hand side of these equations. Except the three elements in each row, the $L$ matrix contains zeros.

The generalized least-squares solution to equation (C-26) satisfies the requirement that the energy of the error vector

$$
e=t-t^{\prime}
$$

is minimum (Lines and Treitel, 1984). The cumulative error energy is

$$
E=\mathbf{e}^{\mathrm{T}} \mathbf{e}
$$

Substitute equation (C-27a) into equation (C-27b) and use equation (C-26) to obtain

$$
E=\left(\mathrm{t}-\mathbf{L p}^{\mathrm{p}}\right)^{T}\left(\mathbf{t}-\mathbf{L}_{\mathbf{p}}\right)
$$

Minimization of $E$ with respect to $p$ requires that

$$
\frac{\partial E}{\partial s_{3}}=\frac{\partial E}{\partial \tau_{i}}=\frac{\partial E}{\partial G_{k}}=\frac{\partial E}{\partial M_{k}}=0
$$

which, in the case of equation (C-24b), yields $n_{s}+n_{r}+n_{G}+n_{G}$ equations and that many unknowns. These equations can be solved for the residual statics associated with $n$, source locations, $n_{r}$ receiver locations, $n_{G}$ structural terms, and $n_{G}$ residual moveout terms.

Finally, the solution that satisfies the minimization requirement given by equation ( $\mathrm{C}-27 \mathrm{~d}$ ) follows (Lines and Treitel, 1984)

$$
\mathbf{p}=\left(\mathbf{L}^{\mathbf{T}} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathrm{T}} \mathbf{t}
$$

where $\mathbf{t}$ denotes the column vector of $m$-length that represents the traveltime deviations picked from moveout-corrected CMP gathers, and $T$ denotes the matrix transposition.

A practical scheme for solving equation (C-24a) is based on the Gauss-Seidel method. In this scheme, each term on the right-hand side of equation (C-24a) is computed by the set of recursive equations

$$
\begin{aligned}
& s_{j}^{m}=\frac{1}{n_{r}} \sum_{i}^{n_{r}}\left\{t_{\imath \jmath}-G_{k}^{m-1}-M_{k}^{m-1} x_{\imath j}^{2}-r_{i}^{m-1}\right\} \\
& r_{7}^{m}=\frac{1}{n_{g}} \sum_{j}^{n_{3}}\left\{t_{\imath j}-G_{k}^{n-1}-M_{k}^{n-1} x_{\imath \jmath}^{2}-s_{\jmath}^{m-1}\right\}
\end{aligned}
$$

$$
G_{k}^{m}=\frac{1}{n_{h}} \sum_{l}^{n_{h}},\left\{t_{\imath j}-s_{j}^{m-1}-M_{k}^{m-1} x_{v}^{2}-r_{i}^{m-1}\right\}
$$

and

$$
M_{k}^{m}=\frac{1}{n_{G}} \sum_{k}^{n_{g}} \frac{1}{x_{i j}^{2}}\left\{t_{2 j}-s_{j}^{m-1}-G_{k}^{m-1}-r_{\imath}^{m-1}\right\}
$$

where $i$ and $j$ are the receiver and source indexes, respectively, $l=|i-j|$ is the offset index, $k=(\imath+j) / 2$ is the midpoint index, $m$ is the iteration index, and $n_{h}$ is the fold of coverage. The solutions in equations (C-29) are based on the orthogonality of the shot and receiver axes, and the orthogonality of the midpoint and offet axes. Equations (C-29) can be modified as

$$
\begin{aligned}
& s_{j}^{m}=\frac{1}{n_{r}} \sum_{i}^{n_{v}}\left\{t_{v j}\right\}-\frac{1}{n_{r}} \sum_{v}^{n_{r}}\left\{G_{k}^{m-1}-M_{k}^{m-1} x_{i j}^{2}-r_{2}^{m-1}\right\} \\
& r_{i}^{m}=\frac{1}{n_{s}} \sum_{j}^{n_{y}}\left\{t_{2 j}\right\}-\frac{1}{n_{s}} \sum_{j}^{n_{s}}\left\{G_{k}^{m-1}-M_{k}^{m-1} x_{i j}^{2}-s_{j}^{m-1}\right\} \\
& G_{k}^{m}=\frac{1}{n_{h}} \sum_{l}^{n_{h}}\left\{t_{i j}\right\}-\frac{1}{n_{h}} \sum_{l}^{n_{h}}\left\{s_{j}^{m-1}-M_{k}^{m-1} x_{1 j}^{2}-r_{i}^{m-1}\right\}
\end{aligned}
$$

and

$$
M_{k}^{m}=\frac{1}{n_{G}} \sum_{k}^{n_{C}} \frac{1}{x_{v}^{2}}\left\{t_{t}\right\}-\frac{1}{n_{G}} \sum_{k}^{n_{k}} \frac{1}{x_{v}^{2}}\left\{s_{j}^{m-1}-G_{k}^{m-1}-r_{i}^{m-1}\right\}
$$

This modificution enables us to compute and store the sum of the traveltime deviations $\sum t_{\mathfrak{t}}$, thus circumventing the need for storing the individual traveltime deviations. The process is iterated until an index in that yields the least-squares solution such that the differences between the solutions for $s_{j}, \tau_{t}, G_{k}$, and $M_{k}$ from the $m$ th and ( $m-1$ )st iteration are smaller than some specified values.

## G. 5 Depth Estimation from Refracted Arrivals

Refer to Figure 3.4-11 a for a sketch of refracted arrivals associated with a flat refractor. We want to estimate the depth to bedrock $z_{w}$ (thickness of the weathering layer) at some shot-receiver station. The traveltime $t$ for the critically refracted arrival associated with a shot $S$ and receiver $R$ has thre parts

$$
t=\frac{S B}{v_{t w}}+\frac{B C}{v_{b}}+\frac{C R}{v_{w}}
$$

The terms in this equation can be expressed in terms of the near-surface model parameters

$$
t=\frac{z_{w}^{\prime}}{v_{w} \cos \theta_{c}}+\frac{x-2 z_{w} \tan \theta_{c}}{v_{b}}+\frac{z_{w}}{v_{w} \cos \theta_{c}}
$$

where $x$ is the shot-receiver separation, $z_{w}$ is the depth to bedrock, and $v_{w}$ and $v_{b}$ are weathering and bedrock velocities, respectively. The critical angie of refraction $\theta_{c}$ is related to the velocities by the relation

$$
\sin \theta_{c}=\frac{v_{w}}{v_{b}}
$$

Combine the first and third terms on the right, and spiit the second term in equation (C-31b) to get

$$
t=\frac{2 z_{w}}{v_{w v} \cos \theta_{c}}-\frac{2 z_{w} \sin \theta_{c}}{v_{b} \cos \theta_{c}}+\frac{x}{v_{b}}
$$

Substitute equation (C-32) into equation (C-33a) and apply some algebra to obtain

$$
t=\frac{2 z_{w} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}+\frac{x}{v_{b}}
$$

Note that this is the equation of a line

$$
t=t_{2}+\frac{x}{v_{b}},
$$

with its slope given by $1 / v_{3}$ - inverse of the bedrock velocity, and the intercept time $t_{2}$ given by

$$
t_{\imath}=\frac{2 z_{w} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}
$$

By measuring the slope of the line associated with refracted arrivals in Figure 3-4.11a, we estimate the bedrock velocity $v_{6}$. We also estimate the intercept time $t_{2}$ by extending the line to $x=0$. Finally, we assume a value for the weathering velocity $v_{w}$. Then, equation (C-35) can be rearranged to compute the depth to bedrock $z_{w}$ as

$$
z_{w}=\frac{v_{b} t_{w} t_{2}}{2 \sqrt{v_{b}^{2}-v_{w}^{2}}}
$$

This is equation (3-41a) in the text.

The depth to bedrock can also be computed from the crossover distance $x_{c}$ where the refracted arrival and the direct arrival coincide (Figure 3-4.112). The equation for the direct arrivals is

$$
t=\frac{x}{v_{w}}
$$

whereas equation (C-34) describes the refracted arrivals. At the crossover distance $x_{c}$, we equate the arrival times in equations (C-34) and (C-37) as

$$
t_{1}+\frac{x_{c}}{v_{b}}=\frac{x_{c}}{v_{w}} .
$$

By substituting equation (C-35), we obtain

$$
z_{v}=\frac{v_{b} v_{w} x_{c}}{2 \sqrt{v_{b}^{2}-v_{t}^{2}}}\left(\frac{1}{v_{w}}-\frac{1}{v_{b}}\right)
$$

By simplifying, we obtain the expression for depth to bedrock in terms of the crossover distance:

$$
z_{w}=\frac{1}{2} \sqrt{\frac{v_{b}-v_{w}}{v_{b}+v_{w}}} x_{c}
$$

This is equation (3-41b) in the text.

## C. 6 Equations for a Dipping Refractor

Consider the dipping refractor depicted in Figure 3.4-1lc. The traveltime for the refracted arrivals from downdip shooting is given by

$$
t^{-}=\frac{S A}{v_{u}}+\frac{A B}{v_{b}}+\frac{B R}{v_{w}}
$$

From the geometry and the variables of Figure 3.4-11c, the terms in equation (C-40a) are explicitly written as

$$
\begin{aligned}
t^{-} & =\frac{z_{w S}}{v_{w} \cos \theta_{c}} \\
& +\frac{x \cos \varphi-z_{w S} \tan \theta_{c}-\left(z_{w S}+x \sin \varphi\right) \tan \theta_{c}}{v_{b}} \\
& +\frac{z_{w S}+x \sin \varphi}{v_{w s} \cos \theta_{c}}
\end{aligned}
$$

Apply some algebra to obtain

$$
t^{-}=\frac{2 z_{w} S \cos \theta_{c} \cos \varphi}{v_{w}}+\frac{x \sin \left(\theta_{c}+\varphi\right)}{v_{w}}
$$

This is the equation of a line

$$
t^{-}=t_{\tau}^{-}+\frac{x}{v_{b}^{-}}
$$

with its inverse slope defined as

$$
v_{b}^{-}=\frac{v_{w}}{\sin \left(\theta_{c}+\varphi\right)}
$$

and the intercept time given by

$$
t_{\mathrm{z}}^{-}=\frac{2 z_{w S} \cos \theta_{c} \cos \varphi}{v_{w}}
$$

Equation (C-41a) can be rewritten for the refracted arrivals from updip shooting (Figure 3.4-11d) as

$$
t^{+}=\frac{2 z_{w R} \cos \theta_{c} \cos \varphi}{v_{w}}+\frac{x \sin \left(\theta_{c}-\varphi\right)}{v_{w}} .
$$

Again, this is the equation of a line

$$
t^{+}=t_{1}^{+}+\frac{x}{v_{b}^{+}}
$$

with its inverse slope defined as

$$
v_{b}^{+}=\frac{v_{w}}{\sin \left(\theta_{c}-\varphi\right)}
$$

and the intercept time given by

$$
t_{z}^{+}=\frac{2 z_{w R} \cos \theta_{c} \cos \varphi}{v_{w}}
$$

To compute the refractor dip and bedrock velocity, first, rewrite equations (C-41c) and (C-42c)

$$
\theta_{c}+\varphi=\sin ^{-1} \frac{v_{w}}{v_{b}^{-}}
$$

and

$$
\theta_{c}-\varphi=\sin ^{-1} \frac{v_{w}}{v_{b}^{+}}
$$

By subtracting equation (C-43b) from (C-43a), we obtain an expression for the refractor dip $\varphi$ :

$$
\varphi=\frac{1}{2}\left[\sin ^{-1} \frac{v_{w}}{v_{b}^{-}}-\sin ^{-1} \frac{v_{w}}{v_{b}^{+}}\right]
$$

This is equation (3-46a) of the text. Measure the slopes of the downdip and updip refracted arrivals in Figure 3.4-11d $-v_{b}^{-}$and $v_{b}^{+}$, respectively. Then, assume a value for the weathering velocity $t_{w}$. By direct substitution into equation (C-44), compute the refractor dip $\varphi$.

To obtain the bedrock velocity $v_{b}$, first, rewrite slopes from equations $(\mathrm{C}-41 \mathrm{c})$ and $(\mathrm{C}-42 \mathrm{c})$ as

$$
\frac{1}{v_{b}^{-}}=\frac{\sin \theta_{c} \cos \varphi+\sin \varphi \cos \theta_{c}}{v_{w}}
$$

and

$$
\frac{1}{v_{b}^{+}}=\frac{\sin \theta_{c} \cos \varphi-\sin \varphi \cos \theta_{c}}{v_{w}}
$$

Add equations ( $\mathrm{C}-45 \mathrm{a})$ and $(\mathrm{C}-45 \mathrm{~b}$ ) and take the inverse. Then use the relation given by equation (C-32) to obtain

$$
v_{b}=\frac{2 \cos \varphi}{\left(\frac{1}{v_{b}^{-}}+\frac{1}{v_{b}^{+}}\right)}
$$

This is equation (3-46b) of the text. Finally, we compute the depth to the bedrock at shotreceiver stations by substituting the estimates for refractor dip $\varphi$ from equation (C-44) and the bedrock velocity $v_{b}$ from equation (C-46), and the measurements for the intercept times $t_{z}^{-}$and $t_{1}^{+}$from the arrival timos in Figure 3-4.11d into equations (C-41d) and (C-42d) to obtain

$$
z_{w S}=\frac{v_{b} v_{u} t_{2}^{-}}{2 \cos \varphi \sqrt{v_{b}^{2}-v_{w i}^{2}}}
$$

and

$$
z_{w R}=\frac{v_{b} v_{\mathbf{w}} t_{t}^{+}}{2 \cos \varphi \sqrt{v_{b}^{2}-v_{w}^{2}}}
$$

These equations are equivalent to equation (3-46c) of the text.

## C. 7 The Plus-Minus Times

Consider the three raypaths in Figure 3.4-12a associated with shot-receiver pairs $A D, D G$, and $A G$. The plus and minus times are defined as

$$
t_{+}=t_{A B C D}+t_{D E F G}-t_{A B F G}
$$

and

$$
t_{-}=t_{A B C D}-t_{D E F G}+t_{A B F G}
$$

The times given on the right side of these equations are the picked values from the first breaks for the three raypaths shown in Figure 3.4-12a. From the raypath configuration, we have the relation

$$
t_{+}=2\left(\frac{C D}{v_{w}}-\frac{C H}{v_{b}}\right)
$$

By using the geometric relations from Figure (3.4-12a), equation (C-49a) can be expressed in terms of the critical angle of refraction $\theta$ and depth to bedrock $z_{w j}$ as

$$
t_{+}=2\left(\frac{z_{w}}{v_{w} \cos \theta}-\frac{z_{w} \tan \theta}{v_{b}}\right)
$$

Finally, by using the relation (C-32), we have the relation for the plus time $t_{+}$in terms of the near-surface parameters - depth to bedrock $z_{w}$, weathering velocity $v_{w}$, and bedrock velocity $v_{b}$ :

$$
t_{+}=\frac{2 z_{w} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{u b} v_{b}}
$$

This is equation $(3-48 a)$ of the text.

Now, consider the minus time $t_{-}$defined by equation (C-48b). By using the raypath configuration depicted in Figure 3.4-12b, we have

$$
t_{-}=\frac{2 C D}{v_{w}}+\frac{2 B C}{v_{b}}+\frac{C E}{v_{b}}
$$

Make substitutions in terms of the near-surface parameters to get

$$
t_{-}=\frac{2 z_{w}}{v_{z,} \cos \theta}+\frac{2 B C}{v_{b}}+\frac{2 z_{w} \tan \theta}{v_{b}}
$$

By some algebraic manipulation, we gct

$$
t_{-}=\frac{2 z_{w}}{v_{w} \cos \theta}-\frac{2 z_{w} \tan \theta}{v_{b}}+\frac{2 x}{v_{b}}
$$

where $x$ is the source receiver separation $A D$. Compare the first two terms on the right with equation (C-48b), and rewrite equation ( $\mathrm{C}-49 \mathrm{c}$ ) to obtain

$$
t_{-}=t_{+}+\frac{2 \varepsilon}{v_{\phi}}
$$

This is equation $(3-48 \mathrm{c})$ of the main text.

## C. 8 Generalized Linear Inversion of Refracted Arrivals

For an arbitrary source-receiver geometry, given a set of observed traveltimes associated with the refracted arrivals, we can estimate the parameters associated with a single-layer near-surface model using the generalized linear inversion (GLI). The parameters consist of the refractor velocity, and the velocity and thickness of the near-surface layer at all shot/receiver locations. The GLI solution for the parameters satisfies the requirement that the difference between the observed (picked) refracted arrival times and the estimated (modeled) times is minimum in the least-squares sense. The modeled times are computed using the traveltime equation for refracted arrivals for a flat refractor considered as the base of a weathering layer.

The GLI schemes that allow velocity and thickness of a near-surface layer to vary spatially require iterative strategies (Hampson and Russell, 1984; Schneider and Kuo, 1985; De Amorim et al., 1987). Starting with initial estimates for the near-surface layer velocity and thickness, and an initial estimate for the bedrock velocity, these parumeters are changed such that the difference between the observed (picked) refracted arrival times and the estimated (modeled) times is minimum in the least-squares sense. The GLI method is not only applicable to 2-D line recording but also to 3-D swath recording geometries (Baixas and Du Pont, 1988; Kircheimer, 1988). It is important to parameterize the near-surface layer parsimoniously while conforming with the basic assumptions required for the use of refacted arrivals in estimating the near-surface model.

There are several ways to paramcterize the near-surface layer. The most general formulation would include varying the weathering and the bedrock velocities and the thickness of the weathering layer at all shot/receiver locations. This, however, would require linearizing the problem and iterating over the estimated parameters (Hampson and Russell, 1984; Schneider and Kuo, 1985; De Amorim et al., 1987). In a simplified version of this general formulation, the weathering velocity may be fixed and is assumed to be known. This leaves the weathering thickness and bedrock velocity as spatially varying parameters. A further simplification may be made by defining a polynomial as a function of the space variable for the bedrock velocity (Farrell and Euwema, 1984). In practice, we often find that iterative GLI schemes suffer from
stability problems. When an inversion scheme leads to unstable solutions, the most likely reason is the ill-posed nature of the problem.

In this section, two robust parameterizations of the near-surface layer are presented and the GLI method is used to estimate the associated parameters. In each, we assume that the near-surface is made up of a single weathering layer with a significant velocity contrast at its base. The varable-thickness scheme allows the thickness of the weathering layer to vary spatially, while assuming a fixed known value for the weathering velocity. The bedrock velocity, however, is included in the parameterization and is assumed to be constant. The vartable-velocity scheme a)lows the weathering velocity to vary spatially, while fixing the refractor position at a specified depth. The bedrock velocity, again, is treated as a parameter to be estimated and is asssumed to be constant. We find that in many field data applications, these two inversion schemes are able to remove long-wavelength statics variations from the data.

We want to describe the near-surface with minimal parameterization and consider the model shown in Figure 3.4-13. The traveltime $t_{\gamma j}^{\prime}$ for the refracted raypath from the shot location $S$, to the receiver location $R_{2}$ is given by

$$
t_{i j}^{\prime}=t_{S_{3} B}+t_{B C}+t_{C R_{2}}
$$

The first and the third terms are associated with the raypaths within the weathering layer and the second term is associated with the raypath within the bedrock along the refractor. In Figure 3.4-13, $\theta_{c}$ is the critical angle of refraction which is expressed in terms of the weathering and bedrock velocities by the relation $\theta_{c}=\sin ^{-1}\left(v_{w} / t_{b}\right)$. Also, as depicted in Figure 3.4-13, we assume a flat refractor. When refractor dip is taken into consideration, the problem cannot be readily linearized.

By rewriting equation (C-50), for a flat or near-flat refractor, we obtain

$$
t_{i}^{\prime}=\frac{S_{y} B}{v_{w}}+\frac{D E-D B-C E}{v_{b}}+\frac{C R_{i}}{v_{w}}
$$

By regrouping the terms, we get

$$
t_{v}^{\prime}=\left(\frac{S_{j} B}{v_{w}}-\frac{D B}{v_{b}}\right)+\left(\frac{C R_{z}}{v_{w}}-\frac{C E}{v_{b}}\right)+\frac{D E}{v_{b}}
$$

Finally, by rewriting equation ( $\mathrm{C}-52$ ) in terms of the near-surface parameters, we obtain the model equation for the refracted arrivals:

$$
t_{\imath j}^{\prime}=\frac{z_{j} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}+\frac{z_{i} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}+\frac{x_{2 j}}{v_{b}}
$$

In additon to asumming a flat refractor, we fix the bedrock velocity but retain it as a parameter to be estimated. Under these assumptions, equation (C-52) can be rewritten in the following form:

$$
t_{v j}^{\prime}=T_{j}+T_{\imath}+s_{b} x_{i j}, \quad(C-54)
$$

where

$$
\begin{aligned}
& T_{j}=\frac{z_{j} \sqrt{v_{b}^{2}-v_{w}^{2}}}{v_{b} v_{w}}, \\
& T_{i}=\frac{z_{t} \sqrt{v_{b}^{2}-v_{w}^{2}}}{t_{b} v_{w}}
\end{aligned}
$$

and

$$
s_{b}=1 / \nu_{b} .
$$

Note that $T_{\text {, and }} T_{1}$ are the intercept time anomalies at shot and receiver locations, respectively, and $s_{b}$ is the bedrock slowness. Hence, for $n$ shot/receiver stations the parameter vector is $\mathbf{p}:\left(T_{1}, T_{2}, \ldots, T_{n} ; s_{b}\right)$. We refer to the scheme based on equation (C-54) as the varable-thackness

GLI solution. Once the parameter vector $\mathbf{p}:\left(T_{1}, T_{2}, \ldots, T_{n} ; s_{b}\right)$ is estimated, then the thickness of the weathering layer below shot and receiver locations can be computed using equations (C55 ) and (C-56), respectively. For $m$ picks of $t_{\imath j}$, and $n+1$ parameters $\mathbf{p}:\left(T_{1}, T_{2}, \ldots, T_{n} ; s_{b}\right)$, we have the following set of equations:

$$
\left(\begin{array}{c}
\vdots \\
\vdots \\
\vdots \\
t_{\imath j}^{\prime} \\
\vdots \\
\vdots \\
\vdots
\end{array}\right)=\left(\begin{array}{llllll} 
& & & & & \\
\cdots & 1 & \cdots & 1 & \cdots & x_{\imath} \\
& & & & &
\end{array}\right)\left(\begin{array}{c}
\vdots \\
T_{2} \\
\vdots \\
T_{2} \\
\vdots \\
s_{b}
\end{array}\right)
$$

By writing these equations in matrix notation, we have

$$
\mathrm{t}^{\prime}=\mathrm{L} \mathbf{p}
$$

where $\mathbf{t}^{\prime}$ is the column vector of $m$-length on the left-hand side of equation ( $\left.\mathbf{C}-58\right), \mathbf{L}$ is the sparse matrix in the same equation with dimensions $m \times(n+1)$, and $\mathbf{p}$ is the column vector of $(n+1)$-length on the right-hand side of equation (C-58). Except for the three elements in each row, the $L$ matrix contains zeros. The GLI solution to equation (C-59) satisfies the requirement that the energy of the error vector

$$
e=t-t^{\prime}
$$

is minimum and is given by:

$$
\mathbf{p}=\left(\mathbf{L}^{\mathbf{T}} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T}} \mathbf{t}
$$

where $t$ denotes the column vector of $m$-length that represents the ohserved (picked) refracted arrival times, and $T$ denotes matrix transposition.

In summary, the variable-thickness scheme for refraction statics is as follows:

(1) Assume a value for the weathering velocity $v_{w}$. This can be varied spatially based on available uphole information.

(2) Estimate the parameter vector $\mathbf{p}:\left(T_{1}, T_{2}, \ldots, T_{n} ; s_{b}\right)$, hence compute the intercept time anomalies at shot/receiver locations and the bedrock slowness by solving equation (C-61).

(3) Solve equations (C-55) and (C-56) for the weathering layer thickness at shot and receiver stations, respectively.

The shape of the weathering layer derived from the variable-thickness scheme strictly depends on the assumed value for the weathering velocity. To demonstrate this important aspect of the variable-thickness scheme, consider the near-surface model in Figure C-4a with a flat refractor R1, and constant weathering and bedrock velocities. We use equation (C-53) and compute the refracted arrival times associated with shot/receiver locations as indicated in Figure C-4a. Then we use these arrival times in equation (C-61) and assume a value for the weathering velocity different from its trie value to estimate the thickness of the weathering layer at all shot/receiver stations. Figures C-4b,c show the estimated refractor shapes R2, R.3 for two different weathering velocities. Note the significant departure from the true refractor shape R.1. Results of Figure C-4 clearly demonstrate that the estimated refractor shape using the variable-thickness scheme (whether it is based on GRM or GLI) does not yield the true refractor shape. Instead, the uncertainty in weathering velocity significantly influences the implied refractor shape.

We now consider an alternative parameterization for the near-surface model. We assume a flat base of weathering as in Figure 3.4-13. This assumption makes the weathering thickness a known quantity in equation (C-53), and leaves the weathering and bedrock velocities as unknown parameters to be estimated. We take the similar view as in the variable-thickness scheme, and
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0470.jpg?height=384&width=762&top_left_y=126&top_left_x=138)

FIG. C-4. (a) A single-layered near-surface model with a flat refractor $\mathbf{R l}_{i} v_{w}=3000 \mathrm{f} / \mathrm{s}, v_{b}=9000$ $\mathrm{f} / \mathrm{s}$. Shot locations are denoted by $\mathrm{x}$ and receiver locations are denoted by the vertical bars. Traveltimes computed from the model in (a) and equation (C-53) are put into the varuable-thickness GLI inversion scheme (equation 2-5) to obtain the results shown in (b) where the weathering velocity is assumed to be $3500 \mathrm{f} / \mathrm{s}$, and (c) where the weathering velocity is assumed to be $2500 \mathrm{f} / \mathrm{s}$. The estimated refractor shapes are denoted by $\mathrm{R} 2$ and $\mathrm{R} 3$. Note the departure from the true location of the flat refractor $\mathrm{R} 1$ due to the uncertainty in the weathering velocity.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0470.jpg?height=400&width=764&top_left_y=690&top_left_x=136)

FIG. C-5. (a) Same model as in Figure C-4a. (b) Results of the variable-velocity GLI inversion scheme (equation 2-13) using the traveltimes computed from equation (C-53) and the model in (a) with an assumed refractor position $\mathrm{R} 2$ that is different from the true position $\mathrm{R} 1$ of the reftactor. The true weathering and bedrock velocities, $v_{w}$ and $v_{b}$, are $3000 \mathrm{f} / \mathrm{s}$ and $9000 \mathrm{f} / \mathrm{s}$, respectively. Shot locations are denoted by $x$ and receiver locations are denoted by vertical bars. While the GLI inversion yields the true refractor velocity, note the spatially varying adjustment of the weathering velocity to the change of the refractor position from $\mathrm{R} 1$ to $\mathrm{R} 2$ to compensete for the thickness R.1-R2.
further assume the bedrock velocity to be a constant parameter. Under these implicit constraints, equation (C-53) takes the form

$$
t_{i j}^{\prime}=\alpha_{j} z_{j}+\alpha_{2} z_{\imath}+s_{6} x_{\imath j},
$$

where

$$
\begin{gathered}
\alpha_{J}=\sqrt{s_{w J}^{2}-s_{b}^{2}}, \\
\alpha_{2}=\sqrt{s_{w i t}^{2}-s_{b}^{2}}, \\
s_{w}=1 / \psi_{w}
\end{gathered}
$$

and

$$
s_{b}=1 / v_{b}
$$

Hence, for $n$ shot/receiver stations, the parameter vector is $\mathbf{p}:\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n} ; s_{b}\right)$. We refer to the scheme based on equation (C-62) as the varable-velocrty GLI solution. Once the parameter vector $\mathbf{p}:\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n} ; s_{b}\right)$ is estimated, then the weathering velocity below shot and receiver locations can be computed using equations (C-63) and (C-64), respectively. For $m$ picks of $t_{z}$, and $n+1$ parameters $\mathbf{p}:\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n} ; s_{b}\right)$, we have the following set of equations:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0471.jpg?height=198&width=385&top_left_y=560&top_left_x=326)

We write these equations in matrix notation as in equation (C-59), where $\mathrm{t}^{\prime}$ is the column vector of $m$-length on the left-hand side of equation (C-67), $L$ is the sparse matrix in the same equation with dimensions $m \times(n+1)$, and $\mathbf{p}$ is the column vector of $(n+1)$-length on the right-hand side of equation (C-67). Except for the three elements in each row, the $\mathbf{L}$ matrix contains zeros. The GLI solution is given by equation (C-61) where the $\mathbf{L}$ matrix is defined as in equation (C-67).

In summary, the variable-velocity scheme for refraction statics is as follows:

(1) Specify a flat datum to which shot and receivers are to be lowered along vertical raypaths.

(2) Estimate the parameters: $\mathbf{p}:\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n} ; s_{b}\right)$ using the GLI solution given by equation (C-61) where the $L$ matrix is defined as in equation (C-67).

(3) Solve equations (C-63) and (C-64) for the weathering velocity at shot and receiver stations, respectively.

The estimated weathering velocity from the variable-velocity scheme depends on the assumed refractor position. Consider the near-surface model in Figure C-5a, with a flat refractor $\mathrm{R} 1$, and constant weathering and bedrock velocities. We use equation (C-53) and compute the refracted arrival times associated with shot/receiver locations as indicated in Figure C-5a. We then use these arrival times in equation (C-61) and assume a refractor position $\mathbf{R} 2$ to estimate the weathering velocity at all shot/receiver stations. Figure C-5b shows the estimated weathering velocity which departs from the true value $v_{w}$. The difference arises from compensating for the difference between the true refractor position $\mathrm{Rl}$ and the assumed refractor position R.2 (Figure C-5a).

In equations ( $\mathrm{C}-58$ ) and ( $\mathrm{C}-67$ ), we made no distinction between a shot and a receiver if they occupy the same location on the surface. This strictly surface-consistent solution is of course not valid for a dynamite source. However, shots can be brought up to surface with an uphole correction prior to setting up equations (C-58) and (C-67).

For most field data applications, both the variable-thickness and the variable-velocity schemes yield comparable staties solutions. The solution from the variable-thickness scheme is sensitive to the uncertainty in weathering velocity, and the solution from the variable-velocity scheme is influenced by the assumed depth of the flat refractor.

## C. 9 Refraction Traveltime Tomography

Return to equation (C-52) and re-express it in the following manner (De Amorim et al., 1987):

$$
t_{i j}^{\prime}=s_{w j} Z_{j}+s_{w 1} Z_{t}+s_{b} X_{i j}
$$

where

$$
\begin{gathered}
Z_{j}=\frac{z_{j}}{\cos \theta_{j}}, \\
Z_{i}=\frac{z_{2}}{\cos \theta_{2}}, \\
X_{2 j}=x_{2 j}-z_{j} \tan \theta_{j}-z_{2} \tan \theta_{1}, \\
s_{w}=\frac{1}{v_{w}},
\end{gathered}
$$

and

$$
s_{b}=\frac{1}{v_{b}}
$$

In matrix form, equation (C-68) now is writter as follows:

$$
\left(\begin{array}{c}
\vdots \\
\vdots \\
\vdots \\
t_{\imath}^{\prime} \\
\vdots \\
\vdots \\
\vdots
\end{array}\right)=\left(\begin{array}{cccccc} 
\\
\cdots & Z_{2} & \cdots & Z_{1} & \cdots & X_{v \jmath} \\
& & & & &
\end{array}\right)\left(\begin{array}{c}
\vdots \\
s_{w j} \\
\vdots \\
s_{w s} \\
\vdots \\
s_{b}
\end{array}\right)
$$

Consider an initial estimate of the parameter vector $\mathbf{p}:\left(\cdots, s_{w}, \cdots, s_{w r}, \cdots, s_{b}\right)$. We want to minimize the difference between the observed and the modeled times by iteratively perturbing the initial estimate of the parameter vector. A change $\Delta p$ in the paramater vector will change the modeled times as follows:

$$
\left[t_{\imath j}^{\prime}\right]_{\text {modeled }}=\left[t_{\imath j}^{\prime}\right]_{\text {mittal }}+\left[\frac{\partial t_{\imath j}^{\prime}}{\partial p}\right]_{\text {modeled }} \Delta p .
$$

The error in modeling the traveltimes is given by

$$
e_{2 j}=\left[t_{2 j}\right]_{\text {observed }}-\left[t_{2 j}^{\prime}\right]_{\text {madeled }}
$$

Substitute equation (C-71) into equation (C-72) to obtain

$$
e_{i j}=\left[t_{\imath j}\right]_{\text {obgerved }}-\left[t_{\imath j}^{\prime}\right]_{\text {mitial }}-\left[\frac{\partial t_{i j}^{\prime}}{\partial p}\right]_{\text {modeled }} \Delta p
$$

Now define the difference $\Delta t_{\imath}$ between the observed traveltimes $t_{\imath j}$ and the initial estimate of the modeled traveltimes $t_{i j}^{\prime}$, and rewrite equation (C-73) to get

$$
e_{\imath \jmath}=\Delta t_{\imath \jmath}-\frac{\partial t_{\imath \jmath}^{\prime}}{\partial p} \Delta p
$$

The second term on the right is the amount of change in $\Delta t_{i j}$ as a result of the change in the parameter $\Delta p$. Define this term as $\Delta t_{1 y}^{\prime}$, and rewrite equation (C-74) once more to obtain

$$
e_{\imath}=\Delta t_{\imath}-\Delta t_{\imath}^{\prime}
$$

where

$$
\Delta t_{\mathfrak{v} j}^{\prime}=\frac{\partial t_{\mathfrak{v}}^{\prime}}{\partial p} \Delta p
$$

The derivatives $\partial t_{2 j}^{\prime} / \partial p$ in equation (C-76) can be computed by differentiating the model equation ( $\mathrm{C}-68$ ) with respect to each of the paraneters:

$$
\begin{aligned}
& \frac{\partial t_{\mathfrak{v}}^{\prime}}{\partial s_{w j}} \equiv Z_{j}, \\
& \frac{\partial t_{\imath j}^{\prime}}{\partial s_{w / 1}} \equiv Z_{v},
\end{aligned}
$$

and

$$
\frac{\partial t_{\imath \jmath}^{\prime}}{\partial s_{b}} \equiv X_{2 \jmath}
$$

These then are substituted back into the right-hand side of equation (C-76) to get

$$
\Delta t_{i j}^{\prime}=Z_{j} \Delta s_{w j}+Z_{\imath} \Delta s_{w_{2}}+X_{\imath j} \Delta s_{b} .
$$

Examine the structure of equation (C-78) and note that, instead of modeling refraction traveltimes by way of equation ( $\mathrm{C}-68$ ), we can model the change in traveltimes by way of equation (C-78), and thus estimate the near-surface parameters. Hence, for $n$ shot/receiver stations, the parameter vector is $\Delta \mathbf{p}:\left(\Delta s_{w 1}, \Delta s_{w 2}, \cdots, \Delta s_{w n n}, \Delta s_{b}\right)$. We refer to the scheme based on equation (C-78) as the terateve GLI solution. For $m$ picks of $t_{2}$, and $n+1$ parameters $\Delta \mathbf{p}:\left(\Delta s_{w 1}, \Delta s_{w 2}, \cdots, \Delta s_{w n}, \Delta s_{b}\right)$, we have the following set of equations:

$$
\left(\begin{array}{c}
\vdots \\
\vdots \\
\vdots \\
\Delta t_{\imath \jmath}^{\prime} \\
\vdots \\
\vdots \\
\vdots
\end{array}\right)=\left(\begin{array}{llllll} 
\\
\cdots & Z_{3} & \cdots & Z_{\imath} & \cdots & X_{\imath \jmath}
\end{array}\right)\left(\begin{array}{c}
\vdots \\
\Delta s_{w j} \\
\vdots \\
\Delta s_{w\}} \\
\vdots \\
\Delta s_{b}
\end{array}\right) .
$$

We write these equations in matrix notation as in equation (C-59) to obtain

$$
\Delta \mathrm{t}^{\prime}=\frac{\partial \mathbf{t}^{\prime}}{\partial \mathbf{p}} \Delta \mathrm{p}
$$

or

$$
\Delta \mathbf{t}^{\prime}=\mathrm{L} \Delta \mathrm{p}
$$

where $\Delta \mathbf{t}^{\prime}$ is the column vector of m-length on the left-hand side of equation (C-79), $\mathrm{L}$ is the sparse matrix in the same equation with nonzero elements as the partial derivatives $\partial t^{\prime} / \partial p$ and with dimensions $m \times(n+1)$, and $p$ is the column vector of $(n+1)$-length on the right-hand side of equation (C-79). Except for the three elements in each row, the $\mathbf{L}$ matrix contains zeros,

The GLI solution to equation (C-81) satisfies the requirement that the energy of the error vector

$$
\mathbf{e}=\Delta \mathrm{t}-\Delta \mathrm{t}^{\prime}
$$

is minimum and is given by

$$
\Delta \mathbf{p}=\left(\mathbf{L}^{\mathbf{T}} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T}} \Delta t,
$$

where $\Delta t$ denotes the column vector of $m$-length that represents the difference between the observed (picked) refracted arrival times and the initial estimate of the modeled times, and $T$ denotes matrix transposition.

In summary, the iterative scheme for refraction statics is as follows:

(a) Specify a flat datum to which shot and receivers are to be lowered along vertical raypaths.

(b) Also specify a set of initial model parameters $\mathbf{p}:\left(s_{w: 1}, s_{w 2}, \cdots, s_{w n}, s_{b}\right)$.

(c) Compute $\Delta t_{5 j}$, the time difference between the picked (observed) times $t_{5 j}$ and the initial modeled times $t_{t j}^{\prime}$.

(d) Estimate the change in parameters: $\Delta \mathbf{p}:\left(\Delta s_{w 1}, \Delta s_{w 2}, \cdots, \Delta s_{w n}, \Delta s_{b}\right)$, by way of the GLI solution given by equation (C-83).

(e) Update the paramater vector $\mathbf{p}+\Delta \mathbf{p}$, and compute new modeled times $t_{i j}^{\prime}$.

(f) Iterate steps (c), (d), and (e) to get a final estimate of the parameter vector $\mathbf{p}$.

The parameter vector for the iterative scheme described above comprises laterally varying weathering velocity and a constant bedrock velocity. Depth to the refractor is assumed to be known. An alternative parameterization of the near-surface model may involve estimating a laterally varying weathering velocity and depth to the refractor while assuming a known value for the bedrock velocity.

Rearrange the terms in equation (C-62):

$$
t_{\imath j}^{\prime \prime}=t_{\imath j}^{\prime}-s_{b} x_{1 j}
$$

so that

$$
t_{i j}^{\prime \prime}=T_{j}+T_{i}
$$

Equation (C-84) implies that, in this scheme, we deal with picked times that have been linearmoveout corrected using the assumed value for the bedrock velocity. By way of equations ( $\mathrm{C}-55$ ) and (C-56), equation (C-85) is expressed as follows:

$$
t_{y j}^{\prime \prime}=z_{j} \sqrt{s_{w j}^{2}-s_{b}^{2}}+z_{z} \sqrt{s_{w t}^{2}-s_{b}^{2}}
$$

Compute the partial derivatives of the parameters to be estimated - depth to refractor and weathering velocity at shot and receiver locations:

$$
\begin{aligned}
& \frac{\partial t_{i j}^{\prime \prime}}{\partial z_{j}}=\sqrt{s_{w j}^{2}-s_{b}^{2}} \equiv Z_{j}, \\
& \frac{\partial t_{i j}^{\prime \prime}}{\partial z_{k}}=\sqrt{s_{w i}^{2}-s_{b}^{2}} \equiv Z_{i}
\end{aligned}
$$

$$
\frac{\partial t_{t j}^{\prime \prime}}{\partial s_{w j}}=\frac{z_{j} s_{w j}}{\sqrt{s_{w j}^{2}}-s_{b}^{2}} \equiv S_{w j}
$$

and

$$
\frac{\partial t_{2}^{\prime \prime}}{\partial s_{t i n}}=\frac{z_{2} s_{w i}}{\sqrt{s_{w 1}^{2}-s_{b}^{2}}} \equiv S_{w 11}
$$

Now rewrite equation (C-76) in terms of the new variable $t^{\prime \prime}$ to obtain

$$
\Delta t^{\prime \prime}=\frac{\partial t^{\prime \prime}}{\partial p} \Delta p
$$

and substitute equations $(2-49 \mathrm{a}, \mathrm{b}, \mathrm{c}, \mathrm{d})$ to get the model equation

$$
\Delta t^{\prime \prime}=Z_{3} \Delta z_{3}+Z_{2} \Delta z_{2}+S_{w 3} \Delta s_{w 3}+S_{w_{2}} \Delta s_{w 3}
$$

Finally, similar to equation (C-79), we have the following set of equations:

$$
\left(\begin{array}{c}
\vdots \\
\vdots \\
\Delta t_{2 j}^{\prime \prime} \\
\vdots \\
\vdots \\
\vdots
\end{array}\right)=\left(\begin{array}{lllllllll} 
\\
\cdots & z_{j} & \cdots & z_{2} & \cdots & S_{w,} & \cdots & S_{w 1} & \cdots \\
& & & & & & & &
\end{array}\right)\left(\begin{array}{c}
\vdots \\
\Delta z_{j} \\
\vdots \\
\Delta z_{1} \\
\vdots \\
\Delta s_{w, j} \\
\vdots \\
\Delta s_{1 z 2} \\
\vdots
\end{array}\right) .
$$

Follow the steps which involve equations (C-80) through (C-83) to estimate the paraneter vector $\mathbf{p}:\left(\cdots, z_{j}, \cdots, z_{t}, \cdots, s_{w j}, \cdots, s_{w 1}\right)$.

## C. $10 L_{1}$-Norm Refraction Statics

The generalized linear inversion method applied to residual and refraction statics is based on minimization of the quantity

$$
E=\sum_{i j}\left\|t_{i j}-t_{i j}^{\prime}\right\|^{2}
$$

where $t_{33}$ are the actual traveltime picks and $t_{2 j}^{\prime}$ are the modeled traveltimes defined by equation (C-24a) for residual statics and (C-54) for refraction statics.

The minimization norm defined by equation (C-91) is formally referred to as the $L_{2}$ norm. For statics applications, it may be desirable to use the $L_{1}$ minimization norm defined by

$$
E=\sum_{v j}\left\|t_{i j}-t_{i j}^{\prime}\right\|
$$

Outliers in picked times can cause biased results from the $L_{2}$-norm, whereas, they may be better handled by the $L_{1}$-norm schemes. The $L_{2}$-norm solutions to equations (C-24a) and (C-54) are expressed by the generalized linear inversion formula (equations $\mathrm{C}-28$ or $\mathrm{C}-61$ ). Whereas, the $L_{1}$-norm solution is based on linear programming techniques (Press et al., 1987) and will not be dealt with here. Instead, we shall refer to model experiments and a field data example for the $L_{1}$-norm refraction statics corrections.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0476.jpg?height=464&width=644&top_left_y=126&top_left_x=196)

L-1 Norm Statics

FIG. C-6. CMP stack associated with the model data in Figure 3.4-14 (a) with refraction statics corrections using the $L_{1}$-norm, (b) section as in (a) after residual statics corrections $u s i n g$ the $L_{1}$-norm. Compare with the L2-norm results in Figure 34-17.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0476.jpg?height=425&width=374&top_left_y=802&top_left_x=157)

FIG. C-7. Summary of the $L_{1}$-norm solution for refraction statics associated with the CMP stacked section in Figure 34-15a. Plot direction is the same as that in Figure 3.4-15. Except in frame 1 , shot attributes are denoted with $x$ and receiver attributes are denoted with vertical bars. Estimated parameters are intercept time anomalies and are plotted in frame 1 with no distinction made between shot and receiver locations.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0477.jpg?height=267&width=556&top_left_y=128&top_left_x=239)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0477.jpg?height=249&width=554&top_left_y=410&top_left_x=239)

L1-Norm Statics

(b)

FIG. C-8. CMP stack associated with the model data in Figure 3.421 (a) with refraction statics corrections using the $L_{1}$-norm, (b) section as in (a) after residual statics corrections using the $L_{1}$-norm. Compare with the L2-norm results in Figure 3.4-26.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0477.jpg?height=355&width=318&top_left_y=870&top_left_x=148)

FIG. C-9. Surnmary of the $L_{1}$-norm solution for refraction statics associated with the CMP stacked section in Figure 3.4-26a. Plot direction is the same as that in Figure 3 4-26. Except in frame 1, shot attributes are denoted with $x$ and receiver attributes are denoted with vertical bars, Estimated perameters are intercept time anomaiies and are plotted in frame 1 with no distinction made between shot and receiver locations.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0478.jpg?height=554&width=732&top_left_y=131&top_left_x=148)

FIG. C-10. The CMP stacked section of the data in Figure 3.4-29 (a) after refraction statics using an $L_{1}$-norm scheme for refraction statics, and (b) followed by residual statics corrections. Compare with Figure 3.4-29 and note the significant improvement of CMP stacking as a result. of resolving both longand short-wavelength statics anomalies by refraction and residual statics corrections, respectively. Also, compare with Figure 3.4-32 and note that the results of $L_{1^{-}}$and $L_{2^{-}}$norm statics solutions, in this case, yield very similar results.

Consider the single-layered near-surface model shown in Figure 3.4-14. Figure C-6 shows results of refraction and residual statics corrections using the $L_{1}$-norm. Note that these results are comparable to those obtained from $L_{2}$-norm minimization (Figure 3.4-17).

The results of the $L_{1}$-norm statics estimates are summarized in Figure C-7. Compare with those of the $L_{2}$-norm solution in Figure 3.4-18 and note that the statics solutions exhibit minor differences, although the resulting stacked sections are almost identical. Frame 1 shows the estimated intercept time anomalies (equations $3-53 \mathrm{a}, \mathrm{b}$ ), as a function of the shot-receiver station number. Frame 2 shows the pick fold, namely the number of picks in each shot (denoted by $x$ ) and receiver (denoted by the vertical bars) gather.

A quantitative measure of the accuracy of the $L_{1}$-norm solution to refraction statics is the sum of the differences between the observed picks $t_{3 j}$ and the modeled traveltimes $t_{i,}^{\prime}$ (equation C-91b) over each shot and receiver gather. These residual time differences are plotted in frame 3 of Figure C-7. Large residuals often are related to bad picks. Nevertheless, even with good picks, there may be large residuals attributable to inappropriateness of the model assumed for the near-surface.

Figure C-7 also shows the estimated weathering thicknesses at all shot-receiver stations (frame 4). Finally, the computed staties and the near-surface model are shown in frames 5 and 6 , respectively.

Now consider the multilayered near-surface model shown in Figure 3.4-21. Figure C-8 shows results of refraction and residual statics corrections using the $L_{\mathbf{1}}$-norm solution. Again, results are comparable to those obtained from $L_{2}$-norm minimization (Figure 3.4-26).

Results of the $L_{1}$-norm refraction statics solution are summarized in Figure C-9. Compare with those of the $L_{2}$-norm solution in Figure 3.4-27 and note that the statics solutions and the resulting stacked sections are virtually identical. Although the actual near-surface model consists of several layers (Figure 3.4-21a), the $L_{1}$-norm solution is based on a single layer with a constant velocity of $1400 \mathrm{~m} / \mathrm{s}$ as for the $L_{2}$-norm solution (Figure 3.4-27). In Figure C-9, Frame 1 shows the estimated intercept time anomalies (equation 3-53a,b), as a function of the shot-receiver station number. Frame 2 shows the pick fold, namely the number of picks in each shot (denoted by $\times$ ) and receiver (denoted by the vertical bars) gather. The sum of the differences between the observed picks $t_{3}$ and the modeled traveltimes $t_{\imath 3}^{\prime}$ (equation G-91b) over each shot and receiver gather is shown in frame 3 . Large residuals, in this case, are attributable to inappropriateness of the model assumed for the near-surface. Figure C-9 also shows the estimated weathering thicknesses at all shot-receiver stations (frame 4). Finally the computed statics and the nearsurface model are shown in frames 5 and 6 , respectively. Whatever the inversion norm, the important point is how the near-surface model is parameterized and how close it is to the real situation.

Figure C-10 shows the results of refraction and residual statics corrections applied to field data as in Figure 3.4-29 using the $L_{1}$-norm solution. The results are comparable to those obtained from $L_{2}$-norm minimization (Figure 3.4-32).

## REFERENCES

Al-Chalabi, M., 1973, Series approximations in velocity and traveltime computations: Geophys. Prosp., 21, 783-795.

Baixas, F. and Du Pont, R., 1988, Practical view of 3-D refraction statics: 58th Ann. Internat. Mtg., Soc. Expl. Geophs., Expanded Abstracts, 787-790.

Bevc, D., 1997 , Flooding the topography: Wave-equation datuming of land data with rugged topography: Geophysics, 62, 1558-1569.

Castle, R. J., 1994, A theory of normal moveout: Geophysics. 59, 983-999.

Claerbout, J. F., 1978, How to derive interval velocities using a pencil and straight edge: Stanford Expl. Proj., Rep. No. 14.

De A morim, W. N., Hubral, P. and Tygel, M., 1987, Computing field statics with the help of seismic tomography: Geophys. Prosp., 35, 907-919.

De Bazelaire, E., 1988, Normal moveout revisited: Inhomogeneous media and curved interfaces: Geophysics, 53, 143-157.

Dix, C. H., 1955, Seismic velocities from surface measurements: Geophysics, 20, 68-86.

Dobrin. M. B., 1960, Introduction to geophysical prospecting: McGraw-Hill Book Co.

Farrell, R. C. and Euwema, R. N., 1984, Refraction Statics: Proc. Inst. Electr. Electron. Eng., 72, 1316-1329.

Grant, F. S. and West, G. F., 1965, Interpretation theory in applied geophysics: McGraw-H.ll Book Co.

Gulunay, N., 1985, A new method for the surface-consistent decomposition of statics using diminishing residual matrices (DRM): 55th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 293-295.

Hagedoorn, J. G., 1959, The pltts-munus method of interpreting seismic refraction sections: Geophys Prosp., 7, 158-182.

Hampson, D. and Russell, B., 1984, First-break interpretation using generalized inversion: J. Can. Soc. Explor. Geophys., 20, 40-54

Hileman, J. A., Embree, P., and Pfieuger, J. C., 1968, Automatod static corrections: Geophys. Prosp., 16, 326-358.

Hill, R. N., 1987, Downward continuation of refracted arrivals to determine shallow strucutre: Geophysics, 52, 118\&-1198.

Hill, R. N. and Wuenschel, P. C., 1985, Numerical modeling of refraction arrivals in complex aress: Geophysics, 50, 90-98.

Hubral, P and Krey, T., 1980, Interval velocities from sensmic reflection time measurcments: Soc. Expl. Geophys.

Kircheimer, F, 1988, 3-D Refraction statics by weighted least-squares inversion: 59th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 794-797.

Levin, F. K , 1971, Apparent velocity from dipping interface reflections: Geophysics, 36, 510-516.

Lines, L. R. and Treitel, S., 1984, Tutorial: A review of leest-squares inversion and its application to geophyiscal problems: Geophys. Prosp., 32, 159-186.

Neidell, N. S, and Taner, M. T., 1971, Semblance and other coheroncy measures for multichannel data: Geophysics, 34, 482-497.

Nur, A., 1981, Physical properties of rocks: Soc. Expl. Geophys. Continuing Education Course Notes.

Palmer, D., 1981, The gencralized reciprocal method of refaction seismic interpretation: Geophysics, 46, 1508-1518.

Press, W. H., B. P. Flannery, S. A. Teukolsky and W. A. Vettering, 1987: Numerical recipes The art of scientific computing, Cambridge University Press.

Ronen, J. and Claerbout, J. F., 1985, Surface-consistent residual statics estimation by stack-power maximization: Geophysics, 50, 2759-2767.

Schneider, W. A., 1971, Developments in seismic data procossing and analysis (1968-1970): Gcophysics, 36 , 1043-1073.

Schneider, W. A. and Kuo, S., 1985, Refraction modeling for statics corrcctions: 55th Ann Internat. Mtg,, Soc. Expl. Geophys., Expanded Abstracts, 295-299.

Sheriff, R. E., 1976, Inferring stratigraphy from seismic data: Am. Assn. Petr. Geol. Bull, 60, $528-542$.

Sherwood, J. W. C. and Poe, P. H., 1972, Constant velocity stack and selsmic wavelet processing: Geophysics, 37, 769-787.

Slotnıc, M. M., 1959, Lessons in seismic computing: Soc. Expl. Geophys.

Taner, M. T. and Koehler, F., 1969, Velocity spectra - digital computer derivation and applications of velocity functions: Geophysics, $39,859-881$.

Taner, M. T., Koehler, F, and Alhilali, K. A., 1974, Estimstion and correction of near-surface time anomalies: Geophysics, 41, 441-463.

Taner, M. T., Wagner, D. E., Baysal, E., and Lu, L., 1998, A untfied method for 2-D and 3-D refraction staitcs: Geophysics, 63, 1-15.

Thore, P. D, and Kelly, P., 1992, Stack enhancement using the three-term equation: Synthetic and real data examples: 62 nd Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1550-1553.

Wiggins, R. A., Larner, K. L., and Wisecup, R. D., 1976, Residual statics analysis as a general linear inverse problem: Geophysics, 41, 922-938.

## 4 Migration

- Introduction $\cdot$ Exploding Reflectors $\bullet$ Migration Strategies $\bullet$ Migration Algorithms $\bullet$ Migration Parameters $\bullet$ As pects of Input data $\bullet$ Migration Velocities $\bullet$ Migration Principles - Kirchhoff Migration $\bullet$ Diffraction Summation - Amplitude and Phase Factors - Kirchhof Summation - Finite-Difference Migration - Downward Continuation Differencing Schemes $\cdot$ Rational Approximations for Implicit Schemes $\cdot$ Reverse Time Migration - Frequency-Space Implicit Schemes $\cdot$ Frequency-Space Explicit Schemes - Frequency-Wavenumber Migration - Phase-Shift Migration - Stolt Migration - Summary of Domains of Migration Algorithms - Kirchhoff Migration in Practice Aperture Width $\cdot$ Maximum Dip to Migrate $\cdot$ Velocity Errors $\cdot$ Finite-Difference Migration in Practice $\cdot$ Depth Step Size - Velocity Errors $\cdot$ Cascaded Migration $\cdot$ Reverse Time Migration $\cdot$ Frequency-Space Migration in Practice $\cdot$ Steep-Dip Implicit Methods $\cdot$ Depth Step Size $\cdot$ Velocity Errors $\cdot$ Steep-Dip Explicit Methods - Dip Limits of Extrapolation Filters $\cdot$ Velocity Errors - Frequency-Wavenumber Migration in Practice $\cdot$ Maximum Dip to Migrate $\bullet$ Depth Step Size $\cdot$ Velocity Errors $\cdot$ Stolt Stretch Factor $~$ Wraparound - Residual Migration $\cdot$ Further Aspects of Migration in Practice $\cdot$ Migration and Spatial Aliasing $\cdot$ Migration and Random Noise - Migration and Line Length - Migration from Topography $\bullet$ Exercises $\cdot$ Appendix D: Mathematical Foundation of Migration - Wavefield Extrapolation and Migration - Stationary Phase Approximations - The Parabolic Approximation - Frequency-Space Implicit Schemes $\bullet$ Stable Explicit Extrapolation - Optimum Depth Step $\cdot$ Frequency-Wavenumber Migration $\bullet$ Residual Migration $\bullet$ References


### 4.0 INTRODUCTION

Migration moves dipping refloctions to their true subsurface positions and collapses diffractions, thus increasing spatial resolution and yielding a sewmic mage of the subsurface. Figure 4.0-1 shows a CMP-stacked section before and after migration. The stacked section indicates the presence of a salt dome flanked by gently dipping strata. Figure 4.0-1 also shows a sketch of two prominent features - the diffraction hyperbola $D$ that originates at the tip of the sait dome, and the reflection $B$ off the fank of the salt dome. After migration, note that the diffraction has collapsed to its apux $P$ and the dipping event has moved to a subsurface location $A$, which is at or near the salt dome flank. In contrast, reflections associated with the gently dipping strata have moved little after migration.

Fignre 4,0-2 is an example with a different type of structural feature. The stack contains a zone of nearhorizontal reflections down to $1 \mathrm{~s}$. After migration, these events are virtually unchanged. Note the prominent unconformity that represents an ancient erosional surface just below $1 \mathrm{~s}$. On the stacked section, the unconformity appears complex, while on the migrated section, it becomes interpretable. The bowties on the stacked section are untied and turned into synclines on the mi-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0482.jpg?height=316&width=244&top_left_y=117&top_left_x=169)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0482.jpg?height=315&width=232&top_left_y=118&top_left_x=408)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0482.jpg?height=315&width=226&top_left_y=119&top_left_x=641)

(c)

FIG. 4.0-1. A CMP stack (a) before, (b) after migration; (c) sketch of a prominent diffraction $D$ and a dipping event before (B) and after (A) migration. Migration moves the dipping event B to its assumed true subsurface position A and collapses the diffraction $D$ to its apex $P$. The dotted line indicates the boundary of a salt dome.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0482.jpg?height=267&width=352&top_left_y=582&top_left_x=114)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0482.jpg?height=263&width=348&top_left_y=879&top_left_x=117)

(b)

FIG. 4.0-2. A CMP stack (a) before, (b) after mgration. Mygation unties the bowties on the stacked section and turns them into synclnes (Taner and Koehler, 1977). grated section. The deeper event in the neighborhood of $3 \mathrm{~s}$ is the multiple associated with the unconformity above. When treated as a primary and migrated with the primary velocity, it is overnigrated.

Figure 4.0-3a shows a stacked section that contains fault-plane reflections conflicting with the shallow gently-dipping reflections. Note the accurate positioning of the fault planes and delineation of the fault blocks on the migrated section in Figure 4.0-3b. From the three examples shown in Figures 4.0-1, 4.0-2, and $4.0-3$, note that migration moves dipping events in the updip direction and collapses diffractions, thus enabling us to delineate faults while retaining horizontal events in their original positions.

The goal of migration is to make the stacked section appear similar to the geologic cross-section in depth along a seismic traverse. The migrated section, however, commonly is displayed in time. One reason for this is that velocity estimation based on seismic and other data always is limited in accuracy. Therefore, depth conversion is not completely accurate. Another reason is that interpreters prefer to evaluate the validity of migrated sections by comparing them to the unmigrated data. Therefore, it is preferable to have both sections displayed in time. The migration process that produces a migrated time section is called tame mugration. Time migration, the main theme of Chapter 4 , is appropriate as long as lateral velocity variations are mild to moderate.

When the lateral velocity gradients are significant, time migration does not produce the true subsurface image. Instead, we need to use depth magntion, the output

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0483.jpg?height=1013&width=753&top_left_y=136&top_left_x=137)

FIG. 4.0-3. A CMP stack (a) before, (b) after migration. Migration collapses subtle diffractions associated with the growth faults, moves the fault-plane reflections to the fault poeitions, and thus makes detailed structural interpretation easier.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0484.jpg?height=497&width=650&top_left_y=123&top_left_x=195)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0484.jpg?height=467&width=641&top_left_y=629&top_left_x=198)

FIG. 4.0-4. A CMP stack (a) before, (b) after time migration. Time migration is adequate for accurate imaging o top-salt boundary, whereas depth migration is imperative for accurate imaging of the base-salt boundary (B).
of which is a depth section. Consider the data from an area with intense salt tectonics in Figure 4.0-4. Time migration has produced an acceptable image of the region above the salt. However, note the crossing of events that is a manifestation of overmigration of the reflection associated with the base-salt boundary (denoted by $B$ in Figure 4.0-4b). The improper migration is the result of inadequate treatment by the time migration of the effects of severe raypath bendings at the top-balt boundary caused by the strong velocity contrast between the selt layer and the overlying rocks.

Complex structures associated with salt diapirism, overthrust tectonics and irregular water-bottom topography usually are three dimensional (3-D) in character. A stacked section really is the seismic response of a 3D subsurface on a two-dimensional (2-D) plane of profile. Therefore, 2-D migration is not completely valid for 3-D data from areas with complex 3-D structures. Figure $4.0-5 \mathrm{a}$ is an inline stacked section from a land 3-D survey. Figure $4.0-5 \mathrm{~b}$ is a 2-D migration of this section, while Figure $4.0-5 \mathrm{c}$ is the same section after 3-D migration of the entire 3-D survey data. In particular, note the significant difference in the imaging of the top of salt $T$ and base of salt $B$. In 2-D migration, we assume that the stacked section does not contain any energy that comes from outside the plane of recording (sideswipe). Three-dimensional imaging of the subsurface is discussed in Section 7.3.

## Exploding Reflectors

When a stacked section is migrated, we use the migration theory applicable to data recorded with a coincident source and receiver (zero-offset). To develop a conceptual framework for discussing migration of zerooffset data, we now examine two types of recording schemes.

A zero-offset section is recorded by moving a single source and a single receiver along the line with no separation between them (Figure 4.0-6). The recorded energy follows raypaths that are normal incidence to reflecting interfaces. This recording geometry obviously is not realizable in practice.

Now consider an alternative geometry (Figure 4.06) that will produce the same seismic section. Imagine exploding sources that are located along the reflecting interfaces (Loewenthal et al., 1976). Also, consider one receiver located on the surface at each GMP location along the line. The sources explode in unison and send out waves that propagate upward. The waves are recorded by the receivers at the surface. The earth model described by this experiment is referred to as the exploding reflectors model.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0485.jpg?height=306&width=330&top_left_y=125&top_left_x=581)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0485.jpg?height=304&width=319&top_left_y=438&top_left_x=581)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0485.jpg?height=303&width=342&top_left_y=756&top_left_x=579)

(c)

FIG. 4.0-5. A 2-D CMP stack (a) represents a 2-D crosssection of a 3-D wavefield. Thus, it can contain energy from outside the plane of the 2-D line traverse. A 2-D migration (b) is inadequate when this kind of energy is present on the 2-D CMP-stacked section. (c) Clear imaging of the salt structure requires both 3-D data collection and 3-D migration (Section 7.3), (Data courtesy Nederlandse Aardole Maatschappij B.V)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0486.jpg?height=311&width=407&top_left_y=125&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0486.jpg?height=332&width=425&top_left_y=125&top_left_x=528)

(b)

FIG. 4.0-6. Geometry of zero-offet recording (left), and hypothetical simulation of the zero-offset experiment using exploding reflectors (right) (Claerbout, 1985).

The seismic section that results from the exploding reflectors model is largely equivalent to the zero-offset section, with one important distinction. The zero-offset section is recorded as two-way traveltime (from source to reflection point to receiver), while the exploding reflectors model is recorded as one-way traveltime (from the reflection point at which the source is located to the receiver). To make the sections compatible, we can imagine that the velocity of propagation is half the true medium velocity for the exploding reflectors model.

The equivalence between the zero-offset section and the exploding reflectors model is not quite exact, particularly in the presence of strong lateral velocity variations (Kjartansson and Rocca, 1979).

These concepts now are applied to the velocitydepth model in Figure 4.0-7. Consider source-receiver pairs placed along the earth's surface at every tenth midpoint. In this case, a zero-offset section is modeled. At midpoint 130, five different arrivals are associated with rays that are normal incidence to the first interface. Alternatively, imagine receivers placed along the earth's surface at every tenth midpoint and sources placed along the interface where the rays emerge at the right angle to the interface (equivalent to the normalincidence rays of the zero-offset section). In the latter case, the velocities indicated in Figore 4.0-7 must be halved to match the time axis with that associated with the zero-offset section.

The interface can be sampled more densely by placing receivers and sources at closer spacing (Figure 4.08a). The next deeper interface can be modeled; that is,
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0486.jpg?height=498&width=390&top_left_y=610&top_left_x=556)

FIG. 4.0-7. A velocty-depth model (top) and the zerooffset traveltime response (bottom) of the water-bottom reflector. Shown also are the normal-incidence rays used to compute the zero-offset traveltime trajectory. Note the five arrivals $A, B, C, D$ and $E$ at CMP 130 all from the water bottom.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0487.jpg?height=974&width=744&top_left_y=134&top_left_x=144)

D15IANCE (M)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0487.jpg?height=251&width=373&top_left_y=873&top_left_x=515)

F1G. 4.0-8. Exploding-reflector modeling of zero-offset traveltimes associated with (a) a water botton, (b) a flat, and (c) a dipping reflector. (d) The superposition of the normal-incidence traveltime responses in (a), (b), and (c). Shown on the velocity-depth models in the left-hand column are the normal-incidence rays used to compute the traveltime trajectories. The time sections shown on the right-hand column are equivalent to a zero-offet traveltme section with the vertical axis in two-way tıme.
the traveltime trajectory can be computed by placing sources along this interface and leaving the receivers where they were on the surface (Figure 4.0-8b). Finally, the same experiment can be repeated for the third interface (Figure 4.0-8c). To derive the composite response from the velocity-depth model in Figure 4.0-8d (the lefthand column), individual responses shown in Figures $4.0-8 \mathrm{a}, 4.0-8 \mathrm{~b}$ and $4.0-8 \mathrm{c}$ from each interface are superimposed. The result is shown in Figure 4.0-8d (the right-hand column). We can imagine that sources were placed at all three interfaces and turned on simultaneously. Such an experiment would cause the rays emerging from the three interfaces to be recorded at receivers placed on the surface, along the line

Actually, Figure 4.0-8d (the right-hand column) represents the modeled zero-offset traveltime section. Sersmic wavefields, however, are represented not only by wave traveltimes but also by wave ampltudes. Figure 4.0-9a shows the modeled zero-offeet wavefield section based on the same velocity-depth model in Figure 4.08d (the left-hand column). The shallow complex interface (horizon 1 in Figure 4.0-8a) caused the complicated response of the two simple interfaces (horizons 2 and 3) in this zero-offset traveltime section.

How valid is the assumption that a stacked section is equivalent to a zero-ofiset section? The conventional CMP recording geometry provides the wavefield at nonzero offsets. During processing, we collapse the offset axis by stacking the data onto the midpoint-time plane at zero offset. For CMP stacking, we normally assume hyperbolic moveout. Figure $4.0-10$ shows selected CMP gathers modeled from the velocity-depth model in Figure 4.0-8d (the left-hand column). Because of the presence of strong lateral velocity variations, the hyperbolic assumption may not be appropriate for some reflections on some CMP gathers (Figure 4 0-10a); however, it may be valid for others (Figure 4.0-10b). We obtain a stacked section (Figure 4.0-9b) that resembles the zero-offset section (Figure 4.0-9a) to the extent that the hyperbolic moveout assumption is valid. The assumption that a conventional stacked section is equivalent to a zero-offset section also is violated to varying degrees in the presence of strong multiples and conflicting dips with different stacking velocities (Chapter 5). While migration of unstacked data is discussed in Chapter 5 , our main focus in this chapter is on migration after stack.

## Migration Strategies

In practice, migration of seismic data requires decision making with regards to:

(a) an appropriate migration strategy, (b) a migration algorithm compatible with the strategy,

(c) appropriate parameters for the algorithm,

(d) issues concening the input data, and

(e) migration velocities.

Migration strategies include:

(a) 2-D versus 3-D migration,

(b) post- versus prestack migration, and

(c) time versus depth migration.

The spectrum of migration strategies extend from 2-D poststack time migration to $3-D$ prestack depth migration. Depending on the nature of the subsurface geology, any other in-between combination can be selected. In practice, 2-D/3-D poststack time migration is used most often for a good reason it is the least sensitive to velocity errors, and it often yields results acceptable for a reliable interpretation. Table 4-1 is an overview of different migration strategies applied to different types of seismic data (2-D, 3-D, stacked, and unstacked).

Choice of an appropriate migration strategy requires input from the interpreter as to the structural geology and stratigraphy in an area. Dipping events on a stacked section call for time migration, Conflicting dips with different stacking velocities is one case in which a conventional stacked section differs from a zero-offset section. Thus, strictly speaking, poststack migration

Table 4-1. Migration strategies.

| Case | Migration |
| :--- | :--- |
| dipping events | time migration |
| conflicting dips with <br> different stacking velocities | prestack migration |
| 3-D behavior of <br> fault planes and salt flanks | 3 -D migration |

Case Migration

strong lateral velocity depth migration

variations associated with

complex overburden structures

complex nonhyperbolic moveout prestack migration

3-D structures

3-D migration

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0489.jpg?height=377&width=211&top_left_y=117&top_left_x=85)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0489.jpg?height=379&width=215&top_left_y=116&top_left_x=284)

(b)
FIG. 4.0-9. (a) The zero-offset wavefield section equivalent to the zero-offiset traveltime section in Figure 4.0-8d (the right-hand column); (b) the CMP stack generated from the CMP gathers as in Figure 4.0-10. (Modeling by Deregowski and Barley, 1981.)

which assumes that the stacked section is equivalent to a zero-offset section is not valid to handle the case of conflicting dips. Instead, one needs to do prestack time migration.

Conflicting dips often are associated with salt flanks and fault planes, which can have 3-D characteristics. This then requires $3-D$ prestack time migration. In Section 5.3, we shall discuss a practical alternative to 2-D prestack time migration strategies. The alternative sequence includes the application of normal-moveout (NMO) correction using velocities appropriate for flat events followed by 2-D dip moveout correction (DMO) to correct for the dip and source-receiver azimuth effects on stacking velocities. As a result, conflicting dips are preserved during stacking, and thus, inuaging can be deferred until after stacking using 2-D poststack time migration strategies. This series of processing steps is largely equivalent to 2 -D prestack time migration and results often are comparable. The same workflow also is applicable to 3-D prestack time migration (Section 7,4).

Accurate imaging of targets beneath complex structures with strong lateral velocity variations requires depth migration. Aside from the problem of conflicting dips with different stacking velocities, strong lateral velocity variations associated with complex overburden structures usually cause conventional stacking based on the hyperbolic moveout assumption to fail.
Therefore, a case of complex overburden structures calls for depth migration before stacking the data.

Furthermore, complex overburden structures, encountered in areas with salt tectonics, overthrust tectonics and irregular water-bottom topographles can often exhibit 3-D characteristics. Thus, imaging such structures may require $3-D$ prestack depth migration.

Field surveys are designed such that line orientations are, as much as puosible, along the dominant strike and dip directions, so as to minimize 3-D effects. Under these circumstances, the 2-D assumption for migration can be acceptable. However, if the subsurface has a truly 3-D geometry, without a dominant dip or strike direction, then it is imperative to do 3-D migration of 3-D data. In such cases, 2-D migration (whether poststack or prestack, time or depth) can lead to potential problems in interpretation.

A practical alternative to 2 -D prestack depth $\mathrm{mi}$ gration can be a prestack layer replacement to correct for the complex nonhyperbolic moveout followed by time migration after stack. This, however, is applicable to situations involving a single overburden layer, such as irregular water-bottom topography for it to be reasonably practical.

## Migration Algorithms

The one-way-in-depth scalar wave equation is the basis for common migration algorithms. These algorithms do not explicitly model multiple reflections, converted waves, surface waves, or noise. Any such energy present in data input to migration is treated as primary reflections. Migration algorithms can be classified under three main categories:

(a) those that are based on the integral solution to the scalar wave equation,

(b) those that are based on the finite-difference solutions, and

(c) those that are based on frequency-toatienumber implementations.

Whatever the algorithm, it should desirably:

(a) handle steep dips with sufficient accuracy,

(b) handle lateral and vertical velocity variations, and

(c) be implemented, efficiently.

Figure $4.0-11$ is a migrated CMP stacked section with a major unconformity. The undermigration - incomplete imaging of the unconformity, is not because of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0490.jpg?height=504&width=384&top_left_y=118&top_left_x=124)

(a)

## CMP

240

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0490.jpg?height=453&width=412&top_left_y=173&top_left_x=507)

(b)

FIG. 4.0-10. Selected CMP gathers modeled from the velocity-depth model in Figure 4,0-8d (the left-hand column). (a) Gathers from the complex part of the velocity-depth model, (b) gathers from the simpler part of the velocity-depth model. CMP locations arc indicated in Figure 4.0-8d. The CMP stack is shown in Figure $40-9 \mathrm{~b}$ (Modeling by Deregowski and Barley, 1981.)

erroneously too low velocities. Although we should always be aware of velocity errors when migrating seismic data, the undermigration in Figure $4.0-11$ is the result of using a dip-limited algorithm. By using a steep-dip algorithm, we can achieve a more accurate imaging of the unconformity (Figure I-9).

The three principle migration techniques are discussed in this chapter in their historical order of development as outlined below. The first migration technique developed was the semicircle superposition method that was used before the age of computers. Then came the diffraction-summation technique, which is based on summing the seismic amplitudes along a diffraction hyperbola whose curvature is governed by the medium velocity. The Kirchhoff summation technique introduced later (Schneider, 1978), but actually in use earlier, basically is the same as the diffraction summation technique with added amplitude and phase corrections applied to the data before summation. These corrections make the summation consistent with the wave equation in that they account for spherical spreading (Section 1.4), the obliquity factor (angle-dependency of amplitudes), and the phase shift inherent in Huygens' secondary sources (Section 4.1).

Another migration technique (Claerbout and Doherty, 1972) is based on the idea that a stacked section can be modeled as an upcoming zero-offset wavefield generated by exploding reflectors. Using the exploding reflectors model, migration can be conceptualized as consisting of wavefield extrapolation in the form of downward continuation followed by imaging. To understand imaging, consider the shape of a wavefield at observation time $t=0$ generated by an exploding reflector. Since no time has elapsed and, thus, no propagation has occurred, the wavefront shape must be the same as the reflector shape that generated the wavefront. The fact that the wavefront shape at $t=0$ corresponds to the reflector shape is called the magng principle. To define the reflector geometry from a wavefield recorded at the surface, we only need to extrapolate the wavefield back in depth then monitor the energy arriving at $\boldsymbol{t}=\mathbf{0}$. The reflector shape at any particular extrapola-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0491.jpg?height=538&width=840&top_left_y=122&top_left_x=100)

FIG. 4.0-11. A CMP stack (a) before, and (b) after migration. Note the undermigration of the unconformity event (U) caused by the use of a dip-limited algorithm.

tion depth directly corresponds to the wavefront shape at $t=0$.

Downward continuation of wavefields can be implemented conveniently using finite-difference solutions to the scalar wave equation. Migration methods based on such implementations are called finite-difference migration. Many different differencing schemes applied to the differential operators in the scalar wave equation exist both in time-space and frequency-space domains. Glaerbout (1985) provides a comprehensive theoretical foundation of finite-difference migration and its practical espects.

After the developments on Kirchhoff summation and finite-difference migrations, Stolt (1978) introduced migration by Fourier transform. This method involves a coordinate transformation from frequency (the transform variable associated with the input time axis) to vertical wavenumber axis (the transform variable associated with the output depth axis), while keeping the horizontal wavenumber unchanged. The Stolt method is based on a constant-velocity assumption. However, Stolt modifed his method by introducing stretching in the time direction to handle the types of velocity variations for which time migration is acceptable. Stolt, and Benson (1986) combine theory with practice in the field of migration with an emphasis on the frequencywavenumber methods.

Another frequency-wavenumber migration is the phase-shift method (Gazdag, 1978). This method is besed on the equivalence of downward continuation to a phase shift in the frequency-wavenumber domain. The imaging principle is invoked by summing over the frequency components of the extrapolated wavefield at each depth step to obtain the image at $t=0$.

A reason for the wide range of migration algorithms used in the industry today is that none of the algorithms fully meets the important criteria of handling all dips and velocity variations while still being cost-effective.

Migration algorithms based on the integral solution to the scalar wave equation, commonly known as Kirchhoff migration, can handle all dips up to 90 degrees, but they can be cumbersome in handling lateral velocity variations.

Finite-difference algorithms can handle all types of velocity variations, but they have different degrees of dip approximations. Furthermore, differencing schemes, if carelessly designed, can severely degrade the intended dip approximation.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0492.jpg?height=656&width=860&top_left_y=121&top_left_x=93)

FIG. 4.0-12. A CMP stack (a) before, and (b) after migration. Lack of any event to the right of the dotted line on the migrated section is a result of the finite line length.

Finally, frequency-wavenumber algorithms have limited ability in handling velocity variations, particularly in the lateral direction. As a result of limitations of the three main categories of migration algorithms integral, finite-difference, and frequencywavenumber methods, migration software has expended further to additional extensions and combinations of the basic algorithms. Residual migration - phase-shift or constant-velocity Stolt migration followed by the application of a dip-limited algorithm is one example.

## Migration Parameters

After deciding on the migration strategy and the appropriate algorithm, the analyst then needs to decide on the migration parameters. Migration aperture width is the critical parameter in Kirchhoff migration. A smal] aperture causes removal of steep dips; it generates spurious horizontal events and organizes the random noise uncorrelated from trace to trace.

Depth step size in downward continuation is the critical parameter in finite-difference methods. An optimum depth step size is the largest depth step with the minimum tolerable phase errors. It depends on temporal and spatial samplings, dip, velocity, and frequency. It also depends on the type of differencing scheme used in the algorithm.

Finally, the stretch factor is the critical parameter for Stolt migration. A constant-velocity medium implies a stretch factor of 1 . In general, the larger the vertical velocity gradient, the smaller the stretch factor needs to be.

## Aspects of Input Data

When migrating seismic data, one needs to be concerned with various aspects of the input data set itself:

(a) line length or areal extent,

(b) signal-to-noise ratio, and

(c) spatial aliasing.

The line length must be sufficient to allow a steeply dipping event to migrate to its true subsurface location. It is a fatal error to record short profiles in areas with complex geology. Also, for 3-D migration, the surface areal extent of a 3-D survey is almost always larger than the target subsurface areal extent.

Random noise at late times on a stacked section, when migrated, potentially can be hazardous for shallower data. One may have to compromise on migration aperture for deep data to prevent this problem to occur.

Trace spacing must be small enough to prevent spatial aliasing of steep dips at high frequencies. Although this is not an issue for modern prestack data a coarse shot-receiver spacing can degrade the fidelity of prestack migration severely. Old data and 3-D marine data in the crossline direction often are trace interpolated prior to poststack migration.

Figure 4.0-12 is a CMP stacked section before and after migration. From an interpretation viewpoint, the reliable part of this migrated section is confined to the upper central part. Lack of any reflection energy to the right of the dotted line does not mean that there is a structural discontinuity there. It only means that the reflections associated with the imbricate structure have been migrated in the updip direction from right to left. As a result, a zone with no reflectors to the right of the dotted line is left behind because of the truncation of the wavefeld represented by the right-hand edge of the stacked section. The deeper part is useless, because the noise dominates the section.

## Migration Velocities

Horizontal displacement during migration is proportional to migration velocity squared (equation 4-1). Since velocities generally increase with depth, errors in migration are usually larger for deep events than shallow events. Also, the steeper the dip, the more accurate the migration velocities need to be, since displacement is proportional to dip.

Figure 4.0-13 shows a portion of a CMP-stacked section after $3-D$ poststack time migration using a percent range of stacking velocities. Note the subtle underand overmigration effects on dipping events below the major unconformity represented by the strong, nearhorizontal reflection. Events $A$ dipping up to the left and $B$ dipping up to the right cross over one another on sections that correspond to 90 percent and 95 percent of stacking velocities, indicating undermigration. The same events are split away from one another in opposite directions on sections that correspond to 105 percent and 110 percent of stacking velocities. The most overall acceptable image is seen on the section that corresponds to the 100 percent of stacking velocities.

Accuracy in event positioning after migration actually depends on the combined effects of the performance of the migration algorithm used and the velocity errors. For example, the inherently undermigrating character of a 45-degree finite-difference algorithm can be, for an event with a specific dip, coincidentally counterbalanced by the overmigration effect of erroneously too high velocities. In the presence of large vertical velocity gradients, a two-pass 3-D migration can also cause overmigration of steep dips (in the form of lateral translation) even with the correct migration velocities.

Figure 4.0-14a shows a portion of a migrated stacked section. Although this section does not contain steep dips, accurate imaging of the faults along the lowrelief structures can be important to the interpreter. Note the slight undermigration, which may be caused by any of the following: (a) error in migration velocities, (b) a dip-limited algorithm that failed to focus the diffraction energy adequately, or (c) a possible 3-D behavior of the geometry of the reflector. The section in Figure 4.0-14a has been migrated with a dip-limited algorithm. Using a proper algorithm, with the same velocities, we get the migrated section in Figure 4.0-14b. The resulting section shows slight overmigration, which can be attributed to errors in migration velocities. Lowering the velocities gives the improved, but not completely accurate, image in Figure 4.0-14c. Perhaps, the remaining issues in imaging may be attributed to $3-\mathrm{D}$ effects.

As demonstrated by the example in Figure 4.0-14, migration results generally are self-evident underand overmigration often can be recognized on a migrated section. Problems in imaging often are traced to accuracy in migration velocities. I consider migration velocities as the weak link between the seismic section and the geologic cross-section.

In the next section, basic principles of migration are presented and the Kirchhoff summation, finitedifference, irequency-space, and frequency-wavenumber algorithms are reviewed. Practical aspects of the migration algorithms are expounded in Sections 4.2 through 4.5. Specifically, key parameters for each category of the migration algorithms are analyzed using appropriate synthetic and field data examples. Further aspects of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0494.jpg?height=682&width=417&top_left_y=135&top_left_x=80)

FIG. 4.0-13. A portion of a CMP-stacked section after 3 D poststack time migration using, from top to bottom, 90 , $95,100,105$ and 110 percent of stacking velocities. Note the subtle under- and overmigration effects on dipping events below the major unconformity represented by the strong, near-horizontal reflection. Note the effect of velocities used in migration on the positioning of the event $A$ dipping up to the left and event B dipping up to the right.

migration in practice, including spatial aliasing, migration response to random noise, line length, and irregular topography are discussed in Section 4.6. The problem of conflicting dips with different stacking velocities that requires dip-moveout (DMO) correction and prestack time migration, and the accompanying topic on migration velocity analysis are deferred until Chapter 5 . The problem of imaging beneath complex structures that requires earth imaging and modeling in depth is discussed in Chapters 8 and 9, respectively.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0494.jpg?height=517&width=427&top_left_y=120&top_left_x=538)

FIG. 4.0-14. (a) A portion of a migrated CMP stack; note the subtle undermigration at fault locations $A$ and $B$ caused by the use of a dip-limited algorithm; (b) same data set but migrated with an algorithm with no dip limitation; note the subtle overmigration most likely due to erroneously too high velocities; (c) same data set migrated with the same algorithm as in (b) but with velocities adjusted to prevent overmigration.

### 4.1 MIGRATION PRINCIPLES

Consider the dipping reflector $C D$ of the simple geologic section in Figure 4.1-1a. We want to obtain a zero-offset section along the profile $O$ z As we move the source-receiver pair $(s, g)$ along $O_{x}$, the first normalincidence arrival from the dipping reflector is recorded at location $A$. In this discussion, we assume a normalized constant-velocity medium $v=1$ so that time and depth coordinates become interchangeable. The reflection arrival at location $A$ is indicated by point $C$ on the zero-offset time section in Figure 4.1-1b. As we move from location $A$ to the right, normal-incidence arrivals are recorded from the dipping reflector $C D$. The last arrival is recorded at location $B$, which is indicated by point $D^{\prime}$ in Figure 4.1-1b. In this experiment, diffractions off the edges of reflector $C D$ are excluded to simplify the discussion.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0495.jpg?height=277&width=350&top_left_y=126&top_left_x=124)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0495.jpg?height=248&width=354&top_left_y=433&top_left_x=114)

(b)

FIG. 4,1-1. Migration principles: The reflection segment $C^{\prime} D^{\prime}$ in the time section as in (b), when migrated, is moved updip, steepened, shortened, and mapped onto its true subsurface location $C D$ as in (a). (Adapted from Chun and Jacewitz, 1981.)

Compare the geologic section in Figure 4.1-1a, which is in depth, with the zero-offset seismic section in Figure 4.1-1b, which is in time. The true subsurface position of reflector $C D$ is superimposed onto the time section for comparison. Clearly the true geologic position of reflector $C D$ is not the same as the reflection event position $C^{\prime} D^{\prime}$.

From this simple geometric construction, note that the reflection in the time section $C^{\prime} D^{\prime}$ must be morated to its true subsurface position $C D$ in the depth section. The following observations can be made from the geometric description of migration in Figure 4.1-1:

(a) The dip angle of the reflector in the geologic section is greater than in the time section; thus, migration steepens reflectors.

(b) The length of the reflector, as seen in the geologic section, is shorter than in the time section; thus, migration shortens reflectors. (c) Migration moves reflectors in the updip direction.

The example in Figure 4.0-1 demonstrates the above observations. In particular, the dipping event $(B)$ has moved in the updip direction, become shorter, and steepened after migration $(A)$.

As mentioned in the previous section, conventional migration output is displayed in time, as is the input stacked section. To distinguish the two time axes, we will denote the time axis on the stacked section as $t$

event time in the unmigrated position, and the time axis on the migrated section as $T$ event time in the migrated position.

We shall now examine the horizontal and vertical displacements as seen on the migrated time section. From Figure 4.1-2, consider a reflector segment $C D$. Assume that $C D$ migrates to $C^{\prime} D^{\prime}$ and that point $E^{\prime}$ on $C^{\prime} D^{\prime}$ migrates to point $E$ on $C D$. The horizontal and vertical (time) displacements $d_{x}$ and $d_{t}$, and the dip $\Delta \tau / \Delta x$, all measured on the migrated time section (Figure 4.1-2), can be expressed in terms of medium velocity $v$, traveltime $t$, and apparent dip $\Delta t / \Delta x$ as measured on the unmigrated time section (Figure 4.1-2). Chun and Jacewitz (1981) derived the following formulas:

$$
\begin{gathered}
d_{x}=\frac{v^{2} t}{4} \frac{\Delta t}{\Delta x} \\
d_{t}=t\left[1-\sqrt{1-\left(\frac{v \Delta t}{2 \Delta x}\right)^{2}}\right] \\
\frac{\Delta \tau}{\Delta x}=\frac{\Delta t}{\Delta x} \frac{1}{\sqrt{1-\left(\frac{v \Delta t}{2 \Delta x}\right)^{2}}}
\end{gathered}
$$

To gain a quantitative insight into these expressions, we consider a numerieal example. For a realistic velocity function that increases with depth, consider five reflecting segments at various depths. For simplicity, assume that quantity $\Delta t / \Delta x$ is the same for all (10 ms per $25-\mathrm{m}$ trace spacing). From equations (4-1), (42), and (4-3), compute the horizontal and vertical displacements $d_{x}$ and $d_{t}$ and the dips (in ms/trace) after migration. The results are summarized in Table 4-2.

Refer to Table 4-2 and equations (4-1), (4-2), and (4.3) and make the following observations:

(a) The time dip $\Delta \tau / \Delta x$ on the migrated section is always greater than the time dip $\Delta t / \Delta x$ on the unmigrated section.

(b) The horizontal displacement $d_{x}$ increases with event time $t$ in the unmigrated position. At $4 \mathrm{~s}$, the horizontal displacement is more than $6 \mathrm{~km}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0496.jpg?height=394&width=848&top_left_y=155&top_left_x=82)

FIG. 4.1-2. Quantitative analysis of the migration process. Dipping event $A B$ on the unmigrated section (Ieft) is moved to $A^{\prime} B^{\prime}$ on the migrated section (nght). The event after migration also is supcrimposed on the unmigrated section to compare the position of the event before and after migration. Point $C$ on dipping reflector $A B$ is moved to $C^{\prime}$ after migration. The amount of horizontal displacement $d_{x}$, vertical displacement $d_{t}$, and the dip $\Delta \tau / \Delta x$ after migration is calculated from equations (4-I), (4-2) and (4-3).

Table 4-2. Horizontal and vertical displacements as a result of migration of a series of dipping reflections with the same apparent dip ( $10 \mathrm{~ms} /$ trace) as measured on the unmigrated stacked section at various depths, and changes in dip angle as measured on the migrated section in time.

| $t$ | $v$ | $d_{x}$ | $d_{t}$ | $\Delta t / \Delta x$ | $\overline{\Delta \tau / \Delta x}$ |
| ---: | :---: | ---: | :---: | :---: | :---: |
| $(\mathrm{~s})$ | $(\mathrm{m} / \mathrm{s})$ | $(\mathrm{m})$ | $(\mathrm{s})$ | $\Delta \mathrm{m} /$ trace $)$ <br> $(\mathrm{ms} /$ trace $)$ |  |
| 1 | 2500 | 625 | 0.134 | 10 | 11.5 |
| 2 | 3000 | 1800 | 0.400 | 10 | 12.5 |
| 3 | 3500 | 3675 | 0.858 | 10 | 14.0 |
| 4 | 4000 | 6400 | 1.600 | 10 | 16.7 |
| 5 | 4500 | 10125 | 2.820 | 10 | 23.0 |

(c) The horizontal displacement $d_{x}$ is a function of the velocity squared. If there is a 20 percent error in the velocity used in migration, then the event is misplaced by an error of 44 percent.

(d) The vertical displacement $d_{t}$ also increases with time and velocity.

(e) The steeper the event dip, the more the horizontal and vertical displacements after migration.
In Figure 4.1-1a, assume that the zero-offset section was recorded only between surface locations $A$ and $B$. The time section would include the event $C^{\prime} D^{\prime}$, but when migrated, the event would migrate out of the section, resulting in a blank migrated section (Figure 4.11b). Therefore, the data on a stacked section are not necessarily confined to the subsurface below the seismic line. The converse is even more important; the structure below the seismic line may not be recorded on the seismic section. Suppose that the data were recorded only between surface locations $O$ and $A$. This time, the resulting time section would be blank. So, we should not record between $A$ and $B$, and neither should we record between $O$ and $A$. Instead, we should record between $O$ and $B$ in order to record the reflector of interest properly and also to migrate it properly.

In areas with a structural dip, line length must be chosen by considering the horizontal displacements of dipping events from the structures causing the events. This is an important consideration, especially in 3-D seismic work. The areal surface coverage of a survey usually is larger than the areal subsurface coverage of interest.

To achieve a complete image of a dipping reflector, also, the recording time must be long enough. For

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0497.jpg?height=416&width=615&top_left_y=116&top_left_x=211)

FIG. 4.1-3. (a) A zero-offet section modeled from the dipping reflectors shown in (b). The medium velocity is constant 3500 $\mathrm{m} / \mathrm{s}$ and the trace spacing is $25 \mathrm{~m}$. The true dip angles of the reflectors vary from 0 to 45 degrees at 5 -degree increment. Migration of the zero-ofiset section (a) yieids the model of the dipping reflectors (b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0497.jpg?height=466&width=436&top_left_y=645&top_left_x=94)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0497.jpg?height=460&width=417&top_left_y=651&top_left_x=527)

(b)

FIG. 4.1-4. A portion of a CMP stack (a) before and (b) after migration. Note the group of events with a range of dips that fan out from a fault plane. Migration has moved them in the updip direction, made them shorter and steeper.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0498.jpg?height=980&width=429&top_left_y=125&top_left_x=79)

FIG. 4.1-5. Curyed reflecting interfaces (synclines and anticlines) (a) before and (b) after migration. See text for detals. (Modeling courtesy Union Oil Company.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0498.jpg?height=605&width=416&top_left_y=126&top_left_x=538)

FIG. 4.1-6. (a) A velocity-depth model consisting of a synclinal reflector; (b) selected normal-incidence arrivals on the sero-offet section Trace the bowtie in the time section.

example, if only $O E$ seconds were recorded (Figure 4.11), then the recorded segment $C^{\prime} D^{\prime \prime}$ would yield only part of the complete image $C D$. An excellent example of recording deeper in time and with longer line length for steeper dips is shown in Figure 4.0-1. Proper imaging of the salt dome boundary required that data be recorded for more than $6 \mathrm{~s}$.

The migration concepts described above are demonstrated further by the dipping events model in Figure 4.1-3. The edge diffractions are included here. The dipping reflectors on the zero-offset section are steepened, shortened, and moved in the updip direction as a result of migration. A field data example of a series of dipping events on a stacked section before and after migration is shown in Figure 4.1-4. Note that the steeper the dip, the more the event moves after migration.

So far, only linear reflectors were considered. We now consider a more realistic geologic situation that involves curved reflecting interfaces. Figure 4.1-5 shows

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0499.jpg?height=402&width=417&top_left_y=124&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0499.jpg?height=402&width=425&top_left_y=123&top_left_x=528)

(b)

FIG. 4.1-7. A portion of a CMP stack (a) before and (b) after migration. Antichnes appear bigger, while synclines appear smaller than their actual sizes on the unmigrated section (a).

three synclines and a smali anticlinal feature. The synclines appear as bowties on the zero-offset section. By using the principles deduced from the geometry of Figure 4.1-1, note that as a result of migration, segment $A$ of the bow tie moves in the updip direction to the left. Similarly, segment $B$ moves to the right, while fattopped segment $C$ does not move much at all. Consequently, after migration the flanks of bow ties associated with synclines are opened up. On the other hand, the small anticline seems to be broader on the zero-offset section than it is on the migrated section. Again note that segment $D$ moves updip to the right, while segment $E$ moves updip to the left as a result of migration. Thus, synclines broaden and anticlines compress us a result of migration. Migration velocities also affect the apparent size of the structure; higher velocities mean more migration and, hence, smaller anticlinal structure.

Why does a syncline look like a bowtie on the stacked section? The answer is in Figure 4.1-6, where a symmetric syncline is modeled. Given the subsurface model in Figure 4.1-6a, the normal-incidence rays can be computed to derive the zero-offset traveltime section in Figure 4.1-6b. Only five CMP locations are shown for clarity. At locations 2 and 4, there are two distinct arrivals, while at location 3 , there are three distinct arrivals. By filling in the intermediate raypaths, the bow tie character of the syncline can be constructed on the time section. Complete the procedure by tracing the traveltime trajectory in Figure 4.1-6b.

Two field data examples containing synclinal and anticlinal structures are shown in Figures 4.1-7 and 4.1-8. In Figure 4.1-7, note that the synclinal feature broadens and the anticlinal feature narrows as a result of migration. In Figure 4.1-8, the bow ties associated with two small synclinal besins $A$ and $B$ grow larger in depth. After migration, the bowties are untied and the synclines are delineated.

## Kirchhoff Migration

Claerbout (1985) uses the harbor example in Figure 4.19 to describe the physical principles of migration. Assume that a storm barrier exists at some distance $z_{3}$ from the beach and that there is a gap in the barrier. Inagine a calm afternoon breeze that comes from the ocean as a plane incident wave. The wavefront is parallel to the storm barrier. As we walk along the beach line, we see a wavefront different from a plane wave. The gap on the storm barrier has acted as a secondary source and generated the semicircular wavefront that is propagating toward the beach.

If we did not know about the storm barrier and the gap, we might want to lay out a recelver cable along the beach to record the approaching waves. This experiment

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0500.jpg?height=354&width=855&top_left_y=114&top_left_x=91)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0500.jpg?height=234&width=858&top_left_y=526&top_left_x=92)

(b)

FIG. 4.1-8. A portion of a CMP stack (a) before and (b) after migration. Migration unties the bowties and turns them into synclines below $A$ and $B$.

is illustrated in Figure 4.1-10 with the recorded time section. Physicists call the gap on the barrier a pont aperture. It is somewhat similar to a, pont source, since both generate circular wavefronts. However, the amplitudes on the wavefront that propagate outward from a point source are isotropic, while those from a. point aperture are angle-dependent. The point aperture on the barrier acts as a Huygens' secondary source.

From the beach experiment, we find that Huygens' secondary source responds to a plane incident. wave and generates a semicircular wavefront in the ' $x-z$ plane. The response in the $x-t$ plane is the diffaction hyperbola shown in Figure 4.1-11.

Imagine that the subsurface consists of points along each reflecting horizon that behave much as the gap on the storm barrier. From Figure 4.1-12, these points act as Huygens' secondary sources and produce hyperbolic traveltime trajectories. Moreover, as the sources (the points on the reflecting interface) get closer to each other, superposition of the hyperbolas produces the response of the actual reflecting interface (Figure 4,1-13). In terms of the harbor example, this is like assuming that the barrier is wiped out by a storm so that the primary incident plane wave reaches the beach without modification. The diffraction hyperbolas, which are caused by sharp discontinuities at both ends of the reflector in Figure 4.1-13, remain. These hyperbolas are equivalent to diffactions seen at fault boundaries on stacked sections.

In summary, we find that reflectors in the subsurface can be visualized as being made up of many points that act as Huygens' secondary sources. We also find that the zero-offset section consists of a superposition of the many hyperbolic traveltime responses. Moreover, when there are discontinuities (faults) along the reflector, diffraction hyperbolas often stand out.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0501.jpg?height=202&width=415&top_left_y=113&top_left_x=82)

Ocean

FIG. 4.1-9. The gap in the barrier acts as Huygeas' secondary source, causing the circular wavefronts that approach the beach line. (Adapted from Claerbout, 1985.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0501.jpg?height=543&width=426&top_left_y=612&top_left_x=74)

FIG. 4.1-10. Waves recorded along the beach generated by Huygens' secondary source (the gap in the barrier in Figure 4.1-9) have a hyperbolic traveltime trajectory.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0501.jpg?height=360&width=392&top_left_y=115&top_left_x=550)

FIG. 4.1-11. A point that represents a Huygens' secondary source (a) produces a diffraction byperbola on the zero-offiset time section (b). The vertical axis in this section is two-way time, while the vertical axis in the time section in Figure 4.1-10 is one-way time.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0501.jpg?height=269&width=396&top_left_y=593&top_left_x=548)

FIG. 4.1-12. Superposition of the zero-offset responses (b) of a discrete number of Huygens' secondary sources as in (a).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0501.jpg?height=255&width=376&top_left_y=941&top_left_x=558)

FIG. 4.1-13. Superposition of the zero-offset responses (b) of a continuum of Huygens' secondary sourcts as in (a).

## Diffraction Summation

Huygens' secondary source signature is a semicircle in the $x-z$ plane and a hyperbola in the $x-t$ plane, This characterization of point sources in the subsurface leads to two practical migration schemes. Figure 4.114a shows a zero-offset section that consists of a single arrival at a single trace. This event migrates to a semicircle (Figure 4.1-14b). From Figure 4.1-14, note that the zero-offset section recorded over a constant-velocity earth model consisting of a semicircular reflecting interface contains a single blip of energy at a single trace as in Figure 4.1-14a. Since this recorded section consists of an impulse, the migrated section in Figure 4.1-14b can be called the migration impulse response. An alternate scheme for migration results from the observation that a zero-offset section consisting of a single diffraction hyperbola migrates to a single point (Figure 4.1-15b).

The first method of migration is based on the superposition of semicircles, while the second method is based on the summation of amplitudes along hyperbolic paths. The first method was used before the age of digital computers. The second method, which is known as the diffraction summation method, was the first computer implementation of migration.

The migration scheme based on the semicircle superposition consists of mapping the amplitude at a sample in the input $x-t$ plane of the unmigrated time section onto a semicircle in the output $x-z$ plane. The migrated section is formed as a result of the superposition of the many semicircles.

The migration scheme based on diffraction summation consists of searching the input data in the $x-t$ plane for energy that, would have resulted if a diffracting source (Huygens' secondary source) were located at a particular point in the output $x-z$ plane. This search is carried out by summing the amplitudes in the $x-t$ plane along the diffraction curve that corresponds to Huygens' secondary source at each point in the $x-z$ plane. The result of this summation then is mapped onto the corresponding point in the $x-z$ plane. As noted early in this section, within the context of time migration, however, the summation result actually is mapped onto the $x-\tau$ plane, where $\tau$ is the event time in the migrated position.

The curvature of the hyperbolic trajectory for amplitude summation is governed by the velocity function. The equation for this trajectory can be derived from the geometry of Fjgure 4.1-15. A formal derivation also is provided in Section D.2. Assuming a horizontally layered velocity-depth model, the velocity function used to compute the traveltime trajectory is the rms velocity at the apex of the hyperbola at time $\tau$ (Section 3.1).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0502.jpg?height=181&width=424&top_left_y=125&top_left_x=538)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0502.jpg?height=187&width=422&top_left_y=319&top_left_x=540)

(b)

FIG. 4.1-14. Principles of migration based on semicircle superposition. (a) Zero-ofset section (trace interval, $25 \mathbf{~ m}$; constant velocity, $2500 \mathrm{~m} / \mathrm{s}$ ), (b) migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0502.jpg?height=200&width=428&top_left_y=678&top_left_x=536)

(B)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0502.jpg?height=194&width=428&top_left_y=895&top_left_x=536)

(b)

FIG. 4.1-15. Principles of migration based on diffraction summation. (a) Zero-offset section (trace interval, $25 \mathrm{~m}$; constant velocity, $2500 \mathrm{~m} / \mathrm{s}$ ), (b) migration. The amplitude at input trace location $B$ along the flank of the travoltime hyperbola is mapped onto output trace location $A$ at the apex of the hyperbola by equation (4-4)

From the triangle $C O A$ in Figure 4.1-15a, we note that

$$
t^{2}=\tau^{2}+\frac{4 x^{2}}{v_{r m s}^{2}}
$$

Having computed the input time $t$, the amplitude at input location $B$ is placed on the output section at location $A$, corresponding to the output time $\tau$ at the apex of the hyperbola.

From Section 3.1, refection traveltimes in a layered earth approximate small-spread hyperbolas. This may seem to impose a serious restriction on the aperture width the lateral extent of the diffraction hyperbola, in the summation process. However, the small-spread approximation is valid even at large distances from the apex, and the errors associated with it are insignificant a.t late times. In practice, this approximation is not usually an issue.

## Amplitude and Phase Factors

Now consider several factors associated with the amplitude and phase behavior of the waveform along the diffraction hyperbola. From Figure 4.1-9, given the alternative of standing at location $A$ or $B$, we intuitively think that it is safer to stand at location $B$. This is because the wave amplitude at location $A$, which is on the $z$-axis, is stronger than the wave amplitude at location $B$, which is at an oblique angle from the $z$-axis. As mentioned earlier, this is one difference between a point source with uniform amplitude response at all angles and the point aperture that produces a wavefront with angle-dependent amplitudes. This angle dependence of amplitudes, which is described by the obliquity factor, should be considered before summation. To correct for the obliquity factor, the amplitude at location $B$ in Figure 4.1-15a is scaled by the cosine of the angle between $B C$ and $C A$ before it is placed at output location $A$.

Another factor is the spherical divergence of wave amplitudes. Again, from Figure 4.1-9, given the alternative of standing at location $B$ or $C$, we prefer to stand at location $C$. The reason for this is that the wave amplitude along the wavefront at location $C$, which is farther from the point aperture source, is weaker than the wave amplitude at location $B$. Wave energy decays as $\left(1 / r^{2}\right)$, where $r$ is the distance from the source to the wavefront, while amplitudes decay as $(1 / r)$. Thus, amplitudes must be scaled by factor $(1 / r)$ before summation for wave propagation in three dimensions.

Finally, there is a third factor that involves the inherent property of Huygens' secondary source waveform. This factor is difficult to explain from a physical viewpoint. Nevertheless, it is obvious from Figure 4.113 that Huygens' secondary sources must respond as a wavelet along the hyperbolic paths with a unique phase and frequency characteristic. Otherwise, there would be no amplitude cancelation when they are close to one another. The waveform that results from the summation must be restored in both phase and amplitude.

In summary, we must consider the following three factors before diffraction summation:

(a) The oblqquaty factor or the directivity factor, which describes the angle dependence of amplitudes and is given by the cosine of the angle between the direction of propagation and the vertical axis $z$ (Figure 4.1-15).

(b) The spherical spreading factor, which is proportional to $\sqrt{1 / U r}$ for $2-D$ wave propagation, and $(1 / v r)$ for $3-\mathrm{D}$ wave propagation.

(c) The wavelet shaping factor, which is designed with a 45-degree constant phase spectrum and an amplitude spectrum proportional to the square root of the frequency for 2-D migration. For 3-D migration, the phase shift is 90 degrees and the amplitude is proportional to frequency.

## Kirchhoff Summation

The diffraction summation that incorporates the obliq uity, spherical spreading and wavelet shaping factors is called the Kirchhoff summation, and the migration method based on this summation is called the Kirchhoff migration. To perform this method, multiply the input data by the obliquity and spherical spreading factors. Then apply the filter with the above specifications and sum along the hyperbolic path that is defined by equation (4-4). Place the result on the migrated section at time $\tau$ corresponding to the apex of the hyperbola. In practice, the order of the filter application, specified by factor (c), and summation can be interchanged without sacrificing accuracy because the summation is a linear process and the filter is independent of time and space.

The velocity used in equation (4-4) is taken as the rms velocity, which can be allowed to vary laterally. However, lateral variation in velocity distorts the hyperbolic nature of the diffraction pattern and somehow must be considered. The value for the rms velocity typically is that of the output time sample; that is, the apex time $\tau$ of the hyperbola.

What was determined from a physical point of view in the preceding discussion can be rigorously described by the integral solution to the scalar wave equation. Schneider (1978), Berryhill (1979) and Berkhout (1980) are excellent references for the mathematical treatment of the Kirchhoff migration method. The integral solution of the scalar wave equation yields three terms; the far-field term which is proportional to $(1 / r)$, and two other terms which are proportional to $\left(1 / r^{2}\right)$. Hence,
it is the far-field term that makes the most contribution to the summation that is used in practical implementation of Kirchhoff migration. The output image $P_{\text {out }}\left(\mathbf{x}_{0}, z=v \tau / 2, t=0\right)$ at a subsurface location $\left(x_{0}, z\right)$ using only the far-field term is computed from the 2-D zero-offset wavefield $P_{8 n}(x, z=0, t)$, which is measured at the surface $(z=0)$, by the following summation over a spatial aperture

$$
P_{\text {out }}=\frac{\Delta x}{2 \pi} \sum_{\mathbf{r}}\left[\frac{\cos \theta}{\sqrt{v_{\mathrm{rms}} T}} \rho(t) * P_{\mathrm{n}}\right]
$$

where $v_{r m s}$ is the rms velocity at the output point $\left(x_{0}, z\right)$ and $r=\sqrt{\left(x-x_{0}\right)^{2}+z^{2}}$, which is the distance between the input $(x, z=0)$ and the output $\left(x_{0}, z\right)$ points. The asterisk denotes convolution of the rho filter $\rho(t)$ with the input wavefield $P_{i n}$.

The rho filter $\rho(t)$ corresponds to the time derivative of the measured wavefield, which yields the 90 degree phase shift and adjustment of the amplitude spectrum by the ramp function $\omega$ of frequency (Table A-1 of Appendix A). For 2-D migration, the halfderivative of the wavefield is used. This is equivalent to the 45-degree phase shift and adjustment of the amplitude spectrum by a function of frequency defined as $\sqrt{\omega}$. Since the rho filter is independent of the spatial variables, it actually can be applied to the output of the summation in equation (4-5). Finally, the far-field term in equation (4-5) is proportional to the cosine of the angle of propagation (the directivity term or the obliquity factor) and is inversely proportional to $v r$ (the spherical spreading term) in three dimensions. In two dimensions, the spherical spreading term is $\sqrt{v r}$.

Equation (4-5) can be used to compute the wavefield at any depth $z$. The ouput image $P_{\text {out }}$ is computed at ( $\left.x_{0}, z=v \tau / 2, t=0\right)$ using the input wavefield $P_{z n}$ at $(x, z=0, t-r / v)$. To obtain the migrated section at an output time $\tau$, equation (4-5) must be evaluated at $z=v \tau / 2$ and the imaging principle must be invoked by mapping amplitudes of the resulting wavefield at $t=0$ onto the migrated section at output time $\tau$. The complete migrated section is obtained by performing the summation in equation (4-5) and setting $t=0$ for each output location. The range of the summation is called the migration aperture.

## Finite-Difference Migration

To describe the physical basis of finite-difference migration, recall the harbor example of Figure 4.1-9. Instead of taking the section recorded along the beach, which contains the diffraction hyperbola, then collapsing it to get the migrated section in Figure 4.1-15, consider the following alternative procedure. Again, start with the wavefield recorded along the beach (Figure 4.1-16a). Assume that the barrier is $1250 \mathrm{~m}$ from the beach. Now move the recording cable into the water, $250 \mathrm{~m}$ from the beach. Start recording at the instant the plane wave hits the barrier. The recorded section is shown in Figure 4.116b. Move the cable $500 \mathrm{~m}$ from the beach and record the section in Figure 4.1-16c, followed by a recording $750 \mathrm{~m}$ from the beach to obtain the section in Figure 4.1-16d. Finally, $1000 \mathrm{~m}$ from the beach, record the section shown in Figure 4.1-16e.

Note that each recording yields a hyperbola in which the apex moves closer to zero time. The actual extent of the recording cable is denoted by the solid line on top of each frame. Had we recorded at the barrier ( $1250 \mathrm{~m}$ from the beach), the apex of the hyperbola would be positioned at $t=0$.

In Kirchhoff migration, the diffraction hyperbola is collapsed by summing the amplitudes, then placing them at the apex. The alternative approach implied by the result of the experiment shown in Figure 4.116 is to use the hyperbola recorded a distance away from the beach to construct the hyperbola that would be recorded at another distance closer to the source of the diffraction hyperbola. The process is stopped when the hyperbola collapses to its apex. In the harbor experiment, this collapse occurs when the receiver cable coincides with the barrier, or, equivalently, when $t=0$. As stated in the introductory section, this is called the amaging pruciple.

## Downward Continuation

The harbor experiment described above can be simulated in the computer. Pretend that moving the receiver cable from the beach into the water closer to the barrier is like moving the receiver cable from the surface down into the earth closer to the reflectors. Think of the gap on the barrier as equivalent to a point diffractor on a reflecting interface causing the diffraction hyperbola (Figure 4.1-17a). Start with the wavefield recorded at the surface and move the receivers down to depth levels at finite intervals. Downward continuation of the upcoming waveficld at the surface, therefore, can be considered equivalent to lowering the receivers into the earth.

The computer-simulated wavefields at these different depths are shown in Figure 4.1-17. By applying the imaging principle at each depth, the entire wavefield is imaged. The final output from this process is the migrated section. The last section (panel $f$ ) at $1250 \mathrm{~m}$ has only one arrival at $t=0$. The recording cable is on the storm barrier and the arrival from the gap occurs at $t=0$. As the cable moved into the ocean and

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0505.jpg?height=286&width=871&top_left_y=115&top_left_x=83)

FIG. 4.1-16. Moving the receiver cable in the harbor experiment (Figure 4.1-9) from the beach into the water at discrete intervals paraliel to the beach line. Numbers on top indicate the distance of the recelver cable from the beach line.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0505.jpg?height=176&width=861&top_left_y=465&top_left_x=91)

FIG. 4.1-17. Computer simulation of the experiment illustrated in Figure 4.1-16. Here, we downward continue the receivers at discrete depth intervals. The numbers on top indicate the distance of the receiver cable from the surface, $z=0$.

recorded closer to the barrier, the recorded diffraction hyperbola arrived earlier, and became shorter and more compressed. It collapsed to a point when the receivers coincided with the storm barrier over which the source point forms a gap.

There is one important difference between the physical experiment in Figure 4,1-16 and the computersimulated downward-continuation experiment in Figure 4.1-17. The receiver cable is the same at each step in Figure 4.1-16, whereas the effective cable length gets shorter and shorter toward the source (the gap in the barrier) in Figure 4.1-17. This is because we started by recording the wavefield at the surface (Figure 4.1-16a) with a finite cable length. The recorded information is confined to within the two raypaths depicted on the section in Figure 4.1-17a. As the cable moves closer to the source, the effective receiver cable containing the information is confined to smaller and smaller lengths. Although receivers are lowered vertically, energy moves down along raypaths it originaliy took on the way up.

To relate these recordings at different depths (Figure 4.1-17), we superimpose them as shown in Figure 4.1-18a. Moreover, the recordings can be shifted so that the apexes of the hyperbolas coincide and are positioned at a time that is equivalent to the distance from the surface to the diffractor as shown in Figure 4.1-18b. This is called tame retardation.

Reconsider the results from the computer simuiation of the harbor experiment in Figure 4.1-17. Suppose we stopped recording at a depth of $1000 \mathrm{~m}$ before

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0505.jpg?height=262&width=193&top_left_y=869&top_left_x=549)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0505.jpg?height=262&width=199&top_left_y=868&top_left_x=755)

(b)
FIG. 4.1-18. (a) Superposition of the time sections in Figure 4 1-17; (b) removing the translational effect by retardation to place the energy at the apex of the hyperbola obtaned intially along the beach line.
the barrier. The original hyperbola in Figure 4.1-17a was partially collapsed at this depth (Figure 4.1-17e). Therefore, downward continuing to a depth short of the true depth of the source causes undemigration. Diffractions and dipping events also are undermigrated if incorrectly low velocities are used for migration.

Assume that the recording continues and passes beyond barrier position $z_{3}$ (Figure 4.1-9). We infer that the focused energy on the section at this depth (Figure 4.1-17f) would propagate through the focal point and turn into hyperbolas that are the mirror images of those in Figures 4.1-17a through 4.1-17e. We have downward continued more than necessary. This yields overmigration, which also is caused by incorrectly high velocities. From these observations, note that downward continuing to a wrong depth is like downward continuing with the wrong velocity (Doherty and Claerbout, 1974).

Another important issue to consider is how often the extrapolated wavefield should be computed. When going from one frame to another in Figure 4.1-17, what should the depth step size be? This is discussed in detail later in Section 4.3 .

## Differencing Schemes

Finite-difference migration algorithms are based on differential solutions to the scalar wave equation that are used to downward continue the input wavefield recorded at the surface. A simple numerical example illustrates the finite-difference method of solving differential equations (Clacrbout, 1985). Assume that you have $\$ 100$ today. Given an annual inflation rate of 10 percent, for the same buying power next year, you need $\$ 110$. A computer algorithm can determine the face value of the present $\$ 100$ in future years. Table $\mathbf{4 3}$ shows the results of extrapolation from one year to the next.

Given the present value, 100, find future values in the data column. The following equation solves for the unknown $x$ :

$$
(1.0) \times x+(-1.1) \times(100)=0
$$

which yields $x=110$. We used a two-point operator and aligned it with the data column as indicated in Table 4-3. Similarly, we have

$$
(1.0) \times x+(-1.1) \times(110)=0 \text {, }
$$

which yjelds $x=121$. By using the new value for $x$, we obtain

$$
(1.0) \times x+(-1.1) \times(121)=0 \text {, }
$$

which yields $x=133$, and so on. By moving the operator down in the time direction as shown in Table 4-3, we extrapolate the data column into the future.
Table 4-3. Simple extrapolation of a data vector in time.

| Operator | Data | Time Step |
| :---: | :---: | :---: |
| -1.1 | 100 | 0 |
| 1.0 | $x$ | 1 |
|  |  |  |
| -1.1 | 100 | 0 |
| 1.0 | 110 | 1 |
|  | $x$ | 2 |
|  | 100 | 0 |
| -1.1 | 110 | 1 |
| 1.0 | 121 | 2 |
|  | $x$ | 3 |

Equation (4-6a) is generalized as

$$
(1.0) \times P(t+1)+(-1.1) \times P(t)=0, \quad(4-7 a)
$$

which is rewritten in the form

$$
P(t+1)-P(t)-(0.1) \times P(t)
$$

where $t$ is the time variable and $P$ is the quantity being extrapolated. Instead of defining the time interval as one unit, we can define it as an arbitrary increment of time $\Delta t$. Also, assume that the inflation rate is $a$. Equation (4-7b) then takes the more general form

$$
P(t+\Delta t)-P(t)=a P(t)
$$

Alternatively, we could use the average of the present and future values on the right side of this equation:

$$
P(t+\Delta t)-P(t)=\frac{a}{2}[P(t+\Delta t)+P(t)]
$$

Equations (4-8a) and (4-8b) now can be put into the form of equation (4-6a) us

$$
P(t+\Delta t)+(-1-a) P(t)=0,
$$

and

$$
\left(1-\frac{a}{2}\right) P(t+\Delta t)+\left(-1-\frac{a}{2}\right) P(t)=0, \quad(4-9 b)
$$

By using either equation (4-9a) or equation (4-9b), we compute the future values of $P(t)$ from a given initial value as shown in Table 4-4.

The operator in which the coefficient of the future value $P(t+\Delta t)$ is unity is called the explect operator. Stability of the finite-difference solution the problem

Table 4-4. Application of two-point implicit and explicit operators to extrapolate data $P$ from $t$ to $t+\Delta t$.

| Explicit <br> Operator | Implicit <br> Operator | Data <br> Column |
| :---: | :---: | :---: |
| $-1-a$ | $-1-a / 2$ | $P(t)$ |
| 1 | $1-a / 2$ | $P(t+\Delta t)$ |

of wave amplitudes growing from one extrapolation step to another, can be an issue with this type of operator (Section D.6) An mplect operator produces stable results because of averaging on the right side of equation (4-9b), known as the Crank-Nicolson scheme. For the differential equations used in finite-difference migration algorithms, such as the parabolic equation described in Section D. 3, scalar a becomes a matrix coefficient, Implicit schemes require inversion of this matrix. However, no inversion is needed with explicit schemes, since future values can be written explicitly in terms of only past values.

Equation (4-9a) is rewritten by redefining scalar $a$ ts a $\Delta t$ to obtain

$$
\frac{P(t+\Delta t)-P(t)}{\Delta t}=a P(t)
$$

The left side of equation (4-10) is the discrete representation of the continuous derivative of $P$ with respect to time, $d P / d t$. Therefore, equation (4-10) is the finztedefference equation that corresponds to the defferential equation

$$
\frac{d P}{d t}=a P(t)
$$

We have derived the differential equation that describes the inflation of money (equation 4-11). Now consider the analysis in reverse order. We start with the differential equation (4-11), and write the corresponding difference equation (4-10), which is the equation that is solved in the computer. This equation is written in either the explicit (equation 4-9a) or implicit (equation 4-9b) form to extrapolate the present value of $P$ to the future.

This example illustrates how finite-difference schemes can solve differential equations in the computer. The scalar wave equation can be treated in a similar, but more complicated manner. Complications arise because it is a partial differential equation that contains the second derivatives of the wavefield with respect to depth, time, and spatial axes. Setting up the computer algorithm is more involved and is not discussed here. Clacrbout $(1976,1985)$ provides details of various aspects of the finite-difference migration methods.

## Rational Approximations for Implicit Schemes

The scalar wave equation is a two-way wave equation in depth that describes propogation of both upcoming and downgoing waves. If we consider the resulting wavefield from the exploding reflectors model as the upcoming waves, then we are really interested in o one-way wave equation to doumuand continue the upcomeng waves. In fact, we normally use some rational approximation to the one-way wave equation in finite-difference implementations.

To get the actual differential equation to be used in downward extrapolation of the upcoming waves, and therefore to perform a finite-difference migration, the general strategy is as follows:

(a) Start with the two-way scalar wave equation:

$$
\frac{\partial^{2} P}{\partial x^{2}}+\frac{\partial^{2} P}{\partial z^{2}}-\frac{1}{v^{2}(x, z)} \frac{\partial^{2} P}{\partial t^{2}}=0
$$

where $x$ and $z$ are the space variables, $t$ is the time variable, $v$ is the velocity of wave propagation, and $P(x, z, t)$ is the pressure wavefield.

(b) Assume constant velocity and perform 3-D Fourier transform of the pressure wavefield. This is equivalent to substituting the plane-wave solution $\exp \left(i k_{x} x+i k_{z} z-i \omega t\right)$ to equation (4-12). The substitution yields the dispersion relation between the transform variables

$$
k_{z}=\mp \sqrt{\frac{\omega^{2}}{v^{2}}-k_{x}^{2}}
$$

where $k_{x}$ and $k_{z}$ are the wavenumbers in the $x$ and $z$ directions, and $\omega$ is the angular temporal frequency.

(c) We are interested in upcoming waves, hence we only need one of the two solutions. We also want to invoke the exploding reflector model by replacing $v$ by $v / 2$ to obtain the following paramal dispersion relation

$$
k_{z}=\frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{w}}{2 \omega}\right)^{2}}
$$

where the horizontal waventmber $k_{w}$ has been normalized with respect to $2 \omega / v$.

(d) Make a rational approximation to the square-root expression in equation (4-13b) so as to derive a differential equation (Sections D. 3 and D.4). This
approximation imposes a dip limitation to the differential equation. One approxination to the dispersion relation given by equation (4-13b) is obtained by Taylor expansion of the square root and retaining the first two terms in the series (Section D.3)

$$
k_{z}=\frac{2 \omega}{v}\left[1-\frac{1}{2}\left(\frac{v k_{x}}{2 \omega}\right)^{2}\right]
$$

This dispersion equation is known as the 15-degree approximation and is the basis for the first fintedifference time migration algorithm developed by Claerbout and Doherty (1972). Aibeit no longer in use, we shall review the 15-degree finite-difference algorithm for its historical significance.

(c) Operate on the pressure wavefield $P\left(k_{x}, k_{z}, \omega\right)$ with the approximate form of the dispersion relation given by equation (4-14a), and inverse Fourier transform in the $z$ direction to get the differential form of the approximate one-way wave equation.

$$
\frac{\partial}{\partial z} P\left(k_{z}, z, \omega\right)=-i \frac{2 \omega}{v}\left[1-\frac{1}{2}\left(\frac{v k_{x}}{2 \omega}\right)^{2}\right] P\left(k_{x}, z, \omega\right) .
$$

(f) Recall from Figure 4.1-17 that, after each downward-continuation step, we retard the wavefield by translating it in time so that after migration, events appear in their correct depth lacations. The time retardation is done by applying a linear phase shift to the pressure wavefield $P$

$$
Q=P \exp (-i \omega \tau)
$$

where the retarded time is

$$
\tau=\int_{0}^{z} \frac{d z}{\bar{v}(z)}
$$

and $Q$ is the retarded wavefield. The velocity $\bar{v}(z)$ is the horizontally averaged $v(x, z)$. Substitute equation (4-15a) into (4-14b) to obtain the differential equation associated with the 15-degrec finitedifference algorithm in two parts

$$
\frac{\partial^{2} Q}{\partial z \partial t}=\frac{v}{4} \frac{\partial^{2} Q}{\partial x^{2}}
$$

and

$$
\frac{\partial Q}{\partial z}=2\left[\frac{1}{\bar{v}(z)}-\frac{1}{v(x, z)}\right] \frac{\partial Q}{\partial t}
$$

where $Q$ is the retarded wavefield. Derivation of equations $(4-16 a, b)$ is based on the assumption that velocity varies vertically. Nevertheless, in practice, the velocity function in equations (4$16 a, b)$ can be varied laterally, provided the variation is smooth. Equation (4-16a) accounts for col- lapsing diffaction energy to the apex of the traveltime curve only. Hence, it is referred to as the diffraction term. When lateral velocity variations are significant, the diffraction curve is somewhat like a skewed hyperbola with its apex shifted laterally away from the difiraction source. This lateral shift is accounted for by the thm-lens term given by equation (4-16b) (Section D.3). If the lateral velocity variations are significant, then the thinlens term is not negligible. Migration algorithrns that implement both the diffraction and thin-lens terms represented by equations (4-16a,b) generally are two-step schemes that alternately solve these two terms. To propagate one depth step, first apply the difraction term on wavefield $Q$. The thin-lens term then is applied to the output from the diffraction calculation. A migration method that includes the effects of the thin-lens term is called depth migration, since the output section is in depth. Depth migration is warranted if there are strong lateral variations in velocity; in this case, the coefficient of the thin-lens term cannot be negligible. If we assume that velocity varies only in the vertical direction, then $\bar{v}(z)=v(x, z)$. This makes the thinlens term of equation (4-16b) vanish, and we are left with the diffraction term of equation (4-16a). A migration method that implements the diffraction term (equation 4-16a), only, is known as tame megration, the output of which is in time $\tau$ of cquation (4-15b). When recast in terms of the $\tau$ variable, equation (4-16a) takes the form

$$
\frac{\partial^{2} Q}{\partial \tau \partial t}=\frac{v^{2}}{8} \frac{\partial^{2} Q}{\partial x^{2}}
$$

This is the parabolic equation for time migration.

(g) Finally, write down the difference forms of the differential operators either in implicit form to be used in finite-difference solution of the parabolic equation (4-17) for migration.

Boundary and initial conditions are needed to solve the differential equations. The initial condition for migration is the recorded wavefield at the surface $z=0$. Also, in migration we assume that the wavefield is zero after a maximum observation time, typically the end time of the recorded trace. Then there are the side boundaries, beyond which assumptions must be made about the form of the wavefield.

In the $(x, z, t)$ coordinates, the seismic section is represented by the $x-t$ plane, while the migrated section (earth) is represented by the $x-z$ plane. Finitedifference migration, as discussed here, extrapolates the $x-t$ plane in finite increments of $z$ and outputs the wavefield at $t=0$ at each step (Figure 4.1-19).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0509.jpg?height=405&width=385&top_left_y=115&top_left_x=101)

FIG. 4.1-19. The seismic section represented by the $x-t$ plane at the surface $z=0$ is downard continued to obtain the time sections at discrete depth levels. The direction of extrapolation is indicated by tho thick arrow. The migrated section is represented by the $x-z$ plane at $t=0$.

There are two ways to downward continue the wavefield recorded at the surface in the computer (Figure 4.1-20). Starting with the wavefield at the surface $z=0$ represented by the vectors in $x-s_{1}, s_{2}, s_{3}, \ldots$, which are perpendicular to the page, we can compute the wavefield at different depth levels using the order of the computation shown in Figure 4.1-20a. Assume zero value for the bottom of the extrapolated wavefield at each depth step. So, for example, using $s_{7}, s_{8}$, and 0 , compute the wavcfield at position 1 . Then use $s_{6}, s_{7}$, and the wavefield already computed at position $1, \mathrm{com}-$ pute that at position 2, and so on. Notice that, in this scheme, we compute the wavefield at all times for one depth step, then compute the wavefield at all times for the next depth step, followed by the next depth step, and so on. Hence, this is called the $z$-outer computational scheme.

The alternate scheme involves a different order of computation (Figure 4.1-20b). First, compute the wavefield at one time for all depths, then using those al. ready computed values, compute the wavefield at the next shallower time for all depths, and so on. Hence this is called the $t$-outer computational scheme.

In both schemes, the output migrated section is obteined by collecting the diagonal clements. Depending on the depth step size, which can be conveniently defined as the number of time samples, one collects one or more samples at each depth level. In the example shown

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0509.jpg?height=299&width=174&top_left_y=115&top_left_x=548)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0509.jpg?height=300&width=174&top_left_y=113&top_left_x=778)

(b)
FIG. 4.1-20. Two algorithmic schemes to downward contonue wavefields in the computer: (a) $z$-outer, and (b) $t$ outer. The midpoint axis is perpendicular to the plane of the paper. In both schemes, the CMP-stacked data are represented by the $s$-column at $z=0$ (Claerbout, 1976).

in Figure 4.1-20, there are two samples from each depth step collected into the migrated section.

## Reverse Time Migration

Another migration method, known as reverse time migration (Baysal et al., 1983), extrapolates an initially zero $x-x$ plane backward in time, bringing in the seismic data $P(x, z=0, t)$ as a boundary condition $z=0$ at each time step to compute snapshots of the $x-z$ plane at different times. At time $t=0$, this $x-z$ plane contains the migration result $P(x, z, t=0)$ (Figure 4.121).

The algorithmic structure for the reverse time migration is illustrated schematically in Figure 4.1-22. Start with the $x-t$ section at the surface, $z=0$. Also, consider an $x-z$ frame at $t_{\text {max }}$. This frame is blank except for the first row which is equal to the bottom row of the $x-t$ section at $t_{\max }$. Extrapolate this snapshat at $t=t_{\max }$ to $t=t_{\max }-\Delta t$ by using the phase-shift operator $\exp (i \omega \Delta t)$. This yields a new snapshot of the $x-\boldsymbol{z}$ frame at $t=t_{\max }-\Delta t$. The first row of numbers in this frame is identical to the row in the $x-t$ plane - the original unnigrated section, at $t=t_{\max }-\Delta t$. Hence, replace the first row in the snapshot at $t=t_{\max }-\Delta t$ with the row of the $x-t$ section at $t=t_{\text {max }}-\Delta t$ and contime the extrapolation back in time. The last snapshot is at $t=0$ that represents the final migrated section.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0510.jpg?height=400&width=404&top_left_y=115&top_left_x=93)

FIG. 4.1-21. Reverse time migration: Start with an all-zero $x-z$ plane at the bottom of the data cube and extrapolate backward in time toward $t=0$ to compute snapshots of the $x-z$ plane at different times. These snspshots of the subsurface are indicated by the horizontal planes; the direction of extrapolation - reverse in time, is indicated by the thick arrow. At each time level, include the boundary value ( $\tau$ slice at $z=0$, indicated by the dotted lines) into the $x-z$ plane from the seismic section. The migrated section is the $x-z$ plane at $t=0$ (the top horizontal plane).

## Frequency-Space Implicit Schemes

As discussed in Section 4.3, in practice the 15-degree finite-difference migration can handle dips up to 35 degrees with sufficient accuracy. A steep-dip approximation to equation (4-13b) is achiered by continued fractions expansion (Section D.4) as

$$
k_{z}=\frac{2 \omega}{v}\left[1-\frac{v^{2} k_{x}^{2}}{8 \omega^{2}} \frac{1}{1-\frac{v^{2} k_{x}^{2}}{16 \omega^{2}}}\right]
$$

This dispersion equation is known as the 45-degree approximation and is the besis of the most common implementation of steep-dip implicit finite-difference schemes (Kjartansson, 1979).

Refer to the steps described earlier and replace the Taylor expansion given by equation (4-14a) with the continted fractions expansion given by equation (4-18). Follow the subsequent steps to derive the corresponding differential equation associated with the 45-degree diffaction term (Section D.4):

$$
i \frac{v}{4 \omega} \frac{\partial^{3} Q}{\partial z \partial x^{2}}-\frac{\partial^{2} Q}{\partial x^{2}}+\imath \frac{4 \omega}{v} \frac{\partial Q}{\partial z}=0
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0510.jpg?height=477&width=214&top_left_y=116&top_left_x=644)

FIG. 4.1-22. An algorithmic description of reverse time migration.

where $Q(x, z, \omega)$ is the retarded wavefield in the frequency-space domain.

When recast for time migration, equation (4-19a) becomes (Section D.4):

$$
i \frac{1}{2 \omega} \frac{\partial^{3} Q}{\partial \tau \partial x^{2}}-\frac{\partial^{2} Q}{\partial x^{2}}+i \frac{8 \omega}{\nu^{2}} \frac{\partial Q}{\partial \tau}=0
$$

where $\tau$ is the time variable associated with the migrated data.

Note that dropping the first term in equation (419a) and inverse Fourier transforming in time yields the 15-degree diffraction equation (4-16a). Similarly, dropping the first term in equation (4-19b) yileds the 15degree equation (4-17) for time migration.

As for the 15-degree equation, the thin-lens equation (4-16b) also applies for the 45-degree equation. When implemented in the frequency-space domain, the thin-lens term is represented by the phase-shift operator of equation (4-15a). Again, the final step in the procedure is to write down the difference forms of the differential operators in implicit form to be used in finite-difference solution of the 45-degree equation (419) for migration. Kjartansson (1979) provides an implicit scheme in which the extrapolation is in $z$. Nevertheless, as for the 15 -degree equation (4-17), it is trivial to adapt his scheme for time migration with the extrap-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0511.jpg?height=351&width=394&top_left_y=126&top_left_x=93)

FIG. 4.1-23. An algorithmic description of frequency-space migration

olation in $\tau$ of equation (4-15b). The phaseshift operator of equation (4-15a) is velocity-dependent when implemented for depth migration, and it is velocityindependent when implemented for time migration.

The 45-degree approximation given by equation (419b) actually is fairly accurate in practice up to 60 degrees. As described in Section D.4, the basic 45-degree equation (4-19b) also can be adapted to obtain extrapolation schemes for imaging steeper dips up to 90 degrees. Nevertheless, a penalty is paid for steep-dip accuracy in terms of dispersive noise incurred by implicit schemes (Section 4.3).

Steep-dip finite-difference algorithms may be more conveniently implemented in the frequency-space domain than in the time-space domain. A general framework for implementing such algorithms involve a loop over the depth step $z$, and a loop over the frequency $\omega$ (Figure 4.1-23). For each depth step:

(a) Apply the shift term (equation 4-15a).

(b) Apply the diffraction term (equation 4-19) by performing implicit extrapolation of each of the frequency components of the warefield.

(c) Sum over the frequencies to invoke the imaging principle which is equivalent to setting $t=0$.

(d) Repeat the computation for all the depth steps to complete the imaging.

## Frequency-Space Explicit Schemes

Start with the paraxial dispersion relation given by equation (4-13b) adapted to the exploding reflectors model. Operate on the pressure wavefield $P$ and inverse Fourier transform in $z$ to obtain the differential equation

$$
\frac{\partial}{\partial z} P\left(k_{x}, z, \omega\right)=-i k_{z} P\left(k_{x}, z, \omega\right)
$$

whose solution can be used to extrapolate the wavefield at the surface down in depth

$$
P\left(k_{z}, z, \omega\right)=P\left(k_{x}, 0, \omega\right) \exp \left(-i k_{z} z\right) .
$$

For a discrete depth step $\Delta z$, equation (4-21) takes the form

$$
P(z+\Delta z)=P(z) \exp \left(-i k_{z} \Delta z\right)
$$

where, for convenience, the variables $k_{x}$ and $\omega$ have been omitted from $P$.

When designing extrapolation operators, whatever the differencing scheme, the objective must be to ensure that the phose and amplitude of the actual operator closely resembles those of the desired operator $\exp \left(-i k_{z} \Delta z\right)$.

Discretize the one-way wave equation (4-20) and apply differencing approximation using an explicit scheme such as

$$
P(z+\Delta z)=P(z)\left(1-i k_{z} \Delta z\right)
$$

and an implicit scheme (Section D.6):

$$
P(z+\Delta z)=P(z)\left[\frac{1-i k_{z} \Delta z / 2}{1+i k_{z} \Delta z / 2}\right]
$$

The explicit extrapolation operator $\left(1-k_{z} \Delta z\right)$ of equation (4-22b) actually is the first two terms of the Taylor expansion of the exact operator $\exp \left(-\imath k_{z} \Delta z\right)$ of equation (4-22a). Table 4-5 provides the amplitude and phase of the exact, explicit and implicit operators used in equations ( $4-22 a, b, c$ ) for wavefield exptrapolation in depth.

A desired property of an extrapolation operator is that it must be stable - its amplitude should be less or equal to unity. The implicit operator defined by equation $(4-22 c)$ is stable, while the explicit operator defined by equation (4-22b) causes amplitudes of the extrapolated wavefield grow with depth (Section D.6). In fact, the larger the depth step $\Delta z$, the more unstable are the results of extrapolation. Another desired property of an extrapolation operator is that it should yield the least phase error. The inherently stable nature of implicit schemes has been the compelling reason for their use in practice. Recent developments in the design of stable explicit schemes, however, now have made them widely accepted (Holberg, 1988; Hale, 1991; Soubaras, 1992).

In principle, the exact extrapolation operator in equation (4-22a) can be inverse Fourier transformed to

Table 4-5. Amplitude and phase of the exact, explicit and implicit extrapolation operators used in equations (4-22a,b,c). See Section D. 6 for details.

| Operator | Amplitude | Phase |
| :---: | :---: | :---: |
| Exact | 1 | $k_{z} \Delta z$ |
| $\exp \left(-i k_{z} \Delta z\right)$ | 1 |  |
| Explicit |  | $\tan ^{-1}\left(k_{z} \Delta z\right)$ |
| $1-\imath k_{z} \Delta z$ | $\sqrt{1+\left(k_{z} \Delta z\right)^{2}}$ |  |
| Implicit |  | $\tan ^{-1}\left[\frac{k_{z} \Delta z}{1-\left(k_{z} \Delta z / 2\right)^{2}}\right]$ |

frequency-space $(\omega-x)$ domain and applied to $P(z)$ in aл explucit manner. Each output sample of $P(z+\Delta z)$ at some $\tau$ location for a frequency $\omega$ and velocity $v$ is computed independently by convolving an explicit filter operator of a specified length centered at the output location $x$ with the input data array $P(z)$ in the $x$ direction. In contrast, implicit schemes require solving a set of linear equations to obtain the output samples of $P(z+\Delta z)$ - computationally more intensive than convolution. Efficiency is an advantage of the explicit schemes over the implicit schemes.

Another attractive property of stable explicit schemes is their extension to 3-D extrapolation that preserves circular symmetry - a feature that is relatively more difficult to attain with implicit schemes (Section 7.3).

Whether an explicit filter is computed by inverse transforming the exact filter $\exp \left(-i k_{z} \Delta z\right)$ of equation (4-22a) to the frequency-space domain or by Taylor expansion as in equation (4-22b), the problem is that neither approach yields a stable filter operator. A stable explicit extrapolation filter in the frequency-space domain can be designed using a constrained least-squares technique (Holberg, 1988), or by a modified Taylor series expansion of the exact extrapolation filter $\exp \left(-i k_{z} \Delta z\right)$ (Hale, 1991). Another method of explicit operator design based on on an alternative stability criterion is presented by Soubaras (1992).

By substituting for $k_{z}$ from equation (4-13b), the exact extrapolation filter $\exp \left(-\imath k_{z} \Delta z\right)$ of equation (422a) is expressed in the frequency-wavenumber domain as

$$
D\left(k_{x}\right)=\exp \left\{-i \frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{x}}{2 \omega}\right)^{2}} \Delta z\right\}
$$

The objective is to find, for a specific frequency $\omega$ and velocity $v$, a symmetric explicit filter with complex coefficients $h(x)$ in the frequency-space domain such that, when Fourier transformed to the frequencywavenumber domain, the difference between the actual transform $H\left(k_{x}\right)$ and the desired transform $D\left(k_{x}\right)$ of equation (4-23) is minimum, subject to the stability constraint that the amplitude of $H\left(k_{z}\right)$ is never greater than unity within the propagation region $k_{x} \leq(2 \omega / v)$. Details of the method of modified Taylor expansion based on this design criterion by Hale (1991) are described in Section D. 5 .

As for the implicit schemes (Figure 4.1-23), a migration algorithm based on an explicit extrapolation filter design involves a loop over the depth step $z$ and a loop over frequency $w$. For each depth step:

(a) Convolve the explicit extrapolation filter $h(x)$ with each of the frequency components of the wavefield.

(b) Sum over the frequencies to invoke the imaging principle which is equivalent to setting $t=0$.

(c) Repeat the computation for all the depth steps to complete the imaging.

The length of the filter coefficients $h(x)$ determines the dip accuracy of the explicit operator. The larger the number of filter coefficients $2 N+1$, the steeper the dip accuracy. In practice, extrapolation filter lengths 7, 11 , and 25 are often associated with $30-, 50$, and $70-$ degree dip accuracies. Phase error of the extrapolation operator at steep dips may be reduced by increasing the number of coefficients. Also, lateral velocity variations can be accommodated by varying the velocity at each $x$ location of the filter coefficient.

## Frequency-Wavenumber Migration

Froquency-wavcnumber $(f-k)$ migration is not as easily explained as the Kirchhoff or finite-difference migration from a physical point of view. Chun and Jacewitz (1981) provide practical insight into the principles of $f-k$ migration.

In Section 1.2, we learned that dipping events in the $t-x$ domain map onto the $f-k$ domain along radial lines. The steeper the dip, the closer the radial line is to the wavenumber axis. Figure 4.1-24 shows dipping events before and after migration in the $t-x$ and $f-k$ domains. The Nyquist wavenumber is 20 cycles $/ \mathrm{km}$ and the bandwidth is given by the corner frequencies 6,12 $-36,48 \mathrm{~Hz}$ for the passband region of the spectrum. (See Figure 1,1-26 for the definition of corner frequencies.) The red is associated with the flat part of the passband region and the blue is associated with the taper zone. Note that migration rotates the radial lines
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0513.jpg?height=580&width=586&top_left_y=162&top_left_x=179)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0513.jpg?height=518&width=102&top_left_y=249&top_left_x=745)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0513.jpg?height=432&width=542&top_left_y=770&top_left_x=178)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0513.jpg?height=366&width=84&top_left_y=763&top_left_x=782)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0514.jpg?height=635&width=396&top_left_y=118&top_left_x=93)

FIG. 4.1-25. Migration in the $f-k$ domain. (Migration in the $t-x$ domain is illustrated in Figure 4.1-1.) (a) A dip. ping reflector is represented by a radial line $O B$ in the $f-k$ plane. (b) After migration, the radial line $O B$ maps onto another radial line $O B^{\prime}$, while $B$ maps onto $B^{\prime}$. The horizontal wavenumber is invariant under migration. For comparison, the $f-k$ response of the dipping event before migration (a) has been superimposed on the $f-k$ response after migration (b). (Adapted from Chun and Jacewitz, 1981.)

in the 2-D amplitude spectrum outward and away from the frequency axis. The steepest event represented by radial line $A$ maps onto radial line $B$ after migration. The feather-like energy especially prominent in the left quadrant of the $f-k$ spectrum is associated with the flanks of the diffraction hyperbolas in the $t-x$ domain. The energy associated with the left flanks which are dipping opposite to the dipping reflections maps onto the left quadrant of the $f-k$ plane. And the energy associated with the right flanks of the diffraction hyperbolas that are dipping in the same direction as that of the dipping reflections maps onto the right quadrant of the $f-k$ plane and is superimposed on the energy associated with the dipping reflections themselves.

Migration of a dipping event in the $f-k$ domain is sketched in Figure 4.1-25. Note that this figure is the $f-$ $k$ equivalent of Figure 4.1-1. In both figures, we assume velocity equal to 1 . The vertical axis in Figure 4.1-25 represents the temporal frequency $\omega$ for the event in its unmigrated position $B$, and the vertical wavenumber $k_{z}$ for the event in its migrated position $B^{\prime}$.

Migration in the frequency-wavenumber domain inpolves mapping the lines of constant frequency $A B$ in the $\omega-k_{x}$ plane to circles $A B^{\prime}$ in the $k_{z}-k_{x}$ plane. Therefore, migration maps point $B$ vertically onto point $B^{\prime}$. Note that in this process, the horizontal wavenumber $k_{x}$ does not change as a result of mapping. When this mapping is completed, the dipping event $O B$ is mapped along $O B^{\prime}$ after migration; thus, the dip angle $\bar{\theta}$ after migration is greater than the dip angle $\theta$ before migration. For comparison, these two radial lines are shown on the same plane $k_{z}-k_{x}$

We now examine the diffraction hyperbola and its collapse to the apex after migration in the $f-k$ domain. A diffraction hyperbola is represented by an inverted triangular area in the frequency domain as shown in Figure 4.1-26. The Nyquist wayenumber is 40 cycles $/ \mathrm{km}$ and the bandwidth is given by the corner frequencies 6 $12-36,48 \mathrm{~Hz}$ for the passband region of the spectrum. As for the dipping events model in Figure 4.1-24, the red is associated with the flat part of the passband region and the blue is associated with the taper zone. The two edges in the right and left quadrant of the $f-k$ plane correspond to the asymptotes of the flanks of the diffraction hyperbola, the base of the inverted triangle corresponds to the high-frequency end of the passband and the tip of the triangle in the proximity of the origin of the $f-k$ plane corresponds to the low-frequency end of the passband. Migration turns the triangular area into a circular shape as shown in Figure 4.1-26.

The $f-k$ analysis of the diffraction hyperbola shown in Figure 4.1-20 is based on the representation of the hyperbola as a series of discrete dipping segments. Figure 4.1-27 depicts a diffraction hyperbola in the $t-x$ and $f-k$ domains. We imagine that the hyperbola is made up of a series of dipping segments, such as $A, B, C, D$ and $E$. The zero-dip segment $A$ is at the apex, while the steepest dip segment $E$ is along the asymptotes. In the $f-k$ domain, the zero-dip segment $A$ maps along the frequency axis, while the dipping segments $B, C$ and $D$ map along the radial lines, increasingly further away from the frequency axis. Finally, the asymptotic tail $E$ maps along the radial line that represents the boundary between the propagation and the evanescent region. The evanescent region corresponds
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0515.jpg?height=1018&width=588&top_left_y=178&top_left_x=175)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0515.jpg?height=889&width=70&top_left_y=242&top_left_x=767)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0516.jpg?height=359&width=776&top_left_y=126&top_left_x=133)

F1G. 4.1-27. A hyperbola on the $t-x$ plane maps onto an inverted triangular area on the $f-k$ plane. (See text for details.)

to the energy that is located at or greater than 90 degrees from the vertical. The opposite side of the hyperbola maps onto the second quadrant (negative $k_{x}$ ) in the $f-k$ domain. In the continuous case, a diffraction hyperbola is represented by a series of continuous radial lines that constitute an inverted triangular area in the $f-k$ domain (Figure 4.1-26).

A curious fact emerges from the $f-k$ spectrum of the migrated section in Figure 4.1-26. We expect migration to collapse the diffraction hyperbola to a point at the apex. The spectrum of this migrated section really should be more like that in Figure 4.1-28 - a rectangle. Why is there a difference between this spectrum and the spectrum after migration in Figure 4.1-26?

If you start with a point and model it, you get the diffraction hyperbola in Figure 4.1-28. However, in reality we deal with a diffraction hyperbola as shown in Figure 4.1-26. The hyperbolas do not look different in the $t-x$ domain, but note the difference in their $f-k$ spectra. The $f-k$ spectrum of the real-life diffraction, which is always subjected to bandpass filtering (Figure $4.1-26$ ), is missing the energy above the $48-\mathrm{Hz}$ line that is present in the $f-k$ spectrum of the modeled diffraction curve (Figure 4.1-28). These missing high frequencies cause the difference between the spectra after migration.

## Phase-Shift Migration

Theory of the frequency-wavenumber $(f-k)$ migration techniques is left to Section D.7. For now, we briefly review the $f-k$ migration algorithms as follows: (a) Just as any other migration algorithm, start with the two-way scalar wave equation (4-12),

(b) Assume constant velocity and perform 3-D Fourier transform and obtain the dispersion relation between the transform variables (equation 4-13a).

(c) Then, adapt the dispersion relation to the exploding reflectors model by halving the velocity for the upcoming waves (equation $4.13 \mathrm{~b}$ ).

(d) Operate on the pressure wavefield $P$ and inverse transform in $z$ to obtain the differential equation (4-20).

(e) Obtain the solution given by equation (4-21).

The discrete form of this solution given by equation (4-22) is the basis for phase-shift migration in which velocity can be varied at each depth step in the vertical direction.

The phase-shift method involves the following steps:

(a) Start with the stacked section - an approximation to the zero-offset section $P(x, z=0, t)$, and perform 2-D Fourier transform to get $P\left(k_{x}, z=0, \omega\right)$.

(b) By using equation (4-22), for each frequency $\omega$, extrapolate the transformed wavefield $P\left(k_{x}, z, \omega\right)$ at depth $z$ with a phase-shift operator $\exp \left(-i k_{z} \Delta z\right)$ to get the wavefield $P\left(k_{x}, z+\Delta z, \omega\right)$ at depth $z+\Delta z$. At each $z$ step, a new extrapolation operator with the velocity defined for that $z$ value is computed.

(c) As for any other migration, invoke the imaging principle $t=0$ at each extrapolation step to obtain the migrated section $P\left(k_{x}, z, t=0\right)$ in the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0517.jpg?height=1028&width=852&top_left_y=116&top_left_x=88)

4.1-28. (a) A diffraction hyperbola modeled from an impulse in the $t-x$ domain, (b) the $f-k$ spectrum of (a), (c) migration of (a), (d) the $f-k$ spectrum of (c); (e) bandpass-filtered version of (a), (f) the $f-k$ spectrum of (e), (g) migration of (e), and (h) the $f-k$ spectrum of $(\mathrm{g})$.
transform domain. The imaging condition $t=0$ is met by summing over all frequency components of the extrapolated wavefield at each depth step. This is easily shown from the integral representing the inverse Fourier transform of the extrapolated wavefield (equation D-84).

(d) Repeat steps (b) and (c) for downward continuation and imaging, respectively, for all depth steps to get the migrated section in the transform domain $P\left(k_{x}, z, t=0\right)$.

(e) Final stcp involves inverse transforming in the $x$ direction to get the migrated section $P(x, z, t=0)$.

Figure 4.1-29 shows a flowchart of the phase-shift mithod.

The phase-shift method (Gazdag, 1978) can only handle vertically varying velocities. A way to accommo date lateral velocity variations judged to be acceptable for time migration is to first stretch the CMP-stacked section in the time direction so as to nake it correspond to a velocity field $\bar{v}(z)$ that only varies verticelly. This velocity field is obtained by averaging the original velocity field associated with the unstretched CMP-stacked section in the $x$ direction. Following the stretching operation, the stacked section is migrated using the velocity function $\bar{v}(z)$ in the standard phase-shift migration schenc. Finally, the migrated section is unstretched.

Gazdag and Squazzero (1984) extended the phaseshift method to handle lateral velocity variations. To achieve this, first the input wavefield is extrapolated by the phase-shift method using a multiple number of laterally constant velocity functions and a series of reference wavefields are created. The imaged wavefield then is computed by interpolation from the reference wavefields. This migration method is known as phase-shiftplus-interpolation. An alternative extension of phaseshift migration to handle lateral velocity variations is presented by Kosloff and Kessler (1987).

## Stolt Migration

If the medium velocity is constant, migration can be expressed as a direct mapping (Stolt, 1978) from temporal frequency $\omega$ to vertical wavenumber $k_{z}$ (Figure 4.1-25). Figure 4.1-30 is a flowchart of the Stolt algorithm; the mathematical details are left to Section D.7. The equation for Stolt mapping is

$$
\begin{aligned}
P\left(k_{x}, k_{z}, t=0\right)= & {\left[\frac{v}{2} \frac{k_{z}}{\sqrt{k_{x}^{2}+k_{z}^{2}}}\right] } \\
& P\left[k_{x}, 0, \omega=\frac{v}{2} \sqrt{k_{y}^{2}+k_{z}^{2}}\right],
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0518.jpg?height=438&width=234&top_left_y=114&top_left_x=634)

FIG. 4.1-29. Flowchart for Gazdag's phase-shift method of migration.

$$
\begin{gathered}
P(x, z=0, t) \\
\downarrow \\
2-\mathrm{D} \mathrm{FFT}^{+1} \\
P\left(k_{x}, z=0, \omega\right) \\
\downarrow \\
\text { Map } \omega \text { to } k_{z} \\
\downarrow \\
\text { Apply the scaling factor } \\
\downarrow \\
P\left(k_{x}, k_{z}, t=0\right) \\
\downarrow \\
\text { 2-D FFT } \\
P(x, z, t=0)
\end{gathered}
$$

FIG. 4.1-30. Flowchart for Stolt's constant-velocity migration method in the $f-k$ domain.

where $P\left(k_{x}, z=0, \omega\right)$ is the zero-offset section and $P\left(k_{z}, k_{z}, t=0\right)$ is the migrated section in the frequencywavenumber domain.

Note that Stolt migration involves, first, mapping from $\omega$ to $k_{z}$ for a specific $k_{x}$ by using the dispersion relation of equation (4-13a) recast as

$$
\omega=\frac{v}{2} \sqrt{k_{x}^{2}+k_{z}^{2}}
$$

The output of mapping is then scaled by the quantity $S$

$$
S=\frac{v}{2} \frac{k_{z}}{\sqrt{k_{z}^{2}+k_{z}^{2}}}
$$

Stolt's algorithm for constant velocity thus involves the following steps:

(a) Start with the input wavefield $P(x, z=0, t)$ approximated by the CMP stack, and apply 2-D Fourier transform to get $P\left(k_{x}, z=0, \omega\right)$.

(b) Map the wavefield from $w$ to $k_{2}$ using the dispersion relation given by equation (4-24b).

(c) Apply the scaling factor $S$ of equation (4-24c) as part of the mapping procedure (Section D.7).

(d) Invoke the imaging principle by setting $t=0$ and obtain $P\left(k_{s}, k_{z}, t=0\right)$.

(e) Finally, apply 2-D inverse transform to get the migrated section $P(x, z, t=0)$.

It may be questionable as to whether the constantvelocity Stolt method has value on its own as a practical migration algorithu. Nevertheless, Stolt's method can be used efficiently to perform a constant-velocity migration as the first step in a residual migration scheme (Section 4.5). Additionally, the method constitutes an essential procedural step for migration velocity analysis as described in Section 5.4.

Stolt extended his method to handle velocity veriations (Section D.7). For the variable-velocity case, Stolt's extension consists of

(a) modifying the input wavefield to make it appear as if it were the response of a constant-velocity earth,

(b) applying the constant-velocity algorithm outlined in Figure 4.1-30, and

(c) reversing the original modification of the input wavefield.

This modification essentially is a type of stretching of the time axis (Section D. I) to make the reflection times approximately equivalent to those recorded for a constant-velocity earth. The nature of stretching is described by the stretch factor $W$. The const ant-velocity case is equivalent to $W=1$.

Note that the phase-shift and Stolt migration outputs normally are displayed in two-way vertical zerooffset time $\tau=2 z / v$, as are the outputs from the finite-difference and Kirch of migrations. In practice, mapping in the $f-k$ domain really is from $\omega-k_{x}$ to $\omega_{r}-k_{x}$ rather than to $k_{z}-k_{x}$, where $\omega_{r}$ is the Fourier dual of $\tau$ and is simply $k_{z}$ of equation (4-13b) scaled by $v / 2$ (Section D.3):

$$
\omega_{\tau}=\omega \sqrt{1-\left(\frac{v k_{x}}{2 \omega}\right)^{2}}
$$

One important concept must be pointed out from equation (4-25). Note that for a constant $k_{x}, \omega_{r}<\omega$; thus, magation shifts the bandudth to lower frequencues. This is analogous to the conclusion derived in relation to the NMO correction, since the latter also causes data stretching to Iower frequencies (Section 3.1). The implication from equation (4-25) is demonstrated by the dipping events model in Figure 4.1-24. While the bandwidth of the zero-dip event is retained after migration, the bandwidth of the event, with steepest dip has shifted from approximately $40 \mathrm{~Hz}$ to $36 \mathrm{~Hz}$ at the high-frequency end of the spectrum. In fact, the shift in bandwidth is dip-dependent; events with different dips which have the same bandwidth before migration will have different bandwidths after migration.

## Summary of Domains of Migration Algorithms

Migration algorithms described in this section are based on the assumption that the input stacked section represents a zero-offset acoustic waveficld. As such, these algorithms are all based on the scalar wave equation (4-12). Table 4-6 provides a list of the migration algorithms described in this section with the associated design and application domains. While there exist several other migration algorithms, those listed in Table 4-6 are the most widely used in practice.

Also included in Table 4-6 are the types of velocity fields and dips each migration algorithm can accommodate. It is clear that each algorithm is limited by either the type of velocity variations or dip ranges. Therefore, each has an appropriate usage in practice depending on field data and velocity characteristics (Section 4.0). Note that the lateral velocity variations implied by the velocity fields in Table 4-6 are mild to moderate and are within the bounds of time migration. Additionally, the choice of migration algorithm depends on whether your objective is imaging or migration velocity analysis. While imaging is the subject of this chapter, migration velocity analysis is discussed in Chapter 5.

Table 4-6. Domains of migration algorithms.

| Algurithm | Domain | Dips and <br> Velocities |
| :---: | :---: | :---: |
| Kirchhoff <br> Summation | $t-x$ <br> time-space | up to 90 deg <br> rms $v(x, \tau)$ |
| Finite-Difference <br> 15-deg Implicit | $t-x$ <br> time-space | up to 35 deg <br> int $v(x, r)$ |
| Finite-Difference <br> 45 -deg Implicit | $\omega-x$ <br> frequency-space | up to 65 deg <br> int $v(x, \tau)$ |
| Finite-Difference <br> 70-deg Explicit | $\omega-x$ <br> frequency-space | up to 80 deg <br> int $v(x, \tau)$ |
| Phase-Shift | $\omega-k_{x}$ <br> freq-wavenumber | up to 90 deg <br> int $v(\tau)$ |
| Stolt Method <br> with Stretch | $\omega-k_{x}$ <br> freq-wavenumber | up to 90 deg <br> rms $v(x, \tau)$ |

### 4.2 KIRCHHOFF MIGRATION IN PRACTICE

In this and the following three sections, the parameters that affect performance of Kirchhoff summation, finitedifference, and $f-k$ migration methods are discussed. In Kirchhoff migration, the important parameters are the aperture width used in summation and the meximum dip to migrate. In finite-difference and phase-shift migrations, the depth step size needs to be selected properly. The stretch factor is important in Stolt migration. The responses of these methods to velocity errors also are examined. All practical aspects are discussed using synthetic models of two zero-offset sections -- a model of dipping-events and a model of a diffraction hyperbola. Real data examples also are used to evaluate the choice of optimum parameters.

In Sections 4.2, 4.3, 4.4, and 4.5, migration results of different algorithms using various parameters are compared with a desired migration. In all cases, this desired migration was obtained using the phaseshift method with appropriate parameters and velocities. This does not imply that the phase-shift method always provides a desirable output; it only means that the data examples in this section were chosen so that the phase-shift algorithm is appropriate. The choice of the phase-shift method was a compromise; it handles dips of up to 90 degrees and velocities that can only vary vertically.

Before a migration algorithm is used on field dato, its impulse response must be tester. A band-limited impulse response is generated by using an input that contains an isolated wavelet on one trace only To also limit the spatial bandwidth, this trace is replicated on either side with the wavelet amplitude halved. The ideal migration algorithm should produce an impulse response that has the shape of a semicircle. Kirchhoff migration produces the section shown in Figure 4.2-1d. The impulse response indicates that Kirchhoff migration can accurately handle dips up to 90 degrees. The dip on a migration impulse response is measured as the angle $\theta$ between the vertical and a specified radial direction. Note that migration can be limited to smaller dips (Figure 4.2-1).

## Aperture Width

From the previous section, we know that Kirchhoff migration involves a summation of amplitudes along diffraction hyperbolas. Given the rms velocity at a particular time sample of a particular input trace, a hyperbolic traveltime trajectory associated with a fictitious diffractor is overlaid on the input section with its apex at that time sample. In theory, a diffraction hyperbola extends to infinite time and distance. In practice, we have to deal with a truncated hyperbolic summation path. The spatial extent that the actual summation path spans, called the migration aperture, is measured in terms of the number of traces the hyperbolic path spans.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0520.jpg?height=289&width=424&top_left_y=866&top_left_x=538)

FIG. 4.2-1. Migration can be confined to a range of dipe present on a seismic section. The impulse response for the dip-limited migration operator is a truncated semicircle. Dip angle $\theta$ is measured from the vertical axis.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0521.jpg?height=357&width=289&top_left_y=118&top_left_x=103)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0521.jpg?height=356&width=277&top_left_y=118&top_left_x=380)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0521.jpg?height=356&width=280&top_left_y=118&top_left_x=651)

(c)

FIG. 4.2-2. Summation paths for Kirchhoff migration in a medium with (a) low velocity (2000 m/s), (b) high velocity ( 4000 $\mathrm{m} / \mathrm{s}$ ), and (c) vertically varying velocity. Migration aperture is small for low velocities and large for high velocities.

The curvature of the diffraction hyperbola is governed by the velocity function. Figure $4.2-2 \mathrm{a}$ shows a number of low-velocity diffraction hyperbolas, while Figure 4.2-2b shows a number of high-velocity hyperbolas. A low-velocity hyperbola has a narrower aperture when compared to a high-velocity hyperbola. This agrees with our intuition - high velocity means more migration. In practice, we deal with a velocity function that at least varies with depth. The diffraction hyperbolas can have different curvatures depending on the velocity value at a given time sample (Figure 4.2-2c). Because of the vertical variation in velocity, aperture width generally is time variant. For the usual case in which velocity increases with depth, migration of the shallow part of the section requires a narrow aperture, while migration of the deep portion requires a wider aperture (Figure 4.2-2c). This implies that, given the same dip, deep events migrate farther than shallow events.

Figure 4.2-3 shows a zero-offset diffraction hyperbola ( $8 \mathrm{~ms} /$ trace dip along the asymptotes) and migrations using four different aperture widths. The smaller the aperture, the less capable the migration is in collapsing the diffraction hyperbola. In this case, use of an aperture width that is equal to the width of the input section (half aperture, 256 traces) yields the best result.

Figure 4.2-4 shows a synthetic zero-offset section that consists of a number of dipping events ranging from 0 to 45 degrees in increments of 5 degrees. Aperture width is related closely to the horizontal displacement $d_{x}$ that takes place in migration as defined by equation (4-1). The number of traces an event migrates is $n_{z}=d_{x} / \Delta x$, where $\Delta x$ is the CMP interval. Therefore, the aperture width that is required is $2 n_{x}+1$. Figure 4.2 4 also shows Kirchhoff migrations of the dipping events using four different aperture widths. Small-aperture migration eliminates steeply dipping events on the output section. Increasing the aperture width allows proper migration of the steeply dipping events. From this we see that using too small an aperture width causes a dip filtering action during migration, because a small aperture excludes the steeper flanks of the diffraction hyperbola from the summation.

For any given event position in time $t$ before migration, the optimal value for the aperture width is defined by twice the maximum horizontal displacement in migration for the steepest dip of interest in the input section. In this case, the horizontal displacement associated with the 45-degree dipping event is computed by substituting the values for $v=3500 \mathrm{~m} / \mathrm{s}, \Delta x=25 \mathrm{~m}$, $\Delta t / \Delta x=12 \mathrm{~ms} /$ trace, where $t=2 \mathrm{~s}$ in equation (4-1). The value for the borizontal displacement is 118 traces, giving an aperture width of 237 traces. Typically, we consider somewhat larger values to allow for velocity errors.

A good way to determine aperture width is to generate diffraction hyperbolas as shown in Figure 4.2-2c using the regionally averaged, vertically varying velocity. Clearly, the larger the aperture width, the more traces are used in the summation. For the dipping events in Figure 4.2-4, the optimal value of the halfaperture width is 150 traces; increasing the width to 300 traces resulted in no further improvement.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0522.jpg?height=917&width=405&top_left_y=187&top_left_x=316)

FIG. 4.2-3. Tests for aperture width in Kirchhof migration: (a) a zero-ofiset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; Kurchhof migration using (c) 35-trace, (d) 70-trace, (e) 150-trace, and (f) 256-trace half-aperture width.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0523.jpg?height=928&width=408&top_left_y=172&top_left_x=313)

FIG. 4.2-4. Tests for aperture width in Kirchhoff migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; Kirchhoff migration using (c) 35-trace, (d) 70-trace, (e) 150-trace, and (f) 256-trace half-aperture width.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0524.jpg?height=705&width=749&top_left_y=327&top_left_x=143)

FIG. 4.2-5. Tests for aperture width in Kirchhoff migration: Insufficient aperture width causes removal of steeply dipping events.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0525.jpg?height=701&width=827&top_left_y=317&top_left_x=92)

FIG. 4.2-6. Tests for aperture width in Kirchhoff migration: Insufficient aperture width causes spurious horizontal events in deep, noisy part of a stacked section.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0526.jpg?height=521&width=207&top_left_y=114&top_left_x=103)

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0526.jpg?height=520&width=192&top_left_y=114&top_left_x=317)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0526.jpg?height=475&width=186&top_left_y=117&top_left_x=526)

120 traces

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0526.jpg?height=519&width=207&top_left_y=115&top_left_x=726)

(d)

FIG. 4.2-7. Tests for aperture width in Kirchhoff migration: Input to migration is a section (a) that contains band-limited random noise uncorrelated from trace to trace. Note the spurious horizontal events in the deeper part of the section after migration using small aperture ( 60 traces); these gradually disappear at increasingly larger apertures.

A test of aperture width on the CMP stacked data example is shown in Figure 4.2-5. The small-aperture migration causes smearing in the deeper part of the section. This smearing effect destroys the dipping events and produces spurious horizontally dominant events. Smearing is reduced gradually with increasing aperture.

Figure 4.2-6 is the deeper portion of a stacked section with migrations using different aperture sizes. The smesring effert is much more noticeahle at small sperture. The main difference between the stacked sections in Figures 4.2-5 and 4.2-6 is that the latter, being deeper in time, contains a large amount of noise. This smearing phenomenon was not noticed in the noise-free synthetic model in Figure 4.2-4. We now soe that choice of aperture width is more critical than we originally thought. In particular, a small aperture changes the noise characteristics of the section.

Why do we see horizontally dominant smearing with small-aperture migration? To answer this, we must do a simple experiment with a section that contains only random noise and the velocity function used in migration incresses in time (Figure 4.2-7a). We see two interesting phenomena on the migrated sections using three different apertures. First, in all thres cases there is more smearing of noise in the deeper par of the data, where the velocities generally are higher than in the shallower part. Second, there is relatively more smearing in the small-aperture migration compared with others at a given time in the section. Moreover, this smearing is characterized by horizontally dominant spurious events, especially in the deeper part of the section. Note that even with a large aperture, some smearing still is present in the deepest part of the section in Figure 4.2-7d. As indicated in Figure 4.2-2b, because summation stops at the bottom of the section, the effective aperture $(C D)$ at late times is much smaller than that used in other parts of the section $(A B)$. Remember that summation using very small aperture includes only the apex portion of the diffraction hyperbola, where dips are nesuly flat. Therefore, the small aperture with a dip filtering
action passes flat or nearly flat events those horizontal wavenumber components that are zero or nearly zero.

In conclusion, the following assessinents are made concerning the choice of aperture width.

(a) Excessively small aperture width causes destruction of steeply dipping events and rapidly varying amplitude changes.

(b) Excessively small aperture width organizes random noise, especially in the deeper part of the section, as horizontally dominant spurious events.

(c) Excessively large aperture means more computer time. More importantly, large apertures can dograde the migration quelity in poor signal-to-noise ratio conditions. Use of large aperture will cause random noise at late times to creep into the good shallow data. Aperture width always is a compromise with noise.

(d) Sometimes it is better to use a smaller aperture than would theoretically be required to avoid the adverse effect of noise on the migrated event. Noise considerations may even require a timo-dependent aperture width.

(e) It is recommended that the aperture width be kcpt constant in migrating all lines from a particular survey so that an overall uniformity in amplitude characteristics on the migrated sections is maintained.

In practice, a regional velocity function and the steepest dip in a survey area are used to compute the optimal aperture width that can be used over the entire set of data from the area (equation 4-1).

## Maximum Dip to Migrate

During migration, we can specify the maximum dip we want migrated in the section. This may be useful when we need to suppress the steeply dipping coherent noise. Figure 4.2-8 shows migrations of the dipping events with four different maximum allowable dips. For a. $4 \mathrm{~ms} / \mathrm{trace} \mathrm{dip}$ limit, events with dips greater than this value are suppressed. Similarly, for an $8 \mathrm{~ms} /$ trace dip value, events with dips greater than this value are suppressed. When the dip value is $12 \mathrm{~ms} /$ trace, no suppression occurs, since all events in the input section have dips less than this value. Limiting the dip parameter is a way to reduce computational cost, since it is related to aperture width (equation 4-1), which determines the cost.

From Figure 4.2-1, note that the Kirchhoff migration impulse response can be limited to various max- imum dips. The smaller the maximum allowable dip, the smaller the aperture. This combination of maximum aperture width and maximum dip limit determines the actual effective aperture width used in migration. In particular, diffraction hyperbolas along which summation is done are truncated bcyond the spccified maximum dip limit.

A field data example of testing the maximum dip parameter is shown in Figure 4,2-9. Some steep dips are lost on the section that corresponds to the $2 \mathrm{~ms} /$ trace maximum allowable dip. The $8 \mathrm{~ms} /$ trace dip appears to be optimum. The maximum dip parameter must be chosen carefully so that the steep dips of interest in the input section are preserved. Finally, dip value can be changed spatially and in time; however, practical implementation can be cumbersome.

## Velocity Errors

We now examine the response of Kirchhoff migration to velocity errors. Figure 4.2-10 shows the diffraction hyperbola and migrations using the $2500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5, 10, and 20 percent lower velocities. With increasingly lower velocities, the diffraction hyperbola is collapsed less and less taking the shape of a frown it is undermigrated.

Figure 4.2-11 shows the same diffraction hyperbola and migrations using the $2500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5,10 , and 20 percent higher velocities. With increasingly higher velocities, the the diffraction hyperbola is inverted more and more taking the shape of a smile it is overmigrated.

The under-and overmigration effects resulting from the use of erroneously low or high velocities on the dipping events model are seen in Figures 4.2-12 and 4.213, respectively. Label the correct position of the event with the steepest dip from the desired migration on the results of migrations with different velocities and note the event mispositioning caused by erroneously low and high velocities. Compare with the desired migration and also note that the steeper the dip the more the underand overmigration effect. Sensitivity of migration to velocity errors can be measured quantitatively via equations 4-1 and 4-2.

From the migrated sections in Figure 4.2-14, note that the bow tie becomes increasingly less resolved at lower velocities; this indicates undermigration.

Figure 4.2-15 shows a CMP-stacked section and the desired migration. The steep left flank of the salt dome has been imaged with acceptable accuracy. The accuracy of the imaging of the slightly overturned right

(text contznues on p. 520)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0528.jpg?height=926&width=414&top_left_y=186&top_left_x=314)

FIG. 4.2-8. Tests for maximum dip to migrate in Kirchhoff migration: (a) \& zero-offet section that contans a diffraction hyperboia with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; Kirchhoff migration using (c) 4-ms/trace, (d) 8-ms/trace, (e) 12$\mathrm{ms} /$ trace, and (f) $24 \mathrm{~ms} /$ trace maximum dip.

Stack
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0529.jpg?height=776&width=396&top_left_y=278&top_left_x=122)

## Desired Migration

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0529.jpg?height=770&width=396&top_left_y=284&top_left_x=516)

FIG. 4.2-9. Tests for maximum dip to migrate in Kirchhoff migration: A low value for maximum dip to migrate can be hazardous. All dips of interest must be preserved during migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0530.jpg?height=779&width=407&top_left_y=232&top_left_x=315)

FIG. 4.2-10. Tests for velocity errors in Kirchhoff migration; (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; Kirchhoff migration using (c) the medium velocity of $2500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0531.jpg?height=726&width=407&top_left_y=285&top_left_x=315)

FIG. 4.2-11. Tests for velocity errors in Kirchhoff migration: (a) a zero-offet section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; Kirchhof migration using (c) the medium velocity of $2500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0532.jpg?height=830&width=408&top_left_y=222&top_left_x=314)

FIG. 4.2-12. Tests for velocity errors in Kirchhoff migration: (a) a zero-offet section that contains dipping events wii $3500-\mathrm{m} / \mathrm{s}$ velocty, (b) desired migration; Kirchhof migration using (c) the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent lowe (e) 10 percent lower, and (f) 20 percent lower velocity.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0533.jpg?height=843&width=407&top_left_y=216&top_left_x=315)

FIG. 4.2-13. Tests for velocity errors in Kurchhoff migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; Kirchhoff migration using (c) the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity.

## Stack

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0534.jpg?height=854&width=292&top_left_y=230&top_left_x=234)

## Desired Migration

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0534.jpg?height=864&width=286&top_left_y=234&top_left_x=518)

PIG. 4.2-14. Tests for velocity errors in Kirchhoff migration: Undermigration manifested as inadequate handli bowtie is caused by the use of velocities lower than those considered to be medium velocities.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0535.jpg?height=836&width=656&top_left_y=233&top_left_x=190)

FIG. 4.2-15. (a) A CMP-stacked section, and (b) migration using the phase-shift method. Event $A$ is the water-bottom multiple, and Event $B$ is the peg-leg multiple associated with the top-salt boundary. These multiples are respectively denoted by Events $C$ and $D$ on the migrated section.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0536.jpg?height=986&width=664&top_left_y=114&top_left_x=186)

FIG. 4.2-16. Tests for velocity errors in Kirchhof migration using, from top to bottom, 100, 95, 90, and 80 percent of rms velocities. The input stacked section is shown in Figure 4.2-15a and the desired migration using the phase-shift method is shown in Figure 4 2-15b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0537.jpg?height=969&width=674&top_left_y=116&top_left_x=176)

FIG. 4.2-17. Tests for velocity errors in Kirchhoff migration using, from top to bottom, 100, 105, 110, and 120 percent of rms velocities. The input stacked section is shown in Figure 42 2-15a and the desired migration using the phase-shift method is shown in Figure 4.2-15b.

Hank can only be inferred by the lateral positioning of the gently dipping reflections in the vicinity of the salt flank.

Figure 4.2-16 shows results of Kirchhoff migration of the stacked section in Figure 4.2-15 using velocities lower than what may be optimum for imaging. While the undermigration of the left flank of the salt dome is not so evident, the steeply dipping reflection off the right flank intersects the gently dipping reflections associated with the surrounding strata, thus providing a clue for undermigration.

Figure 4.2-17 shows results of Kirchhoff migration of the stacked section in Figure 4.2-15 using velocities higher than what may be optimum for imaging. While overmigration effects may be marginal on the section with a small velocity error ( 105 percent of optimum velocities), migration with higher velocity errors (110 and 120 percent of optimum velocities) shows signs of overmigration in the form of crossing events along the left flank of the salt diapir. Under- and overmigration effects caused by large velocity errors often are detectable; nevertheless, small velocity errors can cause subtle effects making it difficult to judge whether there is under- or overmigration. Uncertainties in migration velocities inevitably cause uncertainties in the interpretation made from migrated sections or volumes of data. For instance, the shape of the salt diapir inferred from the results shown in Figures 4.2-16 and 4.2-17 varies significantly depending on the percent velocity errors.

### 4.3 FINITE-DIFFERENCE MIGRATION IN PRACTICE

As described in Section 4.1, finite-difference migration is implemented using implicit and explicit schemes. In this section, we shall include in our discussion the 15degree finite-difference algorithm because of its historical significance. Nevertheless, we shall primarily discuss practical aspects of the steep-dip implicit and explicit schemes in the frequency-space domain. Specifically, we shall deal with the impulse responses, depth step size and response to velocity errors in implicit and explicit schemes.

The first finite-difference migration algorithm that was introduced to the seismic industry was based on the parabolic approximation to the scalar wave equation (Clserbout and Doherty, 1972). The algorithm was implemented in the time-space domain and designed using an implicit scheme. The parabolic approximation theoretically limits the algorithm to handling dips up to 15 degrees (Section D.3). Nevertheless, in practice, it can handle dips up to 35 degrees with sufficient accuracy due to the bandlimited nature of seismic data. Steeper dips, in principle, can be migrated by a cascaded application of the 15-degree algorithm (Larner and Beasley, 1990)

Finite-difference migration of stacked data currently is performed using steep-dip algorithms based on the continued fractions expansion to the scalar wave equation. This approximation provides a theoretical dip accuracy up to $\mathbf{4 5}$ degrees. The basic 45 -degree scheme can be improved to handle steeper dips up to 80 degrees with reasonable accuracy (Section D.4). The 45degree finite-difference algorithm commonly is imple mented using an implicit scheme in the frequency-space domain.

First, as we did for the Kirchhoff migration, we examine the impulse response of the 15-degree implicit scheme. The shape of the impulse response of a desired migration algorithm with no dip limitation is a semicircle. The shape of the impulse response of the 15-degree equation is, in theury, an ellipse (Claerbout, 1985) as seen in Figure 4.3-1. The nature of the dispersive noise pattern inside the ellipse is discussed in the next section on depth step size. Isolated noise spikes in field data can introduce such noise patterns on migrated sections.

The parts of the responses above the small circles in Figure 4.3-1 correspond to the evanescent energy, while the parts below the circles correspond to the propagating energy (Claerbout, 1985). The parts below the circles are the useful part of the response. The evanescent
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0538.jpg?height=304&width=426&top_left_y=772&top_left_x=536)

FIG. 4.3-1. Desired impulse response of a 90-degree migration algorithm is a semicircle (top), while the impulse response of the 15 -degree migration algorithm is an ellipse (bottom). The propagation zone is defined by the portion of the ellipse below the small circles, and the evanescent zone is defined by the portions above the small circles. For comparison, the desired response has been superimposed on the impulse response of the 15 -degree equation.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0539.jpg?height=513&width=393&top_left_y=118&top_left_x=116)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0539.jpg?height=512&width=203&top_left_y=120&top_left_x=507)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0539.jpg?height=507&width=206&top_left_y=125&top_left_x=713)

(c)

FIG. 4.3-2. (a) CMP stack, (b) desired migration by phase-shift method, (c) 15-degree finite-difference migration. The finite-difference migration based on the parabolic equation has the inherent property of undermigrating the steep flank of the diffraction and the steeply dipping event. See Figure 4.3-3 for a sketch of the migration results.

energy travels horizontally and is characterized by imaginary wavenumbers $k_{z}$, which occur when the quantity in the square root in equation (4-13b) becomes negative. This means that the evanscent region corresponds to horizontal wavenumbers $k_{x}>2 \omega / v$. For negative $k_{z}$, the exact extrapolator $\exp \left(-i k_{2} z\right)$ is no longer a wave propagator; instead, it causes waves to decay rapidly in depth. Thus, evanescent energy is not expected to be present in recorded wavefields. The impulse response of the 15-degree finite-difference algorithm, however, suggests propagation in the region of evanescence. This is not desirable; the parts of the elliptical wavefront above the small circles should be removed. Use of a depth step size that is greater than the input sampling rate tends to suppress the response in the evanescent region. Excessively large depth steps, however, cause truncation of the wavefront further into the propagating zone below the small circles in Figure 4.3-1.

The impulse response (Figure 4.3-1) is used to estimate the muximum dip that the implicit finitedifference algorithm can handle without serious amplitude distortions or phase errors. This is done by super- imposing the desired semicircular response and measuring the angle between the indicated lines. Note from the measured angle in Figure 4.3-1 that the 15-degree implicit scheme can be used to migrate dips up to approximately 35 degrees with sufficient accuracy. This is primarily because errors associated with finite-difference approximations used in particular implementations of the 15-degree equation usually are adjusted to cancel some of the theoretical error asonciated with the 15degree differential equation.

The dip-limited nature of the parabolic equation causes undermigration of steeply dipping events and steep flanks of diffractions. This is demonstrated by the field data example in Figure 4.3-2. The two prominent features, diffraction D and dipping event B, are located as shown in Figure 4.3-3 before and after migration.

## Depth Step Size

Finite-difference migration involves dnwnward continuation of the wavefield at the surface, such as a stacked

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0540.jpg?height=539&width=417&top_left_y=114&top_left_x=80)

FIG. 4.3-3. A sketch of the diffraction $D$ and steeply dipping event before $(B)$ and after $(A)$ desired migration from the sections in Figure 4.3-2. The diffraction and the dipping event after finite-difference migration using the parabolic equation are denoted by $F D-D$ and $F D-B$, respectively.

section, and invoking the imaging principle so as to create an image of the subsurface at $t=0$. The downward continuation takes place in the computer at discrete depth intervals (Section 4.1). Depth step size governs performance of finite-difference migration. Inappropriate specification of this parameter can cause artifacts in the migrated section. We want to choose an optimum depth step size that is large for computational savings, yet yields a tolerable error in positioning the events after migration.

Figure 4.3-4 shows the constant-velocity diffraction hyperbola and the 15-degree implicit finite-difference migrations using four different depth steps. Large depth steps cause severe undermigration as well as kinks along the flank of the diffraction curve (especially apparent in the 60- and 80-ms cases). At smaller depth steps, such as the 20 - and 40 -ms cases, more energy collapses to the apex, but the 15-degree scheme fails to achieve a complete focusing of the energy at the apex of the hyperbola. Note also the dispersive noise that trails the unfocused energy. The dip-limited nature of the 15 -degree algorithm, however, causes undermigration whatever the depth step size (Figure 4.3-5).
Undermigration of the diffaction energy along the steep flanks of the hyperbola is caused by the parabolic approximation to the scalar wave equation. The dispersive noise that accompanies the undermigrated energy is an effect of approximating differential operators with difference operators. The accuracy of this approximation decreases at large frequencies and wavenumbers (Claerbout, 1985). Thus, the dispersive noise becomes tess with smaller trace spacing and sampling in depth and time. For example, the difference operator of equation (4-10) becomes an increasingly better approximation to the differential operator of equation (4-11) as $\Delta t$ is made smedler. To emphasize more strongly the presence of the dispersive noise, migrated sections in Figures 4.3-4 and 4.3-5 have been displayed with the same display gain level as the input section. The dispersion normally is much less pronounced on field data.

Figure 4.3-6 shows the dipping events model and the 15-degree implicit finite-difference migration results using four different depth step sizes. We can make the following inferences:

(a) Increasing depth step size causes more and more undermigration at increasingly steep dips.

(b) The waveform along reflectors is dispersed at steep dips and large depth steps.

(c) Kinks occur along reflectors at discrete intervals that correspond to the depth step size. Kinks are more pronounced at increasingly steeper dips.

The first inference results from the parabolic approximation, the second from differencing approximations, and the third from gradual undermigration toward the base of each depth step. The kinks are good for diagnostics; their presence indicates that the depth step size that is used is too coarse for the dips present in the data. In that case, smaller depth step size should be used; then the kinks disappear altogether (Figure 4.37). Nevertheless, kinks that characterize undermigration can be eliminated by a local adjustment of migration velocities or interpolation between the wavefields at the adjacent depth steps.

It is apparent from Figure 4.3-6 that migration with 20-ms depth step, which corresponds to one-half of the typical dominant period of recorded seismic waves, has the least dispersion with the least undermigration

optimum accuracy in event positioning. Further decreasing depth step size does not improve migration significantly (Figure 4.3-7). The 15-degree implicit scheme causes precursive dispersion at large depth steps greater than $20 \mathrm{~ms}$ (Figure 4.3-6) and postcursive dispersion at small depth steps less than $20 \mathrm{~ms}$ (Figure 4.3-7). Hence, taking smailer depth steps does not necessarily mean a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0541.jpg?height=209&width=392&top_left_y=107&top_left_x=95)

b
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0541.jpg?height=782&width=382&top_left_y=335&top_left_x=104)

FIG. 4.3-4. Tests for extrapolation depth step size in 15degree finite-difference migration: (a) a zero-offset section that contains a diffaction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) $20-\mathrm{ms}$ (d) $40-\mathrm{ms}$, (e) $60-\mathrm{ms}$, and (f) $80-\mathrm{ms}$ depth step.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0541.jpg?height=200&width=384&top_left_y=114&top_left_x=558)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0541.jpg?height=72&width=371&top_left_y=349&top_left_x=571)

C
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0541.jpg?height=252&width=376&top_left_y=456&top_left_x=566)

e
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0541.jpg?height=316&width=376&top_left_y=742&top_left_x=558)

FIG. 4.3-5. Tests for extrapolation depth step size in 15degree finite-dufference migration: (a) a zero-offset section that contains a diffrection hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) 4-ms (d) $8-\mathrm{ms}_{1}$ (e) $12-\mathrm{ms}$, and (f) 16 -ms depth step.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0542.jpg?height=996&width=406&top_left_y=114&top_left_x=91)

FIG. 4.3-6. Tests for extrapolation depth step size in 15degree finite-difference migration: (a) a zero-offet section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) $20-\mathrm{ms}$ (d) $40-\mathrm{ms}_{2}$ (e) $60-\mathrm{ms}$, and (f) $80-\mathrm{ms}$ depth step.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0542.jpg?height=972&width=412&top_left_y=114&top_left_x=540)

FIG. 4.3-7. Tests for extrapolation depth step size in 15degree finite-difference migration: (a) a zero-offet section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) 4-ms (d) 8 -ms, (e) 12 -ms, and (f) 16-ms depth step.
better quality migration free of the artifacts that occur with the finite-difference method.

Figures 4.3-8 and 4.3-9 show the migrations of the stacked section in Figure 4.3-2a with five different depth steps using the 15 -degree implicit scheme. Note that as the depth step size is increased, the dipping event off the flank of the salt djapir is more undermigrated and the diffraction off the tip of the diapir is less collapsed. Dispersion along the diffraction hyperbola is apparent at larger depth steps (Figure 4.3-9). Again, this phenomenon is caused by the differencing approximations to the differential operators used in the design of a finite-difference algorithm.

## Velocity Errors

Figure 4.3-10 shows the diffraction hyperbola and its migration using the $2500 \mathrm{~m} / \mathrm{s}$ medium velocity and 5 , 10 , and 20 percent lower velocities. When velocities lower than medium velocity are used, the diffraction hyperbola gets undermigrated by the 15-degree algorithm more than it would be by an algorithm with no dip limitation (compare with Figure 4.2-10).

Figure 4.3-11 shows the diffraction hyperbola and its migration using the $2500 \mathrm{~m} / \mathrm{s}$ medium velocity and 5, 10, and 20 percent higher velocities. When velocities higher than medium velocity are used, the diffraction hyperbola gets overmigrated less by the 15 -degree algorithm than it would be by an algorithm with no dip limitation (compare with Figure 4.2-11). Moreover, note the increase in dispersive noise as a result of overmigration.

Figure 4.3-12 is the dipping events model with migrations using the $3500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5 , 10, and 20 percent lower velocities. For comparison, label the correct position of the event with the steepest dip from the desired migration on the results of migration with different velocities. As in any other migration method, velocity errors cause events to be mispositioned at increasingly steeper dips. The undermigration effect of lower velocities is reinforced by the inherently undermigrating nature of the 15-degree algorithm. As a result, dipping events are undermigrated more by the 15-degree algorithm in contrast than by an algorithm with no dip limitation (compare with Figure 4.2-12).

Figure $4.3-13$ is the dipping events model with migrations using the $3500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5 , 10, and 20 percent higher velocities. For comparison, again, label the the correct position of the event with the steepest dip from the desired migration on the results of migration with different velocities. The overmigration effect of higher velocities is counteracted by the inherently undermigrating nature of the 15-degree algorithm. As a result, dipping events are not overmigrated by the 15 -degree algorithm as much as they would be by an algorithm with no dip limitation (compare with Figure 4.2-13).

Velocity error test results on field data using the 15-degree implicit scheme are shown in Figures 4.3-14 and 4.3-15. Figure 4.3-16 is a sketch of the under- and overmigration effects. As noted above with the dipping events model (Figures 4.3-12 and 4.3-13), when using velocities greater than medium velocities, overmigration is not as pronounced with the 15 -degree finite-difference migration as it is with a 90 -degree algorithm, such as the Kirchhoff or phase-shift method. On the other hand, when using velocities lower than medium velocities, the undermigration effect is more pronounced with the 15degree finite-difference migration in comparison with a 90-degree algorithm (compare Figure 4.3-16 with Figure 4.5-13).

At first, it may appear to be sensible to compensate for the undermigration caused by a low-dip algorithm by adjusting migration velocities. For example, the best match between the desired migration and the 15-degree finite-difference results for the dipping event in Figure 4.3-16 occurs when 10 percent higher velocities are used in the finite-difference migration. While for one dip this adjustment may be acceptable, for another dip it may not be. Therefore, deficiencies of a migration algorithm should not be compensated for by makng modifications to the velocity field for magration.

## Cascaded Migration

To compensate for the inherent undermigration by the 15-degree finite-difference migration, Larner and Beasley (1990) proposed performing migration using the 15-degree equation, repeatedly the input to the next migration stage being the output from the previous stage. Such cascaded application of the 15-degree migration is demonstrated in Figure 4.3-17. Migration of the constant-velocity diffraction hyperbola using the 15-degree equation only once yields the familiar result of unfocused energy accompanied with dispersive noise (Figure 4.3-17c). A cascaded application of the 15-degree equation produces improved focusing of the energy at the apex of the hyperbola. The more the number of stages in the cascaded migration the more the improvement in focusing the energy (Figures 4.3-17d,e,f).

An interesting theoretical observation is that cascaded migration using a dip-limited algorithm, such as the 15 -degree finite-difference scheme, actually requires a depth step size that is greater than the optimal depth size for a single-stage application of the algorithm. In
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0544.jpg?height=470&width=512&top_left_y=125&top_left_x=137)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0544.jpg?height=445&width=254&top_left_y=152&top_left_x=644)

FIG. 4.3-8. Tests for extrapolation depth step size in 15-degree fnite-difference migration: (a) Desixed migration using the phase-shift method, (b) 4-ms depth step, and (c) 20-ms depth step. The input CMP stack is shown in Figure 4.3-2a.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0544.jpg?height=478&width=510&top_left_y=687&top_left_x=138)

b C

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0544.jpg?height=445&width=254&top_left_y=718&top_left_x=644)

FIG. 4.3-9. Tests for extrapolation depth step size in 15-degree finite-difference migration: (a) 40-ms depth step, (b) 60-ms depth step, and (c) 80 -ms depth step. The input CMP stack is shown in Figure 4.3-2a and the desired migration is shown in Figure 4.3-2b.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=472&width=406&top_left_y=112&top_left_x=91)

d

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=131&width=382&top_left_y=612&top_left_x=105)

e
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=314&width=384&top_left_y=790&top_left_x=104)

FIG. 4.a-10. Tests for velocity errors in 15-degree finitedifference migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500 \mathrm{~m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) the medium velocity of $2500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity. Depth step stze is $20 \mathrm{~ms}$. s

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=184&width=399&top_left_y=137&top_left_x=548)

b
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=230&width=386&top_left_y=350&top_left_x=558)

d

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=119&width=378&top_left_y=620&top_left_x=566)

e
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0545.jpg?height=318&width=378&top_left_y=779&top_left_x=566)

FIG. 4.3-11. Tests for velocity errors in 15-degree finitedifference migration: (a) a zero-ofset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) the medium velocity of $2500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity. Depth step size is $20 \mathrm{~ms}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0546.jpg?height=970&width=386&top_left_y=114&top_left_x=102)

FIG. 4.3-12. Tests for velocity exrors in 15-degree finitedifference migration: (a) a zero-offet section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity. Depth step size is $20 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0546.jpg?height=216&width=415&top_left_y=114&top_left_x=537)

b
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0546.jpg?height=684&width=396&top_left_y=365&top_left_x=558)

FIG. 4.3-13. Tests for velocity errors in 15-degree fintedifference migration: (a) a zero-ofset section that contains dipping events with $3500 \mathrm{~m} / \mathrm{s}$ velocity, (b) desired migration; 15-degree finite-difference migration using (c) the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity. Depth step size is $20 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0547.jpg?height=477&width=754&top_left_y=120&top_left_x=136)

FIG. 4.3-14. Tests for velocity errors in 15-degree finite-difference migration using (a) 95 percent, (b) 90 percent, and (c) 80 percent of rms velocities. The input stacked section is shown in Figure 4.3-2a and the desired migration using the phase-shift method is shown in Figure 4.3-2b. Depth step size is $20 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0547.jpg?height=478&width=761&top_left_y=687&top_left_x=138)

FIG. 4.3-15. Tests for velocity errors in 15-degree finite-difference migration using (a) 105 percent, (b) 110 percent, and (c) 120 percent of rms velocities. The input stacked section is shown in Figure 4.3-2a and the desired migration using the phase-shift method is shown in Figure 4.3-2b. Depth step size is $20 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0548.jpg?height=485&width=372&top_left_y=116&top_left_x=105)

FIG. 4.3-16. The undermigration and overmigration effects from Figures 4.3-14 and 4.3-15. $B=$ dipping event before and $A=$ dipping event after desired migration, $D=$ diffraction before and $D^{\prime}=$ diffraction after 15-degree finitedifference migrations, and $L=$ percent lower velocities, and $H=$ percent higher velocities.

fact, the more the number of stages in the cascade, the coarser the depth step size to achieve better focusing of the energy (Figure 4.3-17).

Cascaded migration of the constant-velocity zerooffset section that contains dipping events is shown in Figure 4.3-18. Again, the 15-degree finite-difference migration yields the familiar result of undermigrated steeply dipping events accompanied by the dispersive noise. When applied in a cascaded manner, the algorithm positions the steeply dipping events more accurately. With a sufficient number of cascades (Figure 4.3$\left.18 f^{\prime}\right)$, the 15-degree algorithm can actually position the events as accurately as a 90 -degree algorithm applied only once (Figure 4.3-18b). For comparison, the event with the steepest dip (AB) is labeled on the desired migration (Figure 4.3-18b) and the cascaded migration (Figure 4.3-18f).

Unfortunately, the encouraging results from cascaded migration using the 15-degree algorithrn shown in Figures 4.3-17 and 4.3-18 are only attainable for a constant-velocity medium. In case of a medium with vertically varying velocity, the cascaded application of the 15-degree algorithm causes overmigration (Figure
4.3-19). While this observation can be verified by theory, the situation can also be remedied by a cleverly implemented form of cascaded migration with a constant velocity used in each stage (Larner and Beasley, 1990).

Actually, it turns out that cascaded migration theory dictates constant velocity to be used in each stage. If a variable velocity is used, then a 90 -degree algorithm such as the phase-shift method is required in lieu of a dip-limited algorithm for each stage. While the cascaded application of a dip-limited finite-difference algorithm with a variable velocity causes overmigration (Figure 4.3-19c), the cascaded application of the phase-shift algorithm with no dip limit yields an accurate image (Figure 4.3-20e).

Since the advancements made in practical implementation of steep-dip implicit and explicit finitedifference schemes, practical use of cascaded migration, however, has been limited.

## Reverse Time Migration

In Section 4.1, a. migration algorithm based on extrapolation back in time while using the stacked section to be the boundary condition at $z=0$ was discussed. The impulse response of this algorithm, which is known as reverse tine migration, is shown in Figure 4.3-21. Note that the algorithm can handle dips up to 90 degrees with the accuracy of phase-shift migration. The important consideration is that the extrapolation step $\Delta t$ in reverse time migration must be taken quite small, usually a fraction of the input temporal sampling interval. This then makes the algorithm computationally intensive.

Figure 4.3-22 shows a portion of a CMP-stacked section and its reverse time migration. The steep flanks of the salt diapirs have been imaged accurately, enabling. delineation of the geometry of the top-salt boundary with confidence. Reverse time migration, albeit its simple and elegant, implementation (Section 4.1), has not been used widely in practice. Again, this is primarily because it requires very small extrapolation step in time, which increases the computational cost of the algorithm.

### 4.4 FREQUENCY-SPACE MIGRATION IN PRACTICE

The basis of the steep-dip implicit algorithms is the dispersion relation of equation (4-18). Finite-difference schemes with steep-dip accuracy are implemented conveniently in the frequency-space donain. An important

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0549.jpg?height=185&width=853&top_left_y=324&top_left_x=92)

(a)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0549.jpg?height=180&width=851&top_left_y=540&top_left_x=93)

(c)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0549.jpg?height=180&width=439&top_left_y=753&top_left_x=93)

(e)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0549.jpg?height=197&width=414&top_left_y=756&top_left_x=528)

FIG. 4.3-17. (a) A zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method, (c) 15-degree finite-difference migration using a depth step of $20 \mathrm{~ms}$; cascaded application of the 15-degree migration using (d) 4 cascades with 80-ms depth step, (e) 10 cascades with 200 -ms depth step, and (f) 20 cascades with $400-\mathrm{ms}$ depth step.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0550.jpg?height=197&width=858&top_left_y=314&top_left_x=95)

(a)

(b)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0550.jpg?height=120&width=850&top_left_y=540&top_left_x=92)

(c)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0550.jpg?height=182&width=438&top_left_y=749&top_left_x=92)

(e)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0550.jpg?height=183&width=414&top_left_y=750&top_left_x=528)

(t)

FIG. 4.3-18. (a) A zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method, (c) 15-degree finite-difference migration using a depth step of $20 \mathrm{~ms}$; cascaded application of the 15-degree migration using (d) 4 cascades with $80-\mathrm{ms}$ depth step, (e) 10 cascades with $200-\mathrm{ms}$ depth step, and (f) 20 cascades with 400 -ms depth step. For comparison, event $A B$ with the steepest dip is labeled on the desired migration (b) and the cascaded migration (f).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0551.jpg?height=285&width=301&top_left_y=327&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0551.jpg?height=282&width=299&top_left_y=637&top_left_x=93)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0551.jpg?height=285&width=270&top_left_y=327&top_left_x=397)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0551.jpg?height=279&width=269&top_left_y=638&top_left_x=397)

(e)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0551.jpg?height=285&width=270&top_left_y=327&top_left_x=665)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0551.jpg?height=278&width=266&top_left_y=636&top_left_x=666)

(f)

FIG. 4.3-19. (a) A zero-offset section that contains three diffaction hyperbolas with a vertically varymg velocity, (b) 15degree finite-difference migration using a depth step of $20 \mathrm{~ms}$; the output from the last stage of cascaded application of the 15-degree migration using (c) 4 cascades with 80-ms depth step, (d) 10 cascades with 200 -ms depth step, (e) 20 cascades with $400-m s$ depth step, and (f) desired migration using the phase-shift method.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0552.jpg?height=284&width=299&top_left_y=329&top_left_x=95)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0552.jpg?height=280&width=307&top_left_y=643&top_left_x=95)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0552.jpg?height=283&width=265&top_left_y=329&top_left_x=402)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0552.jpg?height=282&width=269&top_left_y=645&top_left_x=400)

(e)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0552.jpg?height=284&width=267&top_left_y=329&top_left_x=675)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0552.jpg?height=282&width=265&top_left_y=645&top_left_x=677)

(f)

FIG. 4.3-20. (a) A zero-offset section that contains three diffraction hyperbolas with a vertically varying velocity; four-stage cascaded migration using the phase shift-method with 80-ms depth step: (b) first-stage, (c) second stage, (d) third stage, (e) fourth stage, and (f) desired migration using the phase-shift method only once with 20-ms depth step. Compare the fourth stage (e) with the output of the four-stage casceded migration using a dip-limited algorithm as in Figure 4.3-19c.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0553.jpg?height=188&width=425&top_left_y=116&top_left_x=81)

FIG, 4.3-21. Impulse response of a reverse time migration algorithm.

advantage of the implicit method is its exceptional ability to handle velocity variations, whether vertical or leteral. Its accuracy for the lateral velocity problem results from the fact that the time shift associated with the thin-lens term (equation 4-16b) can be implemented exactly in the frequency domain. For these reasons, the algorithm is most appropriate for depth migration to image targets beneath complex structures (Chapter 8 ).

The frequency-space, sometimes referred to as $\omega-x$ or $f-x$, migration also has the important operational advantage that each frequency can be processed separately. This property can reduce computer memory requirements significantly and, thus, decrease inputoutput operations for large data sets. Also, in frequencyspace migration, some accuracy features can be conveniently implemented. For example, wave extrapolation can be limited to a specified signal bandwidth. Each frequency component can, in principle, be downward continued using an optimum depth step size that yields a minimum acceptable phase error, leading to a minimum amount of dispersive noise on the migrated section.

## Steep-Dip Implicit Methods

Figure 4.4-1 shows the impulse responses of a series of implicit frequency-space finite-difference schemes with different degrees of dip accuracy. Whether it is implemented in the time-space domain (Figure 4.3-1) or frequency-space domain (Figure 4.4-1), the 15-degree algorithm yields an elliptic impulse response. The 45degree algorithm yields an impulse response in the shape of a heart.

The 15-degree equation is derived from the Taylor expansion of the dispersion relation (equation 414a). The 45-degre equation is based on the continued fractions expansion (equation 4-18), which allows wider angle approximations. Kjartansson (1979) implemented the 45-degree equation for migration of stacked data.

The 45-degree equation (4-18) can be upgraded to be accurate for dips up to 65 degrees by tuning some coefficients (Section D.4). Higher-order operators can be obtained by the successive application of a number of operators like the 45-degree operator (Ma, 1981) with a different set of coefficients (Lee and Suh, 1985). As shown in Figure 4.4-1, with increasing dip accuracy, the impulse responses of the algorithms approach the shape of a semicircle. However, branches in the impulse response associated with evanescent energy remain.

Fipure 4.4-2 shows migration of a constant-velocity diffraction hyperbola using the 65-, 80-, 87-, and 90degree implicit schenes (Section D.4). While the for cusing is better than that achieved by the 15 -degree implicit scheme (Figure 4.3-4c), note that the dispersive noise still persists in the image obtained from the 65-degree implicit scheme (Figure 4.4-2c). It is evident that the quality of focusing from the 80 -degree implicit scheme is superior (Figure 4.4-2d). The 87- and 90-degree schemes have caused overmigration of the diffraction hyperbola (Figures 4.4-2e,f).

The overmigration effect also can be observed on the results from the constant-velocity dipping events model in Figure 4.4-3. In fact, the dispersive noise that accompanies the steeply dipping events is present in all cases. The response of an implicit scheme is the product of a complicated interplay of various parameters (Section D.6) - depth step size, sampling intervals in space and time, dip angle, velocity and frequency. Dispersive noise, and under- or overmigration characteristics of implicit schemes depend on the specific implementation.

Figure 4.4-4 shows the stacked data migrated using three different approximations in frequency-space domain $-15,45$, and 65 degrees. Note that by higherdegree approximation, the collapse of the diffraction becomes complete, and the steeply dipping event is migrated more accurately. Compare these results with the desired migration in Figure 4.3-2b. Also note the similar results obtained from the 15-degree time-space $(t-x)$ algorithm (Figure 4.3-2c) and the 15-degree frequencyspace $(\omega-x)$ algorithm (Figure 4.4-4a).

Figure 4.4-5 shows a field data example of frequency-space implicit finite-difference migrations with different degrees of accuracy. Compare the results with the desired migration in Figure 4.2-15b and note that the 80-degree scheme probably produces the most preferred inage of the salt dome as compared to that from the 65 -degree scheme. The schemes with steeper dip accuracy (87- and 90-degree schemes), however, yield marginal improvenents over the 80 -degree scheme. Often the 65-degree scheme produces acceptable results, and the 80 -degree scheme, which requires twice the computational effort, is used occasionally in practice.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0554.jpg?height=1066&width=724&top_left_y=156&top_left_x=146)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=170&width=377&top_left_y=124&top_left_x=134)

Desired Impulse Response

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=195&width=376&top_left_y=339&top_left_x=135)

$15^{\circ}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=199&width=376&top_left_y=546&top_left_x=135)

$45^{\circ}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=206&width=377&top_left_y=762&top_left_x=134)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=213&width=374&top_left_y=126&top_left_x=527)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=190&width=379&top_left_y=339&top_left_x=530)

$87^{\circ}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=193&width=382&top_left_y=550&top_left_x=526)

900

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0555.jpg?height=194&width=376&top_left_y=763&top_left_x=526)

$90^{\circ}$

FIG. 4.4-1. Impulse responses of the frequency-space implicit schemes with various degrees of approximations to the one-way scalar wave equation. (See Section D. 4 for the theoretical basis of these responses)

## Depth Step Size

Figure 4.4-6 shows the constant-velocity diffraction hyperbola and the steep-dip implicit 65-degree finitedifference migrations using four different depth steps. Large depth steps cause undermigration as well as kinks along the flank of the diffraction curve (especially apparent in $60-$ and $80-\mathrm{ms}$ cases). The dispersive noise, typical of finite-difference schemes, persists to varying degrees irrespective of the depth step size. At smaller depth steps, more energy collapses to the apex (Figure 4.4-7f).

As in the case of the parabolic approximation (Figure 4.3-5), the dispersive noise that accompanies the undermigrated energy (Figures 4.4.6 and 4.4.7) is an effect of approximating differential operators with dif-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0556.jpg?height=810&width=407&top_left_y=242&top_left_x=315)

FIG. 4.4-2. (a) A zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; frequency-space finite-diference migrations using (c) the 65-degree, (d) 80-degree, (e) 87-degree, and (f) 90-degree implicit scheme.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0557.jpg?height=328&width=414&top_left_y=255&top_left_x=314)

c
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0557.jpg?height=408&width=400&top_left_y=628&top_left_x=323)

FIG. 4.4-3. (a) A zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; frequency-space finite-difference migrations using (c) the 65-degree, (d) 80-degree, (e) 87-degree, and (f) 90-degree implicit scheme.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0558.jpg?height=507&width=308&top_left_y=117&top_left_x=95)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0558.jpg?height=505&width=269&top_left_y=118&top_left_x=397)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0558.jpg?height=505&width=279&top_left_y=118&top_left_x=662)

(c)

FIG. 4.4-4. Frequency-space finite-difference migrations of the CMP stack in Figure 4.3-2a using implicit finite-difference schemes based on (a) the 15-degree, (b) 45-degree, and (c) 65-degree approximation. Note the increasingly better imaging obtained using higher angle approximations. The desired migration is shown in Figure 4.3-2b.

ference operators. With reasonable depth steps $(20 \mathrm{~ms})$, the undermigration caused by the dip limitation of the 65-degree algorithm (Figure 4.4-7f) is less pronounced as compared to that of the 15-degree algorithm (Figure 4.3-4c). At large depth steps, the steep-dip accuracy is compromised, and the difference between the two algorithms becomes less distinguishable (compare Figures 4.4-6f and 4.3-4f).

The response of a finite-difference algorithm to a diffraction or a dipping event depends upon the type of differencing scheme and dip limitation. At large depth steps, the steep-dip algorithm undermigrates the diffraction hyperbola (Figure 4.4-6) as does the 15degree scheme (Figure 4.3-4). At small depth steps, the steep-dip algorithm causes slight overmigration of the diffraction hyperbola (Figure 4.4-7c,d), unlike the 15degree scheme which causes undermigration whatever the depth step size (Figure 4.3-5).

Figure 4.4-8 shows the constant-velocity dipping events model and the steep-dip implicit finite-difference migration results using four different depth step sizes. The response of the steep-dip implicit scheme is quite similar to that of the 15 -degree scheme. Specifically, in- creasing depth step size causes more and more undermigration at increasingly steep dips. The waveform along reflectors is dispersed at steep dips and large depth steps. Kinks occur along reflectors at discrete intervals that correspond to the depth step size. Note that the kinks are more pronounced at increasingly steeper dips.

It is apparent from Figure 4.4.9 that migration with 20 -ms depth step has the least dispersion with the least undermigration optimum accuracy in event positioning. Further decreasing depth step size actually causes overmigration as for the diffraction hyperbola (Figure 4.4-7).

The response of a finite-difference algorithm to dipping events depends again on the approximation made to the scalar wave equation. For instance, with small depth steps less than one-half the dominant period of the reflection events, the steep-dip implicit scheme causes overmigration of the reflection with the stoepest dip (Figure 4.4-9c). The 15-degreee implicit scheme, on the other hand, causes postcursive dispersion along the steeply dipping reflectors (Figure 4.3-7c). Hence, taking smaller depth steps does not necessarily mean a better quality migration free of the artifacts that ve-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0559.jpg?height=1040&width=712&top_left_y=114&top_left_x=165)

FIG. 4.4-5. Frequency-space finite-difference migrations of the CMP stack in Figure 4.2-15a using, from top to bottom, the 65-degree, 80 -degree, 87 -degree, and 90 -degree implicit schemes. The desired migration usung the phase-shift method is shown in Figure 4 2-15b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0560.jpg?height=835&width=396&top_left_y=114&top_left_x=93)

FIG. 4.4-6. Tests for extrapolation depth step size in 65 degree frequency-space implicit finite-difference migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocty, (b) desired migration; 65-degree finite-difference migrations using (c) $32-\mathrm{ms}$, (d) $40-\mathrm{ms}$, (e) $60-\mathrm{ms}$, and (f) $80-\mathrm{ms}$ depth step.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0560.jpg?height=804&width=400&top_left_y=116&top_left_x=551)

FIG. 4.4-7. Tests for extrapolation depth step size in 65 degree frequency-space implicit finite-difference migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 65-degree finite-difference migrations using (c) 8-ms, (d) 12-ms, (e) 16-ms, and (f) 20 -ms depth step.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0561.jpg?height=422&width=388&top_left_y=114&top_left_x=100)

d

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0561.jpg?height=463&width=376&top_left_y=557&top_left_x=104)

FIG. 4.4-8. Tests for extrapolation depth step size in 65degre frequency-space implicit finite-difference migration: (a) a zero-ofiset section that contains dipping events with $3500-\pi / \mathrm{s}$ velocity, (b) desired migration; 65 -degree finitedifference migrations using (c) $32-\mathrm{ms}$, (d) $40-\mathrm{ms}$, (e) $60-\mathrm{ms}$, and (f) 80 -ms depth step.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0561.jpg?height=760&width=386&top_left_y=114&top_left_x=558)

FIG. 4.4-9. Tests for extrapolation depth step size in 65degre frequency-space implicit finite-difference migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 65-degree fintedifference migrations using (c) 8-ms, (d) 12-ms, (e) 16-ms, and (f) 20-ms depth step.
cur with the finite-difference method. With large depth steps, both schemes cause undermigration accompanied by precursive dispersion along the dipping events (Figures 4.3-6 and 4.4-8).

Theoretically, the 65 -degree differential equation is more accurate than the 15 -degree differential equation. However, once discretized, the difference in performance between these two equations can be less (Diet and Lailly, 1984). A good finite-difference migration program uses differencing schemes that maintain the dip accuracy implied by the corresponding differential equation.

The main point to remember is that migration of steep dips generally requires a small depth step size, Practical considerations suggest that depth step size should be between one-half and one-full dominant period of the seismic data to be migrated (from 20 to 40 $\mathrm{ms}$ ), depending on the steepness of the dips in the data.

A higher order approximation, such as the 65degree equation, provides a. smaller range of choice for optimum depth size as compared to the 15-degree equation. In particular, note that the optimum depth step size is $20 \mathrm{~ms}$ for the dipping events model shown in Figures 4.4-8 and 4.49; any departure from this value causes either undermigration or overmigration. The results with the $20-\mathrm{ms}$ depth step in Figures 4.3-4 and 4.4-9 convincingly show that the 65-degree algorithm can migrate steeper dips and collapse diffractions more accurately than the 15 -degree equation.

Figures 4.4-10 and 4.4-11 show migrations of the stacked section in Figure 4.2-15a with eight different depth steps using a steep-dip implicit scheme. Note that as the depth step size is increased, more undermigration occurs. Dispersion along the undermigrated event associated with the steep left flank of the salt dome is apparent at larger depth steps. A $20-\mathrm{ms}$ depth step size, which is equivalent to the usual case of one-half the dominant period of seismic data, generally is an acceptable choice for most of the implicit finite-difference schemes.

## Velocity Errors

We now examine the response of a steep-dip implicit algorithm to velocity errors. Figure 4.4-12 shows the constant-velocity diffraction hyperbola and its migrations using the medium velocity, and 5,10 , and 20 percent lower velocities. When velocities lower than medium velocity are used, the diffraction hyperbola is undermigrated (Figure 4.412d,e,f), but not as much as in the case of the 15-degree equation (Figure 4.3$10 d, e, f)$. On the other hand, the diffraction hyperbola gets undermigrated by the steep-dip algorithm more than it would be by an algorithm with no dip limitation (compare with Figure 4.2-10).

Figure 4.4-13 shows the constant-velocity diffaction hyperbola and its migrations using the medium velocity, and 5,10 , and 20 percent higher velocities. When velocities higher than medium velocity are used, the diffraction hyperbola is overmigrated (Figure 4.413d,e,f), more so than with the 15-degree equation (Figure 4.3-1Id,e,f). On the other hand, the diffaction hyperbola gets overmigrated by the steep-dip algorithm less than it would be by an algorithm with no dip limitation (compare with Figure 4.2-11). Whatever the velocity used for migration, dispersive noise is present persistently in finite-difference results (Figures 4.4-12 and 4.4-13).

Figure 4.4-14 shows the constant-velocity dipping events model with migrations using the medium velocity, and velocities that are 5, 10, and 20 percent lower. For comparison, label the correct position of the event with the steepest dip from the desired migration on the results of migration with different velocities. As in any other migration method, velocity errors cause events to be increasingly more mispositioned at steeper dips. The undermigration effect of lower velocities is reinforced by the inherently undermigrating nature of the steep-dip algorithm, although not as much as in the case of the 15-degree algorithm (Figure 4.3-12). As a result, dipping events are more undermigrated by the steep-dip algorithm in contrast to an algorithm with no dip limitation (compare with Figure 4.2-12).

Figure 4.4-15 is the dipping events model with migrations using the $3500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5 , 10, and 20 percent higher velocities. For comparison, again, label the correct position of the event with the steepest dip from the desired migration on the results of migration with different velucities. The overmigration effect of higher velocitjes is counteracted by the inherently undermigrating nature of the steep-dip algorithm, although not as much as in the case of the 15-degree algorithm (Figure 4.3-13). As a result, dipping events are not overmigrated by the steep-dip algorithm as much as they would be by an algorithm with no dip limitation (compare with Figure 4.2-13).

The nature of the precursive and postcursive dispersion along steeply dipping events in the output from finite-difference migration, theoretically depends on the type of differencing scheme used in approximating the differential operators associated with the scalar wave equation. In principle, an implicit finite-difference migration implemented in the frequency-space domain yields less dispersion compared to an implicit scheme implemented in the time-space domain. This is because the former requires differencing in $x$ and $z$, while the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0563.jpg?height=1008&width=680&top_left_y=117&top_left_x=177)

FIG. 4.4-10. Tests for extrapolation depth step size in 65-degre frequency-space implicit finite-difference migration using from top to bottom, 32-ms, 40-ms, 60-ms, and 80-ms depth steps. The input CMP stack is shown in Figure 4.2-15a, and the desired migration using the phase-shift method is shown in Figure 4 2-15b.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0564.jpg?height=1004&width=690&top_left_y=117&top_left_x=176)

FIG. 4.4-11. Tests for extrapolation depth step size in 65-degree frequency-space implicit finite-difference migration usiug, from top to bottom, $8-\mathrm{ms}, 12-\mathrm{ms}, 16-\mathrm{ms}$, and $20-\mathrm{ms}$ depth steps. The input CMP stack is shown in Figure 4.2-15a, and the desired migration using the phase-shift method is shown in Figure 4.2-15b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0565.jpg?height=303&width=406&top_left_y=108&top_left_x=91)

c

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0565.jpg?height=426&width=394&top_left_y=440&top_left_x=94)

FIG. 4.4-12. Tests for velocity errors in 65-degree frequency-space implicit finite-difference migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 65-degree fintedifference migration using (c) the mediurn velocity of 2500 $\mathrm{m} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity. Depth step size is $20 \mathrm{~ms}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0565.jpg?height=378&width=406&top_left_y=114&top_left_x=538)

d

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0565.jpg?height=53&width=394&top_left_y=526&top_left_x=550)

e

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0565.jpg?height=176&width=387&top_left_y=637&top_left_x=558)

FIG. 4.4-13. Tests for velocity errors in 65-degree frequency-space implicit finite-difference migration: (a) a zero-offset section that contains a diffaction hyperbola with $2500 \mathrm{-m} / \mathrm{s}$ velocity, (b) desired migration; 65 -degree finitedifference migration using (c) the medium velocty of 2500 $\mathrm{m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity. Depth step size is $20 \mathrm{~ms}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0566.jpg?height=815&width=397&top_left_y=116&top_left_x=91)

FIG. 4.4-14. Tests for velocity errors in 65-degree frequency-space implicit finite-difference migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 65-degree finitedifference migration using (c) the medium velocity of 3500 $\mathrm{m} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity, Depth step size is $20 \mathrm{~ms}$,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0566.jpg?height=308&width=397&top_left_y=116&top_left_x=549)

c
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0566.jpg?height=174&width=392&top_left_y=452&top_left_x=558)

e
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0566.jpg?height=258&width=388&top_left_y=663&top_left_x=555)

FIG. 4.4-15. Tests for velocity errors in 65-degree frequency-space implicit finite-difference migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; 65 -degree finitedifference migration using (c) the medium velocity of 3500 $\mathrm{m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity. Depth step size is $20 \mathrm{~ms}$
latter requires differencing in $t$ in addition to $x$ and $z$. In practice, however, dispersive noise contaminates migration results from implicit schemes almost without exception.

Velocity error tests on field data using the $65-$ degree implicit scheme are shown in Figures 4.4-16 and 4.417. With velocities erroneously too low, note the pronounced undermigration of the steep salt flank. With velocities erroneously too high, note the overmigration of the steep salt flank and the crossing of reflections at the vicinity of the crest of the salt structure.

## Steep-Dip Explicit Methods

Although implicit schemes are always stable and naturally suitable to accommodate lateral velocity variations, they have been known to have some unfavorable aspects. Specifically, dispersive noise caused by the differencing approximations to differential operators does indeed deteriorate the quality of migration of real data (Figures 4.3-8, 4.3-9, 4.4-10, and 4.4-11). An equally important concern about implicit schemes is the fact that they never meet the expected theoretical dip accuracy. A 45-degree algorithm can actually provide only a 5degree accuracy for certain frequencies and velocities. Because of a complex interaction of temporal and spatial sampling rates, dip, velocity, and frequency, an optimun depth step size that yields minimum phase and amplitude errors for an entire data set is never easy to specify (Section D.6).

While implicit schemes are guaranteed to be stable whatever the depth step size, stability of explicit schemes requires a depth step that is sufficiently small (Section D.6). Putting aside the stability issue, explicit schemes implemented in the frequency-space domain (Section D.5) can alleviate some of these deficiencies of implicit schemes.

Refer to the impulse responses shown in Figure 4.418 and note that explicit schemes do not produce any visible dispersion along steep dips. Explicit schemes involve convolution of a symmetric complex filter in the frequency-space domain with the wavefield to perform extrapolation in depth. In contrast, implicit schemes can be computationally intensive for large volumes of data since they require solving complex tridiagonal equations associated with the differencing in the $x$ direction.

Steep-dip accuracy in explicit schemes is attained by increasing the extrapolation filter length. The impulse responses shown in Figure 4.4-18 are associated with three different extrapolators - a 7-point filter with a 30 -degree accuracy, an 11-point filter with a 50-degree accuracy, and a 25 -point filter with a 70 -degree accuracy. Note that the explicit extrapolation filter cuts off beyond the specified dip limit. In contrast, the implicit extrapolation treats the evanescent energy as though it is part of the propagating energy (Figure 4,41).

## Dip Limits of Extrapolation Filters

Figure 4.4-19 shows a zero-offset section that contains a diffraction hyperbola and its migrations using the 30 -, 50- and 70-degree explicit schemes. Also show is the desired migration using the phase-shift method. Note that the low-dip algorithm causes undermigration of the diffraction hyperbola, while the steep-dip algorithm focuses the energy at the apex better than a steep-dip implicit scheme with equivalent dip accuracy (Figure 4.4-7).

Explicit schemes are designed based on a specified cutoff wavenumber $k_{x}$ (Section D.5), beyond which the amplitude spectrum of the filter is set to zero. Figure 4.4-20 shows the $f-k$ spectra of the results of migration of the diffraction hyperbola as shown in Figure 4.419 using the three explicit extrapolators. Note that the lower the dip limit, the lower the cutoff wavenumber. The steep-dip algorithm with a 70 -degree dip limit is able to replicate the amplitude response characteristics of the desired migration using the phase-shift method. This of course is at the expense of using a long, complex convolutional filter.

Figure 4.4-21 shows a zero-ofset section that contains a set of dipping events and its migrations using the 30,50 and 70 -degree explicit schemes. Also shown is the desired migration using the phase-shift method. For comparison, label the the correct position of the event with the steepest dip from the desired migration on the results of migration with different velocities. The steep-dip algorithm positions the events nearly as good as the desired migration using the phase-shift method and better than a steep-dip implicit scheme with equivalent dip accuracy (Figure 4.4-9).

Figure 4.4-22 shows the $f-k$ spectra of the results of migration of the dipping events as shown in Figure 4.4-21 using the three explicit extrapolators. The extrapolation filter with the 30-degree dip limit has truncated the steeply dipping events at high wavenumbers $k_{x}$. Except for very high wavenumbers, the extrapolation filter with the 70-degree dip limit is able to repiicate the amplitude response characteristics of the desired migration using the phase-shift method. Keep in mind that we achieve stability of explicit schemes at the expense of truncating the response at wavenumbers $k_{x}$ above a specified cutoff value (Section D.5).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0568.jpg?height=1007&width=703&top_left_y=113&top_left_x=167)

FIG. 4.4-16. Tests for velocity errors in 65-degree frequency-space implicit finite-difference migration using interval velocities derived from, from top to bottom, $100,95,90$, and 80 percent of rms velocities. The input stacked section is shown in Figure 4 2-15a, and the desired migration using the phase-shift method is shown in Figure 4.2-15b. Depth step size is $20 \mathrm{~ms}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0569.jpg?height=1014&width=700&top_left_y=116&top_left_x=168)

FIG. 4,4-17. Tests for velocity errors in 65 -degree frequency-space implicit finite-difference migration using interval velocities derived from, from top to bottom, $100,105,110$, and 120 percent of $\mathrm{rms}$ velocities. The input stacked section is shown in Figure 4.2-15a, and the desired migration using the phase-shift method is shown in Figure $42-15 \mathrm{~b}$. Depth step size is $20 \mathrm{~ms}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0570.jpg?height=802&width=428&top_left_y=116&top_left_x=304)

FIG. 4.4-18. (a) Impulse response of a desired migration algorithm using the phase-shft method; impulse responses of (b) a 30 -degree, (c) 50 -degree, and (d) 70 -degree frequency-space explicit scheme for migration.

A field data example of a stacked section which has been migrated using the 30 -degree, 50 -degree and 70-degree extrapoaltion filters is shown in Figure 4.4-23. The steep flanks of the salt diapirs are clearly better imaged by the steep-dip extrapolation filter. For comparison, Figure 4.4-24 shows the desired migration using the phase-shift method. Although the length of the extrapolation filter for a steep-dip algorithm is much longer than that for a low-dip extrapolation filter, the benefit of using the former is indisputably demonstrated by the field data example shown in Figure 4.4-23.

## Velocity Errors

Figure 4.4-25 shows migrations of a zero-offet section that contains a diffraction hyperbola using a frequencyspace explicit algorithm based on 30-degree, 50-degree and 70-degree extrapolation filters and a velocity that is 90 percent of the medium velocity. For comparison, desired migration using the phase-shift method with the medium velocity and 90 percent of the medium velocity are also shown in the same figure. Migration with an

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0571.jpg?height=616&width=405&top_left_y=122&top_left_x=82)

FIG. 4.4-19. (a) A zero-offet section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; migrations using frequency-space explicit schemes with (c) 30 -degree, (d) 50 degree, and (e) 70-degree accuracy.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0571.jpg?height=804&width=392&top_left_y=121&top_left_x=548)

FIG. 4.4-20. The $f-k$ spectra of the sections in Figure 4.4. 19: (a) A vero-offset section that contains a diffraction byperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; migrations using frequency-space explicit schemes with (c) 30-degree, (d) 50-degree, and (e) 70-degree accuracy.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0572.jpg?height=710&width=403&top_left_y=116&top_left_x=84)

FIG. 4.4-21. (a) A zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using. the phase-shift method; migrations using frequency-space explicit schemes with (c) 30-degree, (d) 50-degree, and (e) 70-degree accuracy.

erroneously low velocity yields the undermigrated form of the diffraction hyperbola as seen in Figure 4.4-25c. Note, however, the dip-limited explicit schemes appear to cause less undermigration compared to the phaseshift method with 90 -degree accuracy. This behavior is in contradiction to intuition the undermigration effect of an erroneously low velocity is reinforced by a dip-limited algorithm. In fact, this intuitive effect was demonstrated by the steep-dip implicit scheme (Figure 4.4-12).

The deceptive behavior of the explicit schemes that contradicts our intuition can be explained by the fact that these schemes filter out the energy at high wavenumbers (Figures 4.4-19 and 4.4-20). As a result,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0572.jpg?height=812&width=394&top_left_y=115&top_left_x=548)

FIG. 4.4-22. The $f-k$ spectra of the sections in Figure 4.4-21: (a) A zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method; migrations using frequency-space explicit schemes with (c) 30-degree, (d) 50-degree, and (e) 70-degree accuracy.

the steep limbs of the undermigrated diffraction hyperbola are truncated (Figure 4.4-25). This in turn makes the result of migration using lower velocity appear less undermigrated in case of an explicit scheme compared to the case of the phase-shift method with 90-degree accuracy. In fact, if we apply a wavenumber filter to reject the high wavenumbers from the output of phase-shift migration (Figure 4.4-25c), the result would resemble

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0573.jpg?height=1063&width=630&top_left_y=155&top_left_x=189)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0574.jpg?height=970&width=806&top_left_y=183&top_left_x=73)

FIG. 4.4-24. Migration of the CMP stack shown in Figure 4.3-22a using the phase-shift method.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0575.jpg?height=211&width=406&top_left_y=126&top_left_x=92)

b

,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0575.jpg?height=156&width=392&top_left_y=370&top_left_x=103)

d

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0575.jpg?height=317&width=386&top_left_y=553&top_left_x=102)

FIG. 4.4-25. Tests for velocity errors in frequency-space explicit migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired $\mathrm{mi}$ gration using the phase-shift method, and (c) phase-shift migration using 10 percent lower velocity; migrations using 10 percent lower velocity and frequency-space explicit schemes with (d) 30-degree, (e) 50-degree, and (f) 70-degree accuracy.

the output of an explicit scheme (Figures 4.4-25d,e,f). Also note from Figure 4.4-25 that the low-dip explicit scheme manifests the effect of undermigration much less than the steep-dip explicit scheme. This is because the wavenumber filtering effect is more sovere for the low-dip explicit scheme (Figure 4.4-20).

Figure 4.4-26 shows migrations of a zero-offset section that contains a diffaction hyperbola using a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0575.jpg?height=741&width=403&top_left_y=124&top_left_x=550)

FIG. 4.4-26. Tests for velocity errors in frequency-space explicit migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method, and (c) phase-shift migration using 10 percent lower velocity; migrations us. ing 10 percent higher velocity and frequency-space explicit schemes with (d) 30-degree, (e) 50-degree, and (f) 70-degree accuracy.

frequency-space explicit algorithm based on 30-degree, 50-degree and 70-degree extrapolation filters and a velocity that is 110 percent of the medium velocity. Again, for comparison, desired migration using the phase-shift method with the medium velocity and 110 percent of the medium velocity are also shown in the same figure.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0576.jpg?height=826&width=397&top_left_y=116&top_left_x=91)

FIG. 4.4-27. Tests for velocity errors in frequency-space explicit migration: (a) a zero-offset section that contains dipping events with $3500 \mathrm{~m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method, and (c) phase-shift migration using 10 percent lower velocity; migrations using 10 percent lower velocity and frequency-space explucit schemes with (d) 30-degree, (e) 50-degree, and (f) 70-degree accuracy.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0576.jpg?height=801&width=396&top_left_y=118&top_left_x=548)

FIG. 4.4-28. Tests for velocity errors in frequency-space explicit migration: (a) A zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method, and (c) phase-shift migration using 10 percent higher velocity; migrations using 10 percent higher velocity and frequeney-space explicit schemes with (d) 30-degree, (e) 50-degree, and (f) 70-degree accuracy.

## $a$ $=$ $=$ $=$ $=$ b

Migration with an erroneously high velocity yields the overmigrated form of the diffaction hyperbola as seen in Figure 4.4-26c. 4.4-26:

We make the following observations from Figure

(a) The dip-limited explicit schemes, much like the implicit schemes (Figure 4.4-13), cause less overnigration compared to the phase-shift method with 90-degree accuracy.

(b) The low-dip explicit scheme manifests the effect of overmigration much less than the steep-dip explicit scheme.

(c) The wavenumber filtering effect (Figure 4.4-20) further truncates the steep limbs of the overmigrated hyperbola.

The interplay of the three factors results in the response to velocity errors by the explicit schemes as shown in Figure 4.4-26.

Tests for velocity errors are repeated for a zerooffset section that contains a set of dipping events as shown in Figures 4.4-27 and 4.4-28. For comparison, label the correct position of the event with the steepest dip from the desired migration on the results of migration with different velocities. The residual diffractions off the end of the dipping reflectors on the migrated sections from the explicit schemes have been truncated by the wavenumber filtering effect of the extrapolation filters. This filtering effect is most prominent in the case of the explicit scheme with the low-dip limit and erroneously high velocity (Figure 4.4-28d).

Field data examples for tests of velocity errors for the explicit schemes are shown in Figures 4.429, 4.430, and 4.4-31. First, note the better imaging of the salt flanks by the steep-dip explicit scheme compared to the low-dip explicit scheme (Figure 4.4-29). The undermigration effect of erroneously low velocities (Figure 4.4-30) and the overmigration effect of erroneously high velocities (Figure 4.4-31) may be compared with the results of migration using optimum velocities (Figure 4.4-29).

We shall complete this section by reviewing the performance of Kirchhoff summation, finite difference frequency-space implicit, and frequency-space explicit schemes with various dip limits. Figure 4.4-32 shows the compilation of the results of migration of a zero-offset section that contains a diffraction hyperbola. For comparison, desired migration using the phase-shift method is included in the panel. The dip-limited nature of the implicit and explicit schemes is manifested by the incomplete focusing of the energy at the apex of the diffraction hyperbola (Figures 4.4-32c,g,h). The undermigration effect caused by the dip limitation is allevi- ated by using a steep-dip explicit scheme (Figure 4.432j). A steep-dip implicit scheme, on the other hand, can actually overshoot in the opposite direction and cause overmigration (Figure 4.4-32f). The differencing approximations are manifested by the dispersive noise (Figure 4.4-32c).

Figure 4.4-33 shows the compilation of the results of migration of a zero-offset section that contains a set of dipping events. Again, for comparison, desired migration using the phase-shift method is included in the panel. The dip-limited nature of the implicit and explicit schemes is manifested by the undermigration of the steeply dipping events (Figures 4.4-33c,g,h). This effect is alleviated by using a steep-dip explicit scheme (Figure 4.4-33j). A steep-dip implicit scheme, on the other hand, can actually overshoot in the opposite direction and cause overmigration (Figure 4.4-33f). The differencing approximations are manifested by the dispersive noise accompanying the steeply dipping events (Figure 4.4-33c,d,e,f).

### 4.5 FREQUENCY-WAVENUMBER MIGRATION IN PRACTICE

Two different methods of migration are implemented in the frequency-wavenumber domain. The Stolt method is exact for a constant-velocity medium, while the phaseshift method is exact for a medium with vertical velocity variations. The Stolt method can be extended to the case of a medium with lateral velocity variations judged to be acceptable for time migration. The phase-shift method also can be extended to handle lateral velocity variations. One extension, phase-shiftplus-interpolation scheme, accommodates lateral variations in velocity by interpolating between the results of migration using a group of vertically-varying velocity functions. Another extension, phase-shift-pluscorrection, applies an additional extrapolation operator at each depth step to account for differences between the laterally varying velocity field and vertically varying-only velocity function used for phase-shift migration. The phase-shift method also has been extended to image turning waves associated with salt overhang structures.

## Maximum Dip to Migrate

The phase-shift method of migration (Section 4.1 and Section D.7) allows vertical variations in velocity and is accurate for up to dips of 90 degrees. Figure 4.5-1 shows the impulse response of the phase-shift algorithm.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0578.jpg?height=971&width=669&top_left_y=115&top_left_x=188)

FIG. 4.4-29. From top to bottom, desired mgration as in Figure 4.2-15b and frequency-space explicit migration with 30 degree, 50-degree, and 70-degree accuracy, and using interval velocities derived from 100 percent of the rms velocities. The input CMP stack is shown in Figure 4.2-15a.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0579.jpg?height=968&width=668&top_left_y=117&top_left_x=179)

FIG, 4.4-30. From top to bottom, desired migration as in Figure 4 2-15b and tests for velocity errors in frequency-space explicit migration with 30-degree, 50-degree, and 70 -degree accuracy, and using interval velocities derived from 90 perent of rms velocities. The input CMP stack is shown in Figure 4.2-15a.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0580.jpg?height=970&width=656&top_left_y=117&top_left_x=190)

FIG. 4.4-31. From top to bottom, desired migration as in Figure $42-15 \mathrm{~b}$ and tests for velocity errors in frequency-space explicit migration with 30-degree, 50-degree, and 70 -degree accuracy, and using interval velocities derived from 110 percent of rms velocities. The input CMP stack is shown in Figure 4.2-15a.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0581.jpg?height=998&width=383&top_left_y=112&top_left_x=327)

FIG. 4.4-32. Summary of the results of migration of a zero-offet section that contains a diffraction hyperbola with 2500 $\mathrm{m} / \mathrm{s}$ velocity as in (a): (b) Kirchhoff migration; frequency-space implicit finite-difference migration with (c) 65-degree, (d) 80-degree, (e) 87-degree, and (f) 90-degree accuracy; frequency-space explicit migration with (g) 30-degree, (h) 50-degree, and (i) 70-degree accuracy; and (j) frequency-wavenumber phase-shift migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0582.jpg?height=992&width=381&top_left_y=115&top_left_x=328)

FIG. 4.4-33. Summary of the results of migration of a zero-offset section that contains a set of dipping events with $3500-$ $\mathrm{m} / \mathrm{s}$ velocity as in (a): (b) Kirchhoff migration; frequency-space implicit finite-difference migration with (c) 65 -degree, (d) 80-degree, (e) 87-degree, and (f) 90-degree accuracy; frequency-spece explicit migration with (g) 30-degree, (h) 50-degree, and (i) 70-degree accuracy; and (j) frequency-wavenumber phase-shft migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0583.jpg?height=191&width=428&top_left_y=128&top_left_x=80)

FIG. 4.5-1. Impulse response of phase-shift migration has a semicircular shape.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0583.jpg?height=292&width=425&top_left_y=415&top_left_x=81)

FIG. 4.5-2. The impulse response of the $f-k$ migration operator has a truncated semicircular shape when a maximum dip limit is imposed. For comparison, the desired response shape has been superimposed on the $f-k$ responses.

Clearly, for a constant-velocity medium, this respone is equivalent to that of the Stolt migration. The impulse response shown in Figure 4.5-1 is considered to be the desired impulse response for 2-D zero-offiset migration, and as such, responses of all migration algorithms discussed in this chapter are benchmarked against it.

As with the Kirchhoff summation method, migration with the phase-shift method can be limited to smaller dips by truncating the semicircular wavefront (Figure 4.5-2). This dip filtering capability is useful in rejecting coherent noise from the stacked section while migrating the data. If migration is constrained to suall dip values, then the steeply dipping reflectors may be filtered out unintentionally. Edge effects also are pronounced when a very narrow range of dips is passed. Note the linear streaks on the impulse response with a dip limit of $2 \mathrm{~ms} /$ trace (Figure 4.5-2).

The dip-filtering action caused by imposing a dip limit on the impulse response also is visible on the re-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0583.jpg?height=209&width=414&top_left_y=127&top_left_x=550)

b
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0583.jpg?height=596&width=394&top_left_y=364&top_left_x=558)

FIG. 4.5-3. Tests for maximum dip to migrate in phaseshift migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; phase-shift migrations using (c) 2 -ms/trace, (d) 4-ms/trace, (e) 8 - $\mathrm{ms} /$ trace, and (f) 16-ms/trace maximum dip limit.

sults shown in Figure 4.5-3. Note that steep dips greater than the specified maximum dip to migrate have been annihilated. On the field data example shown in Figure 4.5-4, severe dip filtering action of the $2 \mathrm{~ms} / \mathrm{trace}$ maximum dip has caused smearing and eliminated virtually all of the signal contained in the section.

## Stack

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0584.jpg?height=478&width=405&top_left_y=155&top_left_x=124)

## Maximum Dip $=2 \mathrm{~ms} /$ trace

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0584.jpg?height=259&width=394&top_left_y=675&top_left_x=127)

## Desired Migration

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0584.jpg?height=774&width=394&top_left_y=155&top_left_x=518)

FIG. 4.5-4. Tests for maxmum dip to migrate in phase-shift migration: $\mathbf{A}$ low value for maximum dip to migrate can be hazardous. All dips of interest must be preserved during migration.

## Depth Step Size

Figure 4.5-5 shows a zero-offset section that contains a set of dipping events migrated with the phase-shift method using different depth step sizes. Since the phaseshift method is based on the dispersion relation given by equation (4-13b) of the exact one-way wave equation, we do not expect undermigration. However, we see discontinuities along the reflectors at intervals equal to the depth step size, which is similar to the finite-difference results (Figure 4.4-8). As with the finite-difference algorithms, the problem occurs along the steeper dips first; therefore, the steep dips require smaller depth steps (Figure 4.5-5)

Because of the band-limited nature of seismic data, very small depth steps are not needed. From Figure 4.5-5, note that migration with a $20-\mathrm{ms}$ depth step produces a section witbout spurious kinks along the reflectors; this is comparable to the desired migration using a depth step equal to the temporal sampling interval.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0585.jpg?height=894&width=414&top_left_y=116&top_left_x=84)

FIG. 4.5-5. Tests for extrapolation depth step size in phaseshift migration: (a) a zero-offet section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; phase-shift migrations using (c) $20-\mathrm{ms}$ (d) $40-\mathrm{mn}$, (e) $60-\mathrm{ms}$, and (f) $80-\mathrm{ms}$ depth step.

Depth step size tests on feld data are shown in Figure 4.5-6. Unlike the finite-difference results (Figure 4.4-10), the phase-shift migration with different depth step sizes produces equally adequate results in terms of the positioning of events. The only problem with large depth steps is the kinks along the steep dips. In principle, as long as there is no aliasing in the $z$-direction, the depth step kinks can be eliminated by a local interpolation process. In practice, as for the implicit finitedifference methods, the depth step size used in migration with the phase shift method typically is taken between the half-and full-dominant period of the wavefield 20 to $40 \mathrm{~ms}$, depending on steepness of the dips present in the section.

## Velocity Errors

We now examine the response of phase-shift migration to velocity errors. Figure $4.5-7$ shows the diffraction hyperbola and phase-shift migrations using the $2500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5, 10, and 20 percent lower velocities. The lower the velocity, the more the diffraction hyperbola is undermigrated. These results are used as a benchmark to evaluate the response of the other migration algorithms discussed in this chapter. Specifically, compare Figure 4.5-7 with Figures 4.2-10 (the case of Kirchhoff migration), 4.3-10 (the case of implicit finite-difference migration), 4.4-12 (the case of implicit frequency-space migration), and 4.4-25 (the case of explicit frequency-space migration), note how the various algorithms respond to velocity errors with significant differences.

Figure 4.5-8 shows the same diffraction hyperbola and phase-shift migrations using the $2500 \mathrm{~m} / \mathrm{s}$ medium velocity, and 5, 10, and 20 percent higher velocities. The higher the velocity, the more the diffraction hyperbola is overmigrated. These results are used to benchmark the response to velocity errors by the other migration algorithms Figures 4.2-1I (the case of Kirch hoff migration), 4.3-11 (the case of implicit finite-difference migration), 4.4-13 (the case of implicit frequency-space migration), and 4.4-26 (the case of explicit frequencyspace migration).

The under- and overmigration effects caused by the use of erroneously low or high velocities on the dipping events model are seen in Figures 4.5-9 and 4.510 , respectively. Label the correct position of the event with the steepest dip from the desired migration on the results of migrations with different velocities, and note the event mispositioning caused by erroneously low and high velocities. Recall that sensitivity of migration to velocity errors can be measured quantitatively via equations 41 and 4-2. The test results shown in Figures 4.5-9 and 4.5-10 are used to benchmark the response to velocity errors by the other migration algorithms Figures 4.2-12 and 4.2-13 (the cases of Kirchhoff migration), 4.3-12 and 4.3-13 (the ceses of implicit

Stack
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0586.jpg?height=436&width=362&top_left_y=160&top_left_x=167)
$\Rightarrow$ Depth Step $=20 \mathrm{~ms}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0586.jpg?height=236&width=358&top_left_y=624&top_left_x=170)

## Desired Migration

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0586.jpg?height=700&width=356&top_left_y=160&top_left_x=526)

FIG. 4.5-6. Tests for extrapolation depth step size in phase-shift migration. Note the kinks along steep dips with large depth steps.

finite-difference migration), 4.4-14 and 4.4-15 (the cases of implicit frequency-space migration), and 4.4-27 and 4.4-28 (the cases of explicit frequency-space migration).

An aspect of phase-shift migration uniquely different from others is its exceptional quality of output. As noted from Figures 4.5-7, 4.5-8, 4.5-9, and 4.5-10, phase-shift migration produces no dispersive noise since it does not involve any differencing of differential operators. Instead, the entire design of extrapolation operator and application of migration are in the frquencywavenumber domain. The results do not stuffer from any dip limitation since the phase-shift method is based on an extrapolation filter that is exact for all dips up to 90 degrees (Figure 4.5-1). Of course, we must also remind ourselves of the fact that the phase shift method is limited to velocities that vary only in the vertical direction.

Figtures 4.5-11 and 4.5-12 are field data examples of phase-shift migration using erroneously low and high velocities, respectively. Figure 4.5-13 shows a sketch of the combined results of these migrations. Clearly, velocities that are too low cause undermigration of the steeply dipping event that defines the flank of the salt diapir and incomplete collapse of the diffraction off the tip of the salt diapir. Velocities that are too high cause overmigration as manifested by the crossing events at the vicinity of the crest of the salt diapir.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0587.jpg?height=749&width=414&top_left_y=127&top_left_x=83)

FIG. 4.5-7. Tests for velocity errors in phase-shift migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; phase-shuft mugration using (c) the medium velocity of 2500 $\mathrm{rn} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity.

Figure 4.5-14 shows the results of phase-shift migration of the stacked section in Figure 4.2-15 using velocities lower than what may be optimum for imasing. The under-migration of the left flank of the salt, dome is not so evident. However, the steeply dipping reflection of the right flank intersects the gently dipping reflections associated with the surrounding strata an indication of undermigration.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0587.jpg?height=814&width=440&top_left_y=124&top_left_x=526)

FIG. 4.5-8. Tests for velocity errors in phase-shift migration: (a) a zero-offset section that contans a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; phase-shift migration using (c) the medum velocity of 2500 $\mathrm{m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity

Figure 4.5-15 shows results of phase-shift migration of the stacked section in Figure 4.2-15 using velocities higher than what may be optimum for imaging. Migration with erroneously high velocities (110 and 120 percent of optimum velocities) shows signs of overmigration in the form of crossing events along the left flank of the salt diapir.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0588.jpg?height=446&width=446&top_left_y=114&top_left_x=73)

d

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0588.jpg?height=433&width=427&top_left_y=585&top_left_x=91)

FIG. 4.5-9. Tests for velocity errors in phase-shift migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; phase-shift migration using (c) the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent lower, (e) 10 percent lower, and (f) 20 percent lower velocity. s
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0588.jpg?height=880&width=442&top_left_y=134&top_left_x=540)

FIG. 4.5-10. Tests for velocity errors in phase-shift migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration; phase-shift migration using (c) the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (d) 5 percent higher, (e) 10 percent higher, and (f) 20 percent higher velocity.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0589.jpg?height=480&width=748&top_left_y=116&top_left_x=144)

FIG. 4.5-11. Teats for velocity errors in phase-shift migration using interval velocities derived from (a) 95 percent, (b) 90 percent, and (c) 80 percent of rms velocities. The input stacked section is shown in Figure 4.3-2a, and the desired migration using the phase-shift method is shown in Figure 4.3-2b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0589.jpg?height=486&width=763&top_left_y=679&top_left_x=137)

FIG. 4.5-12. Tests for velocity errors in phase-shift migration using interval velocities derived from (a) 105 percent, (b) 110 percent, and (c) 120 percent of rms velocities. The input stacked section is shown in Figure 4.3-2a, and the desired migration using the phase-shift method is shown in Figure 4.3-2b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0590.jpg?height=560&width=430&top_left_y=114&top_left_x=73)

FIG. 4.5-13. The combined results of migrations from Figures 4.5-11 and 4.5-12. $B=$ dipping event before and $A=$ dipping event after desired migration; $D=$ diffraction, and $L=$ percent lower velocities and $H=$ percent higher velocities.

## Stolt Stretch Factor

As discussed in Section 4.1, the generalized Stolt method of migration involves converting the time section to an approximately constant-velocity section, which then is migrated by the constant-velocity Stolt algorithm. This conversion is essentially stretching in the vertical (time) direction. Once the section is migrated in the stretched domain, it is converted back to the original time domain. The generalized Stolt method must be distinguished from the constant-velocity algorithm. The constant-velocity algorithm is accurate for dips up to 90 degrees for a constant-velocity medium. The generalized method approximately accounts for velocity variations by stretching the section.

Stretching is defined by the stretch factor $W$. In his original paper, Stolt (1978) discusses implementation of the $W$ factor. Although $W$ is a complicated function of velocity and stretch coordinate variables, it often is set to a scalar (Section D.7). The theoretical range of $W$ is between 0 and 2 .

To understand the effects of the stretch factor, refer to the impulse responses in Figure 4.5-16, where a single, isolated wavelet on a single trace is migrated using various stretch factors. Here, $W=1$ corresponds to the exact constant-velocity Stolt algorithm. So, setting $W<1$ compresses the impulse response inward along its steep flanks, while setting $W>1$ opens it up. Thus, the value of $W$ partially controls the aperture of the generalized Stolt algorithm. The farther $W$ is from 1 , the more limited the aperture becomes. A value of $W<1$ implies undermigration at steeper dips, while a value of $W>1$ implies overmigration at steeper dips, if the medium velocity is constant.

Although not strictly implied by the impulse responses in Figure 4.5-16, when using a stretch factor different from 1, the Stolt algorithm tries to emulate a wavefront in a variable velocity medium (Stolt, 1978), while compromising on the ability to migrate steeper dips. Experience has proven that the Stolt migration with stretch produces acceptable results provided velocity variations are within limits of time migration.

Consider the zero-offet section and the migration results in Figure 4,5-17. Stretch factor $W=1$ produces the best migrated section because the zero-offset section was modeled using a constant-velocity value. For $0<\boldsymbol{W}<\boldsymbol{1}$, the algorithm produces an undermigrated section, while for $1<W<2$, it produces an overmigrated section. These observations are in agreement with the impulse responses in Figure 4.5-16. The nearvertical streaks in the section with $W=1.95$ represent wraparound artifacts.

The generalized Stolt algorithm produces the best result when $W=1$, provided the medium velocity is constant. Since this is never the case, we should examine the algorithm for a vertically varying velocity medium. Figure 4.5-18 shows the impulse responses for different values of $W$. Velocity varies linearly from $t=0$ to $t=4 \mathrm{~s}$ between 2000 and $4000 \mathrm{~m} / \mathrm{s}$. For different $W$ values, the portions of the wavefronts that best match the desired migration using the phase-shift method are between the solid lines. For a vertically varying velocity medium, $W=1$ is no longer the desired factor. In Figure 4.5-18, accuracy over the widest range of dip angles with the Stolt method is attained when $W=0.6$. In general, the larger the velocity gradient, the farther the optimum $W$ is from 1 . Strictly speaking, the optimum value for $W$ is even different at different times.

In practice, wavefront plots, like those in Figure 4.5-18, can be generated using both the phase-shift and Stolt methods for a vertically varying regional velocity function. The $W$ factor that yields the best fit at the largest angular aperture is used then to migrate the data with the Stolt method.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0591.jpg?height=973&width=671&top_left_y=114&top_left_x=178)

FIG. 4.5-14. Tests for velocity errors in phase-shift migration using interval velocities derived from $100,95,90$, and 80 percent of $\mathrm{rms}$ velocities (from top to bottom). The input stacked section is shown in Figure 4.2-15a, and the desired migration using the phase-shift method is shown in Figure 4.2-15b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0592.jpg?height=983&width=670&top_left_y=117&top_left_x=186)

FIG. 4.5-15. Tests for velocity errors in phase-shit migration using interval velocities derived from 100, 105, 110, and 120 percent of rms velocities (from top to bottom). The input stacked section is shown in Figure 4,2-15a, and the desired migration using the phase-shift method is shown in Figure $42-15 \mathrm{~b}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0593.jpg?height=294&width=425&top_left_y=116&top_left_x=81)

FIG. 4.5-16. Tests for the stretch factor in Stolt migration: By varying the stretch factor $W$, the impulse response of the exact 90-degree migration operator (semicircle) is modified. For comparison, the desired response has been superimposed on the Stolt migration impulse responses.

To circumvent the difficulty of defining an optimum stretch factor $W$, Beasley and Lynn (1992) suggested applying the coustant-velocity Stolt migration in a cascaded manner. The idea is based on a clever representation of a vertically varying velocity function by a set of constant velocities, which are then used to perform cascaded migration (Section 4.3). Since each migration stage is done by using a constant velocity, the stretch factor $W$ is by default set to 1 . Of course, representation of a vertically varying velocity function by a set of constant velocities is only an approximation that can be valid for small vertical gradients.

Figures 4.5-19 and 4.5-20 show Stolt migrations of the CMP stack in Figure 4.3-2a using different values of the $W$ factor. Migration velocities are varied only in the vertical direction. Figure 4.5-21 is a sketch of the migration results for the diffaction $D$ off the tip of the salt diapir and steeply dipping event $B$ off the flank of the salt diapir. The best match between the desired migration and the Stolt method with stretch is for $W=0.5$.

## Wraparound

Wraparound is the effect of finite data length in time and space on a migration algorithm implemented in the Fourier transform domain. A migration algorithm implemented in the time-space domain does not suffer from wraparound effect. But a migration algorithm implemented in the frequency-space domain suffers from wraparound along the time axis. Similarly, a migration algorithm implemented in the frequency-wavenumber domain suffers from wraparound effects both along the time and space axes.

Figure 4.5-22 shows a zero-offset section that contains a diffraction hyperbola and its migration using frequency-wavenumber migration based on the phaseshift method. When plotted with a very high display gain, we observe the energy in the migrated section bouncing off the edges of the section both in the time and space directions.

A field data example of the wraparound effect on frequency-wavenumber migration is shown in Figure 4.5-23. This is the same section as in Figure 4.2-15b, except that it has been displayed using a very high gain. The energy above the water bottom is associated with the wraparound effect in the time and space directions. The wraparound noise actually exists within the image portion of the section, also. A way to reduce the wraparound effect is to pad the data with zeros along the axis of Fourier transformation. For frequency-space migration, data must be padded along the time axis; and for frequency-wavenumber migration, data must be padded along both the time and space axes.

A field data example of the wraparound effect on frequency-space migration is shown in Figure 4.5-24. This is the same section as in Figure 4.4-11d, exoept that it has been displayed using a very high gain. The energy above the water bottom is associated with the wraparound effect in the time direction.

## Residual Migration

The constant-velocity Stolt algorithm has useful applications in residual migration as described here and migration velocity analysis as described in Chapter 5 . Consider a zero-offset section that contains a set of dipping events as shown in Figure 4.5-25a. The desired migration is obtained by using the medium velocity of $v=3500 \mathrm{~m} / \mathrm{s}$ as shown in Figure 4.5-25b. Suppose, instead, that you migrate using a velocity of 3000 $\mathrm{m} / \mathrm{s}$. The resulting migrated section is shown in Figure $4.5-25 \mathrm{c}$. Label the event with the steepest dip (AB) from the desired migration on the migrated section with $v_{1}=3000 \mathrm{~m} / \mathrm{s}$, and note the undermigration of the dipping events. By migrating the already migrated section using a velocity of $v_{2}=v^{2}-v_{1}^{2}=1802 \mathrm{~m} / \mathrm{s}$ (Section D.8), we get the section shown in Figure 4.5-25d. Note that this section obtained from the two-stage migration using velocities $3500 \mathrm{~m} / \mathrm{s}$ and $1802 \mathrm{~m} / \mathrm{s}$ is equivalent to the one-stage migration using a velocity of $3500 \mathrm{~m} / \mathrm{s}$. The second stage of the two-stage migration using a velocity of $1802 \mathrm{~m} / \mathrm{s}$ is called residual migration (Rothman et al., 1985).

## Constant-Velocity Zero-Offset Section

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0594.jpg?height=242&width=747&top_left_y=158&top_left_x=145)

## Frequency-Wavenumber Migrations

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0594.jpg?height=236&width=381&top_left_y=407&top_left_x=511)

## Stretch Factor $=1$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0594.jpg?height=236&width=744&top_left_y=653&top_left_x=148)

FIG. 4.5-17. Tests for the stretch factor in Stolt migration: $W<1$ causes undermigration, and $W>1$ causes overmigration. (Modeling courtesy Union Oil Company,)

So, what is the practical use of residual migration? It can improve upon the result of migration using a dip. limited finite-difference algorithm. Figure 4.5-26a shows a zero-offset section that consists of three point scatterers in a layered earth model with vertically varying velocity field. A 15-degree dip-limited finite-difference migration has difficulty collapsing these diffractions (Figure $4.5-26 \mathrm{~b}$ ). Now, first migrate the zero-offset section with the constant-velocity Stolt algorithm using the lowest value, $2000 \mathrm{~m} / \mathrm{s}$, in the vertically varying velocity function. The result is shown in Figure 4.5-26d. Then, take this section and migrate it again (Figure 4.5-26e) using the appropriate residual velocity (Section D.8) and the 15-degree finite-difference algorithm. When compared with the single-stage finite-difference migration (Figure 4.5-26b), note the superior performance of the residual migration. Also compare this with the desired migration using the phase-shift method (Figure 4.5-26c). The important point to keep in mind is that input to residual migration (the second stage) must be data which have been migrated (first stage) using a constant velucity (Rothman et al., 1985).

A field data example is shown in Figure 4.5-27 with a sketch of the migration results in Figure 4.5-28.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0595.jpg?height=166&width=436&top_left_y=118&top_left_x=82)

$W=1$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0595.jpg?height=162&width=429&top_left_y=321&top_left_x=82)

$W=0.75$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0595.jpg?height=181&width=452&top_left_y=518&top_left_x=81)

FIG. 4.5-18. Tests for the stretch factor in Stolt migration: The medium velocity varies vertically from $2000 \mathrm{~m} / \mathrm{s}$ at $t=0$ to $4000 \mathrm{~m} / \mathrm{s}$ at $t=4 \mathrm{~s}$.

The single-stage 15-degree finite-difference result shows the typical undermigrated character (Figure 4.3-3). The $1500-\mathrm{m} / \mathrm{s}$ constant-velocity Stolt migration followed by the finite-difference migration seems to produce an output that is reasonably close to the desired migration.

A limitation of residual migration is that an adequate migration is not always achieved since the firststage migration requires constant velocity which may be far off from the velocity field associated with the data. This is the case in Figure 4.5-27, since after residual migration, the dipping event still is slightly undermigrated (see the sketch in Figure 4.5-28). Undermigration occurs because the apparent dip perceived by the second-stage migration still may be too large to be handled accurately. From equation (D-8c) note that the lower the velocity used in migration, the smaller the dip that is perceived by migration. If the residual velocity function given by equation (D-96b) is not too different from the original velocity function because of a large vertical gradient, then residual migration may not be adequate.

Residual migration is different from cascaded migration that is discussed in Section 4.3. The latter in-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0595.jpg?height=170&width=437&top_left_y=124&top_left_x=517)

Phase-Shift Migration

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0595.jpg?height=184&width=437&top_left_y=323&top_left_x=517)

2

4

住)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0595.jpg?height=23&width=21&top_left_y=591&top_left_x=529)
:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0596.jpg?height=483&width=764&top_left_y=113&top_left_x=135)

FIG. 4.5-19. Tests for the stretch factor $W$ in Stolt migration: (a) Desired migration, (b) $W=0.001$, and (c) $W=0.5$. The input CMP stack is shown in Figure 4.3-2a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0596.jpg?height=481&width=763&top_left_y=664&top_left_x=136)

FIG. 4.4.5-20. Tests for the stretch factor $W$ in Stolt migration: (a) $W=0.7$, (b) $W=1$, and (c) $W=1.5$. The input CMP stack is shown in Figure 4.3-2a and the desired migration is shown in Figure 4.5-19a.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0597.jpg?height=540&width=415&top_left_y=116&top_left_x=82)

FIG. 4.5-21. The combined results of the migrations from Figures 4.5-19 and 4.5-20. $B=$ dipping event before and $A$ $=$ dipping event after desired rnigration, $D=$ diffraction before and $D^{\prime}=$ diffraction after Stolt migration with stretch. Numbers represent different stretch factors $W$.

medium velocity. When the same exercise is repeated using a dip-limited implicit finite-difference algorithm, results are not satisfactory even with constant velocity (Figure 4.5-30). When a variable velocity is used at each stage preceding the last stage the dip-limited algorithm causes overmigration (Figure 4.3-19), while the phaseshift method with no dip limit yields accurate result (Figure 4.3-20).

Despite the limitations mentioned above, residual migration is used in practice in the following mode:

(a) Perform phase-shift migration using a vertically varying velocity function $\bar{v}(z)$, which is obtained by averaging the spatially varying velocity field $v(x, z)$ and modifying it to meet the requirement that $\bar{v}(z)<v(x, z)$.

(b) Follow with a residual migration using a diplimited implicit or explicit frequency-space finitedifference migration with a residual velocity field equal to $\sqrt{v^{2}(x, z)-\bar{v}^{2}(z)}$ (Section D.8).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0597.jpg?height=636&width=364&top_left_y=116&top_left_x=567)

FIG, 4.5-22. Wraparound effect in frequency-wavenumber migration: (a) a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method, and (c) the same as in (b) but with a display gain that is 100 times greater than that used in (b)

### 4.6 FURTHER ASPECTS OF MIGRATION IN PRACTICE

In this section, we shall discuss the effects of spatial a.liasing, random noise and profile length on migration, and migration from topography. Spatial aliasing is a direct result of undersampling of recorded data (Section 1.2). Because of spatial aliasing, migration can perceive events with steep dips at high frequencies as different, from the actual dips in $\mathrm{ms}$ /trace. As a result, migration mispositions the aliased frequency components of the dipping events.

Random noise usually is more prominent in the deep part of a stacked section, just where velocities also

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0598.jpg?height=506&width=606&top_left_y=116&top_left_x=218)

FIG. 4.5-23. Wraparound effect in frequency-wavenumber migration: The input stacked section is shown in Figure 4.2-15a and the desared migration using the phase-shift method is shown in Figure 4.2-15b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0598.jpg?height=501&width=601&top_left_y=686&top_left_x=218)

FIG. 4.5-24. Wraparound effect in frequency-space migration: The input stacked section is shown in Figure 4.2-15a and the desired migration using the phase-shift method is shown in Figure 4.2-15b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0599.jpg?height=176&width=410&top_left_y=118&top_left_x=89)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0599.jpg?height=83&width=415&top_left_y=308&top_left_x=85)

$2-$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0599.jpg?height=68&width=384&top_left_y=405&top_left_x=116)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0599.jpg?height=119&width=412&top_left_y=493&top_left_x=85)

2 .

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0599.jpg?height=92&width=410&top_left_y=626&top_left_x=86)

(d)

FIG. 4.5-25. Principle of residual migration: (a) a zerooffset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method with the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (c) first-pass mjgration of (a) using constant-velocity Stolt migration with $3000-\mathrm{m} / \mathrm{s}$ velocity, and (d) second-pass migration of the output from the first-pass migration as in (c) using a 15-degree finite-difference migration with the residual velocity of 1802 $\mathrm{m} / \mathrm{s}$ (equation D-96b).

are generally higher. This results in random noise organized along wavefront arches, commonly referred to as smiles. This organized noise corrupts the migrated primary energy not just in the deep part of the section but also has detrimental effect on shallow data in a migrated section.

Line length and Jocation of the line traverse at the surface relative to the location of the target in the subsurface have a direct effect on the useability of the a migrated section. Usually a line traverse longer than the spatial extent of the subusrface target is needed (Figure 4.1-1). Keep in mind that your target does not necessarily lie directly beneath the CMP location where the reflection from that target appears on your unmigrated stacked section.

Irregular topography associated with areas subjected to overthurst tectonics has to be accounted for during migration if surface elevation changes ase rapid along the line traverse. Migration algorithms, with the exception of the Kirchhoff summation and the constantvelocity Stolt method, are all based on wave extrapolation from one flat depth level to another. A CMPstacked section is assumed to be equivalent to a zerooffset wavefield and usually is referenced to a flat datum. In the presence of severe topography, one needs to account for the difference between the elevation profile and the reference datum. Otherwise, if the reference datum is above the surface elevation, to a migration algorithm, events appear deeper than they are, and thus are overmigrated. If, on the other hand, the reference datum is below the surface elevation, events appear to a migration algorithm shallower than they actually are, and thus are undermigrated.

## Migration and Spatial Aliasing

The concept of spatial aliasing is presented in Section 1.2. Here, we shall examine the effect of spatial aliasing on migration. Figure 4.6-1 shows a zero-offset section that contains a diffraction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity and $12.5-\mathrm{m}$ trace spacing. By discarding every other trace, obtain another zero-offset section with 25 m trace spacing. Repeat the procedure to obtain the zero-offset sections with $50-\mathrm{m}$ and $100-\mathrm{m}$ trace spacings (Figure 4.6-1).

The $f-k$ spectra of the zero-offset sections with the four different trace spacings are displayed in Figure 4.6-2. The diffraction hyperbola with $12.5-\mathrm{m}$ trace spacing maps onto an inverted triangular area in the $f-k$ plane (Section 4.1). The Nyquist wavenumber is $40 \mathrm{cycles} / \mathrm{km}$ and the bandwidth is given by the corner frequencies $6,12-36,48 \mathrm{~Hz}$ for the passband region of the spectrum. (See Figure 1.1-26 for the definition of corner frequencies.) The red is associated with the flat part of the passband region and the blue is associated with the taper zone.

The $f-k$ spectrum of the zero-offset section with 25-m trace spacing (Figure 4.6-1) indicates spotial aliasing beyond approximately $24 \mathrm{~Hz}$ (Figure 4.6-2). Consequently, the triangular shape of the passband region in the $f-k$ plane that defines the diffraction hyperbola is corrupted around the edges near the Nyquist wavenumber of $20 \mathrm{cycles} / \mathrm{km}$. At a coarser trace spacing of $50 \mathrm{~m}$, which corresponds to a Nyquist wavenumber of $10 \mathrm{cycles} / \mathrm{km}$, the triangular shape in the spectrum is preserved below the threshold frequency for aliasing,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0600.jpg?height=611&width=852&top_left_y=119&top_left_x=91)

FIG. 4.5-26. Principle of residual migration: (a) a zero-offset section with verticelly varying velocities, (b) 15-degree finitedifference migration, (c) desired migration using the phase-shift method, (d) first-pass migration of (a) using constant-velocity Stolt migration with $2000-\mathrm{m} / \mathrm{s}$ velocity, and (e) second-pass migration of the output from the first-pass migration as in (d) using a 15-degree finite-difference migration with the residual velocity function computed by equation (D-96b).

approximately $\mathrm{I} 2 \mathrm{~Hz}$, only. Finally, at trace spacing of $100 \mathrm{~m}$, which correpsonds to a Nyquist wavenumber of 5 cycles $/ \mathrm{km}$, the triangular shape is obliterated, completely (Figure 4,6-2).

Figure 4.6-3 shows the results of Kirchhoff migration of the zero-offset sections in Figure 4.6-1. Frequency components that are spatially aliased are perceived by migration with a dip different from the actual dip along the diffraction hyperbola. Normally, energy is moved in the up-dip direction along the diffraction hyperbola and is mapped onto the apex. However, in each migrated section, the spatially aliased part of the energy is split away from the flanks of the diffraction hyperbola and mapped onto the regions to the left and right of the flanks. The aliased energy is dispersed. Since each frequency component of the aliased energy is perceived to have a different dip by migration, the displacement of the energy after migration is frequency dependent. The unaliased portion of the energy is of course mapped onto the apex. The more frequency components are spatially aliased, the less energy at lower frequencies is mapped onto the apex.

As discussed in Section 4.1, the triangular area on the $f-k$ plane associated with the diffaction hyperbola (Figure 4.6-2) is mapped onto the circular area on the $f-k$ plane associated with the migrated section (Figure 4.6-4). Ideally the area in the $f-k$ plane of the migrated section should be semicircular in shape. Because the diffraction hyperbola is defined within a finite spatial aperture (Figure 4.6-1), there is an inplicitly imposed dip limit on migration. As a result, the semicircular area is notched on either side (Figure 4.6-4).

Spatial aliasing corrupts the semicircular shape of the $f-k$ spectrum on both ends of the spectrum at the vicinity of the Nyquist wavenumber. In case of severe
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0601.jpg?height=1016&width=772&top_left_y=118&top_left_x=126)

FIG. 4.5-27. Residual migration applied to field data: first pass using constant-velocity Stolt migration ( $1500 \mathrm{~m} / \mathrm{s}$ ), and second pass using a 15-degree finite-difference migration of the result from the first pass.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0602.jpg?height=538&width=414&top_left_y=117&top_left_x=81)

FIG. 4.5-28. The combined migration results from Figure 4.5-27, $B=$ dipping event before and $A=$ dipping event after desired migration; $D=$ diffraction; $A 1, D 1=$ after the first pass; $A 2, D 2=$ after the second pass.

undersampling, spatially aliased frequency components invade much of the $f-k$ plane as shown in Figure 4.6-4.

Aside from the spatial aliasing noise, dispersive noise also is seen on data migrated with a dip-limited finite-difference algorithm (Section 4.3). Figure 4.6-5 shows migration of a zero-offset section that contains a diffraction hyperbola using the 15-degree implicit finite-difference method. Note the undermigration of the diffraction hyperbola that is caused by the 15-degree dip limitation, the dispersive noise $A$ that is caused by the finite-difference approximations, and the spatially aliased energy $B$ that splits away from the unaliased part that collapses to the apex.

Figure 4.6-6 shows the results of migration of the zero-offset sections in Figure 4.6-1 using an 'implicit frequency-space finite-difference scheme (Section 4.4). Note the dispersive noise caused by the finite-difference approximations in the section with $12.5-\mathrm{m}$ trace spacing. The dispersive noise in the sections with $25-\mathrm{m}$, $50-\mathrm{m}$, and $100 \mathrm{~m}$ trace spacings, however, is attributed largely to spatial aliasing.
It is instructive to note that the diffaction energy a.ppears slightly undermigrated with 12.5 -m trace spacing, but is overmigrated with $25-\mathrm{m}$ and $50-\mathrm{m}$ trace spacings. As discussed in Sections 4.3 and 4.4, the fidelity of migration by finite-difference schemes is dictated by an intricately complex interplay between the various parameters spatial and temporal sampling intervals, dip, frequency, and velocity. Depending on the values of these parameters, one scheme may cause undermigration in one case and overmigration in another case.

Figure 4.6-7 shows the $f-k$ spectra of the migrated sections in Figure 4.6-6. Note that implicit frequencyspace migration can create high-frequency noise beyond the passband of the input data. Note also that spatial aliasing combined with the inherent dispersive effect of finite-difference schemes corrupt the semicircular shape of the $f-k$ spectrum on both ends of the spectrum.

Figure 4.6-8 shows the results of the migration of the zero-offset sections in Figure 4.6-1 using an explicit frequency-space finite-difference scheme (Section 4,4). There appears to be no aliasing noise in either sections with $12.5-\mathrm{m}$ and $25-\mathrm{m}$ trace spacings. Also note that, compared to the results of Kirchhof migration (Figure 4.6-2), there is less aliasing noise in the sections with 50 $\mathrm{m}$ and $100-\mathrm{m}$ trace spacings. These observations can be verified by referring to the $f-k$ spectra shown in Figure 4.6-9. Explicit schemes, by the design criterion, attenuate energy associated with wavenumbers $k_{x}$ above a specified cutoff wavenumber defined by a fraction of the Nyquist wavenumber. This effectively removes part of the aliased energy that maps onto the spectral region above the cutoff wavenumber associated with the extrapolation filter for the explicit scheme. Note from the $f-k$ spectrum in Figure 4.6-9 that almost all of the aliased energy has been filtered out for the case of the $25-\mathrm{m}$ trace spacing. This is why aliasing noise is absent in the corresponding migrated section in Figure 4.6-8. Despite the wavenumber filtering effect of the explicit scheme, however, much of the aliased noise remains in the sections with the $50-\mathrm{m}$ and $100-\mathrm{m}$ trace spacings.

Figure 4.6-10 shows the results of phase-shift migration of the zero-offset sections in Figure 4.6-1, and Figure 4.6-11 shows the corresponding $f-k$ spectra. These results are used as a benchmark to evaluate the results obtained from the other migration algorithms (Figures 4.6-3 through 4.6-9). Except for the aliasing noise, phase-shift migration produces no artifacts.

The experiments described above clearly demonstrate that all migration algorithms suffer from saptial aliasing. We now examine the effect of spatial aliasing on migration using a dipping events model. Figure 4.6-12 shows a zero-offset section that contains a set of dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity and $25-\mathrm{m}$ trace
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0603.jpg?height=880&width=364&top_left_y=115&top_left_x=334)

FIG. 4.5-29. Multiple passes of residual migration. (a) a zero-offset section that contains dipping events with $3500-m / s$ velocity, (b) desired migration using the phase-shift method with the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (c) first-pass migration of the zero-offet section in (a) using the phase-shift method with a constant velocity of $2500 \mathrm{~m} / \mathrm{s}$, (d) second-pass migration of the output from the first-pass migration as in (c) using the phase-shift method with a constant residual velocity of 1145 $\mathrm{m} / \mathrm{s}$, (e) third-pass migration of the output from the second-pass migration as in (d) using the phase-shift method with a constant residual velocity of $1198 \mathrm{~m} / \mathrm{s}$, (f) fourth-pass migration of the output from the third-pass migration as in (e) using the phase-shift method with a constant residual velocity of $1250 \mathrm{~m} / \mathrm{s}$, and (g) fifth-pass migration of the output from the fourth-pass migration as in (f) using the phase-shift method with a constant residual velocity of $1299 \mathrm{~m} / \mathrm{s}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0604.jpg?height=893&width=373&top_left_y=110&top_left_x=335)

FIG. 4.5-30. Multjple passes of residual migration: (a) a zero-offset section that contains dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, (b) desired migration using the phase-shift method with the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$, (c) first-pass migration of the zero-ofiset section in (a) using the 65-degree implicit method with a constant velocity of $2500 \mathrm{~m} / \mathrm{s}$, (d) second-pass migration of the output from the first-pass migration as in (c) using the 65-degree implicit method with a constant residual velocity of $1145 \mathrm{~m} / \mathrm{s}$, (e) third-pass migration of the output from the second-pass migration as in (d) using the 65-degree implicit method with a constant residual velocity of $1198 \mathrm{~m} / \mathrm{s}$, (f) fourth-pass migration of the output from the third-pass migration as in (e) using the 65-degree implicit method with a constant residual velocity of $1250 \mathrm{~m} / \mathrm{s}$, and (g) fifth-pass migration of the output from the fourth-pass migration as in (f) using the 65-degree implicit method with a constant residual velocity of $1299 \mathrm{~m} / \mathrm{s}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0605.jpg?height=950&width=428&top_left_y=115&top_left_x=303)

FIG. 4,6-1. Zero-offset sections, which contain a diffaction hyperbola with $2500-\mathrm{m} / \mathrm{s}$ velocity, with trace spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0606.jpg?height=990&width=600&top_left_y=116&top_left_x=218)

FIG. 4.6-2. The $f-k$ spectra of the zero-offet sections in Figure 4.6-1 with trace spacings, from top to bottom. $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0607.jpg?height=171&width=470&top_left_y=114&top_left_x=273)

2
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0607.jpg?height=824&width=466&top_left_y=317&top_left_x=285)

FIG. 4.6-3. Kirchhofl migrations of the zero-offset sections in Figure 4.6-1 with trace spacings, from top to bottom, $12.5 \mathrm{~m}$, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0608.jpg?height=998&width=612&top_left_y=116&top_left_x=212)

FIG. 4.6-4. The $f-k$ spectra of the outputs from the Kirchhof migrations in Figure 4.6-3 with trace spacings, from bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0609.jpg?height=882&width=406&top_left_y=214&top_left_x=313)

FIG. 4.6-5. 15-degree finite-difference migrations of the zero-offsot sections in Figure 4.6-1 with trace spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0610.jpg?height=1034&width=470&top_left_y=134&top_left_x=281)

FIG. 4.6-6. 65-degree implicit freguency-space migrations of the vero-offest sections in Figure 4.6-1 with top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0611.jpg?height=1000&width=600&top_left_y=114&top_left_x=218)

FIG. 4.6-7. The $f-k$ spectra of the outputs from the 65 -degree implicit frequency-space migrations in Figure $4.6-6$ with trace spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

S

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0612.jpg?height=90&width=476&top_left_y=138&top_left_x=283)

2
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0612.jpg?height=774&width=468&top_left_y=397&top_left_x=283)

FIG. 4.6-8. 70-degree explicit frequency-space migrations of the zero-offset sections in Figure 4.6-1 with th top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0613.jpg?height=998&width=606&top_left_y=115&top_left_x=212)

FIG. 4.6-9. The $f-k$ spectra of the outputs from the steep-dip explicit frequency-space migrations in Figure $4.6-8$ with trace spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0614.jpg?height=507&width=456&top_left_y=651&top_left_x=293)

FIG. 4.6-10. Phase-shift migrations of the zero-offset sections in Figure 4.6-1 with trace spacings, fro $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

Migration
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0615.jpg?height=996&width=608&top_left_y=116&top_left_x=209)

FIG. 4.6-11. The $f-k$ spectra of the outputs from the phase-shift migrations in Figure 4.6-10 with trace spacin top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0616.jpg?height=962&width=556&top_left_y=126&top_left_x=240)

FIG. 4.6-12. Zero-offset sections, which contain dipping events with $3500-\mathrm{m} / \mathrm{s}$ velocity, with trace spacings, $f$ bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0617.jpg?height=837&width=681&top_left_y=239&top_left_x=175)

FIG. 4.6-13. The $f-k$ spectra of the zero-offset sections in Figure 4.6-12 with trace spacings, from top to bottom, $25 \mathrm{~m}$, $50 \mathrm{~m}$, and $100 \mathrm{~m}$.
s

1

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0618.jpg?height=106&width=533&top_left_y=205&top_left_x=260)

2
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0618.jpg?height=624&width=550&top_left_y=468&top_left_x=242)

FIG. 4.6-14. Kirchhoff migrations of the zero-offset sections in Figure 4.6-12 with trace spacings, from top to bc $50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0619.jpg?height=850&width=689&top_left_y=235&top_left_x=169)

FIG. 4.6-15. The $f-k$ spectra of the outputs from the Kirchhoff migrations in Figure 4.6-14 with trace spacings, from top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0620.jpg?height=146&width=406&top_left_y=321&top_left_x=314)

Trace Spacing $=25 \mathrm{~m}$
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0620.jpg?height=410&width=392&top_left_y=567&top_left_x=326)

FIG. 4.6-16. 15-degree finite-difference migrations of the zero-offset sections in Figure 4.6-12 with $t$ to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0621.jpg?height=1030&width=618&top_left_y=122&top_left_x=206)

FIG. 4.6-17. 65-degree implicit frequency-space migrations of the zero-offset sections in Figure 4.6-12 with truce sprcings, from top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0622.jpg?height=842&width=681&top_left_y=235&top_left_x=178)

FIG. 4.6-18. The $f-k$ spectra of the outputs from the 65 -degree implicit frequency-space migrations in Figure $4.6-17 \mathrm{w}$ trace spacings, from top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
s

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0623.jpg?height=155&width=608&top_left_y=145&top_left_x=209)

2
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0623.jpg?height=668&width=600&top_left_y=496&top_left_x=217)

FIG. 4.6-19. 70-degree explicit frequency-space migrations of the zero-offset sections in Figure 4.6-12 with trace spacings, from top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0624.jpg?height=846&width=689&top_left_y=233&top_left_x=169)

FIG. 4.6-20. The $f-k$ spectra of the outputs from the steep-dip explicit frequency-space migrations in Figure 4.6-19 w trace spacings, from top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0625.jpg?height=1012&width=600&top_left_y=125&top_left_x=217)

FIG. 4.6-21. Phase-shift migrations of the zero-offet sections in Figure 4.6-12 with trace spacings, from top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0626.jpg?height=841&width=683&top_left_y=237&top_left_x=177)

FIG. 4.6-22. The $f-k$ spectra of the outputs from the phase-shift migrations in Figure 4.6-21 with trace spacings, frr top to bottom, $25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
spacing. By discarding every other trace, obtain another zero-offset section with $50 \mathrm{~m}$ trace spacing. Repeat the procedure to obtain the zero-offset section with 100-m trace spacing (Figure 4.6-12).

The $f-k$ spectra of the zero-offset sections with the three different trace spacings are displayed in Figure 4.6-13. The dipping events with $25-\mathrm{m}$ trace spacing map onto a series of radial lines in the $f-k$ plane (Section 4.1). The Nyquist wavenumber is 20 cycles $/ \mathrm{km}$ and the bandwidth is given by the corner frequencies $6,12-36$, $48 \mathrm{H} z$ for the passband region of the spectrum. As for the diffraction hyperbola model (Figure 4.6-3), the red is associated with the flat part of the passband region and the blue is associated with the taper zone.

The $f-k$ spectrum of the zero-offset section with $50-\mathrm{m}$ trace spacing (Figure 4.6-12), which corresponds to a Nyquist wavenumber of $10 \mathrm{cycles} / \mathrm{km}$, indicates spatial aliasing beyond approximately $24 \mathrm{~Hz}$ (Figure 4.6-13). Consequently, the aliased segments of the radial lines map onto the left quadrant of the $f-k$ spectrum. At a coarser trace spacing of $100 \mathrm{~m}$, which corresponds to a Nyquist wavenumber of $5 \mathrm{cycles} / \mathrm{km}$, spatial aliasing occurs first at approximately $12 \mathrm{~Hz}$. Then, some of the encrgy alrcady aliased becomes aliased for the second time at approximately $36 \mathrm{~Hz}$. Moreover, part of the aliased energy is remapped onto the right quadrant (Figure 4.6-13).

Figure 4.6-14 shows the results of Kirchhoff migration of the zero-offset sections in Figure 4.6-12. No aliasing noise is present on the migrated section with $25-\mathrm{m}$ trace spacing. Next, consider the migrated section with $50-\mathrm{m}$ trace spacing. Frequency components that are spatially aliased are perceived by migration to dip in the direction opposite to the actual dips of the events. Normally, energy is moved in the up-dip dircetion, in this case from right to left as seen in the migrated section with $25-\mathrm{m}$ trace spacing. However, in the migrated section with $50-\mathrm{m}$ trace spacing, the spatially aliased part of the energy is split away from the dipping events and moved from left to right. Note that the aliased energy is dispersed. As for the diffraction hyperbola model (Figure 4.6-2), each frequency component of the aliased energy is perceived to have a different dip by migration, the displacement of the energy after migration is frequency dependent. The unaliased portion of the energy is of course moved from right to left and positioned accurately. The more frequency components are spatially aliased, the less energy at lower frequencies is mapped to the correct position.

Finally, consider the case of the migrated section with $100-\mathrm{m}$ trace spacing (Figure 4.6-14). Note that there exists aliasing noise not only to the right of the dipping events but also in the left-most portion of the section. The latter is associated with the euergy that has been aliased twice (Figure 4.6-3). Because of the complexity of aliasing, the noise essentially disperses over the whole of the section.

An interesting observation on the migrated sections in Figure 4.6-14 relates to the energy in the region above $1 \mathrm{~s}$. In Kirchhoff migration, amplitudes in the input section are summed along a hyperbolic summation path and placed at the apex of the hyperbola. Imagine a summation path whose apex is situated at a time less than 1 s. There will be some energy placed at this apex location since the flanks of the summation path under consideration will intersect through traces with nonzero sample values. This situation is encountered when migrating marine data using Kirchhoff summation. Normally, the migrated section is muted above the water bottom to remove the noisc created by migration within the water layer.

Besides data aliasing, there is also the problem of operator aliasing. In particular, for a low-velocity hyperbola or for a hyperbola with its apex situated at shallow times, Kirchhoff summation may require more than one sample per trace. This results in some energy in the form of precursors above the migrated sea-bottom reflection, when only one point per trace is included in the summation.

Figure 4.6-15 shows the $f-k$ spectra of the migrated sections in Fignre 4.6-14. As discussed in Section 4.1, migration rotates the radial lines on the $f-k$ plane associated with the dipping events.

Figure 4.6-16 shows migration of a zero-offset section that contains a set of dipping events using the 15degree implicit finite-difference method. Note the undermigration of the steeply dipping events caused by the 15-degree dip limitation, the dispersive noise $A$ caused by the finite-difference approximations, and the spatially aliased energy $B$ that splits away from the unaliased part, and moves in the oppasite direction.

Figure 4.6-17 shows the results of migration of the zero-offset sections in Figure 4.6-12 using an implicit frequency-space finite-difference scheme (Section 4.4). Note the dispersive noise caused by the finite-difference approxirations in the section with $25-\mathrm{rn}$ trace spacing. In the sections with $50-\mathrm{rn}$ and $100-\mathrm{m}$ trace spacings, two sets of dispersive noise can be distinguished - one that is caused by the finite-difference approximations and the other caused by spatial aliasing. At coarse spatial sampling, the steeply dipping events are faintly detected on the migrated section.

Figure 4.6-18 shows the $f-k$ spectra of the migrated sections in Figure 4.6-17. As in the case of the diffraction hyperbola (Figure 4.6-7), implicit frequencyspace migration can crate high-frequency noise beyond the passband of the input data.

Figure 4.6-19 shows the results of the migration of the zero-offset sections in Figure 4.6-12 using an explicit
frequency-space finite-difference scheme (Section 4.4). There is no aliasing noise in the section with $25-\mathrm{m}$ trace spacing. But there is precursive dispersion along the steeply dipping events because of the inherent nature of the explicit scheme used here. This dispersion is not as severe as that observed on the result from the implicit scheme (Figure 4.6-17).

The corresponding $f-k$ spectra shown in Figure 4.6-20 explains why there is less aliasing noise on the migrated sections in Figure 4.6-19 compared to those from Kirchhoff summation (Figure 4.6-14). As for the case of the diffaction hyperbola (Figure 4.6-9), explicit schemes attenuate energy associated with wavenumbers $k_{x}$ above a specified cutoff wavenumber. This effectively removes part of the aliased energy that maps onto the spectral region above the cutoff wavenumber associated with the extrapolation filter for the explicit scheme. Note from the $f-k$ spectrum in Figure 4.6-20 that a significant portion of the aliased energy in the left quadrant has been filtered out for the case of the $50-\mathrm{m}$ trace spacing. Despite the wavenumber filtering effect of the explicit scheme, however, much of the aliased noise remains in the section with the $100-\mathrm{m}$ trace spacing.

Figure 4.6-21 shows the results of the phase-shift migration of the zero-offset sections in Figure 4.6-12, and Figure 4.6-22 shows the corresponding $f-k$ spectra. These results are used as a benchmark to evaluate the results obtained from the other migration algorithms (Figures 4.6-14 through 4.6-20). Except for the aliasing noise, phase-shift migration produces no artifacts.

The effect of spatial aliasing on migration of field data, to begin with, is demonstrated in Figures 4.6-23 and 4.6-24. We see the original stacked section and its resampled versions at coarser trace spacings. From the migrations of these four stacked sections with coarser trace spacings, note the loss of spatial resolution. The nearly flat events are not adversely affected by spatial aliasing, while the steeply dipping reflection of the right flank of the salt diapir can only be detected on the migrated section with very coarse sampling by a lowfrequency, weak-amplitude event. The diffraction energy off the tip of the salt diapir is largely dispersed into the region with nearly flat events to the right of the diapir

We now examine the response of the various migration algorithms to spatial alaising using the data shown in Figures 4.6-25 and 4.6-26. The stacked data are associated with the same line sampled at four different trace spacings $-12.5,25,50$, and $100 \mathrm{~m}$. Figure 4.6-27 shows migrations of the stacked sections using Kirchhoff summation. The section with $12.5-\mathrm{m}$ trace spacing provides a crisp image of the salt diapir, while the sections with coarser trace spacings degrade gradually. Specifically, it is almost impossible to delineate the salt boundary on the section with $50-\mathrm{m}$ trace spacing, and the section with $100-\mathrm{m}$ trace spacing does not even provide an image of the gently dipping reflections. This is because of the aliasing noise associated with the steep lanks of the salt diapir corrupting the surrounding reflections. Spar tial aliasing not only adversely affects the quality of the inage associated with a dipping event that is aliased, but it also can obliterate other nonaliased events in the data.

Figure 4.6-28 through 4.6-30 show migrations of the stacked sections in Figures 4.6-25 and 4.6-26 using steep-dip frequency-space implicit and explicit schemes, and the phase-shift method. Similar conclusions are drawn for the Kirchhoff summation results shown in Figure 4.6-27. Differences in terms of delineation of the salt boundary and the surrounding strata are attributable to the manner in which these algorithms are implemented and how they treat the velocity field for migration. For instance, when examining the results from the froquency-space implicit scheme (Figure 4.628), one must keep in mind the effect of spatial aliasing combined with the effect of undermigration caused by the dip-limited nature of the algorithm and the effect of dispersion caused by finite-difference approximations.

What is the remedy for spatial aliasing noise in migration? Arrange the sequence of the sections in Figures 4.6-27 through 4.6-30 from a coarser to a finer trace spacing. Note that the deleterious effect of spatial aliasing in migration disappears as we go to finer trace spacings. To avoid spatial aliasing, we must record with sufficiently fine CMP trace interval or interpolate the data that have been recorded with coarse spatial sampling.

Most modern surveys are conducted using spatial sampling rates that are perfectly adequate to meet exploration and development objectives. If we are dealing with vintage data with coarse spatial sampling, there are two ways to circumvent the effect of spatial aliasing. The first approach would be to filter out the aliased frequencies. This is undesirable, since it severely limits vertical and lateral resolutions (Scction 11.1). The second approach would be to do trace interpolation before migration. In Sections 7.2 and G.5, we discuss interpolation of aliased data. Note from section 1.3 that the smaller the trace interval, the higher the Nyquist in the spatia! wavenumber direction (Figures 1.3-10 and 1.3-11), and thus, the less likelihood of aliasing highfrequency datg.

A schematic illustration of the spatial aliasing phe nomenon is shown in Figure 4.6-31. Start with the spectral bandwidth that spans $C O A$ in the spatial wavenumber axis, where $A$ is the location of the Nyquist wavenumber, and $O N$ in the temporal frequency axis, where $N$ is the location of the Nyquist frequency. Dip
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0629.jpg?height=502&width=774&top_left_y=161&top_left_x=83)

## Trace Spacing $=13.3 \mathrm{~m}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0629.jpg?height=500&width=756&top_left_y=676&top_left_x=101)

FIG. 4.6-23. A portion of a CMP-stacked section spatially sampled at four different trace spacings.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0630.jpg?height=474&width=397&top_left_y=124&top_left_x=104)

## Trace Spacing $=13.3 \mathrm{~m}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0630.jpg?height=1020&width=758&top_left_y=142&top_left_x=128)

FIG. 4.6-24. Phase-shift mgrations of the stacked sections in Figure 4.6-23 sampled at four different trace spacings.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0631.jpg?height=1010&width=736&top_left_y=174&top_left_x=72)

FIG. 4.6-25. A CMP-stacked section spat,ally sampled at $125-\mathrm{m}$ (top) and $25-\mathrm{m}$ (bottom) trace spacings.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0632.jpg?height=1002&width=728&top_left_y=177&top_left_x=154)

FIG. 4.6-26. A CMP-stacked section as in Figure 4.6-25 spatially sampled at 50-m (top) and $100-\mathrm{m}$ (bottom) trace spacings.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0633.jpg?height=986&width=592&top_left_y=114&top_left_x=223)

FIG. 4.6-27. Kirch hoff migrations of the stacked sections in Figure 4.6-25 and 4.6-26 with trace spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0634.jpg?height=992&width=592&top_left_y=122&top_left_x=222)

FIG. 4.6-28. 65-degree implicit frequency-space migrations of the stacked sections in Figure 4.6-25 and $46-26$ w spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0635.jpg?height=1046&width=626&top_left_y=119&top_left_x=200)

FIG. 4.6-29. 70-degree explicit frequency-space migrations of the stacked sections in Figure 46-25 and 4.6-26 with trace spacings, from top to bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0636.jpg?height=1050&width=626&top_left_y=125&top_left_x=208)

FIG. 4,6-30. Phase-shift migrations of the stacked sections in Figure 4.6-25 and 46-26 with trace spacings, from bottom, $12.5 \mathrm{~m}, 25 \mathrm{~m}, 50 \mathrm{~m}$, and $100 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0637.jpg?height=275&width=350&top_left_y=124&top_left_x=116)

FIG. 4.6-31. Two dipping events in the $f-k$ domajn. See text for details.

components 1 and 2 are aliased beyond frequency values $A T$ and $A S$, respectively. Extend the wavenumber axis to $D O B$ by making the trace interval half of the original. Event 1 no longer is spatially aliased within the frequency band width $O N$. Event 2 still is aliased beyond the frequency value $B V$. However, at this point and beyond, there may be no significant energy, so further extension of the wavenumber axis may not be necessary. Another important point is that if the temporal frequency band only extended up to $O G$ to start with, extension of the wavenumber axis to $D O B$ also would result in Event 2 being unaliased. Thus, the amount of trace interpolation that is required also depends on temporal bandwidth as well as on structural dip.

Trace interpolation often is necessary when dealing with 3-D data and old data recorded with a large group interval. In a typical 3-D survey, the inline trace interval may be as little as $12.5 \mathrm{~m}$, while the trace interval in the crossline direction, for some old data, may be as much as $100 \mathrm{~m}$. Therefore, interpolation is required before $\mathrm{mi}-$ gration in the crossline direction. You do not necessarily interpolate down to the inline trace spacing; instead, depending on the maximun structural dip and velocity in the area, the optimum trace spacing for interpolation in the crossline direction can be computed using equation (1-8). Section 7.2 provides more information on trace interpolation in relation to $3-\mathrm{D}$ migration.

## Migration and Random Noise

Figure 4.6-32 shows a section that contains bandlimited random noise uncorrelated from trace to trace and its migration using the phase-shift method. Velocity increases linearly from $2000 \mathrm{~m} / \mathrm{s}$ at the top to 4000 $\mathrm{m} / \mathrm{s}$ at the bottom of the section. The amplitude and frequency characteristics of the input section in Figure

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0637.jpg?height=412&width=180&top_left_y=126&top_left_x=570)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0637.jpg?height=413&width=161&top_left_y=124&top_left_x=761)

(b)
FIG. 4.6-32. Response of migration to random noise: (a) zero-offset section with random noise, only, (b) frequencywavenumber migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0637.jpg?height=230&width=360&top_left_y=660&top_left_x=570)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0637.jpg?height=232&width=360&top_left_y=921&top_left_x=570)

(b)

FIG. 4.6-33. (a) A deeper portion of a CMP-stacked section with significant noise level, (b) the same portion after migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0638.jpg?height=542&width=858&top_left_y=119&top_left_x=84)

FIG. 4.6-34. Migrations of a portion of a CMP stack with different lateral extents.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0638.jpg?height=399&width=256&top_left_y=742&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0638.jpg?height=399&width=260&top_left_y=742&top_left_x=366)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0638.jpg?height=309&width=312&top_left_y=749&top_left_x=631)

(c)

FIG. 4.6-35. Edge effects in migration: (a) a portion of a CMP stack, (b) the same portion after migration, and (c) a sketch that illustrates the edge effect problem using the semicircle superposition method of migration. See text for A, B, C, and D.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0639.jpg?height=507&width=457&top_left_y=125&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0639.jpg?height=508&width=387&top_left_y=124&top_left_x=547)

(b)

FIG. 4.6-36. A CMP stack (a) before and (b) after migration.

4.6-32 are virtually unchanged in the interior portion of the migrated section. However, note the smearing of amplitudes at the bottom and side boundaries after migration.

Ambient noise commonly dominates the deep portion of a stacked section where velocities are high. Therefore, orgenization of random noise caused by migration generally is more severe in the deeper part of a stacked section. A field data example is shown in Figure 4.6-33. In addition to smearing effects, the migrated section also has smiles, which are caused by sparsely distributed bursts of amplitude in the input section. Keep in mind that a single spike on the time section migrates to a semicircle on the depth section.

We already have seen the gdverse effect of an improper choice of aperture width in Kirchhoff summation (Figure 4.2-7). A narrow aperture can introduce strong smearing as spurious, nearly horizontal events. A similar effect occurs for all types of migration algorithms if the maximum dip to migrate is severely restricted (Figure $4.5-4$ ). It is a misconception to imagine that migration attenuates random noise and improves signal-to-noise ratio. Instead, one must keep in mind that migration organizes random noise, it does not ettenuate it. A diplimited migration algorithm acts upon the random noise like a dip filter and removes the noise energy beyond the dip limit much like shown in Figure 6.2-2. The diplimited algorithm also attenuates unaliased linear noise with a dip steeper than the dip limit.

## Migration and Line Length

For one reason or another, a seismic line may have to be recorded in the field with a shorter length than desired. To see the effect of line length on migration, we will examine the migrations of the decreasing lengths of the same CMP stack (Figure 4.6-34). Migration of the smaller portions, $B D$ and $C D$, results in an increasingly smeared section, particularly in the deeper parts. We conclude that short seismic lines really are not suited for migration.

If the line traverse is too short, two effects occur. First, there is not enough space in the section for dipping events to move during migration. This problem may be alleviated by padding the stacked section with

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0640.jpg?height=968&width=653&top_left_y=183&top_left_x=196)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0641.jpg?height=1002&width=641&top_left_y=183&top_left_x=198)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0642.jpg?height=348&width=725&top_left_y=120&top_left_x=155)

FIG. 4.6-39. A sketch of the events after migration from the flat reference datum level as in Figure 4.6-37 denoted by the dotted segments and migration from the floating datum as in Figure 4.6-38 denoted by the solid segments. The area covered corresponds to the upper central portions of the sections in Figures 4.6-37 and $46-38$ between midpoints $A$ and $B$.

zero traces on both sides before migration. Second, side boundary effects contaminate a significant portion of the migrated section. The real solution to circumvent the boundary effects is to record data with sufficient line length.

With a general idea of structural dip in an area, the geophysicist must consider the additional spatial extent that is required by migration. (Refer to the discussion on Figure 4.1-1.) This is especially important in 3-D surveys in which the surface areal coverage must be extended beyond the subsurface areal coverage so that steep dips and structural discontinuities can be recorded and imaged properly (Section 7.1). The problem with $3-D$ is that cost increases as the square of the survey dimension, so that temptation to record too small a survey is great.

Regardless of line lengths, there are additional problems associated with the side boundaries of the stacked section input to migration. All migration algorithms implicitly make some assumption about the nature of data outside the side boundaries of the input stacked section. The simple assumptions, zero amplitude or zero gradient at the side boundaries of the section, cause data that should migrate past the edge to be reflected back into the section. To prevent this, traces of zero amplitude often are appended to the edges of the input section. This allows the dipping events to move freely into the zero-amplitude region during migration. If the events that would migrate off the input section are not needed, they often are suppressed by using absorbing side boundary conditions (Clayton and Engquist, 1980).
Figure 4.6-35 shows a section with significant smearing caused by side boundary effects. The wavefront character that dominates the left boundary of the migrated section down to the bottom of the mute zone can be explained using the principle of semicircle superposition for migration. Consider a dipping event $A$ that extends down to the edge of the section as in the sketch in Figure 4,6-35. After migration $B$, note the remainder of the semicircular wavefront $C$ on the left side. This wavefront did not cancel out during superposition because no data were available beyond the left boundary of the section.

Another source of edge effects is the presence of amplitude bursts at or near the edge of the stacked section associated with a low signal-to-noise ratio that results from low fold. The edge effects on the left boundary below the mute zone in the migrated section (Figure 4.6-35) probably stem from the lack of amplitude balance on the CMP stacked section. The latter is caused by changes in fold at the end of the line.

Figure 4.6-36 shows a CMP stack with an imbricate structure associated with overthrust tectonics. After migration, note that there are two zones with no reflections. The zone to the left of CMP 100 resulted from finite line length. Specifically, the events on the left flank of the imbricate structure are migrated to the right in the up-dip direction, thus leaving behind a zone of no events into which no energy is moved since the line ends to the left of the structure. The zone of no events between CMP 200 and 300 is a direct consequence of the overthrusting that has given rise to a culminating stricture with very steep, almost overturned events. Mi-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0643.jpg?height=1028&width=910&top_left_y=122&top_left_x=73)

FIG, 4,6-40. Principles of migration from topography. See text for details.
gration of such steep dips is possible only if they exist in the recorded data and are imaged using algorithms which handle dips beyond 90 degrees.

## Migration from Topography

A CMP-stacked section is assumed to be equivalent to a zero-offset wavefield and usually is referenced to a flat datum. Figure 4.6-37 shows a migrated CMP stacked section associated with a seismic line that follows a traverse with severe topography from an area with overthrust tectonics. Migration was done from a flat reference datum. When migrating data recorded over such an irregular and severe topography, however, one needs to account for the difference between the elevation profile and the reference datum. Otherwise, events appear to a migration algorithm shallower than they actually are if the flat reference datum is below the elevation profile, and thus are undermigr ated. If the flat reference datum is above the elevation profile, then events appcar to a migration algorithm deeper than they actually are, and thus are overmigrated.

Figure 4.6-38 shows the same data as in Figure 4.6-37 with migration from the floating datum which is a smooth form the elevation profile. A sketch of key events between midpoints $A$ and $B$ from both sections is provided in Figure 4.6-39. The flat reference datum in this case is above the elevation profile. Hence, migration from the flat datum causes overmigration as denoted by the dotted interpretation segments. By migrating the data from the floating datum and interpreting the resulting section, we obtain the solid segments in Figure 4.6-39.

Migration algorithms, with the exception of Kirchhoff summation and the constant-velocity Stolt method, are all based on wave extrapolation from one flat depth level to another. To accommodate an irregular topography, the following formal approach can be used:

(a) Stack the data referenced to the floating datum and assume it to be the zero-offset wavefield recorded along the floating datum profile.

(b) Apply wave-equation datuming (Section 8.1) to extrapolate the zero-offset wavefield as dofined in (a) from the floating datum to a flat datum above using a velocity the same as that just below the floating datum.

(c) Migrate the output wavefield from (b) using a preferred migration algorithm.

The stacking velocity field required in step (a) is referenced to the floating datum. The migration velocity field required in step (c) would need to be derived by redefining the stacking velocities with respect to the flat datum. To circumvent this tedious task, migration from an irregular topography is done either by the zero-velocity trick (Beasley and Lynn, 1902) or the zero-wavefield trick (Reshef, 1991).

In the first approach by Beasley and Lynn (1992), a zero velocity value is assigned to the region between the floating datum and the flat datum, which is specified above the floating datum. Just as it should be in conventional processing, the stacked section is referenced to the flat datum, and the velocities are referenced to the floating datum. Extrapolate the stacked section down one depth step using the zero velocity as part of the migration process. This amounts to a simple vertical time shift. If the depth level intersects the floating detum profile, then invoke the diffraction term (equation 4-16a) for the traces in the stacked section that coincide with the intersection points. Continue the extrapolation process from one depth level to the next while trurning on the diffraction term for those traces which coincide with the intersection points of the depth levels and floating datum profile.

In the second approach by Reshef (1991), to start with, a zero wavefield is assigned to the fat datum level $z_{0}$ in Figure 4.6-40. The stacked section and the velocities are referenced to the floating datum. Extrapolate this wavefield down one depth level to $z_{1}$ using a velocity the same as that just below the floating datum profile. Import the traces 1 and 2 from the stacked section at the intersection points of the depth level and the floating datum profile, and insert them to the section referenced to the depth level $z_{1}$. Now extrapolate down to the next depth level $z_{2}$, and import traces $3,4,5$, and 6 from the stacked section, and insert them into section referenced to the depth level $z_{2}$. At each depth level, while new traces are imported from the original stacked section, the previously imported traces are subsjected to wave extrapolation as symbolized by the small arcs associated with each time sample.

## EXERCISES

Exercise 4-1. Consider the special case of a 90 degree dipping reflector in Figure 4.1-1a. Sketch the corresponding zero-offect time section.

Exercise 4-2. Consider Huygens' secondary sources along a dipping reflector. Sketch the zero-offset section by superimposing the individual responses from these sources. Remember, to do zero-offset modeling, you must map a point in the $x-z$ plane to a hyperbola in the $x-t$ plane with its apex as the input point.

Exercise 4-3. For which case is spatial aliasing a more serious problen, the low-velocity or high-velocity medium?
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0645.jpg?height=686&width=862&top_left_y=124&top_left_x=90)

FIG. 4.E-1. See Excrcise 4-4.

Exercise 4-4. Locate the dipping event $A A^{\prime}$ on the migrated section in Figure 4.E-1,

Exercise 4-5. A point in the $x-t$ plane is mapped onto a semicircle in the $x-z$ plane. Where does it map on the $x-\tau$ plane, where $\tau=2 z / v$.

Exercise 4-6. Refer to Figure 4. I-14. It suggests that if the subsurface consisted of a semicircular reflector (b), then the zero-offset response would be as in (a). What would the subsurface be like if you obtained (a) using a source-receiver pair with a finite separation between them? (See Figurcs D-5 and D-6.)
Exercise 4-7. Suppose you specified the wrong trace spacing in your migration. What effect does it have, overmigration or undermigration? Assume that you supplied the wrong sampling rate in time. What cffect does it have on migration output?

Exercise 4-8. Suppose you want to do zero-offset recording of the steep lank of a salt dome. Which case would require a longer line length when the medium velocity along the raypath is (a) constant or (b) vertically increasing?

Exercise 4-9. How would Figure 4.3-6 look if you used a 15-degree phase-shift migration algorithm?

## Appendix D <br> MATHEMATICAL FOUNDATION OF MIGRATION

## D. 1 Wavefield Extrapolation and Migration

A fundamental equation of reflection seismology is the double-square-root $(D S R)$ equation. This equation describes downward continuation of both shots and receivers into the earth. It is exact for all dips and offsets. Neglecting the velocity gradient $d v(z) / d z$ makes the $D S R$ equation also applicable to a stratified earth. The DSR equation can be extended, with some approximation, to treat weak lateral velocity variations. A comprehensive mathematical treatise of the DSR equation is found in Claerbout (1985).

The basic 2-D theory for wavefield extrapolation is presented here. Then, using the DSR equation, a rigorous analysis of conventional seismic data processing is made. We show that conventional implementation of the $D S R$ equation requires zero-dip and zero-offset assumptions.

Before discussing the $D S R$ equation, we review the basic theory for wavefield cxtrapolation. Once the extrapolation equations are developed, they can be used with the imaging principle to migrate 2-D or 3-D prestack and poststack data.

Start with the 2-D scalar wave equation, which describes propagation of a compressional wavefield $P(x, z, t)$ in a medium with constant material density and compressional wave velocity $v(x, z)$ :

$$
\left(\frac{\partial^{2}}{\partial x^{2}}+\frac{\partial^{2}}{\partial z^{2}}-\frac{1}{v^{2}} \frac{\partial^{2}}{\partial t^{2}}\right) P(x, z, t)=0
$$

where $x$ is the horizontal spatial axis, $z$ is the depth axis (positive downward), and $t$ is time. Given the upcoming seismic wavefield $P(x, 0, t)$, which is recorded at the surface, we want to determine reflectivity $P\left(x_{r} z, 0\right)$. This requires extrapolating the surface wavefield to depth $z$, then collecting it at $t=0$. The process of obtaining the earth's reflectivity $P(x, z, t=0)$ from the observed wavefield $P(x, z=0, t)$ at the surface $z=0$ is called migration, and the reverse process is called modeling (Figure D-1).

It is advantageous to decompose the wavefield into monochromatic plane waves with different angles of propagation from the vertical. Therefore, we will work in the Fourier transform domain whenever possible. The wavefield can always be Fourier transformed over time $t$. If there is no lateral velocity variation, then the wavefield also can be Fourier transformed over the horizontal axis $x$. Thus,

$$
P\left(k_{x}, z, \omega\right)=\iint P(x, z, t) \exp \left(\imath k_{x}-i \omega t\right) d x d t
$$

and inversely,

$$
P(x, z, t)=\iint P\left(k_{x}, z, \omega\right) \exp \left(-i k_{x}+i \omega t\right) d k_{x} d \omega
$$

When the differential operator in equation (D-1) is applied to equation (D-2b), we get

$$
\frac{\partial^{2}}{\partial z^{2}} P\left(\dot{k}_{x}, z, \omega\right)+\left(\frac{\omega^{2}}{v^{2}}-k_{x}^{2}\right) P\left(k_{x}, z, \omega\right)=0
$$

Although $v$ can be varied with depth $z$ in equation (D-3), for now we assume a constant velocity case. The stratified earth case is considered later in this appendix. Equation (D-3) has two solutions, one for upcoming waves, the other for downgoing waves. The upcoming wave solution to equation (D-3) is recognized as

## Migration

## Observations

Earth

| $z=0$ <br> all $t$ |
| :--- |

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0647.jpg?height=96&width=183&top_left_y=222&top_left_x=537)

## Modeling

FIG. D-1. Relationship between migration and wavefield modeling (see Section D.1).

$$
P\left(k_{x}, z, \omega\right)=P\left(k_{x}, z=0, \omega\right) \exp \left[-i \sqrt{\frac{\omega^{2}}{v^{2}}-k_{x}^{2} z}\right]
$$

Equation (D-4) ulso is the solution to the following one-way wave equation:

$$
\frac{\partial}{\partial z} P\left(k_{x}, z, \omega\right)=-i \sqrt{\frac{\omega^{2}}{v^{2}}-k_{x}^{2}} P\left(k_{x}, z_{1} \omega\right)
$$

This solution can be verified by substituting equation (D-4) into equation (D-5).

We define the vertical wavenumber as

$$
k_{z}=\frac{\omega}{v} \sqrt{1-\left(\frac{v k_{x}}{\omega}\right)^{2}}
$$

Equation (D-6) often is called the disperston relation of the one-way scalar wave equation. By using this expression, equation (D-4) takes the simple form

$$
P\left(k_{x}, z, \omega\right)=P\left(k_{x}, z=0, \omega\right) \exp \left(-\imath k_{z} z\right)
$$

To determine the reflectivity $P(x, z, 0)$ from the wavefield recorded at the earth's surface $P(x, 0, t)$, proceed as follows:

(a) Perform a 2-D Fourier transform over $x$ and $t$ to get $P\left(k_{x}, 0, \omega\right)$.

(b) Multiply by the all-pass filter $\exp \left(-\imath k_{z} z\right)$ to obtain the wavefield $P\left(k_{z}, z, \omega\right)$ at depth $z$.

(c) Perform summation over $\omega$ to obtain $P\left(k_{x}, z, 0\right)$.

(d) Finally, inverse Fourier tranforn over $k_{x}$ to obtain the earth's image $P(x, z, 0)$ at that depth.

For the constant velocity case $P\left(k_{x}, k_{z}, 0\right)$ can be computed by a direct mapping in the transform domain from $\left(k_{x}, \omega\right)$ to $\left(k_{x}, k_{z}\right)$ using equation (D-6) (Stolt, 1978).

The main objective here is to interpret equation (D-7) as a tool for downward extrapolating wavefields given at the surface. While the mathematical development of the process presented is simple, its physical basis is not obvious. In an effort to devclop a physical motivation for equation (D-7), a simpler derivation follows.

Given the upcoming wavefield $P(x, 0, f)$ recorded at the surface, we can decompose it into monochromatic plane waves, each traveling at a different angle from the vertical. We identify these plane waves by attaching each one to a unique $\left(k_{x}, \omega\right)$ pair. This plane-wave decomposition is equivalent to Fourier transforming the wavefield to yield $P\left(k_{x}, 0, \omega\right)$.

Now consider one of these plane waves as shown in Figure D-2. Imagine that this plane wave passed point $P$ at $t=0$, traveled upward, and was recorded by a receiver at surface point $G$ at

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0648.jpg?height=407&width=406&top_left_y=118&top_left_x=313)

FIG. D-2. Geometry for wavefield extrapolation (see Section D.1) (Yilmaz, 1979).

time $t$. For reflector mapping, we need to take the energy located at point $G$ on the wavefront at time $t$, back to its position at $t=0$ - to reflection point $P$. To return the energy to $P$, it makes sense to follow the sarne raypath used for outward propagation from $P$. The fact that the same path is used means that downward continuation does not alter the horizontal wavenumber $k_{x}$.

Suppose that the wavefront is moved to a depth $\Delta z=G G^{\prime}$ beneath the receiver at $G$ so that the waveform at $G$ now is at $G^{\prime \prime}$. If a receiver were buried at $G^{\prime \prime}$, it would have recorded the plane wave at $t-\Delta t$, where $\Delta t$ is the traveltime between $G$ and $G^{\prime \prime}$. In other words, moving the receiver at $G$ vertically down a distance $\Delta z$ to a new location $G^{\prime}$ changes the traveltime along the raypath from $G$ to $P$ by $-\Delta t$.

From the geometry of Figure D-2, we have

$$
\Delta t=\frac{\Delta z}{v} \cos \theta
$$

where $v / \cos \theta$ is the vertical phase velocity. We know the $k_{x}$ and $\omega$ values for the plane wave. Suppose the distance between $G$ and $G^{\prime \prime}$ is one wavelength $\lambda$. At time $t-\Delta t$, the wavefront intersects the $x$-axis at distance $\lambda_{x}$ from $G$. From the geometric relation in Figure D-2, we have

$$
\frac{\lambda}{\lambda_{x}}=\sin \theta
$$

By using the definitions $\lambda=2 \pi /(\omega / v), \lambda_{x}=2 \pi / k_{x}$, and equation (D-8b), we obtain

$$
\sin \theta=\frac{v k_{x}}{\omega}
$$

and

$$
\cos \theta=\sqrt{1-\left(\frac{v k_{x}}{\omega}\right)^{2}}
$$

where $\omega / v$ is the wavenumber along the raypath. By substituting equation (D-8d) into equation (D-8a), we have

$$
\Delta t=\frac{1}{v} \sqrt{1-\left(\frac{v k_{r}}{\omega}\right)^{2}} \Delta z
$$

As we move down, we do not want to change the amplitude of the plane wave. Given the change in traveltime, $\Delta t$ by equation (D-8e), the corresponding phase shift is $-\omega \Delta t$. At each $\Delta z$ step of descent, we may propagate the plane wave with a different velocity $v(z)$. The total phase shift to which the waveform was subjected with arrival at $P$ is $-\int \omega d t$.

To compute the wavefield at $P$, we use equation (D-8e) and multiply the transformed surface wavefield $P\left(k_{x}, 0, \omega\right)$ by

$$
\exp \left(-\imath \int_{C}^{P} \omega d t\right)=\exp \left[-\imath \int_{0}^{z} \frac{\omega}{v(z)} \sqrt{1-\left(\frac{v(z) k_{\tau}}{\omega}\right)^{2}} d z\right]
$$

Equation (D-9) is the same operator uscd in equation (D-7), except that equation (D-7) was derived for constant $v$.

We now return to the more mathematical discussion and consider the stratified earth with a velocity $v(z)$. Since we have not Fourier transformed $P(x, z, t)$ over $z$, the one-way wave equation (D-5) also is valid for $v(z)$ :

$$
\frac{\partial}{\partial z} P\left(k_{x}, z, \omega\right)=-i \sqrt{\frac{\omega^{2}}{v^{2}(z)}-k_{z}^{2}} P\left(k_{x}, z, \omega\right)
$$

in which case equation

$$
\text { 6) becomes. }
$$

$$
k_{z}(z)=\frac{\omega}{v(z)} \sqrt{1-\left[\frac{v(z) k_{x}}{\omega}\right]^{2}}
$$

Substitution verifies that equation (D-10) has the following solution:

$$
P\left(k_{x}, z, \omega\right)=P\left(k_{x}, 0, \omega\right) \exp \left[-i \int_{0}^{z} k_{z}(z) d z\right]
$$

We must check whether this solution satisfies the two-way scalar wave equation (D-3). By differentiating equation (D-10) and using equation (D-11), we have

$$
\frac{\partial^{2}}{\partial z^{2}} P=-i \frac{d k_{z}(z)}{d v} \frac{d v(z)}{d z} P-i k_{z}(z) \frac{\partial}{\partial z} P
$$

where $P=P\left(k_{x}, z, \omega\right)$. By substituting equation (D-10) for $\partial P / d z$, we obtain

$$
\frac{\partial^{2}}{\partial z^{2}} P=-i \frac{d k_{z}(z)}{d v} \frac{d v(z)}{d z} P-k_{z}^{2}(z) P
$$

If the velocity gradient $d v(z) / d z$ is ignored, then the first term on the right side drops out. The final expression then is

$$
\frac{\partial^{2}}{\partial z^{2}} P+k_{z}^{2}(z) P=0
$$

When equation (D-11) is substituted into this expression, we get:

$$
\frac{\partial^{2}}{\partial z^{2}} P+\left[\frac{\omega^{2}}{v^{2}(z)}-k_{x}^{2}\right] P=0
$$

which is identical to equation (D-3) where velocity can be varied with depth $z$.

So far, we have shown that a 2-D waveficld recorded at the earth's surface can be extrapolated downward using the phase-shift operator given by equation (D-9). Wave extrapolation can be done through either a constant-velocity medium (equation D-7) or a vertically varying velocity medium (equation D-12). Seismic imaging is not complete until a stopping condition is imposed on downward continuation. The process of downward continuation is terminated when the clock, which measures $t-\int d t$. reads zero traveltime.

The concepts described above can be used to downward continue a complete seismic experiment that involves many shots and receivers. The vertical wavernumber given by equation (D-6)
is expressed as a sum of two square roots, one associated with downward continuation of shots and the other associated with downward continuation of receivers:

$$
k_{z}=\frac{\omega}{v} D S R(G, S)
$$

where $v$ is the medium velocity that can be varied in depth $z$, and $D S R$ stands for the double square root (Claerbout, 1985):

$$
D S R(G, S)=\sqrt{1-G^{2}}+\sqrt{1-S^{2}}
$$

where $G$ and $S$ are the normalized receiver and shot wavenumbers, $k_{g}$ and $k_{s}$, respectively:

$$
G=\frac{v k_{g}}{\omega}
$$

and

$$
S=\frac{v k_{s}}{\omega}
$$

The newly defined vertical wavenumber in equation (D-15) is inserted into the extrapolation equation (D-7) to obtain

$$
P\left(k_{g}, k_{s}, z, \omega\right)=P\left(k_{g}, k_{s}, 0, \omega\right) \operatorname{cxp}\left(-i k_{z} z\right)
$$

where $P\left(k_{q}, k_{s}, 0, \omega\right)$ is the Fourier transform of the prestack data $P(s, g, z=0, t)$ in shotreceiver coordinates. This new extrapolation equation then can be used to downward continue common-shot gathers, and by way of reciprocity, common-receiver gathers.

The DSR equation (D-16) is separable in terms of shot and receiver wavenumbers. This separation means that we can start with the wavefields recorded at the surface as common-shot gathers and use the first part of the $D S R$ operator to downward continue the receivers to depth $\Delta z$. Then, we can sort the already downward-continued wavefields into common-receiver gathers and use the second part of the $D S R$ operator to downward continue the shots to depth $\triangle z$. By alternating between common-receiver and common-shot gathers, the entire seismic experiment (whole line) can be downward continued until imaging is accomplished (Figure D-3).

Although no approximation, besides the stratified earth assumption, is made in this alternating downward-continuation scheme, it is computationally exhausting. In fact, most of today's seismic data processing is done in midpoint-(half) offset $(y, h)$ coordinates, rather than in shotreceiver $\left(s_{r} g\right.$ ) coordinates. Therefore, we will put $D S R$ as defined by equation (D-16) into the $(y, h)$ coordinates.

The following coordinate transformation is required:

$$
y=\frac{1}{2}(g+s)
$$

and

$$
h=\frac{1}{2}(g-s)
$$

After the transformation (Claerbout, 1985), we obtain

$$
G=Y+H
$$

and

$$
S=Y-H
$$

where $Y$ and $H$ are the normalized midpoint and offet wavenumbers, respectively:

$$
Y=\frac{v k_{y}}{2 \omega}
$$

and

$$
H=\frac{v k_{h}}{2 \omega}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0651.jpg?height=333&width=447&top_left_y=123&top_left_x=294)

FIG. D-3. A flow diagram of shot-geophone migration (see Section D.1).

By substituting equations (D-21a) and (D-21b) into equation (D-16), the DSR equation takes the following form in midpoint-offset coordinates:

$$
D S R(Y, H)=\sqrt{1-(Y+H)^{2}}+\sqrt{1-(Y-H)^{2}}
$$

The vertical wavenumber (equation D-15) now is expressed in terms of normalized midpointoffset wavenumbers $Y$ and $H$ :

$$
k_{z}=\frac{\omega}{v} D S R(Y . H)
$$

The newly defined vertical wavenumber in equation (D-23) is inserted into the extrapolation equation (D-18):

$$
P\left(k_{y}, k_{h}, z, \omega\right)=P\left(k_{y}, k_{h}, 0, \omega\right) \exp \left(-\imath k_{z} z\right),
$$

where $P\left(k_{y}, k_{h}, 0, \omega\right)$ is the Fourier transform of the prestack data $P(y, h, z=0, t)$ in midpointoffset coordinates.

Figure D-4 shows the $\omega-k_{y}$ plane for a spocific value of $z$ and $h$, and the $k_{y}-z$ plane for a specific value of $\omega$ and $h$. The radial line A corresponds to $k_{\nu}=2 \omega / v$. The region in the $\omega-k_{y}$ plane below the radial line corresponds to the evanescent energy and that above the radial line corresponds to the propagating energy. The same transition between the two regions also are noted in the $k_{y}-z$ plane. The zero-offset case (Figure D-4c) clearly shows the evanescent energy to the right of the point on the $k_{z}$ axis labeled as $k_{y}=2 \omega / v$ dying off rapidly with depth. The width of the propagation region stays constant with depth. The nonzero-offset case shown in Figure D-4d, however, indicates that the width of the propagation region varies with depth - zero at the surface $z=0$ and approaching rapidly to the zero-offset case immediately at shallow depths. The physical interpretation of this depth-dependency is quite intuitive - the normalized offset wqvenumber $H$ becomes increasingly less significant at greater depths, and the normalized midpoint wavenumber $Y$ becomes the dominating wavenumber. More specifically, on a CMP gather, moveout decreases with depth which implies nearly zero $H$.

Figure D-5 shows the response characteristics of the dispersion relation defined by equation (D-23). Note the semi-elliptical wavefronts in the $y-z$ plane for a single frequency $\omega$; while in the $y-t$ plane, note the table-top traveltime trajectories. The equations for the wavefront and traveltime trajectories are derived in Section D. 2 using stationary phase approximations.

Note that in equation (D-16), the terms with different spatial wavenumbers are separable, However, we have lost the property of separation in equation (D-22) because the operators in $Y$ and $H$ are strongly coupled. As a result, the Taylor series expansions of the square roots in
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0652.jpg?height=610&width=820&top_left_y=220&top_left_x=112)

b

FIG. D-4. Real part of the $\omega-k_{y}$ plane at $z=200 \mathrm{~m}$ : (a) DSR (equation D-23) with $h=0 \mathrm{~m}$, and (b) DSR with $h=400 \mathrm{~m}$. Real part of the $k_{y}-z$ plane at $\omega=16 \mathrm{~m}$ : (c) $D S R$ (equation D-23) with $h=0 \mathrm{~m}$, and (d) $D S R$ with $h=400 \mathrm{~m}$ (Yilmaz, 1979).

equation (D-22) yield terms that contain cross-products of the two wavenumbers. The penalty for processing in the conventional coordinate system $(y, h, t)$ is that strong coupling in the extrapolation operator requires the entire prestack data set to be handled at the same time for each depth step.

Conventional processing comprises two important steps. First, the data are organized into common-midpoint (CMP) gathers, and normal-moveout (NMO) correction is applied to each

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0653.jpg?height=702&width=427&top_left_y=125&top_left_x=305)

FIG. D-5. The response charscteristics of the DSR operator (equation D-23) (Yilmaz, 1979). (a) Real part of the $y-z$ plane at $16 \mathrm{~Hz}$ and $h=400 \mathrm{~m}$. Note the semielliptical wavefronts. (b) Real part of the $y-z$ plane at $t=1024 \mathrm{~ms}, h=400 \mathrm{~m}$. Because of the wraparound in $h$, we observe two wavefronts, one for $h=400 \mathrm{~m}$ and one for $h=0$. (c) Real part of the $y-t$ plane at $z=200,400,600$, and 800 in superimposed. These are the table-top trajectories for $h=400 \mathrm{~m}$. The loci of the arrival times are determined by a stationary-phase approximation to DSR (see Section D.2) (Clayton, 1978). Periodicity in $y$ and $t$ result from approximating Fourier integrals by sums.

gather. The time shift $\Delta t=t(h)-t_{0}$ associated with the NMO correction is given by

$$
\Delta t=t_{0}\left[\sqrt{1+\left(\frac{2 h}{v t_{0}}\right)^{2}}-1\right]
$$

where $t(h)$ is the two-way traveltime for a given (half) offset $h$, and $t_{0}$ is the corresponding twoway zero-offset time. Here, $v$ is the root-mean-square (ms) velocity at $t_{0}$. Equation (D-25) is based on the stratified earth (zero-dip) assumption. After NMO correction, traces of the CMP gather are stacked. This not only reduces data volume, but also enhances the signal-to-noise ratio.

Second, the CMP stack is migrated as if it were the zero-offset wavefield generated by exploding reflectors (Section 4.0). The equation used for the downward extrapolation portion of migration is the solution to the one-way wave equation (equation D-12).

To account for the one-way traveltime of the exploding reflectors model, the velocity used in extrapolation is taken as half the medium velocity. Thus, the vertical wavenumber given by equation (D-11) is expressed as

$$
k_{z}=\frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{y}}{2 \omega}\right)^{2}}
$$

where $v$ can be varied with depth $z$. (Since migration is done in midpoint space, $k_{x}$ has been replaced with $k_{y}$.)

Some of the current migration techniques based on wave extrapolation use certain rational approximations to equation (D-26), while some implement the exact form in the frequencywavenumber domain (Section 4.1).

Conventional processing theory has an advantage over the exact theory represented by the DSR equation in midpoint-offet space (equation D-22). Unlike the approach based on the $D S R$ equation, the conventional approach is composed of two separable operators the NMO correction and stack applied in offset space, and migration applied in mjdpoint space. However, this advantage is based on zero-dip and zero-offset assumptions.

Where do we go from here? On the one hand, we have an exact theory that can handle all dips and offset angles, but is difficult to implement. On the other hand, we have a conventional approach that has the convenient property of separation, but is based on the zero-dip and zero-offset assumptions.

To examine the relationship between the two approaches, we return to the exact theory and make the same two assumptions that underlie the conventional approach. The zero-dip assumption implies that the earth model is stratified in $y-t$ domain. The seismic energy recorded over such an earth is concentrated completely at the zero midpoint wavenumber $k_{y}=0$. This suggests that we set the normalized wavenumber $Y$ equal to zero in $D S R$ as defined by equation (D-22). The resulting operator here is defined as the stacking (St) operator

$$
S t(H)=2 \sqrt{1-H^{2}}
$$

As shown in Section D.2, the NMO shift given by equation (D-25) is a stationary-phase approximation to equation (D-27) (Clayton, 1978). The $S t(H)$ operator condenses primary information on a CMP gather down to zero offset. After applying this operator on a CMP gather, we may keep the zero-offset trace and abandon all other offsets. Since a CMP stack can be regarded as a zero-offset wavefield, equation (D-27) is a zero-dip NMO and stack-type operator.

Application of the zero-offset $(h=0)$ assumption into the $D S R$ operator is more subtle. On a CMP gather at and near $h=0$, energy essentially is concentrated at zero value of the offset wavenumber $k_{h}=0$. In fact, NMO correction tries to push the primary energy on a CMP gather toward $k_{h}=0$. Therefore, by setting the normalized offset wavenumber $H=0$ in equation (D-22), the exploding reflectors (ER) migration operator can be expressed as

$$
E R(Y)=2 \sqrt{1-Y^{2}}
$$

Equation (D-28) is an approximation, because setting $H=0$ is not exactly the same as setting $h=0$. By setting $H=0$ in equation (D-22) and using the dispersion relation given by equation (D-23), we have the zero-offset vertical wavenumber

$$
k_{z}=\frac{2 \omega}{v} \sqrt{1-Y^{2}}
$$

By substituting the definition for $Y$ from equation (D-21a) into equation (D-29), we obtain

$$
k_{z}=\frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{y}}{2 \omega}\right)^{2}}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0655.jpg?height=782&width=478&top_left_y=126&top_left_x=282)

FIG. D-6. The response characteristics of the exploding reflectors operator $E R(Y)$ (equation D-29) (Yilmaz, 1979). (a) Real part of the $y-z$ plane at $16 \mathrm{~Hz}$. Note the circular wavefronts. (b) Real part of the $y-z$ plane at $t=1024 \mathrm{~ms}$. (c) Real part of the $y-t$ plane at $z=200,400,600$, and $800 \mathrm{~m}$ superimposed. These are the hyperbolic trajectories. The loci of the arrival times are determined via the stationary-phase approximation to $E R(Y)$ (see section D.2) (Clayton, 1978). Periodicity in $y$ and $t$ result from approximating Fourier integrals by sums.

which is identical to equation (D-26), We conclude that the zero-ofset migration operator $E R(Y)$ (equation D-28) derived from the $D S R$ equation (D-22) is identical to the migration operator that is based on the exploding reflectors model of conventional processing.

Figure D-6 shows the response characteristics of the dispersion relation defined by equation (D-30). Note the semicircular wavefronts in the $y-z$ plane and the hyperbolic traveltime curves in the $y-t$ plane. Compare these with the response of the complete $D S R$ operator for the nonzero-offset case in Figure D-5. The equations for the wavefront and traveltime trajectories are derived in Section D. 2 using stationary phase approximations.

## D. 2 Stationary Phase Approximations

In this section, we shall use the method of stationary phase to derive the traveltime equation inferred by the double square root equation for nonzero-offset source-receiver separation. Consider the double square root operator defined by equation (D-22) with the wavenurnbers $Y$ and $H$ defined by equations (D-21a,b). We want to operate on the transformed wavefield $P\left(k_{y}, k_{h}, z=0, \omega\right)$ with the $D S R$ operator. Subsequent inverse Fourier transformation will yield the wavefield $P(y, h, z, t)$ :

$$
P(y, h, z, t)=\iiint P\left(k_{t}, k_{h}, z=0, \omega\right) \exp (i \Phi z) d k_{y} d k_{h} d \omega
$$

where the total phase $\Phi$, normalized with respect to $z$, is given by

$$
\Phi=-\frac{\omega}{v} D S R(Y, H)-k_{y} \frac{y}{z}-k_{h} \frac{h}{z}+\omega \frac{t}{z}
$$

The main contribution to integration in equation (D-31) occurs when the phase stays nearly constant. We therefore determine the variation of the phase with respect to variables $k_{y}, k_{h}$, and $\omega$

$$
\begin{aligned}
& \frac{\partial \Phi}{\partial k_{y}}=-\frac{\omega}{v} \frac{\partial D S R}{\partial Y} \frac{\partial Y}{\partial k_{v}}-\frac{y}{z} \\
& \frac{\partial \Phi}{\partial k_{h}}=-\frac{\omega}{v} \frac{\partial D S R}{\partial H} \frac{\partial H}{\partial k_{h}}-\frac{h}{z}
\end{aligned}
$$

and

$$
\frac{\partial \Phi}{\partial \omega}=-\frac{1}{v} D S R-\frac{\omega}{v}\left[\frac{\partial D S R}{\partial H} \frac{\partial H}{\partial \omega}+\frac{\partial D S R}{\partial Y} \frac{\partial Y}{\partial \omega}\right]+\frac{t}{z}
$$

and set each variation to zero. Substitute equation (D-32) and carry out the differentiations in equations (D-33a,b,c) to ohtain

$$
\begin{aligned}
& \frac{1}{2} \frac{G}{\sqrt{1-G^{2}}}+\frac{1}{2} \frac{S}{\sqrt{1-S^{2}}}=\frac{y}{z} \\
& \frac{1}{2} \frac{G}{\sqrt{1-G^{2}}}-\frac{1}{2} \frac{S}{\sqrt{1-S^{2}}}=\frac{h}{z}
\end{aligned}
$$

and

$$
\frac{1}{\sqrt{1-G^{2}}}+\frac{1}{\sqrt{1-S^{2}}}=\frac{v t}{z}
$$

where $G$ and $S$ are defined by equations (D-20a, b).

Now, elininate $G$ and $S$ amongst equations (D-34a,b,c) to get the final expression from stationary phase approximation to the double square root equation as

$$
\sqrt{(y+h)^{2}+z^{2}}+\sqrt{(y-h)^{2}+z^{2}}=v t .
$$

This is the equation of an ellipse in the $y-z$ plane at constant $t$ (Section E.5). Figure D-5 shows the elliptic wavefront and the table-top traveltime trajectory described by equation (D-35).

When equation (D-35) is specialized to the zero-offset case, $h=0$. we obtain

$$
\sqrt{y^{2}+z^{2}}=\frac{v t}{2}
$$

which is a circle in the $y-z$ plane at constant $t$ and a byperbola in the $y-t$ plane at constant z. Figure D-6 shows the circular wavefront and the hyperbolic traveltime trajectory described by equation (D-36).
by

We now consider the stacking operator defined by equation (D-27). The total phase is given

$$
\Phi=-\frac{\omega}{v} S t(H)-k_{h} \frac{h}{z}+\omega \frac{t}{z}
$$

Differentiate equation (D-37) with respect to $k_{h}$ and $\omega$ and set the results to zero to obtein

$$
\frac{H}{\sqrt{1-H^{2}}}=\frac{h}{z}
$$

and

$$
\frac{1}{\sqrt{1-H^{2}}}=\frac{v t}{2 z}
$$

Now, eliminate $H$ between equations (D-38a) and (D-38b) to obtain the stationary phase approximation to the stacking operator:

$$
\sqrt{h^{2}+z^{2}}=\frac{v t}{2}
$$

Definc the zero-offset time as $t_{0}=2 z / v$ and substitute into equation (D-39a) to get

$$
\sqrt{h^{2}+\left(\frac{v t_{0}}{2}\right)^{2}}=\frac{v t}{2}
$$

Finally, rearrange to get the equation for normal moveout:

$$
\Delta t_{N M O}=t_{0}\left[\sqrt{1+\left(\frac{2 h}{v t_{0}}\right)^{2}}-1\right]
$$

where $\Delta t_{N M O}=t-t_{0}$. This is the same equation as equation $(3-2 \mathrm{~b})$ in the main text with offset defined as $x=2 h$.

## D. 3 The Parabolic Approximation

Start with the dispersion relation defined by equation (D-6) recast for the exploding reflectors model for which $v$ is replaced with $v / 2$ to obtain

$$
k_{z}=\frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{x}}{2 \omega}\right)^{2}}
$$

Then apply Taylor series expansion and retain the first two terms:

$$
k_{z}=\frac{2 \omega}{v}\left[1-\frac{1}{2}\left(\frac{v k_{x}}{2 \omega}\right)^{2}\right]
$$

By simplifying, we get the dispersion relation associated with the parabolic equation

$$
k_{z}=\frac{2 \omega}{v}-\frac{v k_{x}^{2}}{4 \omega}
$$

By operating on the wavefield $P(x, z, t)$ and replacing $-i k_{z} P$ with $\partial P / \partial z$, we write the corresponding differential equation as

$$
\frac{\partial P}{\partial z}=-i\left(\frac{2 \omega}{v}-\frac{v k_{x}^{2}}{4 \omega}\right) P
$$

Derivation of equation (D-43) is bascd on the constant-velocity assumption. Nevertheless, just as we did for the 90 -degree one-way wave equation (D-10), the 15-degree onc-way wave
equation (D-43) can be recast using a vertically varying velocity function $v(z)$. Going one step further, once equation (D-43) is inverse Fourier transformed from the horizontal wavenumber $k_{x}$ to the horizontal axis $x$, we will replace $v(z)$ with a laterally varying velocity function $v(x, z)$. Theoretically, this may not be permissible, but in practice, its validity is widely accepted.

The effect of translation is removed by retardation (Figure 4.1-18):

$$
\tau=2 \int_{0}^{z} \frac{d z}{\bar{v}(z)}
$$

where $\bar{v}(z)$ generally is chosen to be a horizontal average of $v(x, z)$. The time shift defined by equation (D-44) is equivalent to a phase shift in the frequency domain. Therefore, the actual wavefield $P$ is related to the time-shifted wavefield $Q$ by

$$
P=Q \exp (-i \omega \tau)
$$

By differentiating with respect to $z$, we get

$$
\frac{\partial P}{\partial z}=\left(\frac{\partial}{\partial z}-i \frac{2 \omega}{\bar{v}(z)}\right) Q \exp (-i \omega \tau)
$$

Finally, by substituting equations (D-45) and (D-46) into equation (D-43), we obtain

$$
\frac{\partial Q}{\partial z}=i \frac{v k_{x}^{2}}{4 \omega} Q+i 2 \omega\left[\frac{1}{\bar{v}(z)}-\frac{1}{v}\right] Q
$$

The first term on the right side of this equation is called the diffraction term and the second term is called the than-lens term.

Consider the special case of $v=\bar{v}(z)$. The thin-lens term then vanishes and we are left with

$$
\frac{\partial Q}{\partial z}=i \frac{v k_{x}^{2}}{4 \omega} Q
$$

After inverse Fourier transforming, we obtain the parabolic differential equation

$$
\frac{\partial^{2} Q}{\partial z \partial t}=\frac{v}{4} \frac{\partial^{2} Q}{\partial x^{2}}
$$

where, in practice, velocity can be varied horizontally as well as vertically.

In some practical implementations of equation (D-48), downward continuation is performed in $\tau$ rather than $z$. The migrated section then is displayed in time $\tau$ and the process is called time migration. The two variables $z$ and $\tau$ are related by equation (D-44). The dispersion relation in equation (D-41) for the scalar wave equation in terms of $\omega_{\tau}=v k_{z} / 2$, the Fourier dual of $\tau$, takes the form

$$
\omega_{\tau}=\omega \sqrt{1-\left(\frac{v k_{z}}{2 \omega}\right)^{2}}
$$

By squaring both sides, we get the equation of an ellipse in the $\omega_{r}-k_{x}$ plane.

The dispersion relation in equation (D-42b) for the parabolic equation, also expressed in terms of $\omega_{r}$, takes the form

$$
\omega_{\tau}=\omega-\frac{v^{2} k_{x}^{2}}{8 \omega}
$$

which is the equation of a parabola in the $\omega_{\tau}-k_{x_{1}}$ plane. The first term is associated with a vertical time shift that can be removed by retardation. To obtain the differential equation in terns of $\tau$, equivalent to equation (D-48), apply the second term on the right side of equation (D-49b) to the retarded waveficld $Q$ as defined by equation (D-45) and inverse Fourier transform

$$
\frac{\partial^{2} Q}{\partial \tau \partial t}=\frac{v^{2}}{8} \frac{\partial^{2} Q}{\partial x^{2}}
$$

This equation is the basis for the 15-degree time migration algorithms.

The dispersion relations given by equations (D-49a) and (D-49b) are plotted in Figure D-7 for constant velocity $v$ and input frequency $\omega=F E$. Curve 1 is associated with the 90-degree scalar wave equation and is the same as shown in Fignre 4.1-25, except that the latter is in terms of $k_{z}$. Point $A$ is mapped onto point $B$ after migration with the 90-degree equation (D-49a). The same point $A$ is mapped onto point $C$ after migration with the 15 -degree equation (D-49b). The dispersion curve 2 for the parabolic equation increasingly departs from the dispersion curve 1 for the exact wave equation as the dip gets steeper. (The dip before migration is measured as the angle between the vertical axis $\mathrm{FE}$ and radial direction $F A$.) Thus, the parabolic equation causes more and more undermigration as dip increases.

## D. 4 Frequency-Space Implicit Schernes

Higher-order approximations to the dispersion relation (equation D-41) of the one-way equation can be found by continued fraction expansion (Claerbout, 1985). When equation (D-41) is rewritten, we have

$$
k_{z}=\frac{2 \omega}{v} R
$$

where

$$
R=\sqrt{1-X^{2}}
$$

with

$$
X=\frac{v k_{z}}{2 \omega}
$$

The various orders of approximations to equation (D-51b) are defined by the following recurrence relation

$$
R_{n+1}=1-\frac{X^{2}}{1+R_{n}}
$$

with the initial value $R_{0}=1$. By setting $n=0$ in cquation (D-52), we have

$$
R_{k}=1-\frac{X^{2}}{2} .
$$

Then, substitution of equation (D-53) into equation (D-51a) yields

$$
k_{z}=\frac{2 \omega}{v}\left(1-\frac{X^{2}}{2}\right)
$$

which is the same equation obtained with the parabolic approximation, equation (D-42 $u$ ).

The next higher-order expansion is obtained by setting $n=1$ in equation (D-52) and using equation (D-53) to obtain

$$
R_{2}=1-\frac{X^{2}}{2-\frac{X^{2}}{2}}
$$

This is referred to as the 45-degrce approximation to equation (D-41).

Ma (1981) discovered that the recurrence relation for the continuous fraction expansion can be expressed as ratios of two polynomials for the even-ordered expansions. He also showed that the expression can be split into the following partial fractions:

$$
R_{2 n}=1-\sum_{i=1}^{n} \frac{\alpha_{i} X^{2}}{1-\beta_{1} X^{2}}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0660.jpg?height=320&width=493&top_left_y=124&top_left_x=272)

FIG. D-7. Dispersion relations for the 90-degree equation (D-49a), 15-degree equation (D-49b) and the 45-degree equation (D-60a) with $\alpha_{1}=0.5$ and $\beta_{1}=0.25$, plotted on the $\omega_{\tau}-k_{x}$ plane for a given input frequency, where $\omega=F E$ and velocity is $v$. Input frequency $\omega=F E=A P$ is mapped on to output frequency $\omega_{\tau}$ which is $\mathrm{PB}, \mathrm{PC}$, and $\mathrm{PD}$ for the 90-degree, 15-degree, and 45-degree equations, respectively. The wavenumber at the intersection of the curves along the $k_{x}$ exis is $2 \omega / v, 2 \sqrt{2} \omega / v$, and $(4 \omega) /(\sqrt{3} v)$ for the 90-degree, 15-degree, and 45-degree equations, respectively.

For exanple, when $n=1$,

$$
R_{2}=1-\frac{\alpha_{1} X^{2}}{1-\beta_{1} X^{2}}
$$

which is equivalent to the 45-degree expansion in equation (D-55) when $\alpha_{1}=0.5$ and $\beta_{1}=0.25$. Note that expansions $R_{4}, R_{6}, R_{8}, \cdots$ are made up of surns of the 45 -degree term, each with a different set of coefficients, $\alpha_{4}$ and $\beta_{4}$. Lee and Suh (1985) minimized the difference in the least-squares sense between $R$ of equation (D-51a) and $R_{2 n}$ of equation (D-56) for a specified dip angle and derived optimal coefficients $\left(\alpha_{1}, \beta_{2}\right)$ for up to the 10th order (Table D-1).

Table D-1. Coefficients of optimized, fractioned, one-way wave equations (Lee and Suh, 1985).

| Order, $2 n$ | Accuracy Deg. | $\alpha_{i}$ | $\beta_{4}$ |
| :--- | :---: | ---: | ---: |
| 2 | 45 | 0.5 | 0.25 |
| 2 | 65 | 0.478242060 | 0.376369527 |
| 4 | 80 | 0.040315157 | 0.873981642 |
| 6 | 87 | 0.457289566 | $\mathbf{0 . 2 2 2 6 9 1 9 8 3}$ |
|  |  | 0.004210420 | 0.972926132 |
| 8 | $90-$ | 0.081312882 | 0.744418059 |
|  |  | 0.414236605 | 0.150843924 |
|  |  | 0.000523275 | 0.994065088 |
|  |  | 0.014853510 | 0.919432661 |
|  | 90 | 0.117592008 | 0.614520676 |
|  |  | 0.367013245 | 0.105756624 |
|  |  | 0.000153427 | 0.997370236 |
|  |  | 0.004172967 | 0.964827992 |
|  |  | 0.033860918 | 0.824918565 |
|  |  | 0.143798076 | 0.483340757 |

We now derive the differential equation associated with the 45-degree dispersion relation. By substituting equation (D-57) and the definition for $X$ given by equation (51c) into equation (D-51a), we obtain

$$
k_{z}=\frac{2 \omega}{v}\left[1-\frac{\alpha x_{1} v^{2} k_{x}^{2}}{4 \omega^{2}} \frac{1}{1-\frac{\beta_{1} v^{2} k_{x}^{2}}{4 \omega^{2}}}\right]
$$

The first term is a vertical shift that can be removed by retardation in the same manner as for the 15-degree approximation (equations D-42 through D-46). By simplifying the remaining terms of equation (D-58), we obtain

$$
\frac{\beta_{1}}{\alpha_{1}} \frac{v}{2 \omega} k_{z} k_{x}^{2}-k_{x}^{2}-\frac{1}{\alpha_{1}} \frac{2 \omega}{v} k_{z}=0
$$

Finally, by operating on the retarded wavefield $Q(x, \omega, z)$ (equation D-45), we obtain

$$
i \frac{\beta_{1} v}{2 \alpha_{1} \omega} \frac{\partial^{3} Q}{\partial z \partial x^{2}}-\frac{\partial^{2} Q}{\partial x^{2}}+\imath \frac{2 \omega}{\alpha_{1} v} \frac{\partial Q}{\partial z}=0
$$

Kjartansson (1979) implemented equation (D-59b) for 45-degree modeling and migration in the frequency-space domain. Migration in the frequency-space domain (commonly known as the $\omega-x$ algorithm) involves two interleaved operations:

(a) a time shift based on equation (D-45), which is velocity-independent for time migration and velocity-dependent for depth migration, and

(b) focusing the diffraction energy using equation (D-59b).

Once you have a code for the basic 45-degree operator, it is easy to implement the higherorder approximations that are given by equation (D-56) with the associated coefficients in Table D-1. Note that the difference between the $\mathbf{4 5}$-degree and 65 -degree algorithms is the values used for coefficients $\left(\alpha_{1}, \beta_{1}\right)$. Also note that the 15-degree equation (D-47b) is obtained from equation (D-59b) by setting $\alpha_{1}=0.5$ and $\beta_{1}=0$.

The dispersion relation in equation (D-58) also can be expressed in terms of $\omega_{\tau}=v k_{z} / 2$, the Fourier dual of the time variable $\tau$ associated with the migrated data:

$$
\omega_{r}=\omega-\frac{\alpha_{1} \omega v^{2} k_{x}^{2}}{4 \omega^{2}-\beta_{1} v^{2} k_{x}^{2}}
$$

The first term is associated with a vertical time shift that can be removed by retardation as for the 15-degree equation (D-49b).

To obtais the differential equation in terms of $\tau$, equivalent to equation (D-59b), apply the second term on the right side of equation (D-60a) to the retarded wavefield $Q$ as defined by equation (D-45) and inverse Fourier transform:

$$
i \frac{\beta_{1}}{\alpha_{1} \omega} \frac{\partial^{3} Q}{\partial \tau \partial x^{2}}-\frac{\partial^{2} Q}{\partial x^{2}}+i \frac{4 \omega}{\alpha_{1} v^{2}} \frac{\partial Q}{\partial \tau}=0
$$

This equation is the basis for the 45 -degree and related steep-dip implicit finite-difference frequency-space time rigration algorithms.

The dispersion relation given by equation (D-60a) for the 45-degree equation, in which $\alpha_{1}=0.5$ and $\beta_{1}=0.25$, is plotted in Figure D-7 for constant velocity $v$ and input frequency $\omega=F E$. Point $A$ is mapped onto point $D$ after migration with the 45 -degree equation (D-60a). The dispersion curve 3 for the 45 -degree equation lies somewhere between those of the 90-degree equation (D-49a) (curve 1) and the 15-degree equation (D-49b) (curve 2).

Figure 4.4-1 shows the impulse responses of various approximations to the one-way dispersion relation based on equation (D-56). Note that the wavefronts become increasingly closer to a sernicircle as the higher-order terms are included in equation (D-56). The 15-degree approximation yields an elliptical wavefront. The 45-degree approximation yields an impulse response
of a heart shape. Refer to Section 4.4 for the practical aspects of 2-D frequency-space steep-dip time migration, and Section 7.3 for its application to $3-$ D migration.

## D. 5 Stable Explicit Extrapolation

The exact extrapolation filter for a specific frequency $\omega$ and velocity $v$ is expressed in the frequency-wavenumber domain as

$$
D\left(k_{x}\right)=\exp \left\{-i \frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{x}}{2 \omega}\right)^{2}} \Delta z\right\}
$$

The objective is to find, again for a specific frequency $\omega$ and velocity $v$, an explicit filter with complex coefficients $h(x)$ in the frequency-space domain such that, when Fourier transformed to the frequency-wavenumber domain, the difference between the actual transform $H\left(k_{x}\right)$ and the desired transform $D\left(k_{x}\right)$ of equation (D-61) is minimum. To ensure stability, we impose the constraint that the arnplitude of $H\left(k_{x}\right)$ is never greater than unity within the propagation region $k_{z} \leq(2 \omega / v)$.

Consider the Fourier transform $H\left(k_{x}\right)$ of the actual extrapolation filter $h(x)$, which we will write in discrete form as $h_{n}$ :

$$
H\left(k_{x}\right)=h_{0}+2 \sum_{n=1}^{N} h_{n} \cos \left(n k_{x}\right)
$$

where $2 N+1$ is the length of the symmetric filter $h_{n}$.

To determine the filter coefficients $h_{n}$, perform Taylor series expansion of the exact $D\left(k_{x}\right)$ and the actual $H\left(k_{z}\right)$ extrapolators given by equations (D-61) and (D-62), respectively, and match the coefficients of the terms in each series at $k_{x}=0$ (Holberg, 1988). Such a direct match of the coefficients in the Taylor series results in a response $H\left(k_{x}\right)$ whose amplitude is greater than unity beyond a certain $k_{x}$, thus violating the stability constraint that the amplitude of $H\left(k_{x}\right)$ is never greater than unity within the propagation region $k_{x} \leq(2 \omega / v)$.

A way to circumvent the unstable response of the conventional Taylor series method is to match the first $M<N$ coefficients in the series expansion and set the remaining $N-M$ to zero (Hale, 1991). This modified Taylor series method proceeds as follows.

Let the filter coefficients $h_{n}$ be defined by the series

$$
h_{n}=c_{0}+2 \sum_{m=1}^{M} c_{m} b_{m+n}
$$

where

$$
b_{m n}=2 \cos \left(\frac{2 \pi m n}{N}\right)
$$

By way of equations (D-63) and (D-64), equation (D-62) takes the form

$$
\begin{aligned}
H\left(k_{x}\right) & =c_{0}\left[1+2 \sum_{n} \cos \left(n k_{x}\right)\right] \\
& +2 \sum_{m} c_{m}\left[1+2 \sum_{n} \cos \left(\frac{2 \pi m n}{N}\right) \cos \left(n k_{x}\right)\right]
\end{aligned}
$$

Equation (D-65) can be written as a single summation

$$
H\left(k_{x}\right)=\sum_{m=0}^{M} c_{m} B_{m}\left(k_{x}\right)
$$

where

$$
B_{0}\left(k_{x}\right)=1+2 \sum_{n} \cos \left(n k_{x}\right)
$$

and

$$
B_{m}\left(k_{x}\right)=1+2 \sum_{n} \cos \left(\frac{2 \pi m n}{N}\right) \cos \left(n k_{x}\right)
$$

61):

Now, perform the Taylor series expansion of the exact extrapolator given by equation (D-

$$
D\left(k_{x}\right)=D(0)+k_{x} \frac{\partial D\left(k_{x}\right)}{\partial k_{x}}+\frac{k_{x}^{2}}{2} \frac{\partial^{2} D\left(k_{x}\right)}{\partial k_{x}^{2}}+\cdots
$$

where the derivatives are evaluated at $k_{x}=0$, and thus the terms associated with the odd derivatives vanish.

Matching the terms of the actual extrapolator $H\left(k_{x}\right)$ with those of the desired extrapolator $D\left(k_{x}\right)$ is equivalent to matching their even derivatives

$$
\sum_{m=0}^{M} c_{m} B_{m}^{2 j}(0)=D^{2 j}(0), j=0,1,2, \ldots, M
$$

where the derivative terms $B_{m}^{2 j}$ are

$$
B_{0}^{2 J}(0)=(-1)^{3}\left[1+2 \sum_{n=1} n^{23}\right]
$$

and

$$
B_{m}^{2 \eta}(0)=2(-1)^{2}\left[1+2 \sum_{n=1} \cos \left(\frac{2 \pi m n}{N}\right) n^{2}\right]
$$

Equation (D-69) represents a system of $M$ linear equations that can be solved for the coefficients $c_{m}$. The extrapolation filter coefficients $h_{n}$ then can be computed by substituting the solution of equation (D-69) into equation (D-63).

The modified Taylor expansion yields filter coeffcients $h_{n}$ with its response $\boldsymbol{H}\left(k_{x}\right)$ that vanishes beyond a cutoff value for $k_{x}$ in the wavenumber domain that depends on the scalar $M$. Also, the response of the extrapolator based on the modified Taylor expansion satisfies the stability constraint $H\left(k_{x}\right)<1$ in the passband region of the filter. The cutoff wavenumber $k_{x}$ determines the maximum dip accuracy of the extrapolation filter. The larger the number of filter coefficients $2 N+1$, the steeper the dip accuracy. In practice, extrapolation filter lengths 7, 11 and 25 are often associated with 30-, 50- and 70-degree dip accuracies.

An alternative method for computing the filter coefficients $h_{n}$ with more accuracy at large wavenumbers $k_{x}$ is based on the Remez exchange algorithm (Soubaras, 1996). The objective is to minimize the error function

$$
E\left(k_{x}\right)=W\left(k_{x}\right)\left[D\left(k_{x}\right)-H\left(k_{x}\right)\right],
$$

where $W\left(k_{x}\right)$ is a weighting function, such that

$$
\|E\|_{\infty}=\max \left|E\left(k_{x}\right)\right|
$$

is minimum. The criterion $\|E\|_{\infty}$ means that the actual response $H\left(k_{x}\right)$ is equiripple. Specifically, the response $H\left(k_{x}\right)$ has extrema of the sane absolute value with alternating signs within the passband region specified by a cutoff wavenumber $k_{x}$. The objective of the error function is to minimize the deviation of the extrema from the desired value of unity.

## D. 6 Optimum Depth Step

The objective is to specify an optimum depth step size that yields minimum-phase errors in wave extrapolation as part of the design of finite-difference migration algorithms. First, we shall review implicit and explicit schemes. Then, we shall derive equations for optimum depth size for frequency-wavenumber implicit schemes.

Start with the one-way wave equation (D-5):

$$
\frac{\partial}{\partial z} P\left(k_{x}, z, \omega\right)=-\imath k_{z} P\left(k_{x}, z=0, \omega\right)
$$

whose solution is

$$
P(z+\Delta z)=P(z) \exp \left(-\imath k_{z} \Delta z\right)
$$

where, for simplicity, $k_{x}$ and $\omega$ variables are omitted from $P_{\text {, and }}$

$$
k_{x}=\frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{x}}{2 \omega}\right)^{2}}
$$

The phase of the exact extrapolation operator

$$
\exp \left(-\imath k_{z} \Delta z\right)
$$

is

$$
\Phi=k_{z} \Delta z
$$

and its amplitude is

$$
A=1 \text {. }
$$

Discretize the one-way wave equation (D-73):

$$
\frac{\delta P}{\delta z}=-\imath k_{z} P
$$

Apply differencing approximation using the explicit scheme

$$
\frac{P(z+\Delta z)-P(z)}{\Delta z}=-i k_{z} P(z)
$$

and the implicit scheme

$$
\frac{P(z+\Delta z)-P(z)}{\Delta z}=-i k_{z} \frac{P(z+\Delta z)-P(z)}{2} .
$$

Rewrite the explicit equation (D-78a) as

$$
P(z+\Delta z)=P(z)\left(1-i k_{z} \Delta z\right)
$$

The phase of the explicit extrapolation operator

$$
\left(1-i k_{z} \Delta z\right)
$$

is

$$
\widehat{\Phi}=\tan ^{-1}\left(k_{z} \Delta z\right)
$$

and its amplitude is

$$
\hat{A}=\sqrt{1+\left(k_{z} \Delta z\right)^{2}}
$$

Note that the amplitude of the explicit operator is greater than unity and grows from one extrapolation step to the next. In fact, large depth steps cause the operator to yield unstable results early in the extrapolation process. In general, explicit schemes tend to be unstable unless special design considerations are made (Section D.5).

Rewrite the implicit equation (D-78b) as

$$
P(z+\Delta z)=P(z)\left[\frac{1-i k_{z} \Delta z / 2}{1+\imath k_{z} \Delta z / 2}\right]
$$

The phase of the implicit extrapolation operator

$$
\frac{1-i k_{z} \Delta z / 2}{1+i k_{z} \Delta z / 2}
$$

is

$$
\widehat{\Phi}=\tan ^{-1}\left[\frac{k_{z} \Delta z}{1-\left(k_{z} \Delta z / 2\right)^{2}}\right]
$$

and its amplitude is

$$
\hat{A}=1
$$

Note that the amplitude of the implicit scheme is unity. This means that implicit schemes are unconditionally stable.

We now specialize the phase of the frequency-space implicit scheme given by equation (D80b) for the 65-degree dispersion relation as in equation (D-58) and obtain

$$
\widehat{\Phi}=\tan ^{-1}\left[\frac{\hat{k}_{z} \Delta z}{1-\left(\hat{k}_{z} \Delta z / 2\right)^{2}}\right]
$$

where

$$
\hat{k}_{z}=\frac{\alpha \hat{k}_{x}^{2}}{\frac{2 \omega}{v}-\beta \frac{v}{2 \omega} \hat{k}_{x}^{2}}
$$

with $\alpha$ and $\beta$ specified as in Table D-1 for the 65-degree scheme. Equation (D-81a) is the timeretarded form of equation (D-58) and hence corresponds to the second term of the latter. The discrete forms of the transform variables are (Claerbout, 1976):

$$
\hat{k}_{x}^{2}=\frac{4}{\Delta x^{2}} \frac{\sin ^{2}\left(\frac{\omega}{v} \Delta x \sin \theta\right)}{1-4 b \sin ^{2}\left(\frac{\omega}{v} \Delta x \sin \theta\right)}
$$

and

$$
\hat{\omega}=\frac{2}{\Delta t} \tan \left(\frac{\omega \Delta t}{2}\right)
$$

The scalar $b$ in equation (D-81c) is set to a value between $1 / 12$ and $1 / 6$. The phase error for the 65 -degree implicit scheme then is given by

$$
\Delta \stackrel{\Phi}{ }=\stackrel{\rightharpoonup}{\Phi}-\Phi
$$

where $\Phi$ and $\Phi$ are given by equations (D-81a) and (D-76a), respectively. Refer to the equations (D-81a,b,c,d) and note that the phase error depends on $\Delta x, \Delta t, v, \theta, \omega$, and the depth step $\Delta z$.

Figure D-8 shows contour plots of the phase error defined by equation (D-82) for three $\omega / v$ yalues as a function of dip angle and depth step size. Note the complicated behavior of the contours which indicates that the optimum depth step size is associated with a complicated interdependence of the various parameters - dip, frequency, velocity, spatial, and temporal sampling rates. Therefore, in practice, migration algoirthms that require wave extrapolation at discrete depth steps usually do not incorporate an automated estimation of optimum depth steps. Instead, a constant value between one-half and one dominant period, 20 to $40 \mathrm{~ms}$, depending on maximum reflector dip is specified in practice. See Section 4.4 for the practical aspects of frequency-space migration.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0666.jpg?height=976&width=416&top_left_y=124&top_left_x=306)

FIG. D-8. Phase error contours in degrees associated with the 65-degree implicit extrapolator (see Section D.6) for a range of dip angles $\theta$ versus depth step sizes $\Delta z$, and for specific ratios of $\omega / v$, from top to botton, 0.001 (low frequency or high velocity), 0.06 (medium frequency and velocity) and 0.2 (high frequency or low velocity). The parameter $b$ in equation (D-81c) was set to 0.14 for all three cases. (Computation by Dave Nichols.)

## D. 7 Frequency-Wavenumber Migration

We start with the solution of the scalar wave equation for the zero-offset wavefield as given by equation (D-7) and assume a horizontally layered earth model associated with a vertically varying velocity function $v(z)$. By inverse Fourier transforming equation (D-7), we have

$$
P(x, z, t)=\iint P\left(k_{x}, 0, \omega\right) \exp \left(-i k_{z} z\right) \exp \left(-i k_{x} x+i \omega t\right) d k_{x} d \omega
$$

where $k_{z}$ is defined by equation (D-6) adapted to the exploding reflectors model by replacing $v$ with $v / 2$ :

$$
k_{z}=\frac{2 \omega}{v} \sqrt{1-\left(\frac{v k_{z}}{2 \omega}\right)^{2}}
$$

The inaging principle $t=0$ then is applied to get the migrated section $P(x, z, t=0)$,

$$
P(x, z, t=0)=\iint P\left(k_{x}, 0, \omega\right) \exp \left(-i k_{x} x-i k_{z} z\right) d k_{x} d \omega
$$

This is the equation for the phase-shift method (Gazdag, 1978). Equation (D-84) involves integration over frequency and inverse Fourier transformation along midpoint axis $x$. Refer to Figure 4.1-29 for a flow diagram of phase-shift migration.

We now consider the special case of constant velocity $v$. Stolt (1978) devised a migration technique that involves an efficient mapping in the 2-D Fourier transform domain from temporal frequency $\omega$ to vertical wavenumber $k_{z}$. We rewrite equation (D-83b) to get

$$
\omega=\frac{v}{2} \sqrt{k_{x}^{2}+k_{z}^{2}}
$$

By keeping the horizontal wavenumber $k_{x}$ unchanged and differentiating, we obtain

$$
d \omega=\frac{v}{2} \frac{k_{z}}{\sqrt{k_{x}^{2}+k_{z}^{2}}} d k_{z}
$$

When equations (D-85) and (D-86) are substituted into equation (D-84), we get

$$
P(x, z, t=0)=\iint\left[\frac{v}{2} \frac{k_{z}}{\sqrt{k_{x}^{2}+k_{z}^{2}}}\right] P\left[k_{x}, 0, \frac{v}{2} \sqrt{k_{x}^{2}+k_{z}^{2}}\right] \exp \left(-i k_{x} x-i k_{z} z\right) d k_{x} d k_{z} .
$$

This is the equation for constant-velocity Stolt migration. It involves two operations in the $f-k$ domain. First, the temporal frequency $\omega$ is mapped onto the vertical wavenumber $k_{z}$ via equation (D-85). This is the same as mapping point $B^{\prime}$ onto point $B$ in Figure 4.1-25. Second, the amplitudes are scaled by the quantity

$$
S=\frac{v}{2} \frac{k_{z}}{\sqrt{k_{z}^{2}+\bar{k}_{z}^{2}}}
$$

which is equivalent to the obliquity factor associated with Kirchhoff migration (Section 4.1). Refer to Figure 4.1-30 for a flow djagram of constant-velocity Stolt migration.

To extend the algorithm to the variable-velocity case, yet retain efficiency, Stolt (1978) did a coordinate transformation that involves stretching the time axis to make the scalar wave equation velocity independent. A summary of the theoretical procedure is given here. Consider wavefield $P(x, z, t)$ and the transformed wavefield $P(x, d, T)$ :

$$
P(x, z, t)=P(x, d, T)
$$

where $T$ is the stretched time axis and $d$ is the output variable (equivalent of $z$ ) for migration in the stretched coordinate system. Here, the $x$ variable is identical in both coordinate systems.

This coordinate transformation basically is equivalent to stretching the data using the rms velocities

$$
T(t)=\frac{1}{\mathrm{c}}\left[2 \int_{0}^{t} d t^{\prime} v_{r m s}^{2}\left(t^{\prime}\right) t^{\prime}\right]^{1 / 2}
$$

where

$$
v_{r m s}^{2}(t)=\frac{1}{t} \int_{0}^{t} v^{2}\left(t^{\prime}\right) d t^{\prime}
$$

and $c$ is an arbitrary reference velocity used to maintain the vertical axis as time after the coordinate transformation from $t$ to $T$. After some tedious algebra, the time-retarded scalar wave equation takes the following form in the stretched coordinates (Stolt, 1978):

$$
\frac{\partial^{2} P}{\partial x^{2}}+W \frac{\partial^{2} P}{\partial d^{2}}+\frac{2}{c} \frac{\partial^{2} P}{\partial d \partial T}
$$

where $W$ is a complicated function of velocity and coordinate variables. In practice, it normally is set to a constant between 0 and 1 . The procedure for Stolt migration with stretch follows:

(a) Start with the stacked section, which is assumed to be a zoro-offset section $P(x, z=0, t)$.

(b) Convert this time section to stretched section $P(x, d=0, T)$ by the coordinate transformation (equation D-88).

(c) 2-D Fonrier transform the stretched section $P\left(k_{x}, d=0, \omega_{T}\right)$.

(d) Apply the following mapping function to perform migration:

$$
k_{d}=\left(1-\frac{1}{W}\right) \frac{\omega_{T}}{c}-\frac{1}{W} \sqrt{\frac{\omega_{T}^{2}}{c^{2}}-W k_{x}^{2}}
$$

This equation is based on the dispersion relation of the retarded wave equation in the stretched coordinates (equation D-90). The expression for the output from migration is (omitting the heavy algebra)

$$
P\left(k_{x}, k_{d}, 0\right)=\left[\frac{c}{2-W}\left(1-W+\frac{1}{K}\right)\right] P\left\{k_{x}, 0,\left[\frac{c k_{d}}{2-W}(1-W+K)\right\}, \quad(D-92 a)\right.
$$

where

$$
K=\frac{1}{\sqrt{1+(2-W) \frac{k_{x}^{2}}{k_{d}^{2}}}}
$$

(e) 2-D inverse Fourier transform the migrated section in the stretched coordinates $P(x, d, T=$ $0)$.

(f) Convert back to the familiar space-time coordinates $P(x, z, t=0)$. This is the final nigrated section.

To derive the equations for Stolt migration with the output in time $\tau=2 z / v$, use the dispersion relation as in equation (D-49a) in lieu of equation (D-83b) and replace the vertical wavenumber $k_{x}$ with the output frequency $\omega_{\tau}=v k_{z} / 2$ in equations (D-84) through (D-88).

When $W=1$, equation (D-91) takes the simple form

$$
k_{d}=\sqrt{\frac{\omega_{T}^{2}}{\mathrm{c}^{2}}-k_{x}^{2}}
$$

which makes mapping of equation (D-91) equivalent to the constant-velocity Stolt algorithm.

Note that Stolt migration with stretch tries to handle velocity variations. However, it is no substitute for depth migration; it only accommodates velocity variations that can be bandled by time migration. Figure D-9 shows the flow diagram for Stolt migration with stretch. See Section 4.5 for the practical aspects of frequency-wavenumber migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0669.jpg?height=482&width=261&top_left_y=124&top_left_x=388)

FIG. D-9. Flowchart for Stolt migration with stretch.

## D. 8 Residual Migration

The relationship between the output and input temporal frequencies for a 90 -degree time migration operator (rewritten from equation D-49a) is given by

$$
\omega_{\tau}=\sqrt{\omega^{2}-\frac{v^{2} k_{x}^{2}}{4}}
$$

where $\omega_{T}=v k_{z} / 2$ is the output frequency, $\omega$ is the input frequency $\boldsymbol{v}$ is the true medium velocity, and $k_{z}$ is the midpoint wavenumber. Equation (D-94) refers to single-pass migration if the migration velocity is the same as the medium velocity.

Consider a two-pass migration, first with velocity $v_{1}$, followed by a second migration with velocity $v_{2}$. The output frequency from the first pass is

$$
\omega_{1}=\sqrt{\omega^{2}-\frac{v_{1}^{2} k_{x}^{2}}{4}}
$$

which is the input frequency for the second pass

$$
\omega_{2}=\sqrt{\omega_{1}^{2}-\frac{v_{2}^{2} k_{x}^{2}}{4}}
$$

The horizontal wavenumber $k_{x}$ is fixed, since it is invariant under migration.

If the output frequency from the single-pass migration given by equation (D 94 ) is set equal to that from the two-pass migration given by equation (D-95b), then the necessary relationship between the residual migration velocity $v_{2}$ and the medium velocity $v$ can be established as

$$
v^{2}=v_{1}^{2}+v_{2}^{2}
$$

One practical scheme for residual migration is implemented as follows:

(a) The constant-velocity Stolt migration with a stretch factor of $W=1$ is used for the first pass. Velocity $v_{1}$ in equation (D-96a) is chosen as the minimum value in the actual velocity field.

(b) For the second pass, a dip-limited finite-difference migration can be used. The first-pass migration brings the dips down to within the range that the second-pass finite-difference migration can accommodate, accurately. Remember that the velocity field for the second pass is computed by the the relation

$$
v_{2}=\sqrt{v^{2}-v_{1}^{2}}
$$

where $v, v_{1}$, and $v_{2}$ are the original, first- and second-pass migration velocities, respectively. A multiple-pass application of residual migration is referred to as cascaded migration. Refer to Sections 4.3 and 4.5 for the practical aspects of cascaded migration and residual migration, respectively.

## REFERENCES

Baysal, E., Kosloff, D., and Sherwood, J.W.C., 1983, Reverse time migration: Geophysics, 48, 1514-1524.

Beasley, C., Lynn, W. S., Larner, K. L. and Nguyen, H. V., 1992, Extended Stolt $f-k$ migration: 62nd Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 551-553.

Beaslcy, C. and Lynn, W. S., 1992, The zero-velocity layer: migration from irregular surfeces: Geophysics, 57, 1435-1443.

Berkhout, A.J., 1980, Seismic migration - Imaging of acoustic energy by wavefield extrapolation: Elsevier Science Pub. Co., Inc.

Berryhll, J.R., 1979, Wave-equation datuming: Geophysics, 44, 1329-1333.

Chun, J.H. and Jacewitz, C., 1981, Fundamentals of frequency-doman migration: Geophysics, 46, 717-732.

Clacrbout, J.F., 1976, Fundamentals of geophysical data processing. MoGraw-Hill Book Co.

Clacrbout, J.F., 1985, Imaging the earth's interior: Blackwell Scientific Publications.

Claerbout, J.F. and Doherty, S.M., 1972, Downward continuation of moveout-corrected seismograms: Geophysics, 37, 741-768.

Clayton, R., 1978, Common midpoint migration: Stanford Expl. Proj., Rep. No. 14, Stanford University.

Clayton, R. and Engquist, B., 1980, Absorbing side boundary conditions for wave-equation migration: Geophysics, 45, 895-904.

Deregowski, S. and Rocca, F., 1981, Geometrical optics and wave theory for constant-offet sections in layered media: Geophys. Prosp., 29, 374-387.

Diet, J.P. and Lally, P., 1984, Choice of scheme and parameters for optimal finite-differenco migration in 2-D: 54th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 454-456.

Doherty, S.M. and Claerbout, J.F., 1974, Velocity analysis based on the wave equation: Stanford Expl. Proj, Rep. No. 1, Stanford University.

Gazdag, J., 1978, Wave-equation migration by phase shift: Geophysics, 43, 1342-1351.

Gazdag, J. and Squazzero, P., 1984, Migration of seismic data by phaşe shift plus interpolation: Geophysics, 49, 124-131.

Hale, I. D., 1991, Stable explicit depth extrapolation of sersme wavefields: Geophysics, 56, 17701777 .

Holberg, O., 1988, Towards optimum one-way wave propagation: Geophys. Prosp., 36, 99-114.

Kjartanson, E., 1979, Modeling and migretion by the monochromatic 45-degree cquation: Stanford Exploration Project Report, No. 15, Stanford University.

Kjartansson, E. and Rocca, F., 1979, The exploding reflector model and laterally variable media: Stanford Exploration Project Repart. No. 16, Stanford University.

Latner, K. L. and Beasley, C., 1990, Cascaded migrations: improving the accuracy of finitedifference migration: Geophysics, 52, 618-643.

Lee, M W. and Suh, S.H., 1985, Optimization of one-way wave equations: Geophysics, 50, 16341637.

Loewenthal, D., Lu, L., Roberson, R., and Sherwood, J W.C., 1976, The wave equation applied to migration: Geophys. Prosp., 24, 380-399.

Ma, Z., 1981, Finite-difference migration with higher-order approximation: Presented at the 1981 Joint Mtg. Chinese Geophys. Soc. and Soc. Explor. Geophys.

Reshef, M., 1991, Migration from icregular topography: Geophysics, 50, 1333-1335.

Rothmas, D., Levin, S., and Rocca, F., 1985, Residual meration: Applications and limitations: Geophysics, 50, 110-126.

Schneider, W., 1978, Integral formulation for migration in two and three dimensions: Gcophysics, $43,49-76$.

Soubaras, R., 1992, Explicit 3-D migration using equiripple polynomial expansion and Laplacian synthesis: 62nd Ann. Internat. Mtg., Soc. Expl. Geophys., Expandod Abstracts, 905-908.

Soubaras, R., 1996, Explicit 3-D migration using equiripple polynomial expansion and Laplacian synthesis: Geophysics, 61, 1386-1393.

Stolt, R.H., 1978, Migration by Fourier transform: Geophysics, 43, 23-48.

Stolt, R.H. and Benson, A K,, 1986, Seismic migration: theory and practice: Geophysical Press.

Taner, M.T., Cook, E.E., Neidell, N.S., 1982, Paleo-seismic and color acoustic impedance sections: applications of downward continustion in structural and stratigraphic conbext; 52 nd Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 110-111.

Taner, M.T. and Koehlor, F, 1977, Wave-equation migration: Technical brochure, Sescom-Delta, Inc.

Yilmaz, O., 1979, Presteck partial migration: Ph.D. thesis, Stanford University.

# 5 Dip-Moveout Correction and Prestack Migration 

\begin{abstract}
- Introduction $\cdot$ Sait-Flank Reflections $\cdot$ Fault-Planc Reflections $\cdot$ DMO and Stacking Velocities $\cdot$ Turning-Wave Reflections - Principles of Dip-Moveout Correction - Prestack Partial Migration - Frequency-Wavenumber DMO Correction - Log-Stretch DMO Correction $\cdot$ Integral DMO Correction $\cdot$ Velocity Errors - Variable Velocity - Turning-Wave Migration - Dip-Moveout Correction in Practice - Salt Flanks - Fault Planes - DMO and Multiples $\cdot$ DMO and Coherent Linear Noise $\cdot$ Other Considerations $\cdot$ Aspects of DMO Correction - A Summary - Prestack Time Migration - DMO Correction and Common-Offset Migration - Salt Flanks - Fault Planes Common-Reflection-Point versus Common-Reflection-Surface Stacking - Migration Velocity Analysis - Prestack Stolt Migration - Common-Ofset Migration of DMO-Corrected Data - Prestack Kirchhoff Migration - Velocity Analysis Using Common-Reflection-Point Gathers - Focusing Analysis - Fowler's Velocity-Independent Prestack Migration $\cdot$ Exercises $\cdot$ Appendix E: Topics in Dip-Moveout Correction and Prestack Time Migration - Reflection Point Dispersal $\bullet$ Equations for DMO Correction $\bullet$ Log-Stretch DMO Correction - The DMO Ellipse Nonzero-Offset Traveltime Equation $\bullet$ Prestack Frequency-Wavenumber Migration $\bullet$ Velocity Analysis by Wavefield Extrapolation $\bullet$ References
\end{abstract}

### 5.0 INTRODUCTION

Dip-moveout (DMO) correction is applied to normalmoveout corrected prestack data to preserve conflicting dips with different stacking velocities during stacking. As a result, DMO correction yields an improved stacked section that is a closer representation of a zero-offset section compared to conventional CMP stack based on normal-moveout correction, only. This then enables us to apply the theory of zero-offset migration discussed in Chapter 4 to stacked data with greater confidence.

We remind ourselves from Chapter 3 that stacking velocities are dip-dependent (equation 3-8). When a flat event is intersected by a dipping event, we can only choose a stacking velocity in favor of one of these events, not both. Therefore, conventional CMP stacking does not equally preserve events with conflicting dips with different stacking velocities. This is not the case for a zero-offset section, for it contains all events, regardless of dip. Thus, in the presence of conflicting dips, a stacked section is not identical to a zero-offset section.

Since a CMP-stacked section strictly is not equivalent to a zero-offset section, we expect that migration after stack would not produce a crisp image in the pres-
ence of conflicting dips with different stacking velocities. To circumvent the problem of conflicting dips, it can be suggested that migration should be done before rather than after stack.

A practical alternative to migration before stack is to correct for the dip effect on moveout velocities implied by Levin's equation (3-8) prior to stacking. It can be suggested that prestack data first can be moveout-corrected using flat-event velocities. This normal-moveout correction (NMO) then is followed by a dip-moveout correction (DMO) to account for the dip effect on moveout. Stacking of NMO- and DMO-corrected CMP gathers yields a section that is a closer approximation to a zero-offset section than a conventional CMPstacked section based on NMO correction only.

Conflicting dips with different stacking velocities often are encountered in two geological situations reflections from steeply dipping fault planes confilicting with reflections associated with gently dipping strata, and diffractions and reflections off the flank of salt domes conflicting with, again, reflections associated with gently dipping strata.

The conflicting dips problem has been investigated extensively. Doherty (1975) first introduced the wave extrapolation equations for nonzero-offset data. Sherwood et al. (1978) devised a method for mapping nonzero-offset data to zero offset in the presence of conflicting dips with different stacking velocities. Then, Yilmaz and Claerbout (1980) suggested a prestack partial migration (PSPM) technique for solving the problem of conflicting dips. Specifically, they developed a wave theory to account for the difference between migration before stack and the result of conventional processing that includes movenut correction, CMP stacking and migration after stack (Section D.1). They recognized the fact that DMO correction actually is a partial migration process applied to moveout-corrected commonoffset data. Nevertheless, the PSPM theory had one important drawback. Although valid for the layered earth velocity model, it, was besed on a small-offet approximation. Deregowski and Rocca (1981) recast the theory for PSPM in a form similar to Kirchhoff migration. Ottolini (1982) developed the PSPM equations in Snell-midpoint coordinates, the domain of constant-rayparameter sections (Section F.2). The technique is theoretically accurate for layered medium as well as for all offsets and dips. This method was followed by another unique approach that involves offset continuation (Bolondi et al., 1982, 1984; Salvador and Savelli, 1982; Bolondi and Rocca, 1985); that is, mapping a far-offset section to a near-offset section, thereby collapsing all offsets to zero offset. Hale $(1983,1984)$ formulated a DMO method in the $f-k$ domain. This method is exact for constant velocity, it can handle all dips and offsets, and is accurate as long as the vertical velocity gradient is moderate. Jacubowicz (1990) developed a conceptually appealing technique that involves first dip decomposition of the input data and application of a DMO operator to each component, individually. Hale (1983), Hale and Artley (1992), and Artley and Hale (1994) extended the DMO theory to accommodate vertical velocity variations. French et al. (1984) developed a partial migration technique that tries to account for variations in source-receiver azimuths, a form particularly suitable for 3-D applications. Biondi and Ronen (1987), Cabrera and Levy (1989), Granser (1994) and Zhou et al. (1996) designed DMO operators applied to shot profiles. All of these techniques are confined to vertical velocity variations for which time migration is appropriate. However, DMO correction cannot, solve stack imperfections caused by lateral velocity variations. Principles of and techniques for DMO correction are described in Section 5.1, and practical aspects of DMO corroction are covered in Section 5.2.

While the practical solution to the problem of conflicting dips with different stacking velocities is DMO correction combined with poststack time migration, the rigorous solution is prestack time migration. A theory for imaging nonzero-offset data based on the doublesquare-root equation is provided in Section D.1. Recall from Section 4.1 that poststack migration, in principle, is based on summation of amplitudes along a zero-offset hyperbolic traveltime curve and placing the summed amplitude to the apex of the hyperbola. Similarly, prestack time migration, in principle, involves summation of amplitudes along the nonzero-offset traveltime curve in midpoint-offset coordinates and placing the summed amplitude at the apex of the surface. The nonzero-offset traveltime equation can be derived by stationary-phase approximation to the doublesquare-root equation (Section D.2). As with the zerooffset case, the welocity field dictates the curvature of the nonzero-offet summation paths. Each commonoffset section can be imaged separately; the results then can be superimposed to produce the migrated section. In practice, however, processing sequence for prestack time migration often incorporates DMO correction and repicking velocities after migration. Fowler (1984) developed a velocity-independent prestack imaging technique that incorporates a step to correct for dipdependency of stacking velocities applied to constantvelocity stacked data. Gardner et al. (1986) combined DMO correction with a velocity-independent prestack imaging technique based on constant-time slices of prestack data in midpoint-offset coordinates. Bancroft and Geiger (1994) developed a prestack imaging tech nique also based on constent-time slices of prestack data, but in shot-receiver coordinates. Practical aspects
of prestack time migration are discussed in Section 5.3, while techniques for migration velocity analysis are described in Section 5.4.

## Salt-Flank Reflections

Consider the stacked section in Figure 5.0-1a. While picking velocities in favor of the flat reflections, the steep flank of the diffaction hyperbola of the tip of the salt dome and the steeply dipping reflection off the flank of the salt dome are not stacked with sufficient strength. This inadequate definition of the diffraction and the steeply dipping reflection then causes migration after stack to respond somewhat poorly (Figure 5.0-1b). The stack with dip-moveout correction preserves the diffraction and the steeply dipping reflection as well as the flat reflections (Figure 5.0-1c). As a result, migration yields an image of the salt diapir that stands out clearly in contrast with the surrounding strata (Figure $5.0-1 d$ ).

It is important to evaluate the two migrated sections (Figures 5.0-1b and d) from the viewpoint of an interpreter. Surely, by using the termination points of the nearly flat events in Figure 5.0-1b, one can trace the salt boundary without the need for proper stacking and imaging the reflection of the flank. However, by preserving this reflection on the stacked section and migrating it properly (Figure 5.0-1d), we attain a clue to migration velocity errors. Specifically, if the steeply dipping event that defines the salt boundary and the surrounding flat events cross over each other, we know that overmigration has occurred, and as a result, the salt diapir has not been delineated accurately.

## Fault-Plane Reflections

The section in Figure 5.0-2a contains a major listric fault that dips down from left to right. Also, there are many auxiliary faults that intersect this main fault and several antithetic faults which do not intersect it. These fault patterns commonly occur in areas in which extension has taken place. We see reflections associated with the sedimentary strata, as well as faint indications of fault-plane reflections. Along major fault zones, such as those in Figure 5.0-2a, there is often a clear case of conflicting dips. Migration of the stacked section (Figure 5.0-2b) positions the events dipping down from right to left with an acceptable accuracy. Nevertheless, the Listric fault can be inferred and traced only by following the termination points of the dipping events.

The DMO stack shown in Figure 5.0-2c has preserved the conflicting dips associated with the listric fault and the growth faults in comparison with the conventional CMP stack (Figure 5.0-2a). Migration of the DMO stack (Figure 5,0-2d) yields a crisp image of the fault planes associated with the growth faults in contrast with the image from migration of the conventional stack (Figure 5.0-2b).

## DMO and Stacking Velocities

We now closely examine an aspect of dip-moveout correction in relation to stacking velocities. Consider the CMP stack in Figure 5.0-3a and the DMO stack in Figure 5.0-3b, and note that the steeply dipping reflections are better preserved by the latter. We know from equation (3-8) that the steeper the dip the higher the stacking velocities. Figure 5.0-4 shows constantvelocity-stack (CVS) panels in the neighborhood of midpoint $A$ as denoted in Figure 5.0-3a using CMP gathers without and with DMO correction. Note that gently dipping reflections and associated multiples stack at low velocities, whereas steeply dipping reflections stack at high velocities. After DMO correction, the velocities for the steeply dipping events have been corrected for the dip effect; hence both gently dipping and steeply dipping reflections stack with equal strength at low velocities.

Consider velocity analysis at midpoint $A$ in Figure 5.0-3a where the steeply dipping reflections are in conflict with the reflections associated with the gently dipping strata. The dip effect on stacking velocities can be clearly observed on the velocity spectrum shown in Figure 5.0-5a. The group of semblance peaks on the spectrum in Figure 5.0-5a denoted by $A$ represent the steeply dipping events which conflict with the nearlyflat events as sen in the stacked section in Figure 5.0$3 b$ in the neighborhood of milpoint $A$. We would have a problem when trying to pick a velocity function from this velocity spectrum. We normally would pick along the predominant velocity trend as denoted in Figure 5.0-5a. This leads to rejection of the picks associated with the steeply dipping refections and a significant reduction in their amplitudes on the stacked section (Figure 5.0-3a). Following DMO correction, the duality in velocity picks are eliminated, and the velocities are corrected for dip as shown in Figure 5.0-5b. Also, note the improved velocity trend after DMO correction.

Figure 5.0-6 shows a close-up view of the CMP gather at midpoint $A$ as in Figure 5.0-3a without DMO correction, the velocity spectrum, and the gather after NMO correction using the velocity function denoted in the velocity spectrum. The overcorrected events on the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0675.jpg?height=452&width=449&top_left_y=118&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0675.jpg?height=453&width=417&top_left_y=636&top_left_x=125)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0675.jpg?height=445&width=402&top_left_y=124&top_left_x=549)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0675.jpg?height=444&width=392&top_left_y=643&top_left_x=550)

(d)

FIG. 5.0-1. Conflicting dips associated with salt flanks: (a) CMP stack without dip-moveout correction; (b) time migration of the stack in (a); (c) the stack with dip-moveout correction; (d) time migration of the stack in (c).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0676.jpg?height=1040&width=862&top_left_y=168&top_left_x=80)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0676.jpg?height=875&width=38&top_left_y=253&top_left_x=981)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0677.jpg?height=1036&width=670&top_left_y=117&top_left_x=178)

FIG. 5.0-3. (a) A CMP stack, and (b) a DMO stack. See Figures 5.0-4 through 5.0-11 for the results of velocity analy performed at midpoint locations $A$ and $B$ using CMP gathers before and after DMO correction.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0678.jpg?height=1050&width=860&top_left_y=162&top_left_x=70)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0679.jpg?height=437&width=291&top_left_y=115&top_left_x=230)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0679.jpg?height=437&width=280&top_left_y=115&top_left_x=524)

b

FIG. 5.0-5. Velocity spectrum at midpoint location $A$ as in Figure $5.0-3$ without (a) and with (b) DMO correction. The group of semblance peaks on the spectrum in (a) denoted by $A$ represents the steepiy dipping events which conflict with the nearly flat events as seen in the stacked section in Figure 5.0-3b in the neighborhood of midpoint $A$.

moveout-corrected gather represent the steeply dipping reflections, and the undercorrected events represent the multiple reflections.

The cloev-up view of the CMP gather in Figure 5.0-6 after DMO corroction is shown in Figure 5.07. Note the more rigorous delincation of the velocity trend in the spectrum as compared to that in Figure 5.0-6. The absence of the overcorrected events in the moveout-corrected gather is a convincing evidence that the velocities of the steeply dipping reflections have been corrected for the dip effect as inferred by equation (3-8). Where are the overcorrected events that we see in Figure 5.0-6c? Are they still present in the moveoutcorrected gather after DMO correction shown in Figure 5.0-7c? They should not be, because both flat events and dipping events could not be flattened simultaneously in the same gather. Moreover, the semblance peak in the velocity spectrum denoted by $A$ in Figure $5.0-5 \mathrm{a}$ is absent in Figure 5.0-5b after dip-moveout correction. Did it merge with the semblance peaks aligned with the velocity trend denoted in Figure 5.0-5b? No, it did not; instead, the energy represented by the semblance peak $A$ in Figure 5.0-5a actually has moved to another CMP location in the updip direction. So, we begin to have a clue to another aspect of dip-moveout correction that it may not be a moveout correction after all. We shall examine this clue closely later in Section 5.1.
The case in the neighborhood of midpoint $A$ in Figure $5.0-3 \mathrm{a}$ is that of reflections with conflicting dips. Often, on stacked data, diffractions and reflections also form couflicting dips. Figure 5.0-8 shows constantvelocity-stack (CVS) panels in the neighborhood of midpoint $B$ as denoted in Figure 5.0-3a using CMP gathers without and with DMO correction. Note that gently dipping reflections stack at low velocities, whereas the diffraction off the tip of the salt diapir stack at high velocities. After DMO correction, the velocities for the steeply dipping events have been corrected for the dip effect; hence both gently dipping reflections and the diffraction stack with equal strength at low velocities.

Consider velocity analysis at midpoint $B$ as in Figure $5.0-3 \mathrm{a}$ where the diffraction off the tip of the salt diapir are in conflict with the refloctions associated with the gently dipping strata. The dip effect on stacking velocities can be clearly observed on the velocity spectrum shown in Figure 5.0-9a. The semblance peak on the spectrum denoted by $B$ represents the diffraction off the tip of the salt dome which conflicts with the nearly flat events as soen in the stacked section in Figure 5.0$3 \mathrm{~b}$ in the neighborhood of midpoint $B$. Again, we would normally pick along the predominant velocity trend as denoted in Figure 5.0-9a. This leads to rejection of the pick associated with the diffraction, which would mean failure of preserving it on the stacked section (Figure

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0680.jpg?height=442&width=297&top_left_y=118&top_left_x=95)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0680.jpg?height=442&width=298&top_left_y=118&top_left_x=379)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0680.jpg?height=435&width=268&top_left_y=124&top_left_x=673)

C

FIG. 5.0-6. A elowe-up view of (a) the CMP gather at midpoint $A$ as in Figure 5.0-3 without DMO correction, (b) the veiocity spectrun, and (c) the CMP gather is in (a) after NMO correction using the velocity function denoted in the velocity spertrum in (b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0680.jpg?height=442&width=297&top_left_y=676&top_left_x=95)

a
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0680.jpg?height=456&width=552&top_left_y=676&top_left_x=388)

FIG. 5.0-7. A close-up view of (a) the CMP gather at midpoint $A$ as in Figure $5.0-3$ with DMO correction, (b) the velocity spectrum, and (c) the CMP gather as in (a) after NMO correction using the velocity function dencted in the velocity spectrum in (b).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0681.jpg?height=1056&width=872&top_left_y=157&top_left_x=62)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0682.jpg?height=433&width=291&top_left_y=117&top_left_x=230)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0682.jpg?height=432&width=281&top_left_y=120&top_left_x=525)

b

FIG. 5.0-9. Velocity spectrum at midpoint location $B$ as in Figure $5.0-3$ without (a) and with (b) DMO correction. The scmblance peak on the spectrum in (a) denoted by $B$ represents the diffraction off the tip of the salt dome which conflicts with the nearly flat events as seen in the stacked section in Figure 5.0-3b in the neighborhood of midpoint B.

5.0-3a). Following DMO correction, the duality in velocity picks is eliminated, and the velocities are corrected for dip as shown in Figure 5.0-9b.

Figure 5.0-10 shows a close-up view of the CMP gather at midpoint $B$ as in Figure 5.0-3a without DMO correction, the velocity spectrum, and the gather after NMO correction using the velocity function denoted in the velocity spectrum. The overcorrerted event at $3.75 \mathrm{~s}$ on the moveout-corrected gather represents the diffraction, and the undercorrected events represent the multiple reflections.

The close-up view of the CMP gather as in Figure 5.0-10 after DMO correction is shown in Figure 5.011. Note the more rigorous delineation of the velocity trend in the spectrum as compared to that in Figure 5.010. The overcorrected event associated with the diffraction is absent in the moveout-corrected gather once again, convincing evidence that the diffraction velocity has been corrected for the dip effect. The diffraction energy, however, that gave rise to the peak denoted by $B$ in Figure 5.0-9a is absent in the moveout-corrected gather after DMO correction shown in Figure 5.0-11c. Dip-moveout correction, unlike cotventional normalmoveout correction, has caused energy to move from one CMP location to another.

Figure 5.0-12 shows time migrations of the CMP. stacked and DMO-stacked sections in Figure 5.0-3. Be- cause the steep events associated with the diffraction energy and the dipping reflections have been preserved in the DMO stack (Figure 5.0-3b), time migration of this section produces an image of the salt dipair with its boundaries clearly delitueated (Figure 5.0-12b). In contrast, the boundaries of the salt diapir in the CMP stack can be delineated only by the terminations of the gently dipping strata (Figure 5.0-12a).

## Turning-Wave Reflections

When salt tectonism is at an advanoed stage, it can cause overhang structures. If velocities within the surrounding sedimentary strata increase rapidly with depth, it is possible to record reflections from the underside of the salt overhang. These reflections are associated with turning vaves that first travel downward after they bounce off the underside of the salt overhang before returning to the surface. Turning-wave reflections give rise to a dipping event on the stacked section that conflicts with the refloctions nssociated with the: surrounding gently dipping strata. Nevertheless, dipmoveout correction alone does not strictly preserve the dipping event associated with the turning waves, since these waves propagate at angles greater than 90 degrees.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0683.jpg?height=449&width=299&top_left_y=118&top_left_x=93)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0683.jpg?height=442&width=279&top_left_y=116&top_left_x=390)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0683.jpg?height=434&width=279&top_left_y=123&top_left_x=662)

$\mathbf{c}$

FIG. 5.0-10. A close-up view of (a) the CMP gather at midpoint $B$ as in Figure 5.0-3 without DMO correction, (b) the velocity spectrum, and (c) the CMP gather as in (a) after NMO correction using the velocity function depicted in the velocity spectrum in (b).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0683.jpg?height=452&width=852&top_left_y=676&top_left_x=88)

FIG. 5.0-11. A close-up view of (a) the CMP gather at midpoint $B$ as in Figure $5.0-3$ with DMO correction, (b) the velocity spectrum, and (c) the CMP gather as in (a) after NMO onroction using the velocity function depicted in the vilocity spoctrum in (b).
s

1
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0684.jpg?height=1012&width=716&top_left_y=188&top_left_x=164)

FIG. 5.0-12. Time migrations of (a) the CMP stack, and (b) the DMO stack as in Figure 5.0-3.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0685.jpg?height=519&width=265&top_left_y=124&top_left_x=222)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0685.jpg?height=514&width=268&top_left_y=124&top_left_x=546)

b

FIG. 5.0-13. (a) Conventional poststack time migration; (b) turning-wave migration. (Courtesy Schlumberger Geco-Prakla.)

They can be preserved only by making use of its abnormal moveout behavior during stacking and imaged properly by making use of the evanescent energy associated with dips greater than 90 degrees during migration (Section 5.1).

Figure 5.0-13 shows a field data example of turningwave migration. The salt boundary from the image based on phase-shift migration of the conventional stack can be inferred only from the termination of the reflectors associated with the surrounding sedimentary soquence. Whereas, the image based on the turning-wave migration of the stack that preserves the turning-wave energy shows the overhang structure on either side of the salt intrusion, distinctively.

### 5.1 PRINCIPLES OF DIP-MOVEOUT CORRECTION

The objective we want to achieve with the combination of normal-moveout and dip-moveout correction is mapping nonzero-offset data to the plane of zero-offset section. Once each common-offset section is mapped to zero-offset, the data can then be migrated either before or after stack using the zero-ofiset theory for migration as described in Chapter 4.

Figure 5.1-1a depicts the nonzero-offset recording geometry associated with a dipping reflector. The nonzero-offset traveltime $t=S R G / v$ is measured along the raypath from source $S$ to reflection point $R$ to reociver $G$, where $v$ is the velocity of the medium above the dipping reflector. This arrival time is depicted on the time section in Figure 5.1-1b by point $A$ on the trace that coincides with midpoint $y_{n}$. We want to map the amplitude at time $t$ denoted by the sample $A$ on the trace at midpoint $y_{n}$ of the common-offset section with offset $2 h$ to time $\tau_{0}$ denoted hy the sample $C$ on the trace at midpoint $y_{0}$ of the zero-ofiset section. We achieve this mapping in two steps:

(a) Normal-moveout corroction that maps the amplitude at time $t$ denoted by the sample $A$ on the trace at midpoint $y_{n}$ of the common-offset section with offset $2 h$ to time $t_{n}$ denoted by the sample $B$ on the same trace at midpoint $y_{n}$ of the same common-offset section.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0686.jpg?height=572&width=456&top_left_y=126&top_left_x=74)

FIG. 5.1-1, (a) The geometry of a nonzero-offset recording of reflections from a dipping layer boundary; (b) a sketch of the time section depicting the varnous traveltimes. NMO correction involves corordinate transformation from $y_{n}-t$ to $y_{n}-t_{n}$ by mapping amplitude $A$ at time $t$ to $B$ at time $t_{n}$ on the same trace. DMO correction involves coordinate transformation from $y_{n}-t_{n}$ to $y_{0}-\tau_{0}$ by mapping amplitude $B$ at time $t_{n}$ on the trace at midpoint location $y_{n}$ of the moveout-corrccted common-ofiset section to amplitude $C$ at tirne $\tau_{0}$ on the trace at midpoint location $y_{0}$ of the zero-offset section. Zero-offset migration involves coordinate transformation from $y_{0}-\tau_{0}$ to $y_{m}-\tau$ by mapping amplitude $C$ at time $\tau_{0}$ on the trace at. midpoint location $y_{0}$ of the zero-offset section to amplitude $D$ at time $\tau$ on the trace at midpoint location $y_{m}$ of the migrated section. Migration before stack involves direct mapping of amplitude $A$ at time $\boldsymbol{t}$ on the trace at midpoint. location $y_{n}$ of the common-offset section to amplitude $D$ at time $r$ on the trace at midpoint location $\mathrm{ym}$ of the migrated section. Sec text for the rcla tionships between the coordinate variables.

(b) Dip-moveout correction that maps the amplitude at time $t_{n}$ denoted by the sample $B$ on the trace at midpoint $y_{n}$ of the moveout-corrected commonoffset section with offset $2 h$ to time $\tau_{0}$ denoted by the sample $C$ on the trace at midpoint $y_{0}$ of the zero-offset section.
Zero-offset migration then maps the amplitude at time $\tau_{0}$ denoted by the sample $C$ on the trace at midpoint $y_{0}$ of the zero-ofiset section to the amplitude at time $\tau$ denoted by the sample $D$ on the trace at midpoint $y_{m}$ of the migrated section. Note that the combination of NMO correction, DMO correction, and zero-offset migration achieves the same objective as direct mapping of the amplitude at time $t$ denoted by the sample $A$ on the trace at nidpoint $y_{n}$ of the common-offset section with offset $2 h$ to the amplitude at time $\tau$ denoted by the sample $D$ on the trace at midpoint $y_{m}$ of the migrated section. This direct mapping procedure is the basis of algorithms for migration before stack (Section 5.3).

The important point to note is that the normalmoveout correction in step (a) is performed using the velocity of the medium above the dipping reflector.

The NMO equation (3-8) defines the traveltime $t$ from source location $S$ to the reflection point $R$ to the receiver location $G$. This equation, written in prestack data coordinates, is

$$
t^{2}=t_{0}^{2}+\frac{4 h^{2} \cos ^{2} \phi}{v^{2}}
$$

where $2 h$ is the offsct, $v$ is the medium velocity above the reflector, $\phi$ is the reflector dip, and $t_{0}$ is the two-way zero-offset time at midpoint location $y_{n}$.

Dip-moveout correction of step (b) is preceded by zero-dip normal-moveout correction of step (a) using the dip-independent velocity $v$ :

$$
t^{2}=t_{n}^{2}+\frac{4 h^{2}}{v^{2}}
$$

where $t_{n}$ is the event time at midpoint $y_{n}$ after the NMO correction. Event time $t_{n}$ after the NMO correction and event time $t_{0}$ are related as follows (Section E.2)

$$
t_{\pi}^{2}=t_{0}^{2}-\frac{4 h^{2} \sin ^{2} \phi}{v^{2}}
$$

At first glance, equations (5-2) and (5-3) suggest a two-step approach to moveout corrction:

(a) Apply a $d u$-zndependent moveout correction using equation (5-2) to map the amplitude at time $t$ denoted by the sample $A$ on the trace at midpoint $y_{n}$ of the common-offset section with offset $2 h$ to time $t_{n}$ denoted by the sample $B$ on the same trace at midpoint $y_{n}$ of the same common-offset section.

(b) Apply a dop-dependent moveout correction using equation (5-3) to map the amplitude at time $t_{n}$ denoted by the sample $B$ on the trace at midpoint $y_{n}$ of the moveout-corrected common-olfset section with offset $2 h$ to time $t_{0}$ denoted by the sample
$B^{\prime}$ on the same trace at midpoint $y_{n}$ of the same common-offset section.

This two-step moveout correction is equivalent to the one-step moveout correction using equation (5-1) to map event time $t$ directly to event time $t_{0}$.

Our goal, however, is to map event time $t$ not to $t_{0}$ - the two-way zero-offset time associated with midpoint $y_{n}$ between source $S$ and receiver $G$, but to $\tau_{0}$ - the two-way zero-offset time at midpoint location $y_{0}$ associated with the normal-incidence reflection point $R$ (Figure 5.1-1). The relationships between $\left(y_{n}, t_{n}\right)$ coordinates of the normal-moveout-corrected data and $\left(y_{0}, \tau_{0}\right)$ coordinates of the dip-moveout-corrected data are given by (Section E.2):

$$
y_{0}=y_{n}-\frac{h^{2}}{t_{n} A}\left(\frac{2 \sin \phi}{v}\right)
$$

and

$$
\tau_{0}=\frac{t_{n}}{A}
$$

where

$$
A=\sqrt{1+\frac{h^{2}}{t_{n}^{2}}\left(\frac{2 \sin \phi}{v}\right)^{2}}
$$

For completeness, the relationship between event times $t_{n}$ and $t_{0}$ is given by (Section E.2)

$$
t_{0}=t_{n} A
$$

Note from equation (5-5) that $A \geq 1$; thereforc, $\tau_{0} \leq t_{n}$ (equation 5-4b) and $t_{0} \geq t_{n}$ (equation 5-6).

Refer to Figure 5.1-1 and note that the normalmoveout correction that precedes the dip-moveout correction maps the amplitude at sumple $A$ with coordinates $\left(y_{n}, t\right)$ to sample $B$ with coordinates $\left(y_{n}, t_{n}\right)$. So, the midpont coordznate as invarnant under NMO cornectron. The difference between the input time $t$ and the output time $t_{n}$ is defined by

$$
\Delta t_{N M O}=t-t_{\mathrm{n}},
$$

which can be expressed by way of equation (5-2) as follows

$$
\Delta t_{N M O}=t_{n}\left(A_{n}-1\right)
$$

where

$$
A_{n}=\sqrt{1+\frac{h^{2}}{t_{n}^{2}}\left(\frac{2}{v}\right)^{2}}
$$

Again, refer to Figure 5.1-1 and note that the dipmoveout correction maps the amplitude at sample $B$ with coordinates $\left(y_{n}, t_{n}\right)$ to sample $C$ with coordinates $\left(y_{0}, \tau_{0}\right)$. So, the midpoint coordinate is varzant under $D M O$ correction. The lateral excursion associated with the DMO correction is given by

$$
\Delta y_{D M O}=\left|y_{n}-y_{0}\right|,
$$

which can be expressed by way of equations (5-4a) and $(5-5)$ as

$$
\Delta y_{D M O}=\frac{h^{2}}{t_{n} A}\left(\frac{2 \sin \phi}{v}\right)
$$

The difference between the input time $t_{n}$ and the output time $\tau_{0}$ is defined by

$$
\Delta t_{D M O}=t_{n}-\tau_{0},
$$

which can be expressed by way of equations $(5-4 \mathrm{~b})$ and $(5-5)$ as

$$
\Delta t_{D M O}=t_{n}\left(1-\frac{1}{A}\right)
$$

Finally, as sketched in Figure 5.1-1, the reflection point dispersal $\Delta=N R$ is defined by the distance along the dipping reflector between the normalincidence points $N$ and $R$ associated with midpoints $y_{n}$ and 30 , respectively. By way of cquations (E-18) ard (5-8a) it follows that (Section E.1)

$$
\Delta=\frac{h^{2}}{t_{n} A}\left(\frac{\sin 2 \phi}{v}\right)
$$

Note from equation (5-10) that reflection point dispersal is nill for zero offset, and increases with the square of the offset. Also, the larger the dip and shallower the reflector, the larger the dispersal.

A direct consequence of equation (5-10) is that a reflection event on a CMP gather is associated with more than one reflection point on the reflector. Following DMO correction, reflection-point dispersal is eliminated and, hence, the reflection event is associated with a single reflection point at normal-incidence (point $R$ in Figure 5.1-1). While prestack data before DMO correction can be associated with common madponts, and thus sorted into common-midyont (CMP) gathers; after DMO correction, the data can be associated with common reflection ponts, and thus can be considered in the form of common-reflection-point (CRP) gathers.

## Prestack Partial Migration

While conventional normal-moveout correction involves only a time shift given by equation (5-7b), dip-moveout correction involves mapping both in time and space given by equations $(5-8 \mathrm{~b})$ and (5-9b), respectively. This means that dip-moveout correction, strictly speaking, is not a moveout correction in conventional terms; rather, it is a process of partal magration before stack applied
to common-offset data. We therefore may speak of a dip-moveont operntor with a specific impulse response as for the migration process itself. Following this partial migration to map nonzero-offset data to the plane of zero-offset, each common-offset section is then fully migrated using a zero-offset migration operator.

A dip-moveout operator maps amplitudes on a moveout-corrected trace of a common-offset section along its impulse response trajectory. Before we derive the expression for its impulse response, we shall first make some inferences about the DMO process based on equations (5-8b) and (5-9b). Tables 5-1, 5-2, and 5-3 show horizontal $\left(\triangle y_{D M O}\right)$ and vertical $\left(\Delta t_{D M O}\right)$ displacements associated with dip-moveout correction described by equations (5-8b) and (5-9b), respectively. Combined with equations $(5-8 b)$ and $(5-9 b)$, we make the following observations:

(a) Set $\phi=0$ in equations (5-8b) and (5-10b), and note that $\Delta y_{D M O}=0$ and $\Delta t_{D M O}=0$. Hence, the DMO operator has no effect on a flat reflector, irrespective of the offet. The steeper the dip, the larger the DMO correction.

(b) Note from Table 5-1 that the horizontal displacement $\triangle Y_{D M O}$ and the vertical displacement $\Delta t_{D m o}$ decrecse with time $t_{n}$. This means that the spatial aperture of the dip-moveout operator, in contrast with a migration operator, actually decreases with event time.

(c) Substitute equation (5-5) into equation (5-8b) and note that, in the limit $t_{n}=0$, y $_{D M O}=h$. This means that the largest spatial extent of the DMO operator equals the offset $2 h$ associated with the moveout-corrected trace at $t_{n}=0$.

Table 5-1. Horizontal ( $\left.\triangle y_{D M O}\right)$ and vertical $\left(\Delta t_{D M O}\right)$ displacements associated with dip-moveout correction described by equations (5-8b) and (5-9b), respectively, for a given moveout-corrected time varjable $t_{n}$ and velocity $v$. The dip angle $\phi=30$ degrees, half-offset $h=1500 \mathrm{~m}$. Also given are the corresponding values for the reflection point smear $\Delta$ as in equation (5-10).

| $t_{n}$ <br> $(\mathrm{~s})$ | $v$ <br> $(\mathrm{~m} / \mathrm{s})$ | $\Delta y_{D M O}$ <br> $(\mathrm{~m})$ | $\Delta t_{D M O}$ <br> $(\mathrm{~s})$ | $\Delta$ <br> $(\mathrm{m})$ |
| ---: | ---: | ---: | ---: | ---: |
| 0.5 | 2400 | 1,170 | 0.188 | 1,013 |
| 1.0 | 2400 | 793 | 0.152 | 687 |
| 1.5 | 2400 | 575 | 0.115 | 497 |
| 2.0 | 2400 | 446 | 0.090 | 386 |
| 2.5 | 2400 | 363 | 0.075 | 314 |
| 3.0 | 2400 | 305 | 0.063 | 264 |
| 4.0 | 2400 | 230 | 0.008 | 199 |

(d) Compare the values for $\triangle y_{D M O}$ and $\Delta t_{D M O}$ in Tables 5-1 and 5-2, and note that the lower the velocity, the larger the DMO correction. This also implies that the shallower the event. the more significant the DMO term, since lower velocities generally are found in shallow parts of the seismic data.

(e) For a specific reflector dip $\phi$, compare the values for $\Delta y_{D M O}$ and $\Delta t_{D M O}$ in Tables 5-2 and 5-3, and note that the larger the offset $2 h$, the more the DMO correction. Whatever the reflector dip, DMO correction has no effect on zero-offset data with $h=0$.

Table 5-2. Horizontal ( $\triangle$ VDMO ) and vertical ( $\Delta t_{D M O}$ ) displacements associated with dip-moveout correction described by equations (5-8b) and ( $5-9 b$ ), respectively, for a given moveout-corrected time variable $t_{n}$ and velocity $v$. The dip angle $\phi=30$ degrees, half-offset $h=1500 \mathrm{~m}$. Also given are the corresponding values for the reflection point smear $\Delta$ as in equation (5-10).

| $t_{n}$ <br> $(\mathrm{~s})$ | $v$ <br> $(\mathrm{~m} / \mathrm{s})$ | $\triangle y_{D M O}$ <br> $(\mathrm{mi})$ | $\Delta t_{D M O}$ <br> (s) | $\Delta$ <br> $(\mathrm{m})$ |
| :---: | :---: | :---: | :---: | :---: |
| 0.5 | 1800 | 1,284 | 0.243 | 1,111 |
| 1.0 | 2000 | 900 | 0.200 | 779 |
| 1.5 | 2200 | 620 | 0.135 | 536 |
| 2.0 | 2400 | 446 | 0.090 | 386 |
| 2.5 | 2700 | 324 | 0.060 | 280 |
| 3.0 | 3000 | 246 | 0.036 | 213 |
| 4.0 | 4000 | 140 | 0.016 | 121 |

Table 5-3. Horizontal ( $\triangle$ у $_{D M O}$ ) and vertical ( $\Delta t_{D M O}$ ) displacements associated with dip-moveout correction described by equations ( $5-8 b$ ) and (5-9b), respectively, for a given moveout-corrected time variable $t_{n}$ and velocity $v$, The dip angle $\phi=30$ degrees, half-offset $h=500 \mathrm{~m}$. Also given are the corresponding values for the reflection point smear $\Delta$ as in equation (5-10).

| $t_{n}$ | $v$ | $\Delta y_{D M O}$ | $\Delta t_{D M O}$ | $\Delta$ |
| ---: | ---: | ---: | ---: | ---: |
| $(\mathrm{s})$ | $(\mathrm{m} / \mathrm{s})$ | $(\mathrm{m})$ | $(\mathrm{s})$ | $(\mathrm{m})$ |
|  |  |  |  |  |
| 0.5 | 1800 | 241 | 0.064 | 209 |
| 1.0 | 2000 | 121 | 0.030 | 105 |
| 1.5 | 2200 | 74 | 0.015 | 64 |
| 2.0 | 2400 | 51 | 0.010 | 44 |
| 2.5 | 2700 | 37 | 0.008 | 32 |
| 3.0 | 3000 | 27 | 0.004 | 23 |
| 4.0 | 4000 | 15 | 0.000 | 13 |

(f) Finally, note from Tables 5-1, 5-2 and 5-3 that the reflection point smear $\Delta$ given by equation (5-10) decreases in time and for small offsets.

## Frequency-Wavenumber DMO Correction

Refer to Figure 5.1-1 and recall that our objective with DMO correction is to transform the normal-moveoutcorrected prestack data $P_{n}\left(y_{n}, t_{n} ; h\right)$ from $y_{n}-t_{n}$ coordinates to $y_{0}-\tau_{0}$ coordinates so as to obtain the dipmoveout-corrected zero-offset data $P_{0}\left(y_{0}, \tau_{0} ; h\right)$. Note, however, the transformation equations (5-4a) and (54b) require knowledge of the reflector $\operatorname{dip} \phi$ to perform the DMO correction. To circumvent this requirement, Hale (1984) developed a method for DMO correction in the frequency-wavenumber domain. First, we use the relation from Section D. 1

$$
\sin \phi=\frac{v k_{y}}{2 \omega_{0}}
$$

which states that the reflector dip $\phi$ can be expressed in terms of wavenumber $k_{y}$ and frequency $\omega_{0}$, which are the Fourier duals of midpoint $y_{0}$ and event time $\tau_{0}$, respectively. By way of equation (5-11), the transformation equations (5-4a) and (5-4b) are recast explicitly independent of reflector dip as

and

$$
y_{0}=y_{n}-\frac{h^{2} k_{y}}{t_{n} A w_{0}}
$$

$$
\tau_{0}=\frac{t_{n}}{A}
$$

where $A$ of equation (5-5) now is of the form

$$
A=\sqrt{1+\frac{h^{2} k_{z}^{2}}{t_{n}^{2} \omega_{0}^{2}}}
$$

The frequency-wavenumber domain dip-moveout correction process that transforms the normal-moveoutcorrected prestack data with a specific offset $2 h$ from $y_{n}-t_{n}$ domain to $y_{0}-\tau_{0}$ domain is achieved by the integral

$$
\begin{aligned}
P_{0}\left(k_{y}, \omega_{0} ; h\right) & =\int \frac{2 A^{2}-1}{A^{3}} \\
& \times P_{n}\left(k_{y_{i}} t_{n} ; h\right) \operatorname{cxp}\left(-i \omega_{0} t_{n} A\right) d t_{n} .
\end{aligned}
$$

Derivation of the integral transform of equation (5-14a) is given in Section E. 2

Once dip-moveout correction is applied, the data are inverse Fourier transformed

$$
\begin{aligned}
P_{0}\left(y_{0}, \tau_{0} ; h\right) & =\iint P_{0}\left(k_{y}, \omega_{0} ; h\right) \\
& \times \exp \left(-\imath k_{y} \eta_{0}+i \omega_{0} \tau_{0}\right) d k_{y} d \omega_{0}
\end{aligned}
$$

The amplitude scaling $\left(2 A^{2}-1\right) / A^{3}$ in equation (5-14a) is by Black et al. (1993), and is represented by $A^{-1}$ in the original derivation by Hale (1984). The difference is due to the fact that Hale (1984) defined the output time variable for DMO correction as $t_{0}$ of equation (56), whereas Black et al. (1993) correetly defined the output time variable as $\tau_{0}$ of equation (5-4b). Fortunately, the phase term $\exp \left(-i \omega_{0} t_{n} A\right)$ as in cquation (5-14a) is identical in the case of both derivations. There is one other variation of the amplitude term by Liner (1989) and Bleistein (1990) given by $\left(2 A^{2}-1\right) / A$. Nevertheless, within the context of a conventional processing sequence which includes geometric spreading correction prior to DMO correction, the amplitude scaling $\left(2 A^{2}-1\right) / A^{3}$ described here preserves relative amplitudes.

We now outline the steps in dip-moveout correction in the frequency-wavenumber domain:

(a) Start with prestack data in midpoint-offset $y-h$ coordinates, $P(y, h, t)$ and apply normal moveout correction using a dip-independent velocity $v$.

(b) Sort the data from moveout-corrected CMP gathers $P_{n}\left(y_{n}, h, t_{n}\right)$ to common-offset sections $P_{n}\left(y_{n}, t_{n} ; h\right)$.

(c) Perform Fourier transform of each common-offset section in midpoint $y_{n}$ direction, $P_{n}\left(k_{y}, t_{n} ; h\right)$.

(d) For each output frequency $\omega_{0}$, apply the phase-shift $\exp \left(-i \omega_{0} t_{n} A\right)$, scale by $\left(2 A^{2}-1\right) / A^{3}$, and sum the resulting output over input time $t_{n}$ as described by equation (5-14a).

(e) Finally, perform 2-D inverse Fourier transform to obtain the dip-moveout corrected common-offset section $P_{0}\left(y_{0}, \tau_{0} ; h\right)$ (equation 5-14b).

A flowchart of the dip-moveout correction described above is presented in Figure 5.1-2.

We shall now test the frequency-wavenumber DMO correction using modeled data for point scatterers and dipping events. Figure 5.1-3 depicts six point scatterers buried in a constant-velocity medium. A synthetic data set that comprises 32 common-offset sections, each with 63 midpoints, was created. The offsets range is from 0 to $1550 \mathrm{~m}$ with an increment of $50 \mathrm{~m}$.

Figure 5.1-4 shows two constant-velocity stacks (CVS) of the CMP gathers from the synthetic data sct associated with the velocity-depth model depicted in Figure 5.1-3. The offset range used in stacking is $50-1550 \mathrm{~m}$. At the apex of the traveltime trajectory for each point scatterer, the event dip is zero. Thereforc, stack response is best with moveout velocity equal to the medium velocity $(3000 \mathrm{~m} / \mathrm{s})$. Along the flanks

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0690.jpg?height=455&width=414&top_left_y=126&top_left_x=84)

FIG. 5.1-2. A flowchart for frequency-wavenumber dipmoveout correction algorsthm. The scalar $A$ is given by equation (5-13) and $B=\left(2 A^{2}-1\right) / A^{3}$ as in equation (5-14a).

of the traveltime trajectories, optimum stack response varies as the event dip changes. The steeper the dip, the higher the moveout (or stacking) velocity.

Selected common-offset sections associated with the subsurface model in Figure 5.1-3 are shown in Figure 5.1-5a. The well-known nonhyperbolic table-top trajectories are apparent at large offsets. Selected CMP gathers from the model of Figure 5.1-3 are shown in Figure 5.1-5b. Only selected gathers that span the right side of the center midpoint are displayed, since the common-offset sections are symmetric with respect to the center midpoint (CMP 32). Note that the traveltimes at the center midpoint are perfectly hyperbolic, while the traveltimes at CMP gathers away from the center are increasingly nonhyperbolic.

The following DMO processing is applied to the data as in Figure 5.1-5a:

(1) Figure 5.1-5c shows the NMO-corrected gathers, with stretch muting applied. The medium velocity $(3000 \mathrm{~m} / \mathrm{s}$ ) was used for NMO correction (eriuation 5-2), an essential requirement for subsequent DMO correction. As a result, the events at and in the vicinity of the center midpoint (CMP 32) are flat after NMO correction, while the events at midpoints away from the center midpoint are increasingly overcorrected.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0690.jpg?height=264&width=403&top_left_y=126&top_left_x=550)

FIG. 5.1-3. Depth model of six point scatterers buried in a constant-velocity medium. The asterisks indicate the positions of the point scatterers.

(2) The stacked section derived from these gathers (Figure 5.1-5c) is shown in Figure 5.1-4b. Because medium velocity was used for NMO correction, the stack response is best for zero dip. Note the poor stack response along the steeply dipping flanks. The desired section is the zero-offset section in Figure 5.1-4a.

(3) We sort the NMO-corrected gathers (Figure 5.1-5c) into common-offset sections for DMO processing. These are shown in Figure 5.1-6a.

(4) Each common-offset section is individually corrected for dip moveout. The impulse responses of the dip-moveout operator for the corresponding offsets are shown in Figure 5.1-6b, and the resulting common-offset sections are shown in Figure 5.1-6c. Note the following effects of DMO:

(a) DMO is a partial migration process. The flanks of the nonhyperbolic trajectories have been moved updip just enough to make them look like zerooffset trajectories, which are hyperbolic. As a result, each common-offset section after NMO and DMO corrections is approximately equivalent to the zero-offset section (Figure 5.1-4a).

(b) This partial migration is subtly different from conventional migration in one respect. Unlike conventional migration, note from the impulse responses in Figure 5.1-6b that the dip-moveout correction becomes greater at increasingly shallow depths.

(c) While it does nothing to the zero-offset section, dipmoveout correction also is greater at increasingly large offsets (Figure 5.1-6c).

(d) Finally, as with conventional migration, the steeper the event, the greater partial migration takes place,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0691.jpg?height=292&width=842&top_left_y=116&top_left_x=100)

(a)

(b)

(c)

FIG. 5.1-4. Stack response of six point scatterers buried in a constant-velocity earth model ( $3000 \mathrm{~m} / \mathrm{s}$ ) as depicted in Figure 5 1-3: (a) zero-offset section, (b) stack with NMO velocity of $3000 \mathrm{~m} / \mathrm{s}$, (c) stack with NMO velocity of $3600 \mathrm{~m} / \mathrm{s}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0691.jpg?height=148&width=807&top_left_y=548&top_left_x=116)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0691.jpg?height=150&width=755&top_left_y=707&top_left_x=116)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0691.jpg?height=156&width=757&top_left_y=866&top_left_x=115)

FJG. 5.1-5. Intermediate results from DMO processing the nonzero-ofiset synthetic data derived from the depth model in Figure 5 1-3: (a) common-offset sections with offset range from 50 to $1550 \mathrm{~m}$ and an increment of $300 \mathrm{~m}$; (b) CMP gathers sorted from the common-offset sections as in (a) at midpoint locations from 32 to 63 as denoted in Figure 5. I-3 with an increment of 3; (c) the CMP gathers as in (b) after NMO correction and muting.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0692.jpg?height=612&width=812&top_left_y=120&top_left_x=111)

FIG. 5.1-6. Intermediate results from DMO processing the nonzero-ofiset synthetic date derived from the depth model in Figure 5.1-3: (a) common-offet sections with offset range from 50 to $1550 \mathrm{~m}$ and an thcrement of $300 \mathrm{~m}$ sorted from the NMO-corrected gathers as in Figure 5.1-4c; (b) impulse responses of the DMO operators appled to the comnon-oflset gathers; (c) cornuron-offet sections as in (a) after DMO correction; (d) CMP gathers sorted from the common-offset sections as in (c) at midpoint locations from 32 to 63 as denoted in Figure 5.1-3 with an increment of 3.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0692.jpg?height=272&width=266&top_left_y=881&top_left_x=105)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0692.jpg?height=267&width=267&top_left_y=885&top_left_x=380)

6

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0692.jpg?height=265&width=269&top_left_y=886&top_left_x=662)

C

FIG. 5.1-7. (a) Zero-offset section associated with the depth model in Figure 5.1-3, (b) stack derived from the CMP gathers as in Figure 5.1-5c, (c) DMO stack derived from the CMP gathers as in Figure 5.1-fd.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0693.jpg?height=221&width=318&top_left_y=138&top_left_x=169)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0693.jpg?height=198&width=342&top_left_y=397&top_left_x=169)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0693.jpg?height=222&width=357&top_left_y=135&top_left_x=513)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0693.jpg?height=204&width=350&top_left_y=395&top_left_x=518)

(d)

FIG. 5.1-8. DMO processing of dipping events: (a) zero-offset section with the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$; (b) stack using optamum velocity preks from velocity spectra along the line, such as that shown in Figure 5.1-12a; (c) stack using the medium velocity of $3500 \mathrm{~m} / \mathrm{s}$; (d) DMO stack using velocity picks from velocity spectra along the line, such as that shown in Figure 5.1-12b. Location A refers to an example of events with conflicting dips.

with flat events remaining unaltered (Figure 5.1$6 c)$.

(5) Following the DMO correction, the dath are sorted back to CMP gathers (Figure 5.1-6d). Compare the gathers in Figure 5.1-6d to the CMP gathers without DMO correction (Figure 5.1-5b). The DMO correction has left the zero-dip events unchanged (at and in the vicinity of CMP 32), while it substantially corrected steeply dipping events on the CMP gathers away from the center midpoint (CMP 32). The events on the CMP gathers now are flattened (Figure 5.1-6d). Also, since DMO correction is a migration-like process, it causes the energy to move from one CMP gather to neighboring gathers in the updip direction. Energy depletion at the CMP gathers in Figure 5.1-6d farther from the center midpoint occurred because there was no other CMP gather to contribute energy beyond CMP 63 .

(6) Stacking the NMO- and DMO-corrected gathers (Figure 5.1-6d) yields a section (Figure 5.1-7c) that more closely represents the zero-offset section
(Figure 5.1-7a) than the stacked section without the DMO correction (Figure 5.1-7b). Note the enhanced stack response along the steeply dipping flanks in Figure 5.1-7c. (The sections all have the same display gain.)

We now examine results of DMO processing of a modeled data set for dipping events. Figure 5. I-8a shows a zero-offset section that consists of events with dips from 0 to 45 degrees with a 5 -degree increment. Medium velocity is constant $(3500 \mathrm{~m} / \mathrm{s})$. Several velocity analyses were performed along the line; an example is shown in Figure 5.1-9a. Note the dip-dependent semblance peaks. Selected CMP gathers are shown in Figure 5.1-10a. By using the optimum stacking velocities picked from the densely spaced velocity analyses, we apply NMO correction to the CMP gathers (Figure 5.110b), then stack them (Figure 5.1-8b). Aside from the conflicting dips at location $A$, stack response is close to the zero-offset section (Figure 5.1-8a). The DMO processing requires NMO correction using medium velocity (Figure 5.1-10c). Stack response using the medium ve-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0694.jpg?height=431&width=416&top_left_y=127&top_left_x=83)

(a) (b)

FIG. 5.1-9. Velocity analysis (a) without and (b) with DMO correction at analysis. The stacked sections without and with DMO correction are shown in Figures 5.1-8b and $\mathrm{d}$.

locity (Figure 5.1-8c) clearly degrades at steep dips. By applying DMO correction (Figure 5.1-10d) to the NMOcorrected gathers (Figure 5.1-10b), we get the improved stacked section in Figure 5.1-8d. The DMO stack is closest to the zero-offset section (Figure 5.1-8a).

DMO correction also yields dip-corrected velocity functions that can be used in subsequent migration. Refer to the velocity analysis in Figure 5.1-9b and note that all events have semblance peaks at $3500 \mathrm{~m} / \mathrm{s}$, which is the medium velocity for this model data set.

## Log-Stretch DMO Correction

The frequency-wavenumber DMO correction (Hale, 1984; Black et al. 1993) described in this section is computationally intensive. Specifically, for each output frequency $\omega_{0}$, one has to apply the phase-shift $\exp \left(-i_{n} t_{n} A\right)$, scale by $\left(2 A^{2}-1\right) / A^{3}$, and sum the resulting output over input time $t_{n}$ as described by equation (5-14a). A computationally more efficient DMO correction can be formulated in the logarithmic time domain (Bolondi et al., 1982; Bale and Jacubowicz, 1987; Notfors and Godfrey, 1987; Liner, 1990; Zhou et al., 1996). The log-stretch time variable enables linearization of the coordinate transform equation ( $5-12 b)$, and

as a result, the DMO correction is achieved by a sinple multiplication of the input data with a phase-shift operator in the Fourier transform domain.

Define the following logarithmic variables that correspond to the time variables $\tau_{0}$ and $t_{n}$ of equation (5$12 b):$

$$
T_{0}=\ln T_{0}
$$

and

$$
T_{n}=\ln t_{n},
$$

where, for convenience, a constant scalar with its unit in time is omitted. Hence, the inverse relationships are given by

$$
\tau_{0}=e^{T_{0}}
$$

and

$$
t_{n}=e^{T_{n}}
$$

Our goal is to derive equations for DMO correction in the log-stretch coordinates $\left(y_{0}, T_{0}\right)$. The transform relation between the input log-stretch time variable $T_{n}$ and the output $\log$-stretch time variable $T_{0}$ is given by

$$
T_{0}=T_{n}-\ln A_{e},
$$

and the expression for the midpoint variable $y_{0}$ in the log-stretch domain is given by

$$
y_{0}=y_{n}-\frac{h^{2} k_{y}}{A_{e} \Omega_{0}}
$$

where

$$
A_{e}=\sqrt{1+\frac{h^{2} k_{y}^{2}}{\Omega_{0}^{2}}}
$$

The variable $\Omega_{0}$ is the Fourier transform dual of the variable $T_{0}$ in the $\log$-stretch domain. Equations (5$17 a, b)$ and (5-18) correspond to equations (5-12a,b) and (5-13) in the log-stretch domain. Mathematical details of the derivation of equations $(5-17 a, b)$ are left to Section E.3.

The log-stretch dip-moveout correction process is achieved by the following relationship (Section E.3):

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\exp \left(-i \frac{h^{2} k_{y}^{2}}{A_{e} \Omega_{0}}+i \Omega_{0} \ln A_{e}\right) P_{n}\left(k_{y}, \Omega_{0} ; h\right)
$$

Note that the relationship of input $P_{n}\left(k_{y}, \Omega_{0} ; h\right)$ to output $P_{0}\left(k_{y}, \Omega_{0 ;} h\right)$ given by equation (5-19) computationally is much simpler than that of equation (5-14a). The log-stretch domain implementation of DMO correction involves application of a phase-shift given by the exponential in equation (5-19) to the input data; whereas, the frequency-wavenumber implementation involves an integral transform given by equation (5-14a).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0695.jpg?height=486&width=744&top_left_y=130&top_left_x=144)

(b) NMO Correction using medlum

## ty $=3500 \mathrm{~m} / \mathrm{sec}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0695.jpg?height=230&width=712&top_left_y=626&top_left_x=166)

(c) NMO Correction using picked optlmum stacking velocities
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0695.jpg?height=232&width=722&top_left_y=870&top_left_x=156)

(d) DMO Corrections on (b)

FIG. 5.1-10. (a) Selected CMP gathers from the dipping-events model shown in Figure 5.1-8; (b) NMO-corrected gathers using medium velocity ( $3500 \mathrm{~m} / \mathrm{s}$ ); (c) NMO-corrected gathers using optimum stacking velocities picked from velocity spectra along the line, such as that shown in Figure 5. I-9a; (d) DMO-corrected gathers.

To circumvent the logarithmic computation, a variation of the phase-shift term in equation (5-19) is given by Notfors and Godfrey (1987). As in most $\log$-stretch formulations of DMO correction, this reference assumes that under DMO correction the midpoint variable is invariant; hence, by way of equation ( $5-17 \mathrm{~b}$ ), the first term in the exponential of equation (5-19) drops out. A further approximation, $\ln A_{e}=A_{e}-1$, and use of the definition for $A_{e}$ given by equation (5-18) then lead to the following expression for DMO correction:

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\exp \left[\imath \Omega_{0}\left(\sqrt{1+\frac{h^{2} k_{y}^{2}}{\Omega_{0}^{2}}}-1\right)\right] P_{n}\left(k_{y}, \Omega_{0} ; h\right)
$$

We now outline the steps in dip-moveout correction in the log-stretch domain:

(a) Start with prestack data in midpoint-offset $y-h$ coordinates, $P(y, h, t)$ and apply normal moveout correction using a dip-independent velocity $v$.

(b) Sort the data from moveout-corrected CMP gathers $P_{n}\left(y_{n}, h, t_{n}\right)$ to common-offset sections $P_{n}\left(y_{n}, t_{n} ; h\right)$.

(c) Apply the logarithmic stretch in the time direction based on equation (5-15b) so as to map each common-offset section $P_{n}\left(y_{n}, t_{n} ; h\right)$ in $y_{n}-t_{n}$ coordinates to $P_{n}\left(y_{n}, T_{n} ; h\right)$ in $y_{n}-T_{n}$ cordinates.

(d) Perform 2-D Fourier transform of each commonoffset section in the log-stretch domain.

(e) Apply the phase-shift given by the exponential in equation (5-20) to each common-offset section $P_{n}\left(k_{y}, \Omega_{0} ; h\right)$, and obtain the dip-moveoutcorrected data $P_{0}\left(k_{y}, \Omega_{0} ; h\right)$ in the $\log$-stretch Fourier transform domain.

(f) Perform 2-D inverse Fourier transform to obtain the dip-moveout corrected common-offset section $P_{0}\left(y_{0}, T_{0} ; h\right)$ in the $\log _{0}$ stretch domain.

(g) Undo the logarithmic stretch as in step (c) in the time direction based on equation ( $5-16 a$ ) so as to obtain the dip-moveout-corrected data $P\left(y_{0}, \tau_{0} ; h\right)$.

Figure 5.1-11 shows the impulse responses of a $\log$ stretch DMO operator based on equation (5-20) for $1000 \mathrm{~m}, 2000-\mathrm{m}$ and $3000-\mathrm{m}$ offsets. The impulse responses greatly resemble those of the frequency-wavenumber DMO correction described earlier (Figure 5.16b). Field data examples of DMO correction presented in this chapter mostly have been created using a logstretch algorithm.

## Integral DMO Correction

In Section 4.1, we reviewed the migration process based on Kirchboff summation. Dip-moveout correction also can be formulated as an integration process (Deregowski and Rocca, 1981; Deregowski, 1987; Black et al., 1993). The integral DMO correction is particularly the preferred method for data with irregular spatial sampling and 3-D data with large variations in source-receiver azimuths (Section 7.2).

The traveltime trajectory associated with the dipmoveout correction operator is given by the following equation (Section E.3):

$$
\frac{y_{0}^{2}}{h^{2}}+\frac{\tau_{0}^{2}}{t_{n}^{2}}=1
$$

Equation (5-21) describes an ellipse with the following properties (Figure 5.1-12):

(a) Semi-major axis in midpoint $y_{0}$ direction: $a=h$.

(b) Semi-minor axis in time $\tau_{0}$ direction: $b=t_{n}$

The ellipse of equation (5-21) in the $y_{0}-\tau_{0}$ plane describes the impulse response of a dip-moveout operator applied to nonzero-offset data with offset $2 h$. In Figure 5.1-12, the coordinate of midpoint $M$ is $y_{n}$ and $y_{0}$ coordinate is referenced to $y_{n}$. Note also that the maximum lateral extent of the ellipse the aperture of the DMO operator, is equal to offset $2 h$. Figures 5.1-6b and 5.111 show the DMO ellipses associated with the impulse responses of the frequency-wavenumber and $\log$-stretch DMO operators.

Analogous to the semicircle superposition technique for migration (Section 4.1), DMO correction can be viewed as mapping of an amplitude $A_{0}$ at time $t_{n}$ on a normal-moveout-corrected trace at midpoint $y_{n}$ to an amplitude $A_{1}$ at time $\tau_{0}$ on a trace at midpoint $y_{0}$. The vertical excursion $\Delta t_{D M O}$ and the horizontal excursion $\Delta y_{D M O}$ denoted in Figure 5.1-12 are given by equations $(5-9 a, b)$. If trace spacing in the midpoint direction is $\Delta y_{1}$ then the lateral excursion is $\Delta y_{D M O} / \Delta y$ traces, the maximum excursion being $h / \Delta y$ traces.

While the kinematics of the DMO correction operator is given by equation (5-21), the question remains as to the amplitude and the phase of the operator. Although the method was first described by Deregowski and Rocca (1981), a formal derivation of integral DMO correction with amplitude preserving characteristics is given by Black et al. (1903). Mathematical treatise of the problem is quite involved, and we shall only refer to the results of the analysis.

Rewrite equation (5-21) explicitly in terms of the normal-moveout-corrected time variable $t_{n}$ as

$$
t_{n}=\alpha \tau_{0}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0697.jpg?height=1029&width=629&top_left_y=169&top_left_x=220)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0698.jpg?height=456&width=639&top_left_y=129&top_left_x=199)

where

FIG. 5.1-12. The DMO ellipse. See text for details.

$$
\alpha=\frac{1}{\sqrt{1-\frac{y_{0}^{2}}{h^{2}}}}
$$

and $y_{0} \leq h$. Given the output sample time $\tau_{0}$ on the DMO ellipse, equation (5-22) gives the input sample time $t_{n}$ (Figure 5.1-12). The output sample value $P_{\text {out }}\left(y_{0}, \tau_{0} ; h\right)$ is computed by summing over the input sample values $P_{n n}\left(y_{n}, t_{n} ; h\right)$ over the DMO operator aperture

$$
P_{\text {out }}=\frac{\Delta y}{2 \pi} \sum_{y}\left[\frac{2 \alpha^{2}-1}{h} \sqrt{7_{0}} \rho\left(t_{n}\right) * P_{t n}\right]
$$

where $\Delta y$ is the trace spacing in midpoint direction.

Equation (5-23) is adapted from Black et al. (1993) and is similar to equation (4-5) which describes the Kirchhoff summation. For the 2-D application of DMO correction, the $\rho\left(t_{n}\right)$ filter has an amplitude spectrum of the form $\sqrt{\omega_{n}}$, with $\omega_{n}$ being the temporal frequency associated with the input time variable $t_{n}$, and a phase spectrum equal to $\pi / 4$.

In the integral implementation of DMO correction by Deregowski and Rocca (1981), and Deregowski (1987), the term $\alpha$ is set to unity in equation (5-24). Moreover, in the Liner (1990) and Bleistein (1990) implementation of integral DMO correction, the term $2 \alpha^{2}-1$ in equation (5-24) is replaced with $\alpha^{2}\left(2 \alpha^{2}-1\right)$. Nevertheless, within the context of a conventional processing sequence which includes geometric spreading

correction prior to DMO correction, the amplitude scaling $\left(2 a^{2}-1\right) / h$ described here preserves relative amplitudes. Other DMO amplitude scaling strategies inchde those suggested by Sorin and Ronen (1989), and Gardner and Forel (1990).

In practical implementations of the integral DMO correction, a user-defined aperture commonly is imposed on the operator to avoid aliasing along the steep flanks of the DMO ellipse, especially a.t late times. When the DMO ellipse is truncated before it reaches its fullest lateral extent, anplitude distribution along the elliptic trajectory is adjusted accordingly, such that the amplitude is tapered to zero at the truncation point on the ellipse. Figure 5.1-13 shows the impulse responses of an integral DMO operator based on equation (5-24) for $1000-\mathrm{m}, 2000-\mathrm{m}$, and $3000-\mathrm{m}$ offsets. Compare with the impulse responses in Figure 5.1-11 and note the truncation at steep flanks of the DMO ellipses. The problem of spatial aliasing due to undersampling and the adverse effect of irregular sampling on DMO correction are particularly relevant for $3-D$ data; as such, these issues will be dealt with in Section 7.2.

## Velocity Errors

What happens if the NMO correction that precedes the DMO correction were applied with the wrong velocity?

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0699.jpg?height=1041&width=658&top_left_y=165&top_left_x=188)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0700.jpg?height=514&width=758&top_left_y=134&top_left_x=136)

(C) Common Offset Sections $\mathrm{NMO}_{1}+$ DMO

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0700.jpg?height=129&width=641&top_left_y=642&top_left_x=185)

(d) CMP Gathers $\mathrm{NMO}_{1}+$ DMO

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0700.jpg?height=127&width=643&top_left_y=790&top_left_x=184)

(e) CMP Galhers $\mathrm{NMO}_{1}+\mathrm{DMO}^{2} \mathrm{NMO}_{1}^{-1}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0700.jpg?height=135&width=645&top_left_y=936&top_left_x=180)

FIG. 5.1-14. Intermediate results from DMO processing the nonzero-offset synthetic data derived from the depth model in Figure 5.1-3. See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0701.jpg?height=278&width=805&top_left_y=127&top_left_x=116)

(a)

(b)

(c)

FIG. 5.1-15. (a) Zero-offet section associated with the depth model in Figure 5.1-3; (b) stack derived from the CMP gathers in Figure 5.1-14E; (c) DMO stack derived from the CMP gathers in Figure 5.1-14d.

The DMO process requires an input that is NMO corrected using the medium velocity (equation 5-2). Thus, we try to pick a vertically varying velocity function from the flattest part of the section for NMO correcting the data. The optimum stacking velocities are not used because they depend on dip. However, it is the stacking velocities that are picked from conventional velocity analyses. There is always the possibility that an accurate dip-independent velocity function will not be determined for NMO correcting the input data before DMO correction. The constart-velocity model in Figure 5.1-3 is used to examine this problem.

Assume that the velocity used for NMO correction is 20 percent higher than the velocity that should be used the $3000-\mathrm{m} / \mathrm{s}$ medium velocity. Start with the CMP gathers in Figure 5.1-5b and apply the NMO correction using the incorrect velocity $(3600 \mathrm{~m} / \mathrm{s})$. The results are shown in Figure 5.1-14a. Note the undercorrection at some gathers due to the high velocity used. Follow the DMO processing sequence described earlier. Note that events no longer are aligned after the first NMO and DMO corrections (Figure 5.1-14d). Therefore, the stack obtained from these gathers is not expected to be any better than the conventional stack derived from the gathers in Figure 5.1-14a. The stacked sections are shown in Figure 5.1-15.

Perhaps the CMP stack can be improved by repicking the velocities after DMO correction. To test this idea, consider the following procedure. First, apply inverse NMO correction (Figure 5.1-14e) to the gathers with the velocity function that was used in the first NMO correction step (Figure 5.1-14a). Then, assuming we pick the correct velocity function, use it on the second NMO correction (Figure 5.1-14f). Significant improvement is seen when these gathers are stacked (Figure 5.1-16c). For a fair comparison, refer to the conventional stack with the $3000 \mathrm{~m} / \mathrm{s}$ repicked velocity in Figure 5.1-16b. Although not shown, similar conclusions are reached from tests using velocities that are too low for NMO correction before DMO processing.

## Variable Velocity

The preceding discussion was based on a constantvelocity assumption. To be of practical use, DMO must be applicable to data with velocity gradients. Figure 5.1-17 shows the depth model we will use to investigate DMO correction in the case of vertical velocity variation. The depth model consists of three point scatterers buried beneath the center midpoint (CMP 32) in a medium with a horizontally layered velocity-depth model. Mathematical aspects of the variable-velocity DMO theory is quite involved and we shall only refer to the results of the experiments with the synthetic data associated with the depth model in Figure 5.1-17.

Selected common-offet sections and CMP gathers associated with this subsurface model are shown in Figures 5.1-18 and 5.1-18b. The same processing sequence is followed as that used for the constant-velocity model (Figure 5.1-3). The NMO correction (Figure 5.1-18c) before DMO correction is done using the rms velocity function indicated in Figure 5.1-17. Selected moveoutcorrected common-offset sections are shown in Figure 5.1-19a. We shall apply both constant-velocity DMO correction and variable-velocity DMO correction (Hale

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0702.jpg?height=286&width=827&top_left_y=127&top_left_x=105)

(a)

(b)

(c)

FIG. 5.1-16. (a) Zero-offset section associated with the depth model in Figure 5.1-3; (b) stack derived from the CMP gathers in Figure 5.1-5c; (c) DMO stack derived from the CMP gathers in Figure 5.1-14f.

and Artley, 1992; Artley and Hale, 1994) to these data. The corresponding impulse responses are shown in Figures 5.1-19b,c. Consider the common case of velocities increasing with depth in practice. As noted earlier, the higher the velocity the less the action of the DMO operator. Note that at late times the lateral extent of the impulse response of the variable-velocity DMO operator is less than that of the constant-velocity DMO operator. This is equivalent to modifying the offset value for the common-offet section under consideration - making it smaller than it is so as to decrease the action of the DMO operator.

Results of constant-velocity and variable-velocity DMO corrections are shown in Figures 5.1-20 and 5.121, respectively. Events on the selected $\mathrm{CMP}$ gathers are better flattened with the variable-velocity DMO correction. The corresponding stacked sections accompanied with the zero-offset conventional stacked sections without DMO correction are shown in Figure 5.1-22. The improvement with the depth-variable velocity also is evident on the stacked section (Figure 5.1-22d). Specifically, note that the flanks of the diffaction events are enhanced with the depth-variable velocity, making it resemble much more closely the zero-offset section (Figure 5.1-22a) as compared to the constant-velocity DMO stack (Figure 5.1-22c).

In practice, constant-velocity DMO correction aften yields acceptable results so long as the vertical velocity gradient is reasonably small and does not change rapidly in depth. The constant-velocity DMO correction also has the bonus effect of attenuating coherent linear noise as demonstrated in the next section.

## Thrning-Wave Migration

In an extensional basin, such as the Gulf of Mexico, salt tectonism in its advanced stage can cause the formation of salt diapirs with overhang structures. Consider such a salt structure as sketched in Figure 5.1-23. If velocities in the surrounding sedimentary sequence increase rapidly in depth, downward traveling waves change their direction at some depth and travel upward. When these turning waves, in their upward travel path, encounter a salt overhang, they reflect from the underside of the structure and follow a downgoing path before turning back upward to the surface. The turningwave reflection then gives rise to a dipping event on the stacked section which conflict with the reflections associated with the surrounding gently dipping strata. The concept of imaging turning waves was introduced by Claerbout (1985) and first demonstrated on field data

| CMP <br> pepth, | Interval Velocity, <br> $\mathrm{m} / \mathrm{s}$ | RMS Velocity, <br> n/s | Twomay Time, <br> ms |
| :---: | :---: | :---: | :---: |
| $400-\frac{2000}{}$ | 2000 | 400 |  |
| $650-2500$ | 2190 | 600 |  |
| 950 | 3000 | 2410 | 800 |

FIG. 5.1-17. Depth model of three point scatterers buried in a vertically varying velocity medium. The asterisks indicate the positions of the point scatterers.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0703.jpg?height=560&width=838&top_left_y=136&top_left_x=102)

FIG. 5.1-18. Intermediate results from DMO processing the nonzero-offset synthetic data derived from the depth model in Figure 5 1-17: (a) common-offset sections with offset range from 50 to $1550 \mathrm{~m}$ and an increment of $300 \mathrm{~m}$; (b) CMP gathers sorted from the common-offet sections as in (a) at midpoint locations from 32 to 63 as denoted in Figure 5.1-17 with an increment of 3; (c) the CMP gathers as in (b) after NMO correction and muting.

by Hale et al. (1992). Many examples of turning-wave imaging of salt overhang structures from the Gulf of Mexico are given by Ratcliff et al. (1992).

Dip-moveout correction alone, even if it accounts for vertical velocity variations, does not preserve the turning-wave energy on stacked data. This is because the normal moveout associated with the turning raypaths exhibit an abnormal behavior as sketched in Figure 5.1-23. Consider a reflection point $\mathrm{E}$ that represents all dips on the salt flank. Sketched in Figure 5.1-23 are the zero-offset raypaths for the reflector dip of less than 90 degrees (raypath that emerges at location C), exactly 90 degrees (raypath that emerges at location $B$ ), and greater than 90 degrees (raypath that emerges at location A).

Note that when the CMP raypaths do not have an upward component (location C), the moveout trajectory in the CMP gather exhibits the usual behavior described by the hyperbolic traveltime equation:

$$
t^{2}=t_{0}^{2}+\frac{4 h^{2}}{v_{N M O}^{2}}
$$

where $t$ is the two-way traveltime associated with a source-receiver separation $2 h, t_{0}$ is the two-way zerooffset time, and $v_{N M O}$ is the velocity that best flattens the event after normal-moveout correction.

When, however, the CMP raypaths have an upward component associated with turning waves (location A), the moveout trajectory in the CMP gather exhibits an abnormal behavior which may be described by the traveltime equation (Hale et al., 1992)

$$
t^{2}=t_{0}^{2}-\frac{4 h^{2}}{v_{N M O}^{2}}
$$

Note that the abnormal moveout equation (5-25b) differs from the normal moveout equation (5-25a) by a change in the sign of the moveout term $4 h^{2} / v_{\mathrm{NMO}}^{2}$ -

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0704.jpg?height=539&width=806&top_left_y=130&top_left_x=113)

FIG. 5.1-19. Intermediate results from DMO processing the nonzero-offset synthetic data derived from the depth model in Figure 5.1-17: (a) common-ofset sections with ofset range from 50 to $1550 \mathrm{~m}$ and an increment of $300 \mathrm{~m}$ sorted from the NMO-orrected gathers as in Figure 5,1-4c; (b) impulse responses of the constant-velocity DMO operators applied to the common-oftset gathers; (c) impulse responses of the variable-velocity DMO operators applied to the common-ofiset gathers.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0704.jpg?height=366&width=800&top_left_y=780&top_left_x=114)

FIG. 5.1-20. Intermediate resuits from DMO processing the nonzero-ofset synthetic data derived from the depth model in Figure 5.1-17: (a) common-offset sections as in Figure 5.1-19a after the constant-velocity DMO corection; (b) CMP gathers sorted from the common-ofset sections as in (a) at midpoint locations from 32 to 63 as denoted in Figure 5.1-17 with an increment of 3.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0705.jpg?height=368&width=812&top_left_y=129&top_left_x=112)

FIG. 5.1-21. Intermediate results from DMO processing the nonzero-nfset synthetic data derived from the depth model in Figure 5.1-17: (a) common-offset sections as in Figure 5.1-19a after the variable-velocity DMO corection; (b) CMP gathers sorted from the common-offset sections as in (a) at midpoint locations from 32 to 63 as denoted in Figure 5.1-17 with an increment of 3.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0705.jpg?height=327&width=217&top_left_y=625&top_left_x=82)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0705.jpg?height=326&width=225&top_left_y=624&top_left_x=295)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0705.jpg?height=327&width=214&top_left_y=622&top_left_x=517)

$\mathbf{C}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0705.jpg?height=327&width=225&top_left_y=622&top_left_x=729)

d

FIG. 5.1-22. (a) Zero-ffset section associated with the depth model in Figure 5.1-17; (b) stack derived from the CMP gathers as in Figure 5.1-18c; (c) DMO stack derived from the CMP gathers as in Figure 5.1-20b; (d) DMO stack derived from the CMP gathers as in Figure 5.1-21b.

There can also exist a circumstance where the reflection off the salt flank does not exhibit any moveout (location $B$ in Figure 5.1-23).

To make use of the turning-wave energy in imaging salt overhang structures, we must.

(a) preserve the reflections with abnormal moveout as- sociated with the turning waves during stacking, and

(b) migrate the stacked data using an algorithm that can handle dips beyond 90 degrees.

To derive a stacked section that preserves reflections associated with both normal (nonturning) and

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0706.jpg?height=424&width=490&top_left_y=128&top_left_x=272)

FIG. 5.1-23. Geometry of turning rays in a medium with velocities increasing in depth, and the CMP traveltime trajectories depicted above at three locations, $A, B$, and $C$. At location $A$, the turning raypaths such as $A D E$ causes an abnormal moveout. At location $C$, the raypaths yield a normal moveout, and at location $B$ no moveout is observed on the CMP gather. (Adapted from Hale et al, 1992).

turning waves, consider the stacking process in two parts. First, use equation (5-25a) with positive $v_{N M O}^{2}$ to handle events with normal moveout and derive a stack associated with the normal waves. Second, use equation (5-25a) with negative $v_{N M O}^{2}$ to handle events with ab. normal moveout and derive a stack associated with the turning waves. Finally, add the two sections to obtain the composite-wave stack.

Reflections off the flank of a salt dome, whether they are associated with normal waves or turning waves, and reflections associated with the surrounding sedimentary sequence constitute dipping events with different moveout velocities on a stacked section. As such, DMO correction needs to be applied to data prior to stacking both the normal and turning waves. The DMO operator preferably should account for the strong vertical velocity variations that give rise to turning waves (Hale and Artley, 1992; Artley and Hale, 1994).

Figure 5.1-24 (left column) shows a normal-wave stack, a turning-wave stack, and the composite-wave stack. Note that the normal-wave stack actually contains a significant portion of the turning wave energy represented by the steeply dipping event in the turningwave stack. This is because the turning-wave energy is predominantly of low frequency. Therefore, despite its a.bnormal moveout behavior, nuch of the turning-wave energy is preserved during conventional stacking based on normal moveout.

Note from Figure 5.1-23 that turning waves propagate at angles greater than 90 degrees. This means that turning waves are evanescent waves and need to be imaged using a migration algorithm that can handle dips beyond 90 degrees. Reversetime migration (Brysal et al., 1984) described in Section 4.1 is based on such an algorithm. The field data example shown in Figure 4,322 suggests that the salt dome at its root at about $3 \mathrm{~s}$ has a gentle overhang. This character is not identifiable in the image obtained by an algorithm that only handles waves propagating at less than 90 degrees (Figure 4.4-24).

Kirchhoff migration (Ratcliff et al., 1992) and the phase-shift method (Claerbout, 1985) also can be adapted to image turning waves. To develop the conceptual basis of turning-wave migration, consider the raypath segments $D A$ and $E D$ as denoted in Figure 5.1-23. The raypath segment $D A$ is associated with the upcoming wave energy contained in the normal-wave stack and the raypath segment $E D$ is associated with the downgoing wave energy contained in the turningwave stack (Figure 5.1-24).

Just as the stacking process was treated in two parts, the innaging process also can be treated in
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0707.jpg?height=836&width=794&top_left_y=230&top_left_x=114)

FIG. 5.1-24. Left column: Normal-wave stack (top), turning-wave stack (middle) and composite-wave stack (bottom) created by adding the normal-wave and turning-wave stacks. Right column: Migrations of the sections on the left column. (Hale et al., 1992).
two parts. First, perform phase-shift migration of the normal-wave stack; this involves downward extrapolation of the upcoming wave energy along the raypath $C E$ from the surface $z=0$ to a depth $z_{E}$ where the wave originates (location $E$ in Figure 5.1-23). The equation for the wave extrapolation is (Section D.1):

$$
P\left(k_{y}, z=z_{E}, \omega\right)=P\left(k_{y}, z=0, \omega\right) \exp \left(-i k_{z} z_{E}\right)
$$

where $k_{y}, k_{z}$, and $\omega$ are the Fourier transform variables associated with the coordinate variables for midpoint $y$, depth $z$, and two-way zero-offset traveltime $t_{\mathrm{r}}$ respectively, and $P\left(k_{y}, z=0, \omega\right)$ is the 2-D Fourier transform of the upconing wavefield at the surface $z=0$ represented by the stacked data $P(y, z=0, t)$. The vertical wavenumber $k_{z}$ is defined in terms of the horizontal wavenumber $k_{y}$ and frequency $\omega$ by the dispersion reJation (Section D.1):

$$
k_{z}=\frac{2}{v} \sqrt{\omega^{2}-\frac{v^{2} k_{v}^{2}}{4}}
$$

where $v$ is the medium velocity. In equation (5-27), the region of propagation at angles less than 90 degrees is associated with $\omega>(v / 2)\left|k_{y}\right|$, and the region of evanescense at angles greater than 90 degrees is associated with $\omega<(v / 2)\left|k_{y}\right|$.

Next, perform phase-shift migration of the turningwave stack; this involves downward extrapolation of the upcoming wave energy along the raypath $A D$ from the surface $z=0$ to a depth $z_{D}$ where the wave turns (location $D$ in Figure 5.1-23). The equation for the wave extrapolation is

$$
P\left(k_{y}, z=z_{D}, \omega\right)=P\left(k_{y}, z=0, \omega\right) \exp \left(-\imath k_{z} z_{D}\right)
$$

Since the journey of the turning waves does not end at the turning point $D$, we nust continue with the wave extrapolation until we reach the point where the waves originate on the salt flank (location $E$ in Figure 5.1-23). Hence, perform upward extrapoiation of the downgoing wave energy along the raypath $D E$ from the depth level $z_{D}$ to location $E$ on the sait flank:

$$
P\left(k_{y}, z=z_{E}, \omega\right)=P\left(k_{y}, z=z_{D}, \omega\right) \exp \left[-i k_{z}\left(z_{D}-z_{E}\right)\right],
$$

The wave extrapolations described by equations (5$28 \mathrm{a}, \mathrm{b}$ ) are performed in the transform domain only using the evanescent energy that corresponds to the region $\omega<(v / 2)\left|k_{y}\right|$.

Just as the stacking of normal waves and turning waves is combined to obtain the composite-wave stack (Figure 5.1-24), the migration processes based on the extrapolation equations (5-26) and (5-28a,b) can also be combined (Hale et al., 1992). First, substitute equation (5-28a) into equation (5-28b) to obtain

$$
\begin{aligned}
P\left(k_{y}, z=z_{E}, \omega\right) & =P\left(k_{y}, z=0, \omega\right) \\
& \times\left\{\exp \left[-\imath k_{z} z_{D}-\imath k_{z}\left(z_{D}-z_{E}\right)\right]\right\}
\end{aligned}
$$

Then, combine equations (5-26) and (5-29a) to obtain the exptrapolation equation for the conposite-wave stack:

$$
\begin{aligned}
& P\left(k_{y}, z=z_{E}, \omega\right)=P\left(k_{y}, z=0, \omega\right) \\
& \times\left\{\exp \left(-\imath k_{z} z_{E}\right)+\exp \left[-\imath k_{z}\left(2 z_{D}-z_{E}\right)\right]\right\} \\
& (5-29 b)
\end{aligned}
$$

Based on the concepts described above, we now outline the steps involved in a turning-wave migration algorithm that makes use of the phase-shift method (Claerbout, 1985; Hale et al., 1992). First, consider inaging the normal waves. The process involves downward continution of the upcoming waves from the surface $z=0$ to the maximum specified depth $z_{\text {max }}$ at discrete depth steps $\Delta z$.

(a) Start with the composite-wave stack an approximation to the zero-offset section $P(y, z=0, t)$ and apply 2 -D Fourier transform to get the transformed wavefield $P\left(k_{y}, z=0, \omega\right)$.

(b) For each frequency $\omega>(v / 2)\left|k_{y}\right|$ and $\omega \leq(v / 2)\left|k_{y}\right|$ in the transform domain, extrapolate the wavefield $P\left(k_{y}, z, \omega\right)$ at depth $z$ with a phase-shift operator $\exp \left(-t k_{z} \Delta z\right)$ to get the wavefield $P\left(k_{y}, z+\Delta z, \omega\right)$ at depth $z+\Delta z$. At each depth, a new extrapolation operator with the velocity $v(z)$ defined for that $z$ value is computed.

(c) Split the wavefield $P\left(k_{\nu}, z+\Delta z, \omega\right)$ into its propagating $P_{u}\left(k_{y}, z+\Delta z, \omega\right)$ and evanescent $P_{d}\left(k_{y}, z+\right.$ $\Delta z, \omega)$ components, corresponding to the normal and turning waves, respectively,

(d) Save the wavefield $P_{d}\left(k_{y}, z+\Delta z, \omega\right)$ for use later in turning-wave imaging.

(e) As for any other migration algorithm, invoke the inaging principle $t=0$ upon the wavefield $P_{u}\left(k_{y}, z+\Delta z, w\right)$ at each extrapolation step to obtain the nigrated section from the normal waves $P_{u}\left(k_{y}, z, t=0\right)$ in the transform domain. The imaging condition $t=0$ is met by summing over all frequency components of the extrapolated wavefield at each depth step (equation D-84).

(f) Repeat steps (b) through (d) for all depth steps down to a specified $z=z_{m} a x$ to obtain the normalwave intage in the transform domain $P_{u}\left(k_{y}, z, t=\right.$ $0)$.

(g) Apply inverse Fowier transform in the ruidpoint $y$ direction to obtain the inage $P_{u}(y, z, t=0)$ from the normal waves.

Now consider imaging the turning waves. The process involves upward continuation of the downgoing waves from the maximum specified depth $z_{\max }$ to the surface $z=0$ at discrete depth steps $\Delta z$. At each depth, the downgoing waves are updated by adding the evansecent wave $P_{d}\left(k_{y}, z, \omega\right)$ saved in step (d) during the downward extrapolation of the composite-wave stack. We shall assume that the downgoing wave at $z=z_{\max }$ is null.

(a) Add the evanescent wave saved at depth $z$ to the downgoing wave at the same depth, and for each frequency $\omega \leq(v / 2)\left|k_{y}\right|$ in the evansecent region of the transform domain, extrapolate the new downgoing wave with a phase-shift operator $\exp \left(-i k_{z} \Delta z\right)$ to get the wavefield $P_{d}\left(k_{y}, z-\Delta z, \omega\right)$ at depth $z-\Delta z$.

(b) Invoke the imaging principle $t=0$ upon the wavefield $P_{d}\left(k_{y}, z-\Delta z, \omega\right)$ at each extrapolation step to obtain the migrated section from the turning waves $P_{d}\left(k_{y}, z, t=0\right)$ in the transform domain.

(d) Repeat steps (a) and (b) for all depth steps to obtain the turning-wave image in the transform domain $P_{d}\left(k_{y}, z, t=0\right)$.

(e) Apply inverse Fourier transform in the midpoint $y$ direction to obtain the image $P_{d}(y, z, t=0)$ from the turning waves.

(e) Add the normal-wave image and turning-wave image to obtain the composite-wave image.

As described above, it is important to emphasize that the turning-wave energy can be preserved only by making use of its abnormal moveout behavior during stacking and imaged properly by making use of the evanescent energy during migration.

Figure 5.1-24 (right column) shows migration of a normal-wave stack using the phase-shift equation (528), migration of a turning-wave stack using the phaseshift equation (5-31a), and migration of the compositewave stack using the phase-shift equation (5-31b). Note the distinctively defined salt boundary obtained from imaging the compsite-wave stack.

### 5.2 DIP-MOVEOU'T CORRECTION IN PRACTICE

Results of the previous section suggest the general DMO processing sequence shown in Figure 5.2-1.

(a) Perform velocity analysis at sparse intervals and pick just a few velocity functions with minimal dip effects.

1. Velocity Analysis
2. NMO Correction using Flat-Event Velocities

## 3. DMO Correction

## 4. Inverse NMO Correction with Velocities used in Step 2

5. Velocity Analysis<br>6. NMO Correction using<br>Optimum Stacking Velocities

7. Stacking

8. Migration

FIG. 5.2-1. DMO processing flowchart.

(b) Apply NMO correction using the these flat-event velocities.

(c) Sort data to common-offset sections, apply DMO correction and sort back to CMP gathers.

(d) Apply inverse NMO correction using the flat-event velocities from step (a).

(e) Perform velocity analysis at frequent intervals as needed to derive an optimum stacking velocity field.

(f) Apply NMO correction using the optimum satcking velocity field.

(g) Stack the data and migrate using an edited and appropriately smoothed version of the optimum satcking velocity field.

Note that this processing sequence is similar to the sequence for residual statics corrections described in Figure 3.3-12. Both residual statics and DMO corrections are followed by a revision of velocities so as to get the most out of these corrections during stacking. In this section, we shall apply the sequence outlined above to two common cases of conflicting dips with different stacking velocities - salt flanks and fault planes.

## Salt Flanks

Figure 5.2-2 shows selected CMP gathers along a marine line over a salt structure. CMP gathers 1381 (at 1.5
s), 1461 (at $2.2 \mathrm{~s}$ ), and 170I (at $1.55 \mathrm{~s}$ ) exhibit cases of conflicting dips associated with two events with signifcantly different moveouts.

The DMO processing sequence includes the following steps.

(a) Perform velocity analysis sparsely along the line at locations with prominently flat events and create an initial velocity field.

(b) Apply normal-moveout correction using lat-event velocities. Note the events associated with steep dips have been overcorrected as demonstrated in Figure 5.2-3, whereas reflections with no dip or negligibly small dip have been flattened.

(c) Apply partial stacking to CMP gathers to reduce the fold from 60 to 30 . A partial stack up to a 4:1 reduction in fold usually is acceptable before DMO correction. While fold reduction provides significant computational savings, it must not be done excessively. Following the fold reduction, sort the moveout-corrected gathers (Figure 5.2-3) to common-offet sections and perform dip-moveout correction. Then, sort back to CMP gathers. Compare the selected gathers after DMO correction (Figure 5.2-4) with the same gathers without DMO correction (Figure 5.2-3), and note that the duality in event moveout on CMP gathers 1381 (at 1.5 s), 1461 (at $2.2 \mathrm{~s}$ ), and 1701 (at $1.55 \mathrm{~s}$ ) bas been removed. This is a direct result of the partial migration effect of the DMO correction.

(d) Apply inverse moveout correction (Figure 5.2-5) with the same velocity field that was used for the NMO correction prior to DMO correction (Figure 5.2-3).

(e) Perform velocity analysis at frequent intervals along the line and pick velocity functions which now are supposed to have been corrected for the dip effect. Refer to the velocity analysis at midpoint 1381 shown in Figure 5.2-6. Note the improved velocity trend after DMO correction. Close-up displays of the semblance spectrum and the moveoutcorrected gather before and after DMO correction are shown in Figure 5.2-7 and 5.2-8, respectively. Note the two semblance peaks at $1.5 \mathrm{~g}$ - one at $2050 \mathrm{~m} / \mathrm{s}$ and the other at $2750 \mathrm{~m} / \mathrm{s}$. Because the gather was moveout corrected using the denoted velocity function that includes the $2050 \mathrm{~m} / \mathrm{s}$ peak, the event associated with the $2750-\mathrm{m} / \mathrm{s}$ peak has been overcorrected (Figure 5.2-7). DMO correction has removed the duality in the velocity spectrum at about $1.5 \mathrm{~s}$ and yielded a more distinctive trend (Figure 5.2-8) compared to the spectrum derived from the gather with no $D M O$ correction. The distinctive trend is a direct result of the fact that DMO correction removes reflection-point smearing by mapping reflection points on a dipping reflector associated with nonzero source-receiver separation onto normal-incidence reflection point. The partial migration effect of DMO correction has actually moved the dipping event with the $2750 \mathrm{~m} / \mathrm{s}$ peak to a different midpoint location.

(f) Create a velocity field using the velocity functions picked from the velocity spectra computed from the DMO-corrected gathers (Figure 5.2-9b). This velocity field has more detail than the initial field (Figure 5.2-9a) used for NMO correction prior to DMO correction (step b). This initial velocity field also was used to apply the inverse NMO correction as in step (d).

(g) Apply moveout correction to the DMO-corrected gathers using the velocity field as in Figure 5.29b. Selected CMP gathers are shown in Figure 5.210 , and the corresponding CMP stack is shown in Figure 5.2-11. As a result of DMO correction, the steeply dipping salt-flank reflections have been stacked with as much power as the flat events associated with the surrounding strata. Since a DMO stack is a closer approximation to a zero-offset section in comparison with a CMP stack, time migration of the DMO stack yields an image of the salt diapirs with their flanks clearly delineated, especially between 1-1.5 s (Figure 5.2-12). For comparison, conventional CMP stack and its migration are shown in Figures 5.2-13 and 5.2-14, respectively. Because the reflections of the flanks of the salt diapirs have not been preserved with adequate strength on the CMP stack (Figure 5.2-13), time migration yields a poor definition of the salt boundaries (Figure 5.2-14).

## Fault Planes

Figure 5.2-15 shows selected CMP gathers along a marine line over a structure with fault blocks. CMP gather at midpoint location 1688 (at $2.5 \mathrm{~s}$ ) exhibits a clear case of conflicting dips associated with two events with significantly different moveouts.

The DMO processing sequence includes the following steps.

(a) Perform velocity analysis sparsely along the line at locations with prominently flat events and create an initial velocity field.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0711.jpg?height=873&width=645&top_left_y=249&top_left_x=180)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0712.jpg?height=887&width=711&top_left_y=243&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0713.jpg?height=917&width=692&top_left_y=229&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0714.jpg?height=909&width=720&top_left_y=233&top_left_x=222)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0715.jpg?height=360&width=384&top_left_y=128&top_left_x=145)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0715.jpg?height=357&width=362&top_left_y=128&top_left_x=528)

b

FIG. 5.2-6. Velocity spectrum computed from a CMP gather (a) without, and (b) with DMO correction, as in Figures 5.2-2 and $5.2-5$, respectively.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0715.jpg?height=570&width=462&top_left_y=591&top_left_x=142)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0715.jpg?height=537&width=293&top_left_y=620&top_left_x=602)

b

FIG. 5.2-7. A close-up view of the velocity spectrum shown in Figure 5.2-6a and the associated CMP gather withont DMO correction followed by moveout correction using the velocity function depicted in (a).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0716.jpg?height=588&width=766&top_left_y=132&top_left_x=133)

FIG. 5.2-8. A close-up view of the velocity spectrum shown in Figure 5.2-6b and the associated CMP gather with DMO correction followed by moveout correction using the velocity function depicted in (a).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0716.jpg?height=362&width=376&top_left_y=802&top_left_x=144)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0716.jpg?height=362&width=365&top_left_y=802&top_left_x=525)

b

FIG. 5.2-9. The velocity field used to stack the CMP gathers (a) as in Figure 5.2-3 without DMO corroction, and (b) as in Figure 5.2-5 with DMO currection.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0717.jpg?height=909&width=709&top_left_y=233&top_left_x=159)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0718.jpg?height=1024&width=800&top_left_y=135&top_left_x=79)

FIG. 5.2-11. DMO stack derived from CMP gathers as in Figure 5.2-10. Compare with Figure 5.2-13.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0719.jpg?height=1027&width=810&top_left_y=132&top_left_x=79)

FIG. 5.2-12. Migration of the DMO stack shown in Figure 5 2-11. Compare with Figure 5.2-14.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0720.jpg?height=1028&width=803&top_left_y=134&top_left_x=77)

FIG. 5.2-13. CMP stack derived from CMP gathers as in Figure 5.2-3. Compare with Figure 5.2-11.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0721.jpg?height=1021&width=806&top_left_y=138&top_left_x=81)

FIG. 5.2-14. Migration of the CMP stack shown in Figure 5.2-13. Compare with Figure 5.2-12.
(b) Apply normal-moveout correction using flat-event velocities. Note the event at $2.5 \mathrm{~s}$ on CMP gather 1688 associated with steep fault-plane reflections has been overcorrected as demonstrated in Figure 5.2-16, whereas reflections with no dip or negligibly small dip have been flattened.

(c) Apply partial stacking to CMP gathers to reduce the fold from 60 to 30 , and sort the moveoutcorrected gathers (Figure 5.2-16) to commonoffset sections and perform dip-moveout correction. Then, sort back to CMP gathers and compare the selected gathers after DMO correction (Figure 5.217) with the same gathers without DMO correction (Figure 5.2-16). Note that the overcorrected event at $2.5 \mathrm{~s}$ on CMP gather 1688 has been removed. Again, this is a direct result of the partial migration effect of the DMO correction.

(d) Apply inverse moveout correction (Figure 5.2-18) with the same velocity field that was used for the NMO correction prior to DMO correction (Figure 5.2-16).

(e) Perform velocity analysis at frequent intervals along the line and pick velocity functions which now are supposed to have been corrected for the dip effect. Refer to the velocity analysis at midpoint 1688 shown in Figure 5.2-19. Refer to the velocity spectrum (Figure 5.2-19b) associated with the gather without DMO correction (Figure 5.219a) and note the two semblance peaks at $2.5 \mathrm{~s}-$ one at $2500 \mathrm{~m} / \mathrm{s}$ and the other at $2750 \mathrm{~m} / \mathrm{s}$. The gather was moveout corrected using the denoted velocity function that includes the $2500-\mathrm{m} / \mathrm{s}$ peak, rather than the $2750 \mathrm{~m} / \mathrm{s}$ peak. DMO correction has partially migrated the steeply dipping event to another midpoint location, and as a direct consequence, has removed the duality in the velocity spectrum at $2.5 \mathrm{~s}$ and yielded a more distinctive trend (Figure 5.2-19d) compared to the spectrum derived from the gather with no DMO correction (Figure 5.2-19b).

(f) Create a velocity field using the velocity functions picked from the velocity spectra computed from the DMO-corrected gathers.

(g) Apply moveout correction to DMO-corrected gathers using this velocity field. Selected CMP gathers are shown in Figure 5.2-20 and the corresponding CMP stack is shown in Figure 5.2-21. As a result of DMO correction, the steeply dipping faultplane reflections have been preserved during stacking. Since a DMO stack is a closer approximation to a zero-offset section in comparison with a CMP stack, time migration of the DMO stack yields an image which shows clearly delineated fault blocks in the vicinity of CMP 1688 (Figure 5.2-22). For comparison, conventional CMP stack and its migration are shown in Figures 5.2-23 and 5.2-24, re spectively. Because the fault-plane reflections have not been preserved with adequate strength on the CMP stack (Figure 5.2-23), time migration yields a blurred inage of the fault blocks (Figure 5.2-24).

## DMO and Multiples

Multiples can be enhanced or attenuated by DMO correction. Consider the situation depicted in the velocity spectrum shown in Figure 5.2-25. Suppose you have a flat primary and a flat multiple. After DMO correction, the velocity contrast $\Delta v$ between the primary and the multiple would not change; therefore, DMO correction does not have any impact on the success or failure of a multiple attenuation technique in such a case. A similar situation exists for a dipping primary and a dipping multiple. If you have a dipping primary and a flat multiple a case where the multiple associated with a fat water-bottom interferes with a deeper dipping primary, then, after DMO correction the flat multiple will not be affected. However, the dipping primary will shift to the left on the velocity spectrum, causing a decrease in the velocity contrast between the two events. This suggests that multiple attenuation based on velocity discrimination between primaries and multiples would be less effective on DMO corrected gathers. Finally, the situation would favor multiple attenuation when you have a flat primary conflicting with a dipping multiple.

A field data example is shown in Figure 5.2-26. Note the conflicting primary and multiple events below midpoint 1716 at $1 \mathrm{~s}$ on the section without DMO correction (Figure 5.2-26a). In this case, following DMO correction, the velocity contrast between the primary and multiple event has increased, and thus has led to attenuation of the latter during stacking of the DMOcorrected gathers (Figure 5.2-26b).

The practical question as to whether a multiple attenuation technique should be applied before or after DMO correction is an important one. This question is relevant only for multiple attenuation techniques based on velocity discrimination (Chapter 6). Often, for reasons of efficiency, the multiple attenuation step precedes DMO correction. This is especially the case in processing 3-D data following 3-D DMO correction, data often are stacked concurrently without creating DMOcorrected gathers.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0723.jpg?height=1065&width=817&top_left_y=155&top_left_x=102)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0724.jpg?height=1044&width=808&top_left_y=166&top_left_x=165)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0725.jpg?height=873&width=759&top_left_y=156&top_left_x=135)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0726.jpg?height=1035&width=776&top_left_y=165&top_left_x=136)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0727.jpg?height=872&width=834&top_left_y=232&top_left_x=75)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0728.jpg?height=1050&width=796&top_left_y=160&top_left_x=126)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0729.jpg?height=1078&width=744&top_left_y=146&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0730.jpg?height=1061&width=720&top_left_y=155&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0731.jpg?height=1061&width=745&top_left_y=156&top_left_x=154)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0732.jpg?height=1055&width=723&top_left_y=155&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0733.jpg?height=466&width=396&top_left_y=119&top_left_x=93)

FIG. 5.2-25. A velocity spectrum which indicates a primary event ( $\mathbf{P}$ ) and a multiple event (M) arriving at about the same zero-offset time. The multiple event is associated with a shallow primary. Depending on the flat or dipping character of the primary and multiple reflection, the velocity contrast $\Delta v$ between the two changes after DMO correction (see text for details).

## DMO and Coherent Linear Noise

The constant-velocity assumption underlying the most commonly used DMO algorithms can sometimes attenuate dipping events. This is the case with a shallow dipping event and a deep flat event (Black et al., 1985). If velocity increases with depth (the usual case), then these two events can arrive about the same time and have similar moveouts (Figure 5.2-27). In terms of velocities, this implies that the moveout (or stacking) velocity $v_{1} / \cos \theta$ for the shallow, dipping reflector is approximately equal to the moveout velocity $v_{2}$ associated with the deep, flat reflector. Following the DMO correction, nothing happens to the flat event, while the dipping event shifts to a lower velocity value $v_{1}$. The dipping event, that may be associated with coherent linear noise, drifts away from the velocity function for flat events and thus is attenmated during stacking.

This characteristic response of DMO can be used to our advantage in attenuating coherent linear noise associated with shallow point scatterers in the water bottom. A field data example is shown in Figure 5.2-28.
While the diffactions associated with the steep flanks of the salt diapir are better preserved by DMO correction, the steep coherent linear noise is attenuated by this process.

## Other Considerations

Dip-moveout correction is most effective at shallow times where velocities usually are low. Figure 5.2-29 shows a shallow portion of a CMP stack with and without DMO correction. Note that DMO correction has preserved the diffractions associated with the fault blocks and the fault-plane reflections. As a result, migration then has better imaged the subtle faults in the subsurface.

Albeit dip-moveout correction becomes relatively less significant at late times just the opposite situation with migration, it can still produce a better stack than conventional CMP stacking. Figure 5.2-30 shows a moderately deep portion of a CMP stack with and without DMO correction. DMO correction has visibly enhanced the deep reflections and diffractions. Migrated sections (Figure 5.2-31) exhibit comparable imaging of the dipping events and the unconformity which envelopes these events from below. On the other hand, the crispness of the image from DMO stack (Figure 5.2-31b) also is noticeable.

The response of DMO correction to random noise is examined in Figure 5.2-32. Typically, random noise is more prominent at late times. Since DMO correction becomes increasingly less effective at late times, it may be concluded that it hes minimal impact on random noise. On the other hand, random noise at shallow times may seemingly be attenuated by DMO correction. This action of the DMO process can be attributed to the fact that it is a migration process involving spreading of amplitudes along elliptical trajectories. Nevertheless, DMO correction should not be viewed and used as a process to attenuate noise.

DMO correction becomes insignificant in a medium with high velocities. Figure 5.2-33 shows a CMP stack with and without DMO correction. Velocities vary from $4000 \mathrm{~m} / \mathrm{s}$ at the surface to $6000 \mathrm{~m} / \mathrm{s}$ at the bottom of the section. Note that, diffractions and nearly flat. reflections with conflicting dips appear to stack equally, with or without DMO correction. A way to distinguish between the two sections is the relative attenuation of the shallow coherent linear noise by DMO correction.

DMO correction must always be considered within the framework of time migration. Specifically, DMO correction is not meant to solve the problem of nonhyperbolic moveout of reflections below complex overburden structures which often are accompanied with strong
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0734.jpg?height=1010&width=554&top_left_y=132&top_left_x=239)

FIG. 5.2-26. A portion of CMP stack, (a) without, and (b) with DMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0735.jpg?height=404&width=767&top_left_y=126&top_left_x=135)

FIG. 5.2-27. Response of DMO correction to a deep flat reflector (F) and a shallow dipping reflector (D). See text for details.

lateral velocity variations. While it is not expected to solve this problem, fortuitously, DMO correction may not harm such events. The base-salt event in Figure 5.2-28 exemplifies this observation. Note that, the two diffraction-like segments of the base-salt event below midpoint 1116 between $1.8-2 \mathrm{~s}$ does not appear to be influenced by DMO correction.

For land data, DMO correction can be applied before statics corrections. Specifically, land data processing sequence that includes DMO correction is as follows:

(a) Estimate a model for the near-surface layer using refracted arrivals. The model parameters include the shape of the refractor (base of the weathering layer) and the bedrock velocity.

(b) Assume a value for the weathering velocity and use the near-surface layer to apply the shot and receiver refraction statics (Section 3.4) so as to replace the near-surface layer with the bedrock and move the shots and receivers from the topographic surface to a floating datum, which is a smoothed version of the surface topography.

(c) Perform preliminary velocity analysis and apply moveout corrections.

(d) Apply datum corrections to move the shots and receivers from the floating datum to a flat datum to which the CMP stack is referenced.

(e) Apply DMO correction.

(f) Estimate surface-consistent shot and receiver residual static shifts using methods described in Section 3.3 . (g) Apply residual statics corrections to CMP gathers.

(h) Apply the inverse of step (d) to move the shots and receivers from the flat reference datum back to the floating datum.

(i) Apply inverse moveout correction using velocities from step (c).

(j) Perform velocity analysis and apply roveout correction.

(k) Apply datum corrections to move the shots and receivers from the floating datum to the reference flat datum as in step (d).

(l) Apply mute and stack the data. The stacked section is referenced to the flat datum level specified in step (d).

The above sequence enables performing velocity antalysis after statics and DMO corrections so as to obtain an improved velocity field for the subsequent stacking and migration.

Can DMO be used for trace interpolation? Consider the constant-velocity synthetic data set associated with the earth model shown in Figure 5.1-3. Throw away every other trace on each of the common-ofiset sections and simulate a coarser trace spacing (Figure 5.2-34b). The selected CMP gathers shown in Figure 5.2-34a also exhibit the discarded traces replaced with zero traces. Apply DMO correction to all of the common-offset sections (Figure 5.2-34c) and sort back to CMP gathers (Figure 5.2-34d). Note that on the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0736.jpg?height=1016&width=626&top_left_y=126&top_left_x=208)

(b)

FIG. 5.2-28. A portion of a CMP stack, (a) without, and (b) with DMO correction. Note the attenuation of coherent linear noise by DMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0737.jpg?height=1056&width=903&top_left_y=157&top_left_x=72)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0738.jpg?height=463&width=406&top_left_y=130&top_left_x=125)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0738.jpg?height=458&width=385&top_left_y=135&top_left_x=527)

(b)

FIG. 5.2-30. A moderately deep portion of CMP stack, (a) without DMO correction, and (b) with DMO correction. Migrated sections are shown in Figure 5.2-31.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0738.jpg?height=472&width=404&top_left_y=690&top_left_x=126)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0738.jpg?height=470&width=385&top_left_y=691&top_left_x=527)

(b)

FIG. 5.2-31. Migrated sections, (a) without DMO correction, and (b) with DMO correction. Stacked sections input to migration are shown in Figure 5.2-30.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0739.jpg?height=785&width=840&top_left_y=134&top_left_x=101)

FIG. 5.2-32. A deep portion of a CMP stack, (a) without DMO correction, and (b) with DMO correction.

common-offset sections, the zero traces are filled in at large offsets by DMO correction, whereas they are not quite filled in at small offsets. So, the amplitude distribution after DMO correction will not be uniform from one common-offset section to another. Note also the aliased energy on the CMP gathers. Stack the DMO-corrected gathers and compare the resulting section with the desired zero-offset section (Figure 5.2-35). These data have not been subjected to any gain treatment after stack; hence, the relative amplitudes have been preserved. The amplitude imbalance in the DMO stack from the gathers with missing traces is quite apparent (Figure 5.2-35c).

## Aspects of DMO Correction - A Summary

We discussed the principles of DMO correction and studied its practical aspects using synthetic and field data. It now is appropriate to compile aspects of DMO correction.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0740.jpg?height=1064&width=786&top_left_y=127&top_left_x=80)

FIG. 5.2-33. A portion of a CMP stack, (a) without DMO correction, and (b) with DMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0741.jpg?height=156&width=810&top_left_y=131&top_left_x=83)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0741.jpg?height=154&width=862&top_left_y=320&top_left_x=90)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0741.jpg?height=155&width=869&top_left_y=520&top_left_x=84)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0741.jpg?height=153&width=780&top_left_y=696&top_left_x=90)

(d)

FIG. 5.2-34. (a) Selected moveout-corrected CMP gathers associated with the earth model of point scatteres depicted in Figure 5.1-3, with amplitudes on every other trace zeroed out; (b) selected common-offset sections; (c) same common-offset sections after DMO correction; (d) selected gathers as in (a) after DMO correction.

(a) The process of dip-moveout corrects for the dip effect on stacking velocities.

(b) Thus, it preserves conflicting dips with different stacking velocities during CMP stacking.

(c) The DMO stack, therefore, is a closer representation of a zero-offset section as compared to a conventional CMP stack based on normal-moveout correction, only.

(d) The DMO stack can then be migrated using a zerooffset migration algorithm with greater accuracy.

(e) Conflicting dips with different stacking velocities give rise to multivalued velocity picks from velocity spectra. Velocity analysis of DMO-corrected data alleviates this problem and increases the accuracy of picking an unambiguous velocity function from a velocity spectrum.

(f) Velocities estimated from DMO-corrected data are dip independent; therefore, they are more suitable to derive a migration velucity field as compared to velocities estimated from data without DMO correction.

(g) Dip-moveout correction actually is a process of partial migration before stack. Specifically, it maps normal-moveout-corrected data to normal-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0742.jpg?height=261&width=253&top_left_y=129&top_left_x=117)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0742.jpg?height=256&width=248&top_left_y=134&top_left_x=397)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0742.jpg?height=257&width=253&top_left_y=135&top_left_x=678)

(c)

FIG. 5.2-35. (a) Zera-offset section associated with the earth model of point scatteres depicted in Figure 5.1-3; (b) the DMO stack same as in figure $5.1-7 \mathrm{c}$ from the gathers as in Figure 5.1-6d without missing alternate traces; (c) the DMO stack from the gathers with missing alternate traces as in Figure 5 2-34d.

incidence reflection points in the subsurface. As a result, midpoint coordinate is variant under DMO correction.

(h) As a direct consequence of aspect (g), DMO correction removes the reflection point dispersal associated with nonzero-offset recording in the presence of dipping reflectors.

(i) Following DMO correction, prestack data can be migrated so as to create CMP gathers in their migrated position (next section). This then enables us to conduct velocity analysis to derive a migration velocity field with greater confidence.

(j) Finally, the CMP gathers from prestack time migration of DMO-corrected data can be used for amplitude variation with offset analysis.

In this chapter, we discussed the dip-moveout process within the context of 2-D seismic data. Threedimensional aspects of DMO correction are discussed in Section 7.2 .

### 5.3 PRESTACK TIME MIGRATION

As stated early in the chapter, the rigorous solution to the problem of conflicting dips with different stacking velocities is prestack time migration. The robust alternative in practice is to apply $\mathrm{NMO}$ and DMO corrections followed by poststack time migration. The migration step can, however, be moved up to precede CMP stacking. Specifically, by migrating each of the NMOand DMO-corrected common-offset sections, one has the opportunity to update the velocity field and generate CMP gathers which can be used for analysis of amplitude variation with offset as well as to obtain an improved migrated stack.

We now review the kinematics of prestack time migration. The theory of extrapolation of nonzerooffset wavefields is provided in Section D.1, while the stationary-phase traveltime trajectory associated with nonzero-offset wave propagation is given in Section E.5. Figure E-2 shows a sketch of a nonzero-offset raypath in a constant-velocity medium from a source location $S$ to a reflection point $R$ and to a receiver location $G$. The traveltime equation associated with the raypath $S R G$ is given by (Section E.5)

$$
v t=\sqrt{x^{2}+(y+h)^{2}}+\sqrt{z^{2}+(y-h)^{2}}
$$

where $v$ is the medium velocity, $t$ is the total traveltime from $S$ to $R$ to $G$. The medium is represented by the midpoint $y$ and depth $z$ coordinates.

Equation (5-32) can be put into the following alternative form (Section E.5):

$$
\frac{y^{2}}{(v t / 2)^{2}}+\frac{z^{2}}{(v t / 2)^{2}-\bar{h}^{2}}=1
$$

which represents an ellipse in the $y-z$ plane for a constant $t$ with the following parameters:

(a) Semi-major axis in midpoint $y$ direction: $a=v t / 2$.

(b) Semi-minor axis in depth $z$ direction: $b=$ $\sqrt{(v t / 2)^{2}-h^{2}}$

(c) Distance from center to either focus: $\sqrt{a^{2}-b^{2}}=h$.

(d) Distance from one focus to a point on the ellipse to the other focus: $v t$.

From its properties, note that this ellipse in the $y-$ $z$ plane can be associated with a recording geometry
for a source-recejver pair which is situated at the foci with a separation equal to the offset $2 h$ (Figure E-2). The ellipse itself describes the geometry of a reflecting interface such that the reflections recorded by a sourcereceiver pair situated at the foci have the same arrival time $t$. This means that the nonzero-offset traveltime section from such a recording would contain traces with zero amplitudes, except for one sample at time $t$ on the trace at a midpoint location that coincides with the center of the ellipse. Hence, the ellipse of equation (533) in the $y-z$ plane describes the impulse response of a prestack migration operator applied to nonzero-offset data.

Equation (5-32) describes the nonzero-offset traveltime trajectory in the $y-t$ plane for a constant $z$ associated with a point scatterer. Figure D-5 (Section D.1) shows the elliptic wayefront in the $y-z$ plane equivalent to the elliptic reflector geometry described here, and the table-top traveltime trajectory in the $y-t$ plane.

When equation (5-33) is specialized to the zerooffset case, $h=0$, we obtain

$$
\frac{y^{2}}{(v t / 2)^{2}}+\frac{z^{2}}{(v t / 2)^{2}}=1
$$

which describes a circle in the $y-z$ plane for a constant $t$ with a radius $u t / 2$. This circle represents the impulse response of a poststack migration operator applied to zero-offset data.

When equation (5-32) is specialized to the zerooffset case, $h=0$, we obtain

$$
v t=2 \sqrt{y^{2}+z^{2}}
$$

which describes the well-known diffraction hyperbola in the $y-t$ plane for a constant $z$. Figure D-6 (Appendix D) shows the circular wavefront in the $y-z$ plane equivalent to the circular reflector geometry described here, and the zero-ofset hyperbolic traveltime trajectory in the $y-t$ plane.

In Section 4.1, we discussed semicircle superposition and diffraction summation concepts for zero-offset migration using equations (5-34a) and (5-34b), respectively. Specifically, zero-ofset migration can be conceptualized as spreading of amplitudes on each input stacked trace on the $y-t$ plane along semicircular trajectories on the $y-z$ plane of the migrated section. Alternatively, for a given output sample of a trace on the $z-t$ plane of the migrated section, amplitudes along the hyperbolic trajectory on the $y-t$ plane of the input stacked section can be summed and placed on that output sample location. The Kirch hoff summation technique for migration incorporates to the process of diffraction summation the amplitude and phase factors described in Section 4.1.

Similarly, prestack time migration can be conceptualized either by way of semi-elliptical superposition using equation (5-33) or diffraction summation over the traveltime surface described by equation (5-32). The traveltime surface, which is shown in Figure 5.3-1a, is known as Cheops' pyramid (Claerbout, 1985). The result of summation of amplitudes over the pyramidal surface is placed at its apex. The question that is of practical importance is how to define the summation paths over this surface.

To consider alternative methods of summation, refer to the traveltime equation (5-32) that describes the pyramidal surface in Figure 5.3-1a, and, first, make the change of variables from depth $z$ to event time $\tau$ in the migrated position by using the relation $z=v \tau / 2$, then rewrite this equation in terms of the event position after migration, which is the lateral coordinate $y_{m}$ of the apex of the pyramid

$$
t=\sqrt{\frac{\tau^{2}}{4}+\frac{\left(y-y_{m}+h\right)^{2}}{v^{2}}}+\sqrt{\frac{\tau^{2}}{4}+\frac{\left(y-y_{m}-h\right)^{2}}{v^{2}}} .
$$

Hence, within the context of equation (5-35), the summation involves mapping amplitude at a point on the pyramidal surface with coordinates $(y, h, t)$ to the apex with coordinates $\left(y_{m}, h=0, \tau\right)$.

Whatever the summation strategy, it may not be desirable to map the amplitudes on the pyramidal surface directly onto the apex of the pyramid. Instead, it is desirable first to collapse the pyramidal surface described by equation (5-35) to a traveltime curve that passes through the apex of the pyramid at $y=y_{m} \mathrm{de}-$ scribed by

$$
t=\sqrt{\tau^{2}+\frac{4 h^{2}}{v^{2}}}
$$

As a result, amplitude at a point on the pyramidal surface with coordinates $(y, h, t)$ is mapped onto a point with coordinates $\left(y_{m}, h, \sqrt{\tau^{2}+4 h^{2} / v^{2}}\right)$ on the hyperbolic curve of equation (5-36). Now, you have the opportunity to perform velocity analysis using equation (5-36) and refine the velocity field used in the first summation step. The second step in the summation involves applying NMO correction using equation (5-36), stacking the amplitudes along the offset axis, and placing the result at the apex of the hyperbola of equation (5-36) at time $\tau$ and offset $h=0$. This apex coincides with the apex of the pyramidal surface with coordinates $\left(y_{m}, h=0, \tau\right)$.

The two most obvious choices of summation paths to collapse the pyramidal surface of equation (5-35) to the hyperbolic curve of equation (5-36) are described below:

(a) Summation curves of constant offet: Consider a set of vertical cross-sections of the traveltime pyra-
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0744.jpg?height=820&width=406&top_left_y=128&top_left_x=80)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0744.jpg?height=834&width=440&top_left_y=138&top_left_x=516)

FIG. 5.3-1. Left column (adapted from Fowler, 1997): The nonzero-ofiset traveltime surface associated with a point scat terer and the various summation trajectories for prestack time migration. Right column: The nonzero-ofset traveltime surfaces as in the left column after DMO correction. See text for details.

mid illustrated in Figure 5.3-1a parallel to the midpoint axis as illustrated in Figure 5.3-1b. Sum the amplitudes along each of the constant-offset tabletop traveltime curves, independently, and place the result for each at the apex $A_{h}$ of the summation curve with coordinates $\left(y_{m}, h, \sqrt{\tau^{2}+4 h^{2} / v^{2}}\right)$. The summation collapses the pyramidal surface onto the hyperbolic traveltime curve of equation (5-36), which is formed by combining the apex points $A_{h}$ of the constant-offset curves. This hyperbolic traveltime curve is orthogonal to the constant-offset summation curves.

(b) Summation curves of constant tzme: Consider a set of horizontal cross-sections of the traveltime pyramid as illustrated in Figure 5.3-1c (Bancroft and Geiger, 1994; Bancroft et al., 1997). Sum
the amplitudes along each of the constant-time curves, independently, and place the result for each at $A_{h}$ on the summation curve with coordinates $\left(y_{m}, h, \sqrt{\tau^{2}+4 h^{2} / v^{2}}\right)$. The summation collapses the pyramidal surface onto the hyperbolic traveltime curve of equation (5-36), which is formed by combining the points $A_{h}$ of the constant-time curves. This hyperbolic traveltime curve is orthogonal to the constant-time summation curves.

The pyramidal surface described by equation (535 ) is converted by DMO correction to a hyperboloid of revolution as illustrated in Figure 5.3-1d and described by the following equation (Gardner et al., 1986):

$$
t=\sqrt{\tau^{2}+\frac{4\left(y-y_{m}\right)^{2}}{v^{2}}+\frac{4 h^{2}}{v^{2}}}
$$

As for equation (5-35), within the context of equation $(5-37)$, the summation required by prestack time migration involves mapping amplitude at a point on the hyperboloidal surface with coordinates $(y, h, t)$ to the apex with coordinates $\left(y_{m}, h=0, \tau\right)$.

Again, it is desirable first to collapse the hyperboloidal surface described by equation (5-37) to a traveltime curve that passes through the apex of the hyperboloid at $y=y_{m}$ described by equation (5-36). As a result, amplitude at a point on the hyperbolodial surface with coordinates $(y, h, t)$ is mapped onto e point with coordinates $\left(y_{m}, h, \sqrt{\tau^{2}+4 h^{2} / v^{2}}\right)$ on the hyperbolic curve of equation (5-36). As for the pyramidal surface, the second step in the summation involves applying NMO correction, stacking the amplitudes along the offset axis, and placing the result at the apex of the hyperbola of equation (5-36) at time $\tau$ and offset $h=0$. This apex coincides with the apex of the hyperboloidal surface with coordinates $\left(y_{m}, h=0, \tau\right)$.

For constant offset $h$, rewrite equation (5-37) in the following form:

$$
\frac{t^{2}}{\tau^{2}+4 h^{2} / v^{2}}-\frac{\left(y-y_{r n}\right)^{2}}{h^{2}+v^{2} \tau^{2} / 4}=1
$$

Note that, as a result of the transformation from the pyramidal surface to the hyperboloidal surface, the table-top summation curves at constant offset are transformed to hyperbolic curves described by equation (538).

For constant time $t$, rewrite equation (5-37) in the foilowing form:

$$
\left(y-y_{\pi}\right)^{2}+h^{2}=\frac{v^{2}}{4}\left(t^{2}-\tau^{2}\right)
$$

Note that the constant-time curves of the pyramidal surface are transformed to circles described by equation (5-39).
So, for the constant-offset and constant-time summation techniques described above, we may consider substituting the pyramidal surface with the hyperboloidal surface in the following manner:

(a) Summation curves of constant offset: Consider a set of vertical cross-sections of the traveltime hyperboloid parallel to the midpoint axis. Sum the amplitudes along each of the constant-offset hyperbolic traveltime curves of equation (5-38) as illustrated in Figure 5.3-1e, independently, and place the result for each at the apex $A_{h}$ of the summation curve with coordinates $\left(y_{m}, h, \sqrt{\tau^{2}+4 h^{2} / v^{2}}\right.$ ). The summation collapses the hyperboloidal surface onto the hyperbolic traveltime curve of equation (536), which is formed by combining the apex points $A_{h}$ of the constant-offet curves. This hyperbolic traveltime curve is orthogonal to the constantoffset summation curves.

(b) Summation curves of constant tome: Consider a set of horizontal cross-sections of the traveltime hyperboloid (Gardner et al., 1986). Sum the amplitudes along each of the constent-time circles of equation (5-39) as illustrated in Figure 5.3-1f, independently, and place the result for each at $A_{h}$ on the summa tion curve with coordinates $\left(y_{m}, h,(v / 2) \sqrt{t^{2}-\tau^{2}}\right)$. The summation collapses the hyperboloidal surface onto the hyperbolic traveltime curve of equation (536), which is formed by combining the points $A_{h}$ of the constant-time circles. This hyperbolic traveltime curve is orthogonal to the constant-time summation curves.

## DMO Correction and Common-Offset Migration

As stated earlier, a desired workfiow for prestack time migration incorporates a step for updating the initial velocity field that was used to migrate the data. Specifically, we want to create common-reflection-point (CRP) gathers from prestack time migration and use them to perform conventional velocity aualysis based on the hyperbolic moveout assumption. Finally, we can apply normal-moveout correction to the CRP gathers using the updated velocity field and stack them along to obtain the prestack time-migrated section.

In this section, we shall follow a most popular sequence for prestack time migration based on a practical variation of the constant-offset summation technique described above (Marcoux et al., 1987).

(a) Perform velocity analysis at sparse intervals and pick just a few velocity functions with minimal dip effects.
(b) Apply NMO correction using these flat-event velocities.

(c) Sort data to common-offset sections and apply DMO correction.

(d) Migrate each of the common-offset sections using your favorite zero-offset migration algorithm (Chapter 4) and the velocity field based on the flatevent velocity picks from step (a).

(e) Sort the migrated common-offset data back to CMP gathers, and apply inverse NMO correction using the flat-event velocities from step (a).

(f) Perform velocity analysis at frequent intervals as needed to derive an optinum stacking velocity field.

(g) Apply NMO correction using the optimum stacking velocity field.

(h) Stack the data and perform inverse migration (equivalent to 2-D zero-offset wavefield modeling) using the velocity field from step (d).

(i) Finally, remigrate the result from step (h) using the updated velocity field from step (f).

This sequence differs from the constant-offset summation procedure for prestack time migration (Figure 5.31e) in one respect, only. In case of the latter, step (e) precedes step (d). Although this is more plausable, in practice, the two procedures yield comparable results.

Consider a zero-offset section that contains a set of pulses at $500-\mathrm{ms}$ intervals placed on the center trace as shown in Figure 5.3-2a (left column). Now, assume that this same section represents a common-offset section with $1000-\mathrm{m}$ offset. Apply DMO correction to this section to obtain the section in Figure (5.3-2b, left column). Repeat the same exercise by labeling the input section with pulses (Figure 5.3-2a, left column) as a common-offset section with $2000 \mathrm{~m}$ offset and apply DMO correction to get the section in Figure 5.3-2c (left column). Repeat this exercise once more with an offet value of $3000 \mathrm{~m}$ to get the section in Figure 5.3-2d (left column). The DMO-corrected common-offet sections shown on the left column of Figure 5.3-2 represent the DMO impulse responses for zero-offset, $1000-\mathrm{m}, 2000-\mathrm{m}$ and $3000-\mathrm{m}$ offset cases.

Following the sequence described above, now, treat each of the DMO-corrected sections on the left column in Figure 5.3-2 as zero-offset sections and migrate them using a zero-offset constant-velocity algorithm. Results are shown on the right, column of Figure 5.3-2. Migration of the section in Figure 5.3-2a (left column) yields a set of concentric circles (right column). This migrated section represents the zero-offset migration impulse response, and its circular trajectories are defined by equation (5-34a). Migrations of the sections in Figure 5.3$2 \mathrm{~b}, \mathrm{c}$, (left column) yield a set of elliptical trajectories (right column). These migrated sections represent the nonzero-offset (prestack) migration impulse responses, and their elliptical trajectories are defined by equation (5-33).

Once again, consider the section in Figure 5.3-2a (left column) as a common-offset section with assigned offsets values of $0,1000,2000$, and $3000 \mathrm{~m}$. If we were to have migrated each of these common-offset sections directly using a prestack migration algorithm in lieu of first applying DMO correction then migrating using a zero-offset rigration algorithm, we would have obtained the same results as those shown in Figure 5.3-2 (right column). Figure 5.3-3 shows the DMO impulse responses on the left column of Figure 5.3-2 superimposed on the migration impulse responses on the right column of the same figure. For the zero-offset case (Figure 5.3-3a), the DMO impulse response has zero aperture, while for the nonzero-offset case the lateral excursion of the DMO impulse response increases with offset and at shallow times. But, the lateral excursion of the DMO impulse response always is much less than that of the migration impulse response.

This experiment demonstrates that zero-offset migration of DMO-corrected common-offset data is equivalent to prestack migration of nonzero-offet data. Of course, this equivalence is largely valid only within the bounds of velocity variations judged to be acceptable for time migration. In this section, we shall apply the sequence outlined above to two common cases of conflicting dips with different stacking velocities - salt flanks and fauit planes.

## Salt Flanks

DMO correction maps moveout-corrected commonoffset data to zero-offset. As a direct result of this aspect of DMO correction, the process decouples commonoffset sections, thus enabling treatment of each of the common-offset sections, independently. A DMOcorrected common-offset section can be considered a replica of a zero-offset section, and therefore, can be migrated using a method applicable to zero-offset wavefield.

(a) Starting with input prestack data in midpoint, offset and two-way event time in the unmigrated position, apply NMO correction using flat-event velocities. These are picked from velocity spectra computed sparsely along the line. Figure 5.3-4 shows

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0747.jpg?height=1004&width=699&top_left_y=128&top_left_x=169)

FIG. 5.3-2. Left column: Impulse response of a frequency-wavenumber dip-moveout operator with source-receiver offsets (a) $0 \mathrm{~m}_{7}$ (b) $1000 \mathrm{~m}$, (c) $2000 \mathrm{~m}$, and (d) $3000 \mathrm{~m}$. Right column: Zero-offset migrations of the sections in the left column. These sections are equivalent to the results one would obtain from presatck migrations of common-offset sections with source-receiver offsets (a) $0 \mathrm{~m}_{1}$ (b) $1000 \mathrm{~m}$, (c) $2000 \mathrm{~m}$, and (d) $3000 \mathrm{~m}$, hence can be considered as impulse response of a prestack time migration algorithm.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0748.jpg?height=1041&width=553&top_left_y=125&top_left_x=250)

FIG. 5.3-3. The impulse response of a dip-moveout operator (left column in Figure 5.3-2) and prestack time migration operator (right column in Figure 5.3-2) superimposed. The source-receiver offsets for the input common-offet sections are (a) $0 \mathrm{~m}$, (b) $1000 \mathrm{~m}$, (c) $2000 \mathrm{~m}$, and (d) $3000 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0749.jpg?height=1060&width=658&top_left_y=158&top_left_x=200)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0750.jpg?height=1033&width=661&top_left_y=169&top_left_x=188)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0751.jpg?height=1050&width=662&top_left_y=164&top_left_x=174)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0752.jpg?height=901&width=681&top_left_y=237&top_left_x=178)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0753.jpg?height=902&width=689&top_left_y=233&top_left_x=169)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0754.jpg?height=885&width=529&top_left_y=243&top_left_x=243)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0755.jpg?height=905&width=630&top_left_y=234&top_left_x=165)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0756.jpg?height=1024&width=802&top_left_y=136&top_left_x=79)

FIG. 5.3-11. Stack of the gathers as in Figure 5.3-10.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0757.jpg?height=1025&width=807&top_left_y=133&top_left_x=74)

FIG. 5.3-12. Inverse migration of the stack shown in Figure 5311 using the velocity field shown in Figure 5 2-9b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0758.jpg?height=1027&width=808&top_left_y=136&top_left_x=80)

FIG. 5.3-13. Migration of the stack shown in Figure 5.3-12 using the velocity field shown in Figure 5.3-9b.
three common-offset sections associated with the data as in Figure $5.2-3$ with offsets $78.5 \mathrm{~m}, 1078.5$ $\mathrm{m}$, and $2078.5 \mathrm{~m}$, following NMO correction.

(b) Apply DMO correction to each common-offset section (Figure 5.3-5).

(c) Following DMO correction, each common-offset section is assumed to be a replica of zero-offset section, and thus, can be migrated using a zero-offet migration algorithm. How could these commonoffset sections be migrated before we even know migration velocities? The conjecture is that a smoothed stacking velocity field (Figure 5.2-9a) can be used to perform the migrations of commonoffset data. As a result, events will be moved spatially to locations that are between their unmigrated and correctly migrated positions, but fairly close to the latter. Figure 5.3-6 shows three selected common-offset sections as in Figure 5.3-5 after migration.

(d) Sort the migrated common-offset sections into CMP gathers (Figure 5.3-7). Events on these gathers are now assumingly close to correct subsurface positions after migration. Note the presence of residual moveout on some events, which suggest errors in the velocity field used for migration.

(e) Apply inverse NMO correction and perform velocity analysis. Although event positioning in the spatial sense will not be affected by this velocity analysis, use of updated velocities will improve the stacking of the CMP gathers after migration. Figure 5.3-8 shows selected CMP gathers as in Figure 5.3-7 after inverse moveout correction, and Figure 5.3-9b shows the migration velocity field derived from the analysis of such gathers. For comparison, the DMO velocity field using the DMO-corrected gathers as in Figure 5.2-5 is shown in Figure 5.3-9a.

(f) Apply NMO correction (Figure 5.3-10) using the migration velocity field (Figure 5.3-9b) and stack the migrated data (Figure 5.3-11). Keep in mind that migration actually has been done using an initial estimate for the velocity field (Figure 5.2-9a).

(g) To obtain the migrated section with the updated velocity field (Figure 5.3-9b), we can follow two alternative approaches. First, compute the residual velocity field (Section D.8) from the initial (Figure 5.2-9a) and updated (Figure 5.3-9b) velocity fields, and use it to perform residual migration (Section 4.5) for which the input is the stacked section from step (f). The residual migration is acceptable provided the initial velocity field varies vertically, only, and the vertical variation in velocity is expressed with moderate gradients. The second approach involves first simulation of an unmigrated stacked section by forward modeling (inverse migration) of the migrated section obtained in step (f) (Figure
5.3-11) using the initial velocity field (Figure 5.29a). The modeled section is shown in Figure 5.312 and may be treated as equivalent to the unmigrated stacked section. The next step involves migrating the modeled section using the updated velocity field (Figure 5.3-9b). The final result of prestack time migration sequence described above is shown in Figure 5.3-13.

## Fault Planes

Figure 5.3-14 shows a portion of a conventional CMP stack without DMO correction. Steeply dipping events represent diffractions and fault-plane reflections. Because no DMO correction has bcen applied, these events have not been preserved with as much strength as the gently dipping reflections. As a result, migration of this conventional CMP stack yields an inadequate definition of the intensive fault pattern (Figure 5.3-15).

We shall use the data set shown in Figure 5.3-14 to bring together and review all we learned in this chapter about DMO correction and prestack time migration. To begin with, examine the dip effect on stacking velocities. Based on velocity analysis at CMP location $A$, a velocity function appropriate for gently dipping reflections was picked. By setting this as the center function and using a range of lower and higher percents of this function, a set of multivelocity-function stack panels shown in Figures 5.3-16 and 5.3-17 was created over a CMP range that includes a zone with gently dipping reflections and steeply dipping events. Note that the gently dipping reflections stack best with 100 percent of the center function (Figure 5.3-16) and the steeply dipping events stack best with 120 percent of the center function (Figure 5.3-17). This 20 percent difference in stacking velocities between the gently dipping and steeply dipping reflections is primarily stems from the dip effect. After DMO correction, both gently dipping and steeply dipping events stack best with 100 percent of the center function (Figures 5.3-18 and 5.3-19).

Removal of the dip effect on stacking velocities by DMO correction is further demonstrated by velocity analysis before and after DMO correction. Figure 5.320 shows the CMP gather and its velocity spectrum at location A as in Figure 5.3-14. At first impression, the velocity spectrum may suggest the presence of multiples. Nevertheless, there actually exist two sets of picks - the low-velocity picks as shown in Figure 5.3-21 associated with the gently dipping reflections, and the high-velocity picks as shown in Figure 5.3-22 associated with the steeply dipping fault-plane reflections and possibly diffractions. By applying NMO correction to the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0760.jpg?height=975&width=830&top_left_y=200&top_left_x=93)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0761.jpg?height=990&width=790&top_left_y=198&top_left_x=113)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0762.jpg?height=1030&width=785&top_left_y=178&top_left_x=126)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0763.jpg?height=1045&width=756&top_left_y=165&top_left_x=134)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0764.jpg?height=1022&width=689&top_left_y=177&top_left_x=179)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0764.jpg?height=879&width=58&top_left_y=243&top_left_x=894)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0765.jpg?height=1046&width=764&top_left_y=165&top_left_x=126)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0766.jpg?height=746&width=887&top_left_y=292&top_left_x=75)

FIG. 5.3-20. CMP gather (left) and the velocity spectnam (right) at location $A$ as in Figure 5.3-16 before DMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0767.jpg?height=747&width=882&top_left_y=272&top_left_x=80)

FIG. 5.3-21. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-20, with moveout correction applied to the data using the velocity function that is posted on the spectrum. This velocity function is appropriate for the nearly fiat events associated with the sedimentary strata.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0768.jpg?height=748&width=882&top_left_y=274&top_left_x=80)

FIG. 5.3-22. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-20, with moveout correction applied to the data using the velocity function that is posted on the spectrum. This velocity function is appropriate for the steeply dipping events associated with the fault-plane reflections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0769.jpg?height=746&width=887&top_left_y=292&top_left_x=75)

FIG. 5.3-23. CMP gather (left) and the velocity spectrum (right) at location $A$ as in Figure 5.3-18 after DMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0770.jpg?height=750&width=884&top_left_y=281&top_left_x=79)

FIG. 5.3-24. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-23, with the velority function of the gently flit events as in Figure 5.3-21 posted on the spectrum.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0771.jpg?height=744&width=881&top_left_y=284&top_left_x=81)

FIG. 5.3-25. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-23, with the velocity function of the sterply dipping events as in Figure 5.3-22 pusted on the spectrum.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0772.jpg?height=750&width=889&top_left_y=284&top_left_x=74)

FIG. 5.3-26. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-23, with mownout correction applied to the data using the DMO-corrected velocity function that is posted on the spectrum.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0773.jpg?height=978&width=828&top_left_y=199&top_left_x=94)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0774.jpg?height=969&width=740&top_left_y=206&top_left_x=138)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0775.jpg?height=687&width=831&top_left_y=318&top_left_x=103)

FIG. 5.3-29. Purtions of three common-offset sections that coincide with the CVS panels shown in Figure 5.3-16 before DMO correction. Ofsets are, from left to right, 500,1500 , and $2500 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0776.jpg?height=687&width=833&top_left_y=318&top_left_x=101)

FIG. 5.3-30. Portions of three common-offset sections that coincide with the CVS panels shown in Figure 5.3-18 after DMO correction. Offsets are, from left to right, 500,1500 , and $2500 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0777.jpg?height=688&width=831&top_left_y=316&top_left_x=103)

FIG. 5.3-31. Portions of three common-offset sections that coincide with the CVS panels shown in Figure 5.3-18 after DMO correction and common-offset migration. Offsets are, from left to right, 500,1500 , and $2500 \mathrm{~m}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0778.jpg?height=750&width=887&top_left_y=273&top_left_x=75)

FIG. 5.3-32. CMP gather (left) and the velocity spectrum (right) at locatiun $A$ as in Figure 5.3-18, but after DMO correction and common-offset migration. The velocity function poeted on the spectrum is the sams as in Figure 5.3-26 derived from the data after DMO correction.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0779.jpg?height=750&width=884&top_left_y=273&top_left_x=79)

FIG. 5.3-33. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-32 after DMO correction, common-offset migration and inverse NMO correction using the velocity function pusted on the spectrum. This velocity function is the same as in Figure 5.3-26 derived frum the dats after DMO currection.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0780.jpg?height=751&width=889&top_left_y=262&top_left_x=73)

FIG. 5.3-34. CMP gather (left) and the velocity spectrum (right) as in Figure 5.3-33 after DMO correction, commun-oflset migration inverse NMO correction using the velocity function posted on the spertrum in Figure 5.3-33, and finally, NMO correction using the velocity function posted on the spectrum shown bere and derived from the gather shown bere after DMO correction and commun-offset migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0781.jpg?height=986&width=691&top_left_y=192&top_left_x=136)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0782.jpg?height=970&width=690&top_left_y=203&top_left_x=155)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0783.jpg?height=974&width=803&top_left_y=205&top_left_x=128)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0784.jpg?height=955&width=804&top_left_y=209&top_left_x=127)

CMP gather using the Iow-velocity function in Figure 5.3-21, events that correspond to the gently dipping reflections are flattened whereas events that correspond to the steeply dipping reflections and diffractions are overcorrected. By applying NMO correction to the CMP gather using the high-velocity function in Figure 5.322 , events that correspond to the steeply dipping reflections are flattened whereas events that correspond to the gently dipping reflections and diffractions are undercorrected.

The velocity spectrum at the same analysis location as for Figure 5.3-20 after the application of DMO correction shows a single, unambiguous velocity trend as shown in Figure 5.3-23. We have resolved the dip effect on stacking velocities and thus eliminated the multiple number of velocity picks as in Figure 5.3-20. As a result of the partial migration effect of DMO correction, energy is moved from one CMP location to another. Consequently, reflection-point smearing is removed and events on CMP gathers improvise a horizontally layered earth model.

For comparison, the low-velocity function associated with the gently dipping reflections in Figure 5.321 is superimposed on the velocity spectrum after DMO correction in Figure 5.3-24. As anticipated, the picks implied by the velocity spectrum after DMO correction are fairly close to the velocity function associated with the gently dipping reflections. Similarly, the high-velocity function associated with the steeply dipping reflections and diffractions in Figure 5.3-22 is superimposed on the velocity spectrum after DMO correction in Figure 5.325 . In this case, the picks implied by the velocity spectrum after DMO correction are significantly lower than the velocity picks associated with the steeply dipping reflections.

The velocity analysis is repeated after DMO correction as shown in Figure 5.3-26. The picked velocities are then used to stack the data (Figure 5.3-27). Compare with the conventional CMP stack in Figure 5.3-14 and note that the DMO stack shown in Figure 5.3-27 has preserved the events with conflicting dips with different stacking velocities - the gently dipping reflections with the velocity function posted in Figure 5.3-21 and the steeply dipping fault-plane reflections with the velocity function posted in Figure 5.3-22. The resulting migrated section in Figure 5.3-28 shows a superior image of the fault blocks as compared to the migrated section without DMO correction (Figure 5.3-15).

For prestack time migration, we shall follow the same sequence as for the salt-flank data set.

(a) Sort the moveout-corrected CMP gathers to common-offset sections. Figure 5.3-29 shows portions of three selected common-offset sections. Note the presence of steeply dipping fault-plane reflections. Without DMO correction, CMP stacking fails to preserve these reflections as shown in Figure 5.3-14.

(b) Apply DMO correction to each common-offset section. Figure 5.3-30 shows portions of the three selected common-offset sections as in Figure 5.329 after DMO correction. Note the steeply dipping fault-plane reflections. With DMO correction, CMP stacking preserves these reflections as shown in Figure 5.3-27.

(c) Following DMO correction, each common-offset section is assumed to be a replica of a zero-offset section, and thus, can be migrated using a zerooffset migration algorithm. In this case, a single, vertically varying velocity function was used to migrate the NMO- and DMO-corrected commonoffset sections. Figure 5.3.31 shows portions of the three selected common-offset sections as in Figure 5.3-30 after common-offset migration.

(d) Sort the migrated common-offset sections into CMP gathers. Events on these gathers are now assumingly close to correct subsuriace positions after migration. Figure 5.3-32 shows a CMP gather after common-offset migration.

(c) Apply inverse NMO correction using the velocities picked before DMO correction and perform velocity analysis. The velocity spectrum computed from migrated data is shown in Figure 5,3-32 with the DMO velocities posted on it for comparison. The CMP gather after inverse NMO correction using the velocity function shown in Figure 5.3-32 is shown in Figure 5.3-33.

(f) Apply NMO correction using the velocity picks after migration (Figure 5.3-34). The velocity field derived from the post-migration velocity picks as in Figure 5.3-34 is shown in Figure 5.3-35, and the stack based on this velocity field is shown in Figure 5.3-36. This stack indeed is equivalent to prestack time-migrated section. Note that, however, common-offset migration actually was done using a single, vertically varying velocity function as in step (c).

(g) To obtain the migrated section with the velocity field (Figure 5.3-35) derived after common-offset migration, first perform inverse migration of the resulting stack from step (f) using the same velocity function as in step (c) to obtain a zero-offset section equivalent to en unmigrated stack as shown in Figure 5.3-37. Then, migrate this zero-offset section using the post-migration velocity field shown in Figure 5.3-35 to obtain the final result from prestack time migration sequence described here (Figure 5.3-38).

## Common-Reflection-Point versus Common-Reflection-Surface Stacking

Conventional stacking is based on the notion of a common midpoint (CMP) and migration is based on the notion of a common reflection point (CRP). In both cases, we assume that reflections are represented by hyperbolas and reflectors are represented by points. Consider a seismic line from the Alberta Plains of Western Canada. The subsuriace is just as flat as the surface over which you have recorded the data. When stacking the data, you can almost picture summing of the amplitudes in a CMP gather over all offsets along a hyperbolic trajectory associated with a zero-offset time and the resulting stacked amplitude being placed at a point reflector where the CMP raypaths converge conveniently. When migrating the stacked data, again, you sum the amplitudes along a hyperbolic trajectory and place the result at the apex of the hyperbola. You conveniently associate the apex of the latter hyperbola with a point diffractor situated on the reflector. Whether it is a reflection hyperbola associated with a point reflector or a diffraction hyperbola associated with a point diffractor, the process of stacking and migrating the data involves summation of amplitudes along hyperbolas and placing the resulting sum to a point in the subsurface.

Now consider a seismic line from the Alberta Foothills where the cascaded flanks of the Rocky Mountains rise steeply. The subsurface is just as steep as the surface over which you have recorded the data. A diffractor still is a point whether it is in the Plains or in the Foothills, and you can still think of diffractions as hyperbolas so long as they are situated below a simple overburden. Fortunately, you can also think of reflections as hyperbolas. No longer, however, can you associate a reflection hyperbola on your CMP gather with a single point reflector; instead, you have reflection points dispersed along the reflector (Section E.1). This is when you have to introduce DMO correction to account for the reflection-point dispersal (Section 5.1). Once the reflection-point dispersal is removed, the resulting stack can be considered equivalent to a zerooffset section which you can migrate, again, using the hyperbolic summation rule. Thus you have been able to overcome the Foothills problem of steeply dipping events.

Finally, consider a seismic line from the Canadian Thrust Belt west of the Foothills. The subsurface is just as complex as it appears on the surface over which you have recorded the data. A diffractor situated below the complex overburden structure caused by the overthrust tectonics stays as a point; no longer, however, can you associate it with a hyperbolic traveltime. Instead, when migrating the data, you have to deal with a complex, distorted traveltime trajectory. And neither can you associate the reflections with hyperbolic traveltimes. Instead, when stacking the data, you have to deal with a nonhyperbolic moveout trajectory associated with many reflection points scattered around in the subsurface (de Bazelaire, 1988).

So the simple hyperbolic and point rules of the Plains or the Foothils are no longer applicable in the Thrust Belt. To overcome the first problem - migration of data in the presence of strong lateral velocity variations associated with complex overburden structures in the Thrust Belt, you may decide to do the imaging in depth (Section 8.0) instead of imaging in time (Section 4.0). Earth imaging in depth requires earth modeling in depth (Section 9.0) - a challenge much higher than the imaging itself. To overcome the second problem stacking of data with nonhyperbolic moveout, you may combine it with the first problem and pursue a rigorous solution by doing the imaging not just in depth but also before stack.

Note that, insofar as stacking and imaging in time or in depth, we choose to map events to commonreflection points. By way of DMO correction, we map events to common-reflection points in their unmigrated positions. Similarly, by way of prestack time migration, we map events to common-reflection points in their $m i$ grated posstions. De Bazelaire (1988) and Gelchinsky (1988) pointed out that, rather than associating the recorded data with common-reflection ponts, we should associate the recorded data with common-reflection surfaces. As such, when stacking the data, rather than constricting the summation of amplitudes to within a single CMP gather, data may be focused to a commonreflection surface (CRS) using multiple shots and receivers (Gelchinsky, 1988; and Höcht, 1998).

The theory and practice of the CRS stacking method (Gelchinsky, 1988; Tygel et al., 1997; Gelchinsky et al., 1999a, b; Höcht, 1998; Berkovitch et al, 1998; Landa et al., 1999) suggest that it is indeed related to prestack time migration when the medium velocities are judged to be within the acceptable bounds for the latter. The CRP gathers from prestack time migration and the CRS gathers both are created by including in the surnmation aperture multiple numbers of CMP gathers. The difference is that the CRP gathers are associated with events in their migrated positions, whereas the CRS gathers are associated with events in thcir unmigraled positions. So, migration of the CRS stack should resemble the section from prestack time migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0787.jpg?height=1057&width=679&top_left_y=125&top_left_x=179)

FIG. 5+3-39. A common-reflection-surface (CRS) stack. (Data courtesy Saudi Aramco_)

## $\begin{array}{llllll}8686 & 8989 & 9292 & 9595 & 9898 & 10201\end{array}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0788.jpg?height=1024&width=671&top_left_y=157&top_left_x=175)

FIG. 5.3-40. Migration of the common-refection-surface (CRS) stack shown in Figure 5.3-39.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0789.jpg?height=1059&width=693&top_left_y=124&top_left_x=176)

FIG. 5.3-41. A common-reflection-point (CRP) stack of the data as in Figure 5.3-40 derived from prestack time migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0790.jpg?height=939&width=795&top_left_y=147&top_left_x=73)

## 10001

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0791.jpg?height=1045&width=729&top_left_y=151&top_left_x=159)

FIG. 5.3-43. A common-reflection-point (CRP) gather associated with the CRP stack shown in Figure 5.3-41.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0792.jpg?height=303&width=158&top_left_y=129&top_left_x=85)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0792.jpg?height=304&width=118&top_left_y=127&top_left_x=252)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0792.jpg?height=303&width=118&top_left_y=129&top_left_x=380)

(c)

FIG. 5.4-1. (a) A CMP gather containing a single reflector in a constant-velocity medium; (b) velocity spectrum derived by migrating the CMP gather using a number of constant velocities and displaying the zero-offset trace from each migration; (c) velocity spectrum derived by NMO correcting and stacking the CMP gather using the same range of constant velocities as in (b). Each trace in (b) is a zerooffset trace, while each trace in (c) is a CMP stacked trace.

Figure 5.3-39 shows a CRS stack from an area with low-relief structures. The field data were recorded with 240 -fold coverage. For CRS processing, the negative offsets were discarded and the near one-half of the positive offsets were kept; thus the reduced data used to create the CRS stack had 60 -fold coverage. For prestack time migration, the original 240 -fold data were first reduced to 60 -fold by partial stacking. The migrated CRS stack shown in Figure 5.3-40 is comparable to the CRP stack derived from prestack time migration shown in Figure 5.3-41. In the present example, five CMP gathers were used to create one CRS gather with 300 traces as shown in Figure 5.3-42. The 60-fold CRP gather at the same location as for the CRS gather of Figure 5.3-42 is shown in Figure 5.3-43.

Practical refinements to various approaches to CRS stacking and imaging, including extensions to $3-\mathrm{D}$, are under current investigation. As to what extent the technique will be applied routinely to seismic data remains to be seen.

### 5.4 MIGRATION VELOCITY ANALYSIS

Velocity estimation, CMP stacking, and migration generally are considered independent processes. However, they all have a common theoretical base the scalar wave equation. Solution of this equation allows downward extrapolation of a seismic wavefield recorded at

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0792.jpg?height=252&width=137&top_left_y=140&top_left_x=540)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0792.jpg?height=266&width=265&top_left_y=126&top_left_x=686)

(b) (c)
FIG.5.4-2. Migrations of the CMP gather in Figure 5.4la using velocities that are (a) lower than the medium, (b) the same as the medium, and (c) higher than the medium velocity. (Note the wraparound effect in (c) that is inherent to the phase-shift method used in this analysis.)

the earth's surface. In turn, downward extrapolation provides a basis for CMP stacking and migration (Clayton, 1978; Yilmaz and Claerbout, 1980). Because the processes of CMP stacking and migration require ve locity information, they also can be used to obtain a velocity estimate (Taner and Koehler, 1969; Gardner et al., 1974).

For example, consider the problem of conventional velocity estimation for stacking. Figure $5.4-1$ a shows a CMP gather over a single horizontal reflector. Select a constant velocity, apply NMO correction, and stack the traces in the gather. Next, place this stack trace onto the plane of velocity versus two-way zero-offset vertical time $(v, \tau)$ as shown in Figure 5.4-1c. By stacking the gather with different constant velocity values, the entire $(v, \pi)$ plane is filled with stacked amplitudes. (In this section, the variable $\tau$ is used specifically to define the vertical two-way zero-offset time, $\tau=2 z / v$.)

We now consider the migration process. For a horizontally stratified earth, as in Figure 5.4-1a, we cannot distinguish between a CMP gather and a common-shot gather (CSG). Moreover, since a CSG is a true wavefield created by a single shot and recorded by many receivers, it seems reasonable that the CMP gather in Figure 5.4-1 a can be migrated by treating the reflection hyperbola as if it were a diffraction hyperbola. Assuming there is no velocity information, we migrate with various trial constant velocities and evaluate the results. Figure 5-4-2 shows three different attempts at migrating the CMP gather of Figare 5.4-1a. In one attempt (Figure 5.4-2a), too low a velocity was used; hence, the event was undermigrated. In another attempt, too high a velocity was used and the event was overmigrated (Figure

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0793.jpg?height=320&width=392&top_left_y=130&top_left_x=95)

FIG. 5.4-3. A flowchart of an algorithm for prestack Stolt. migration.

5.4-2c). When the velocity in the migration equals the medium velocity, we expect the diffraction hyperbola to collapse to its apex, which is at the zero-offset trace (Figure 5.4-2b).

What is the implication of this experiment for velocity estimation? Since the correct velocity produces a well-compressed event at the apex of the hyperbola, this velocity can be estimated by evaluating the quality of focusing at zero offset. To evaluate focusing, we pick out the zero-offset traces from the various attempts at migration with different velocities and place them side by side. This produces a display of velocity versus twoway zero-offset time as shown in Figure 5.4-1b.

When Figures 5.4:1b and 5.4-1 c are compared, an almost identical character is noted. The resolution of velocity information obtained in the two approaches is equally degraded by data limitations such as maximum source-to-receiver offset and the absence of short-offset traces.

No distinct difference exists between migration and stacking velocity when the subsurface medium is horizontally layered as in Figure 5.4-1. However, for dipping reflectors, the two types of velocity differ. Stacking velocity is sensitive to the dip of the reflecting interface (Section C.3), while, in theory, migration velocity is the medium velocity independent of dip. Therefore, for seismic migration, we must use a velocity field that is corrected for dips present in the data. As a result, any procedure that obtains velocities suitable for migration must use data from a number of neighboring CMP gathers.

Migration velocity analysis can be formulated in much the same way as stacking velocity analysis. To estimate stacking velocities (Chapter 3), in principle, we

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0793.jpg?height=375&width=425&top_left_y=130&top_left_x=528)

FIG. 5.4-4. A flowchart of an algorithm for common-offset migration of DMO-corrected data.

apply moveout correction to a CMP gather and stack the traces in the gather using a range of constant velocities. Results can be used for velocity determination either in the form of a set of velocity spectra at selected locations along the line or a set of constant-velocitystack (CVS) panels. To estimate migration velocities, in principle, we migrate prestack data using a range of constant velocities and output selected gathers in their migrated positions or constant-velocity migration (CVM) panels. The key difference between stacking velocity estimation and migration velocity estimation is that the former only requires individual CMP gathers, whereas the latter requires prestack data set in its entirety. The reason for this is that the processes of moveout correction and stacking are confined to within a CMP gather, while the process of migration moves energy spatially from one CMP location to another.

## Prestack Stolt Migration

The first method for migration velocity analysis that we shall review is based on migrating prestack data using a range of constant velocities and creating constantvelocity migration (CVM) panels (Shurtleff, 1984). Since migrations are performed using constant velocities, an appropriate choice for the algorithm would be prestack frequency-wavenumber migration (Section E.6). A flowchert for the CVM approach for migration velocity analysis is shown in Figure 5.4-3.

If the medium velocity is constant, then migration can be expressed as a direct mapping (Stolt, 1978) from temporal frequency $\omega$ to vertical wavenumber $k_{z}$ (Section E.6). The equation for Stolt mapping is

$$
\begin{aligned}
& P\left(k_{y}, k_{h}, k_{z}, t=0\right)= {\left[\frac{v}{2} \frac{k_{z}^{2}-k_{y}^{2} k_{h}^{2}}{\sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{y}^{2}\right)}}\right] } \\
& \times P\left[k_{y}, k_{h}, 0, \frac{v}{2 k_{z}} \sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}\right]
\end{aligned}
$$

where $y, h_{4}$ and $t$ are the variables for midpoint, offset and event time in the unmigrated position, and $k_{y}, k_{h}$, and $\omega$ are the associated Fourier transform variables.

Note that Stolt migration involves, first, mapping from $\omega$ to $k_{z}$ for a specific $k_{y}$ and $k_{A}$ by using the dispersion relation for prestack wave extrapolation (Section E.6):

$$
\omega=\frac{v}{2 k_{z}} \sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}
$$

The output of mapping is then scaled by the quantity

$$
S=\frac{v}{2} \frac{k_{\mathrm{z}}^{2}-k_{y}^{2} k_{h}^{2}}{\sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}}
$$

Stolt migration output normally is displayed in two-way vertical zero-offset time $\tau=2 z / v$. In practice, mapping in the $f-k$ domain really is from $\omega$ to $\omega_{r}$ rather than from $\omega$ to $k_{z}$, where $\omega_{\tau}$ is the Fourier dual of $\tau$, and is simply $k_{z}$ scaled by $v / 2$. Accordingly, equations (5-40), (5-41), and (5-42) are recast in terms of $\omega_{r}=(v / 2) k_{z}$ when implemented in practice.

Migration velocity analysis based on Stolt's prestack algorithm for constant velocity thus involves the following steps:

(a) Starting with prestack data $P(y, h, t)$ in coordinates of midpoint $y$, offset $h$ and two-way event time $t$ in the unmigrated position, perform 3-D Fourier transform to obtain the transformed volume of data $P\left(k_{y}, k_{h}, \omega\right)$, where $k_{y}, k_{h}$, and $\omega$ are the Fourier transform duals of the variables $y, h$, and $t$, respectively.

(b) For each trial constant velocity $v$, use equation (5-41) to map the transform variable $\omega$ - the temporal frequency associated with the input data $\boldsymbol{P}\left(k_{y}, k_{k}, \omega\right)$, to $\omega_{\tau}$ - the temporal frequency associated with the migrated data $P\left(k_{y}, k_{h}, \omega_{\tau} ; v\right)$. This mapping of complex numbers is the basis for constant-velocity prestack Stolt migration (Section E.6).

(c) Apply the scalisg factor of equation (5-42). (d) Invoke the imaging principle by setting $t=0$ and obtain $P\left(k_{y}, k_{h}, \omega_{\tau}, t=0\right)$.

(e) Sum over the offset wavenumber $k_{h}$ to obtain the image at zero offset, yet in the transform domain, $P\left(k_{y}, h=0, \omega_{\tau} ; v\right)$.

(f) Perform 2-D inverse Fourier transform to obtain the constant-velocity migrated zero-offset section, $P(y, \tau ; v)$.

(g) Repeat steps (b) through (f) for a range of constant velocities to obtain the migration velocity volume $P(y, \tau ; v)$. By viewing this volume, it can be incised to obtain the surface of optimum migration velocity field with an accompanying image derived from prestack time migration.

Practical issues related to prestack Stolt migration include spatial aliasing along the offset axis and cost of Stolt mapping in steps (b) and (c). The spatial sampling along the offset axis often is too coarse for shallow events with low velocity; this gives rise to large moveout on CMP gathers. A linear moveout may be applied to CMP gathers to circumvent spatial aliasing. Equation (5-40) for Stolt mapping is then modified accordingly (Li et al., 1991).

The Stolt mapping of amplitudes for prestack data involves interpolation of complex numbers in the transform domain. This involves the three input variables $k_{\psi}$, $k_{h}$, and $\omega$, and the output variable $\omega_{r}$, and thus is quite costly when one has to consider as many as 100 or more constant velocities. $A$ way to reduce the computational cost is to perform prestack migration using a set of constant velocities at coarse interval, followed by poststack residual constant-velocity migrations of the zero-offset sections from prestack migration to fill in between the coarsely sampled migration velocity panels ( $\mathrm{Li}$ et al., 1991).

## Common-Offset Migration of DMO-Corrected Data

This technique for migration velocity analysis is the basis for the most common sequence used for prestack time migration (Section 5.3). A flowchart for the method is shown in Figure 5.4-4.

(a) Starting with prestack data $P(y, h, t)$ in coordinates of midpoint $y$, offset $h$, and two-way event time $t$ in the unmigrated position, apply NMO correction using an initial velocity field with minimal dip effect.

(b) Sort the norrual-moveout corrected data $P\left(y, h, t_{n}\right)$ to common-offset sections $P\left(y, t_{n} ; h\right)$.

(text contriues on p.788)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0795.jpg?height=595&width=847&top_left_y=368&top_left_x=74)

FIG. 5.4-5. A CMP stacked section associated with data from an overthrust belt. (Data courtesy Husky Oil.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0796.jpg?height=518&width=858&top_left_y=413&top_left_x=71)

FIG. 5.4-6. Velocity field assoriated with the stacked section shown in Figure 5.4-5.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0797.jpg?height=513&width=848&top_left_y=394&top_left_x=92)

FIG. 5.4-7. Poststack time migration of the stacked section shown in Figure 5.4-5 using the velocity field shown in Figure 5.4-6.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0798.jpg?height=980&width=434&top_left_y=136&top_left_x=296)

FIG. 5.4-8. Part 1: Constant-velocity prestack Kirchhoff time migration paneis of the data as in Figure 5.4-5.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0799.jpg?height=980&width=434&top_left_y=140&top_left_x=296)

FIG. 5.4-8. Part 2: Constant-velocity prestack Kirchhoff time rigration panels of the data as in Figure 5.4-5.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0800.jpg?height=1004&width=438&top_left_y=130&top_left_x=302)

FIG. 5.4-8. Part 3: Constant-velocity prestack Kirch hoff time migration pantels of the data as in Figure 5.4-5.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0801.jpg?height=1026&width=704&top_left_y=134&top_left_x=186)

FIG. 5.4-9. Part 1: Velocity panels from the overthrust data created by sorting the results of prestack constant-velocity migrations shown in Figure 5.4-8.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0802.jpg?height=710&width=712&top_left_y=306&top_left_x=156)

FIG. 5.4-9. Part 2: Sorted resuits from Figure 5.4-8. Each panel shows results of constant-velocity migrations in the neighborhood of the CMP location as denoted.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0803.jpg?height=515&width=861&top_left_y=409&top_left_x=83)

FIG. 5.4-10. Time migration velocity field created from the velocity function picks made from the anaiysis panels shown in Figure 5.4-9.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0804.jpg?height=516&width=850&top_left_y=403&top_left_x=71)

FIG. 5.4-11. Prestack time migration using the velocity field shown in Figure 5.4-10.
(c) To each common-offset section $P\left(y, t_{n} ; h\right)$, apply DMO correction $P\left(y, T_{0} ; h\right)$.

(d) Migrate each of the common-offset sections using a. zero-offset migration algorithm (Chapter 4) and the velocity field based on the flat-event velocity picks from step (a).

(e) Sort the migrated common-offset data $P(y, \tau ; h)$ back to CMP gathers $P(y, h, \tau)$ and apply inverso NMO correction using the flat-event velocities from step (a).

(f) Perform velocity analysis at frequent intervals as needed to derive an optimum velocity field which is used for the subsequent migration of the data.

## Prestack Kirchhoff Migration

A practical alternative to prestack Stolt migration that involves all of the prestack data at all times during the computation is to migrate prestack data using the Kirchhoff summation method. The summation of amplitudes is done along the table-top trajectories inferred by equation (5-15), and the necessary amplitude and phase treatment of the surnmed amplitudes are given by the integral solution to the scalar wave equation (Section 4.1)

Prestack Kirchhoff migration provides the flexibility to output selected CMP gathers in their migrated positions. Such an option is attractive if one wants to pick rms velocity functions from the selected output gathers to create a migration velocity field. This is not possible with prestack Stolt migration which generates a volume of prestack migrated data. Another advantage of prestack Kirchhoff migration is its ability to accommodate irregular topography.

Figure 5.4-5 is a CMP-stacked section associated with a seismic traverse over an overthrust structure. The line direction is approximately orthogonal to the thrust planes, and thus yields minimal 3 -D effects. This data set is quite deceptive - at first, it givcs the impression that time rigration is not a valid strategy for imaging the subsurface. Although the reflector geometries are quite complex, velocities vary from $4000 \mathrm{~m} / \mathrm{s}$ a.t the surface to $6500 \mathrm{~m} / \mathrm{s}$ at the bottom of the section with not much refraction occurring at layer boundaries.

The stacking velocity field shown in Figure 5.4-6 does not appear to be geologically plausable. Nevertheless, use it without much editing for poststack time migration. The resulting section shown in Figure 5.4-7 already exhibits a fairly accurate image of the structurally complex zone above $2 \mathrm{~s}$. We observe imbricate structures, folds, and reverse faults that accompany the thrust faults. The sole thrust - zone of detachment between the competent rock layers below $2 \mathrm{~s}$ and the incompetent rock layers above, can be traced along a trajectory that starts at approximately $1.75 \mathrm{~s}$ on the left-edge of the section, climbs upward and emerges on the surface at approximately midpoint 510.

We now perform prestack Kirchhoff migration using a range of constant velocities and obtain a set of migration panels as shown in Figure 5.4-8. To use the constant-velocity migration panels for picking rms velocities, they were split into vertical stripes each comprising 100 midpoints. By grouping the constantvelocity stripes with the same center midpoint, we obtain the velocity panels shown in Figure 5.4-9. Just as a constant-velocity-stack (CVS) panel (Figure 3.2-10) is used to pick a stacking velocity function, the constantvelocity-migration panels in Figure 5.4-9 can be used to pick an rrms velocity function at each center CMP location. These functions can then be combined to create a migration velocity field as shown in Figure 5.4-10. Compare with Figure 5,4-6 and note that the migration velocity field indeed exhibits a pattern that conforms with the subsurface structure. By using the velocity field in Figure 5.4-10, the prestack time migrated section show in Figure 5.4-11 was obtained. Compare with the poststack time migrated section (Figure 5.4-7) and observe that, in this case, the differences are marginal. The primary reason for this is that velocities are generally quite high, making even DMO correction unnecessary.

## Velocity Analysis Using <br> Common-Reflection-Point Gathers

The next field data example demonstrates the use of constant-velocity prestack time migration to generate selected CMP gathers in their migrated positions to determine migration velocities. Figure 5.4-12 shows a CMP stack without DMO correction; the exploration objective requires delineation of fault blocks which manifest themselves with phantom diffractions. These diffractions conflict with the gently dipping reflections associated with the surrounding strata. Poststack time migration of the CMP stack without DMO correction falls short of providing a crisp image of the fault blocks (Figure 5.4-13).

Dip-moveout correction preserves the phantom diffractions and fault-plane reflections on stacked data as shown in Figure 5.4-14. As a result, migration of the DMO stack (Figure 5.4-15) enables a better delineation of the fault planes as compared with the migration of the conventional CMP stack without DMO correction (Figure 5.4-13).

Table 5-4. Velocity function derived from the constantvelocity migration panel of Figure 5.4-16.

| Two-way Zero-Ofset <br> time, ms | RMS Velocity <br> Picked, $\mathrm{m} / \mathrm{s}$ |
| ---: | :---: |
| 0 | 1500 |
| 450 | 1500 |
| 700 | 1600 |
| 900 | 1750 |
| 1050 | 1900 |
| 1200 | 2200 |
| 1500 | 2500 |
| 2000 | 2800 |
| 2350 | 3000 |
| 2500 | 3000 |

Table 5-5. Velocity function derived from the constantvelocity migration pand of Figure 5.4-17.

| Two-way Zero-Offset <br> time, ms | RMS Velocity <br> Picked, $\mathrm{m} / \mathrm{s}$ |
| ---: | :---: |
| 0 | 1500 |
| 400 | 1500 |
| 750 | 1700 |
| 900 | 1800 |
| 1050 | 2000 |
| 1350 | 2300 |
| 1500 | 2600 |
| 2050 | 2900 |
| 2500 | 3000 |

To derive a migration velocity field, we perform prestack time migration using a range of constant velocities and generate selected gathers at their migrated positions. The interval for output gathers is specified in accordance with the degrec of lateral velocity variations that can be accommodated by time migration. An interval equal to a cable length is a reasonable rule to follow. Figures 5.4-16 through 5.4-19 show migration velocity panels at four midpoint locations. The way to use these panels to pick rms velocity functions at analysis locations is similar to the use of a CMP gather that has been normal-moveout corrected using a range of constant velocities (Figure 3.2-11). In both cases, a velocity function is picked based on the criterion of flatness of events. The flatness of an event on a moveout-corrected gather means that the moveout velocity associated with that event is optimum. Similarly, the flatness of an event on a CMP gather created by prestack time migration
Table 5-6. Velocity function derived from the constantvelocity migration panel of Figure 5.4-18.

| Two-way Zero-O | $\mathrm{RM}$ |
| :---: | :---: |

Table 5-7. Velocity function derived from the constantvelocity migration panel of Figure 5.4-19.

| Two-way Zero-Ofset <br> time, $\mathrm{ms}$ | RMS Velocity <br> Picked, m/s |
| ---: | :---: |
| 0 | 1500 |
| 350 | 1500 |
| 650 | 1750 |
| 750 | 1800 |
| 950 | 2000 |
| 1250 | 2500 |
| 1750 | 2700 |
| 2500 | 3000 |

means that the image below the midpoint location associated with that gather is the same irrespective of ofset, and thus migration velocity is correct. Erroneously too low velocity yields a moveout on a gather from prestack time migration similar to the moveout of an event on a CMP gather which has been overcorrected. Similarly, erroneously too high velocity yields a moveout on a gather from prestack time migration much like to the moveout of an event on a CMP gather which has been undercorrected. Observe flat, over- and undercorrected events in the velocity panels shown in Figures 5.4-16 thtough 5.4-19, and pick for each CMP location rms velocity functions. Tables 5-4 through 5-7 list the picked rms velocity functions.

There is one very important aspect of the corstantvelocity migration panel as in Figure 5.4-19 and the constant-velocity moveout panel as in Figure 3.2-11. When picking a moveout velocity function from the latter, you are tracking the same event at the same reflection point from gather to gather in the same panel overcorrected at low velocities, flat at optimum velocity

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0807.jpg?height=478&width=787&top_left_y=130&top_left_x=122)

FIG. 5.4-12. A portion of a CMP stack from an area with fault blocks. (Data courtesy BHP Petroleum.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0807.jpg?height=481&width=790&top_left_y=684&top_left_x=121)

FIG. 5.4-13. Poststack time migration of the CMP stack shown in Figure 5.4-12. Note the undermigration caused by the 2-D migration of 3-D behavior of the fault-plane diffractions and reflections (Chapter 7).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0808.jpg?height=481&width=799&top_left_y=130&top_left_x=112)

FIG. 5.4-14. DMO stack associated with the data set as in Figure 5.4-12.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0808.jpg?height=479&width=797&top_left_y=688&top_left_x=112)

FIG. 5.4-15. Poststack time migration of the DMO stack shown in Figure 5.4-14. Note the undermigration caused by the 2-D migration of 3-D behavior of the fanlt-plane diffractions and reflections (Chapter 7).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0809.jpg?height=684&width=831&top_left_y=319&top_left_x=103)

FIG. 5.4-16. Migration velocity analysis panel for CMP 1161 of the data set as in Figure 5.4-12. The panel is created by performing prestack time migration using a range of constant velocities and displaying the results at CMP location 1161.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0810.jpg?height=691&width=836&top_left_y=312&top_left_x=95)

FIG. 5.4-17. Migration velocity analysis panel for CMP 1561 of the dats set as in Figure 5.4-12. The panel is created by performing prestack time migration using a range of constant velocities and displaying the results at CMP location 1561.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0811.jpg?height=684&width=838&top_left_y=317&top_left_x=94)

FIG. 5.4-18. Migration velocity analysis panel for CMP 1961 of the data set as in Figure 5.4-12. The panel is created by performing prestack time migration using a range of constant velocities and displaying the results at CMP location 1961.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0812.jpg?height=689&width=833&top_left_y=314&top_left_x=101)

FIG. 5.4-19. Migration velocity analysis panel for CMP 2361 of the data set as in Figure 5.4-12. The panel is created by performing prestack time migration using a range of constant velocities and displaying the results at CMP location 2361.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0813.jpg?height=464&width=809&top_left_y=424&top_left_x=114)

FIG. 5.4-20. Time migration velocity field computed from the vertical velocity functions picked from the migration veiocity analysis panels as in Figures 5.4-16 through 5.4-19.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0814.jpg?height=916&width=666&top_left_y=224&top_left_x=179)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0815.jpg?height=515&width=852&top_left_y=134&top_left_x=91)

FIG. 5.4-22. The stack of image gathers as in Figure 5.4-21 derived from prestack time migration. Compare with Figure $6.0-40$.

value and undercorrected at high velocities. Whereas, when picking an rms velocity function from the former, you are not tracking the event at the same reflection point because of the lateral positioning effect of migration.

By interpolating between the picked rms velocity functions as listed in Tables 5-4 through 5-7, a velocity field for time migration can be created (Figure 5.4-20). By using this velocity field, data are migrated before stack. The common-reflection-point (CRP) gathers in Figure 5.4-21 exhibit flatness of events - a way to check the accuracy of the migration velocity field. Stacking the CRP gathers yields the image from prestack time migration as shown in Figure 5.4-22. Admittedly, there is some undermigration caused by the 3-D geometry of the fault planes which can be adequately imaged only by 3-D migration (Section 7,0). Nevertheless, compare with migrations of the conventional stack (Figure 5.4-13) and DMO stack (Figure 5.4-15), and note that the faults have been delineated much more distinctively. Such differences conflicting dips with different stacking velocities associated with fault blocks and salt diapirs where vertical velocity variations may be beyond the accuracy of DMO correction, are one motivation for doing time migration before stack.

Limitations in picking reliable velocity functions are the same as those associated with constant-velocity moveout panels (Figure 3.2-11). Shortening of effective cable length at shallow times because of muting, interference of linear noise and multiples all impnes a limit on the picking accuracy (Section 6.0).

## Focusing Analysis

The idea of a velocity analysis that is based on differential solutions of the scalar wave equation first was introduced by Doherty and Claerbout (1974). They used the 15-degree finite-difference migration algorithm and worked with single CMP gathers. Gonzalez-Serrano and Claerbout (1979) later extended the wave equation velocity analysis to slant-midpoint coordinates and worked with linearly moveout-corrected CMP gathers. The method discussed here (Yilmaz and Chambers, 1984) operates in the Fourier transform domain using the exact form of the double-square-root (DSR) opera-

Procedure

| Recorded Data | $:$ | $P(y, h, \tau=0, t)$ |
| :--- | :---: | :---: |
| 3-D FFT ${ }^{+1}$ | $:$ | $P\left(k_{y}, k_{h}, \tau=0, \omega\right)$ |
| $\times$ |  |  |

FIG. 5.4-23. A flowchart of an algorithm for focusing analysis.

tor. Mathematical details of this method are found in Section E.7. Figure 5.4-23 summarizes the main computational steps involved in this migration velocity analysis based on wavefield extrapolation.

(a) Starting with the prestack data in midpoint $y$, offset $h$, and two-way event time $t$ in the unmigrated position, represented by the wavefield $P(y, h, \tau=$ $0, t$ ) at the surface $\tau=0$, perform 3-D Fourier transform. The variable $r$ is associated with the direction of wave extrapolation, and is related to depth $z$ by $\tau=2 z / v$, where $v$ is the medium velocity.

(b) Specify an extrapolation velocity function that only varies vertically, $v(\tau)$ and apply the extrapolation operator $\exp (-i \omega D S R \tau / 2)$ to compute the extrapolated wavefield in the transform domain $P\left(k_{y}, k_{h}, \tau, \omega\right)$ from the surface wavefield in the transform domain $P\left(k_{y}, k_{h}, \tau=0, \omega\right)$.

(c) To obtain the zero-offset image, sum over the offset wavenumber, and thus obtain $P\left(k_{y}, h=0, \tau, \omega\right)$.

(d) Apply 2-D inverse Fourier transform to obtain the zero-offset image $P(y, h=0 . \tau, t)$. The image below a midpoint $y$ is contained in the $t-\tau$ plane.

(e) Perform mapping of the variables as described in Section E. 6 from $\tau$ to $v$. The velocity information

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0816.jpg?height=232&width=414&top_left_y=126&top_left_x=539)

FIG. 5.4-24. Common-offset data derived from a constantvelocity earth model consisting of six point scatterers beneath midpoint 1, where (a) is zero-offset and (b) is far offset.

is given by the envelope of the velocity volume of data $P(y, h=0, \tau=t, v)$.

We now demonstrate the procedure outlined in Figure 5.4-23 using a synthetic data set. Figure 5.4 24 shows two common-offset sections over a number of point scatterers buried in a constant-velocity earth. where $v=3000 \mathrm{~m} / \mathrm{s}$. Using a constant velocity for extrapolation, $v_{e}=3000 \mathrm{~m} / \mathrm{s}$, the $t-\tau$ image plane was produced for each midpoint. Two such planes corresponding to midpoints 1 and 5 denoted in Figure 5.4-24 are shown in Figure 5.4-25. The $v-\tau$ planes (Figure 5.4 26) then were generated from the $t-\tau$ image planes by the mapping procedure described in Section E.7. Peak amplitudes for all events occur at the correct medium velocity $(3000 \mathrm{~m} / \mathrm{s})$. We expect the diffraction events in Figure 5.4-23 to migrate to the apexes beneath midpoint 1, where the point scatterers are located. Note that in Figure 5.4-25, almost all the energy is in the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0816.jpg?height=257&width=396&top_left_y=910&top_left_x=548)

FIG. 5.4-25. Image planes corresponding to midpoints 1 and 5 as indicated in Figure 5.4-24, where (a) is CMP 5 and (b) is CMP 1.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0817.jpg?height=459&width=406&top_left_y=120&top_left_x=83)

(a)

(b)
FIG. 5.4-26. The $v-\tau$ planes corresponding to midpoints 1 and 5 derived from the image planes in Figure 5.4-25, where (a) is CMP 5 and (b) is CMP 1.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0817.jpg?height=219&width=217&top_left_y=700&top_left_x=82)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0817.jpg?height=223&width=202&top_left_y=706&top_left_x=296)

(b)
FIG. 5.4-27. Common-offset data based on a horizontally layered ear th model containing three point scatterers located beneath midpoint 1 on the boundaries between constantvelocity layers, where (a) is zero-offset and (b) is far ofiset.

image plane corresponding to midpoint 1 ; just five midpoints away, at midpoint 5 , the migrated energy is very low.

How do we interpret the $t-\tau$ image planes? If we used the true medium velocity in downward extrapolation, then, according to the imaging principle, we would see all the events along the diagonal $\tau=t$, the image lene, on the image plane. This happens in Figure 5.425 , because a $3000-\mathrm{m} / \mathrm{s}$ extrapolation velocity was used,

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0817.jpg?height=245&width=391&top_left_y=126&top_left_x=549)

FIG. 5.4-28, Image planes corresponding to ridpoints 1 and 5 as indicated in Figure 5.4-27, where (a) is CMP 5 and (b) is CMP 1.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0817.jpg?height=456&width=414&top_left_y=489&top_left_x=539)

(b)

FIG. 5.4-29. The $\tau-\tau$ planes corresponding to midpoints 1 and 5 derived from the image planes in Figure 5 4-28, where (a) is CMP 5 and (b) is CMP 1.

which is just the velocity used in generating the model in Figure 5.4-23. Any displacement of peak energy from the $t=\tau$ inage line means that the velocity value used for downward extrapolation differs from that of the event. This displacement is also the basis for mapping from the $t-\tau$ image plane to the $v-\tau$ plane by equation ( $\mathrm{E}-\mathrm{77}$ ).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0818.jpg?height=302&width=416&top_left_y=126&top_left_x=82)

F1G. 5.4-30. (a) CMP gather at location 1 as inducated in Figure 5.4-2 $i_{i}$ (b) and (c) are velocity spectra derived from this gather by the methods of Figures 5.4-1b and $c$, respectively.

This mapping is investigated further with the modeled data set shown in Figure 5.4-27, in which velocity increases with depth. In Figure 5.4 28b, note that the top and middle events fall to the left of the image line suggesting that the velocity used in extrapolation $\left(v_{e}=3000 \mathrm{~m} / \mathrm{s}\right)$ is greater than the velocities associated with these events. The bottom event falls on the image line, implying that its velocity is nearly the same as the extrapolation velocity. These observations are confirmed in the corresponding $v-\tau$ planes in Figure 5.4-29. While true stacking velocity values for the three events are 2700,2850 , and $3000 \mathrm{~m} / \mathrm{s}$, the velocities interpreted from Figure 5.4-29b are about 2500, 2800, and $3000 \mathrm{~m} / \mathrm{s}$. Thus, the migration-based velocity estimate for the shallow event is in error by approximately 8 percent.

To determine the reason for the velocity error, we will consider a migration-based velocity analysis of our synthetic data example that does not involve the approximate mapping step. Figure 5.3-30a shows a CMP gather from midpoint 1 in the zero-dip region
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0818.jpg?height=206&width=414&top_left_y=1000&top_left_x=83)

FIG. 5.4-31. Focusing analysis for determining migration velocities. See text for details.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0818.jpg?height=602&width=437&top_left_y=126&top_left_x=526)

FIG. 5.4-32. A CMP stacked section. The center portion was used in the migration velocity analysis described in Figures $5433,5.4-34$, and 5.435 .

of the depth-variable velocity model associated with the constant-offset sections in Figure 5.4-27. The migration velocity analysis on this gather (Figure 5.430b) was done by extrapolating the surface wavefield $P\left(k_{h}, \omega, \tau=0\right)$ repeatedly with diferent constant velocities in steps of $\Delta \tau=\Delta t$ (the sampling rate). The zero-offset trace from each attempt was collected after this effort, abandoning the rest of the migrated CMP gather.

Interpretation of the velocity analysis in Figure 5.4-30b reveals correct stacking velocities for the three events, including the shallowest. Clearly the error observed in Figure 5.4-29 is attributable to the mapping (equation (E-100). Note that the error does not occur because of depth variability of velocity, but instead, because the single extrapolation velocity used differed from the medium velocity. The conventional velocity analysis for midpoint $\mathbf{1}$ of this model data set is shown

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0819.jpg?height=514&width=853&top_left_y=124&top_left_x=93)

FIG. 5.4-33. Image planes associated with the center midpoint from the zone of interest in Figure 5.4-32.

in Figure 5.4-30c for comparison. Note the familiar NMO stretching that is apparent in the shallow event. In other respects, both the results (Figures 5.4-30b and 5.4-30c) are comparable.

The departure of an event on the $t-\tau$ image plane from the $t=\tau$ image line is measured by the quantity $\Delta \tau$ as depicted in Figure 5.4-31a. In some practical implementations, the $t-\tau$ image plane is mapped onto the plane of $\Delta \tau$ versus $\tau$ as depicted in Figure 5.4-31c to determine the rms velocity $v(\tau)$ for time migration from the extrapolation velocity $v_{e}(\tau)$. An event with a velocity error $v(\tau)-v_{e}(\tau)$ is represented by an energy maximum either to the left or to the right of the $\Delta \tau=0$ line. The $\delta \tau(\tau)$ trend can be picked and translated into a velocity trend as depicted in Figure 5.4-31b. This type of analysis has come to be called focusing analysis in the industry (Faye and Jeannaut, 1986). It has been used in some cases erroneously to estimate and update velocitydepth models used for depth migration. The method can only provide plausable velocity update within the frames ork of time migration.

Figure 5.4-32 is a CMP stack from offshore Texas. A 7000 )-ft portion (64 midpoints each with 48 offset traces) of the profile was used for migration velocity analysis. For computational efficiency, the data were windowed into 1024 -ms time gates with 50 percent overlap. The image planes for one particular midpoint are shown in Figure 5.4-33. Different extrapolation velocities picked from a specified regional velocity function are used in each time gate. The velocity scan used in mapping is then carried out within a corridor around this function. Because different extrapolation velocities are used in successive segments, a given event appears at different values of $\tau$ in adjacent time segments.

The resulting velocity analysis for the central midpoint is shown in Figure 5.4-34. In conventional practice, to improve the quality of velocity picks, velocity analyses from a number of neighboring CMP gathers often are summed. Figure 5.4-34c shows the result of stacking velocity analysis for data from the six adjacent CMP gathers indicated in Figure 5.4-34a. For the migration-based method, the $v-\tau$ planes corresponding to these gathers were summed. The result is shown in Figure 5.4-34b. The most obvious difference between the two results is the lack of shallow information in the migration-based $v-\tau$ plane. This shortcoming is attributed to spatial aliasing and lack of long-offset ditia in the shallow time gate. The problem can be eliminated partly by increasing the length of the time gate used in the velocity analysis. With the shortcut tirne-windowing

## Velocity (kft/s) $\rightarrow$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0820.jpg?height=635&width=531&top_left_y=171&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0820.jpg?height=625&width=308&top_left_y=169&top_left_x=634)

(c)

FIG. 5.4-34. (a) A portion of the CMP stacked section in Figure 5.4-32, (b) the velocity spectrum based on the procedure in Figure 5.4-23, followed by averaging over six midpoints; (c) the conventional velocity analysis as discussed in Section 3.2 followed by averaging over six midpoints.

approach described above, the shallowest time segment did not include the large-offset data necessary for velocity resolution. Because the events have dip, the derived migration velocities are lower (by up to 4.5 percent) than the velocities derived from the stacking velocity analysis.

The velocity analysis described in this section does not handle lateral variations in velocity. It is based on a Fourier-transform domain formulation with only vertically varying velocity used in extrapolation. This method may be particularly efficient for the dipcorrected velocity estimate needed for time migration.

## Fowler's Velocity-Independent Prestack Migration

We now restate the underlying principle for migration velocity analysis:

Starting with the prestack volume of data $P(y, h, t)$ in midpoint $y_{1}$ offset $h$ and two-way event time $t$ in the unmigrated position, create a velocity cube volume of data $P(y, v, \tau)$ in midpoint $y$, migration velocity $v$ and two-way event time $\tau$ in the migrated position. Within the context of time migration, the

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0821.jpg?height=286&width=455&top_left_y=124&top_left_x=74)

FIG. 5.4-35. A flowchart of an algorithm to create a migration velocity cube.

output time variable $\tau$ is related to depth by way of vertical stretch: $\tau=2 z / v$.

Although the velocity cube can be created by means of some of the migration velocity analysis techniques described in this section, a variation of the method by Fowler (1984) is particularly efficient and elegant. First, we review Fowler's method to create the velocity cube. Refer to the moveout equation (5-1) and recall that stacking velocity $v_{s t k}$ is dip dependent:

$$
t^{2}=t_{0}^{2}+\frac{4 h^{2}}{v_{s t k}^{2}}
$$

where

$$
v_{s t k}=\frac{v_{D M O}}{\cos \phi} .
$$

Use equation (5-11) to establish a relationship between the dip-dependent stacking velocities $v_{s t k}$ and the dipindependent DMO velocities $v_{D M O}$ - velocities estimated from dip-moveout-corrected data:

$$
v_{s t k}=-\frac{v_{D M O}}{\sqrt{1-\left(\frac{v_{D M O} k_{y}}{2 \omega_{0}}\right)^{2}}}
$$

This equation is the basis for Fowler mapping of $v_{s t k}$ to $v_{D M O}$. Note that the process is applied to data in the frequency-wavenumber domain. The Fowler mapping is then followed by constant-velocity Stolt mapping (Sections 4.1 and D.7) to map the DMO velocities $v_{D M O}$ to migration velocities $v_{\text {mag }}$.

Stolt migration of the dip-moveout-corrected data volume in the Fourier transform domain $P\left(k_{y}, \omega_{0} ; v_{D M O}\right)$ involves, first, mapping from $\omega_{0}$ to $\omega_{\tau}$ for a specific $k_{y}$ by using the dispersion rclation of equa- tion $(4-24 b)$ recast as

$$
\omega_{0}=\sqrt{\omega_{v}^{2}+\frac{v_{m 2 g}^{2} k_{v}^{2}}{4}}
$$

where the relationship $\omega_{\tau}=v_{m i g} k_{z} / 2$ is used. The output of this mapping $P\left(k_{y}, \omega_{\tau} ; v_{\text {mag }}\right)$ is then scaled by the quantity $S$ given by equation (4-24c) recast as

$$
S=\frac{v_{m i g}}{2} \frac{\omega_{\tau}}{\sqrt{\omega_{\tau}^{2}+\frac{v_{m g}^{2} k_{y}^{2}}{4}}}
$$

Again, the relationship $\omega_{\tau}=v_{m i g} k_{z} / 2$ is used to obtain equation (5-47) from equation (4-24c).

Figure 5.4-35 describes a flowchart for creating the migration velocity volume $P\left(y, v_{m 2 g}, \tau\right)$ by Fowler and Stolt mapping.

(a) Start with data $P(y, h, t)$ in coordinates of midpoint $y$, offset $2 h$ and event time $t$ in the unmigrated position, and create constant-velocity stack (CVS) volume $P\left(y, v_{s t k}, t_{r_{2}}\right)$ using a range of velocities $v_{s t k}$, where $t_{n}$ is the event time after constantvelocity normal moveout correction.

(b) Apply 2-D Fourier transform to obtain the CVS cube $P\left(k_{y}, v_{a t k}, \omega\right)$ in the frequency-wavenumber domain, where $k_{y}$ and $w$ are the Fourier transform variables associated with the variables $y$ and $t_{n}$.

(c) Sort the CVS volume $P\left(k_{y}, v_{s t k}, w\right)$ into a set of constant-velocity sections $P\left(k_{v}, \omega ; v_{s t k}\right)$.

(d) Perform the Fowler mapping based on equation (545) on each of the velocity sections so as to obtain the DMO velocity volume $P\left(k_{y}, \omega_{0} ; v_{D M O}\right)$.

(c) Migrate each of the constant-velocity sections of the DMO velocity volume by performing the Stolt mapping based on equations (5-46) and (5-47) so as to obtain the migration velocity volume $P\left(k_{y}, \omega_{\tau} ; v_{m+g}\right)$.

(f) Apply 2-D inverse Fourier transform to obtain the migration velocity volume $P\left(y, \tau, v_{\text {mig }}\right)$.

A variation of Fowler's sequerce described above involves creating the CVS cube directly from DMOcorrected data.

(a) Start with data $P(y, h, t)$ in coordinates of midpoint $y$, offset $2 h$ and event time $t$ in the unmigrated position, and apply DMO correction followed by inverse NMO correction.

(b) Create constant-velocity stack (CVS) volume $P\left(y, v_{D M O}, t_{0}\right)$ using a range of velocities $v_{D M O}$, where $t_{0}$ is the event time after constant-velocity normal moveout correction (Figure 5.4-36a).

(text continues on p. 815)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0822.jpg?height=1058&width=518&top_left_y=118&top_left_x=254)

FIG. 5.4-36. (a) A velocity cube computed from DMO-corrected gathers; (b) the same data as in (a) after Stolt migration of each of the constant-velocity panels.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0823.jpg?height=869&width=882&top_left_y=122&top_left_x=80)

FIG. 5.4-37. (a) A time slice from the migration velocity cube shown in Figure 5.4-36h, (b) the same time slice as in (a) with velocity picking. Red and dark blue curves correspond to primaries and multiples, respectively.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0824.jpg?height=1026&width=553&top_left_y=123&top_left_x=242)

FIG. 5.4-38. (a) Velocity strands picked from the time slices of the migration velocity cube shown in Figure 5.4-36b as demonstrated in Figure 5.4-37b; (b) the color-coded velocity field computed by interpolation of the velocity strands shown in (a).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0825.jpg?height=1043&width=555&top_left_y=120&top_left_x=241)

FIG. 5.4-39. (a) The prestack time-migrated section extracted from the migration velocity cube of Figure 5.4-36b coincident with the surface that corresponds to the velocity field in Figure 5.4-38b, (b) the same soction as in (a) with the viewing axis perpendicular to the plane of the paper.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0826.jpg?height=841&width=878&top_left_y=245&top_left_x=74)

FIG. 5.4-40. The prestack time-migrated section as in Figure 5.4-39b collapsed onto a 2-D section.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0827.jpg?height=1044&width=564&top_left_y=122&top_left_x=232)

FIG. 5.4-41. (a) A migration velocity volume, (b) the same volune viewed end-on showing the vertical variat velocity at a given CMP location.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0828.jpg?height=1032&width=616&top_left_y=122&top_left_x=209)

FIG. 5.4-42. (a) A time slice from the migration veiocity volume shown in Figure 5.4-41a with the interpretation of the rms velocity as a function of midprint lecation, (b) the migration velocity volume as in Figure 5.4-41a with the picknd velocity strands as in (a).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0829.jpg?height=1032&width=550&top_left_y=124&top_left_x=242)

FIG. 5.4-43. (a) The color-coded optimum rms velocity surface extracted from the migration velocity volume shown in Figure $5.4-41 \mathrm{a}$, (b) the same view as in Figure $5.4-41 \mathrm{~b}$ with the intersection of the rms velocity surface showing the vertical velocity variation at a given CMP location.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0830.jpg?height=1038&width=548&top_left_y=120&top_left_x=239)

FIG. 5.4-44. (a) The image surface associated with prestack time migration that was extracted from the migration velocity volume shown in Figure 5.4-41a by sculpting the amplitudes over the rms velocity surface shown in Figure 5.4-43a, (b) the image surface as in (a) after collapeing it onto a 2-D section associated with prestack time migration.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0831.jpg?height=656&width=890&top_left_y=339&top_left_x=76)

FIG. 5.4-45. A close-up view of the prestack time-migrated section as in Figure 5.4-44b.
(c) Sort the CVS volume $P\left(y, v_{D M O}, t_{0}\right)$ into a set of cosntant-velocity stacked sections $P\left(y, f_{0} ; v_{D M O}\right)$.

(d) Apply 2-D Fourier transform to obtain the CVS cube $P\left(k_{y}, v_{D M O}, \omega_{i j}\right)$ in the frequencywavenumber domain, where $k_{y}$ and $\omega$ are the Fourier transform variables associated with the variables $y$ and $t_{0}$.

(e) Sort the CVS volume $P\left(k_{y}, v_{D M O}, \omega_{0}\right)$ into a set of constant-velocity sections $P\left(k_{y}, \omega_{0} ; v_{D M O}\right)$.

(i) Migrate each of the constant-velocity sections of the DMO velocity volume by performing the Stolt mapping based on equations (5-46) and (5-47) so as to obtain the migration velocity volume $P\left(k_{y}, \omega_{\tau} ; v_{m ; g}\right)$.

(g) Apply 2-D inverse Fourier transform to obtain the migration velocity volume $P\left(y, \tau, v_{r \pi z g}\right)$ (Figure 5.4-36b).

The migration velocity volume $P\left(y, \tau, v_{\text {mag }}\right)$ shown in Figure $5.4-36 \mathrm{~b}$ can be visualized and interpreted to derive a migration velocity field. For spatial consistency, velocity picking should be done on time slices from the migration velocity volume as shown in Figure 5.4-37. The resulting velocity strands shown in Figure $5.4-38$ a are interpolated to create the migration velocity field shown in Figure 5.4-38b. This velocity field then can be used to extract from the volume the section that corresponds to prestack time migration as shown in Figure 5.4-39. An enlarged view of this section is shown in Figure 5.4-40. Note the excellent imaging of the steeply dipping fault planes which conflict with the gently dipping strata.

Alternatively, the plane of ( $v_{\text {tng }}, \tau$ ) for each midpoint $y$ can be inverse transformed to the plane of $(h, \tau)$ associated with the common-refection-point gather derived from prestack time migration. This is then followed by conventional normal-moveout correction and stacking. The resulting section, again, represents the image from prestack time migration.

The data example shown in Figure 5.4-36 demonstrates the use of the migration velocity volume in deriving a high-fidelity image of fault planes from prestack time migration (Figure 5.4-40). The data example shown in Figure 5.4-41 demonstrates the use of the migration velocity volume in imaging steeply dipping event. The migration velocity volume was created using the procedure described above. Specifically, the DMO-corrected CMP gathers were first NMO-corrected using a range of constant velocities and a CVS volume was created. Next, each constant-velocity stacked section was migrated using the Stolt mothod and the constant velocity associated with that section. The resulting migration velocity volume is shown in Figure 5.4-41. Note the vertical variation in velocities on the end-on view of the volume that represents the plane of velocity versus time.

The migration velocity volume is interpreted by picking the primary velocity trend from selected time slices as shown in Figure 5.4-42a. Note the lateral variation in velocities which is captured by continuous picking along the midpoint axis. By interpolating the velocity strands resulting from the interpretation of selected time slices (Figure 5.442a), an rms velocity surface is generated. The picked velocity strands are shown in Figure $5.4-42 \mathrm{~b}$ embedded within the migration velocity volume, and the rms velocity field is shown in Figure 5.4$43 \mathrm{a}$ as a color-coded surface extracted from within the migration velocity volume. A quality control of the rms velocity surface can be made by intersecting it with the cross-sections of the migration velocity volume at selected CMP locations as shown in Figure 5.4-43b.

The prestack time-migrated section is a by-product of the migration velocity analysis described here. Specifically, the image surface associated with the prestack time migration is obtained by sculpting the amplitudes from within the migration velocity volume over the rms velocity surface as shown in Figure 5.4-44a. The conventional 2-D display of the prestack time-migrated section is then created by simply collapsing the sculpted image surface onto a 2-D plane (Figure 5.4-44b). A close-up view of the prestack time-migrated section shows accurate imaging of the steeply dipping event (Figure 5.4$45)$.

## EXERCISES

Exercise 5-1. Consider the application of DMO correction to data referred to a floating datum represented by a smooth form of an irregular topographic surface and data referenced to a flat datum below. Which DMO correction would have more effect on the data?

Exercise 5-2. Refer to Fowler's velocityindependent prestack migration technique for migration velocity analysis described in Section 5.4. Suppose you have transformed the prestack data from offset to velocity space using 30 constant velocity values from 2000 $\mathrm{m} / \mathrm{s}$ to $4900 \mathrm{~m} / \mathrm{s}$ using an increment of $100 \mathrm{~m} / \mathrm{s}$. Can you create additional constant-velocity panels such that the increment is $50 \mathrm{~m} / \mathrm{s}$ by poststack migration rather than prestack migration or trace interpolation? If so, what velocity would you use for poststack migration to create the panel for $3050-\mathrm{m} / \mathrm{s}$ velocity.

Exercise 5-3. Derive Bancroft's equivalent offset equation ( $\mathrm{E}-\mathbf{7 2 b}$ ) from the nonzero-offset traveltime equation (E-67).

Exercise 5-4. Suppose you have two events with conflicting dips of the same magnitude, but in opposite directions, associated with a reflector within a fault block and the fault plane itself. Can these two events be distinguished on a velocity spectrum computed from a CMP gather before DMO correction at a location just above the surface point where the two events intersect one another?

## Appendix $\mathbf{E}$ <br> TOPICS IN DIP-MOVEOUT CORRECTION AND PRESTACK TIME MIGRATION

## E. 1 Reflection Point Dispersal

We start the analysis using the geomctry of Figure E-1. Place the source $S$ at the origin $(0,0)$, and denote the coordinates of the points of interest as $N:\left(x_{0}=S K, x_{0}=K N\right), H:\left(x_{1}=\right.$ $\left.S B, z_{1}=B H\right), F:\left(x_{2}=S A, z_{2}=A F\right)$, and $R:\left(x_{3}=S Q, z_{3}=Q R\right)$. Our objective is to compute the coordinates for the normal-incidence reflection point $N:\left(x_{0}, z_{0}\right)$ associated with midpoint $M$, and the reflection point $R:\left(x_{3}, z_{3}\right)$ associated with the nonzero-offset source receiver separation $x=S G$.

First, we compute the coordinates for $N:\left(x_{0}, z_{0}\right)$. From the geometry of Figure E-1, first, note that $x_{0}=S K$ and $z_{0}=K N$. Then, from the triangle $M K N$, we have

$$
\frac{M K}{M \bar{N}}=\cos \alpha
$$

which, by way of $M K=x_{0}-x / 2$, yields

$$
M N=\frac{x_{0}-x / 2}{\cos \alpha}
$$

Similarly, from the same triangle $M K N$, we have

$$
\frac{K N}{M N}=\cos \phi
$$

which, by way of $K N=z_{0}$, yields

$$
M N=\frac{z_{0}}{\cos \phi}
$$

Finally, combine equations ( $\mathrm{E}-1 \mathrm{a}$ ) and (E-1b) to get a relation between $x_{0}$ and $z_{0}$

$$
\frac{x_{0}-x / 2}{\cos \alpha}=\frac{z_{0}}{\cos \phi}
$$

Next, write the equation of the line that represents the dipping reflector in terms of the directional casines and the normal $d=S C$ to the line from the origin $S$

$$
x_{0} \cos \alpha+z_{0} \cos \phi=d .
$$

Solve for $z_{0}$ from equation (E-2a) and substitute into equation ( $\mathbf{E}-2 \mathrm{~b}$ )

$$
x_{0} \cos \alpha+\left(x_{0}-\frac{x}{2}\right) \frac{\cos ^{2} \phi}{\cos \alpha}=d
$$

Note that the directional cosines satisfy the relation $\cos ^{2} \alpha+\cos ^{2} \phi=1$. By making use of this relation, simplify equation $\left(\mathrm{E}-3\right.$ ) to get the final expression for the coordinate $x_{0}$

$$
x_{0}=d \cos \alpha+\frac{x}{2} \cos ^{2} \phi
$$

Finally, substitute $x_{0}$ back into equation (E-2a) to get the expression for the coordinatc $z_{0}$

$$
z_{0}=d \cos \phi-\frac{x}{2} \cos \alpha \cos \phi .
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0835.jpg?height=356&width=628&top_left_y=134&top_left_x=207)

FIG. E-1. Geometry of a dipping reflector to derive the expression for reflection-point dispersal (Section E.1).

The distance $d=S C$ is given by

$$
d=S U+U C
$$

which can be rewritten using the geometry of Figure E-1 as follows:

$$
d=S M \cos \alpha+M N
$$

Substitute the definitions $S M=x / 2$ and $D=M N$, where $D$ is the distance along the normalincident raypath from the point $N$ on the reflector to the midpoint location $M$, to obtain the relation between $d$ and $D$

$$
d=D+\frac{x}{2} \cos \alpha
$$

Make the further substitution of equation ( $E-5$ ) into equations ( $E-4 a$ ) and (E-4b), and recall that $\cos ^{2} \alpha+\cos ^{2} \phi=1$ to derive the expressions for the coordinates of $N:\left(x_{0}, z_{0}\right)$ in terms of D

and

$$
x_{0}=D \cos \alpha+\frac{x}{2} \quad(E-6 a)
$$

$$
z_{0}=D \cos \phi
$$

To derive the expressions for the coordinates of $R:\left(x_{3}, z_{3}\right)$, we note that $R$ is the intersection of the line defined by the reflecting interface, which yields the relation

$$
x_{3} \cos \alpha+z_{3} \cos \phi=d
$$

and the line $S R F$, which yields the relation

$$
\frac{x_{3}}{x_{2}}=\frac{z_{3}}{z_{2}}
$$

where $\left(x_{2}, z_{2}\right)$ are the coordinates of $F$. From the geometry of Figure $\mathbf{E}-1$, first, note that $x_{2}=S A, z_{2}=A F$, and $x_{3}=S Q$ and $z_{3}=Q R$.

Solve equation (E-7b) for $x_{3}$ and substitute into cquation (E-7a) to get

$$
z_{3}=\frac{z_{2}}{x_{2} \cos \alpha+z_{2} \cos \phi} d
$$

The coordinates for $F:\left(x_{2}, z_{2}\right)$ are derived in Section C.3 (equations C-18c,d)

$$
x_{2}=2(d-x \cos \alpha) \cos \alpha+x
$$

and

$$
z_{2}=2(d-x \cos \alpha) \cos \phi
$$

Substitute equations (E-9a) and ( $\mathrm{E}-9 \mathrm{~b}$ ) into equation (E-8), and replace $d$ via equation (E-5) to obtain, after some involved algebra, the expression for $z_{3}$

$$
z_{3}=D \cos \phi-\frac{x^{2}}{4 D} \cos ^{2} \alpha \cos \phi
$$

Back substitution of equation (E-10a) into equation (E-7a) then yields the expression for $x_{3}$

$$
x_{3}=D \cos \alpha+\frac{x}{2}+\frac{x^{2}}{4 D} \sin ^{2} \alpha \cos \alpha
$$

Knowing the coordinates of $N:\left(x_{0}, z_{0}\right)$ and $R:\left(x_{3}, z_{3}\right)$, the distance $\Delta-N R$ can now be computed

$$
\Delta=\sqrt{\left(x_{3}-x_{0}\right)^{2}+\left(z_{3}-z_{0}\right)^{2}} .
$$

Substitute equations ( $\mathrm{E}-10 \mathrm{a}$ ) and ( $\mathrm{E}-10 \mathrm{~b})$ for the coordinates of $R:\left(x_{3}, z_{3}\right)$, and equations (E-6a) and (E-6b) for the coordinates of $N:\left(x_{0}, x_{0}\right)$ into equation (E-1la) and carry out the algebraic steps to get the final expression

$$
\Delta=\frac{x^{2}}{4 D} \sin \alpha \cos \alpha
$$

Equation (E-11b) represents the reflection point smear, otherwise known as reflection point dispersal (Deregowski, 1981) - the distance between the normal-incidence reflection point $N$ associated with the zero-offset raypath from midpoint $M$, and the reflection point $R$ associated with the nonzero-offset raypath for a source-receiver pair separated by an offset $x$. For the case of zero-offset $x=0$, reflection point smear $\Delta$ vanishes.

Define the two-way zero-offset time $t_{0}$ at midpoint $M$ as the time associated with the normal-incidence raypath $M N$ by the relation $v t_{0} / 2=D$. Then use this relation in equation (E-11b) to obtain the expression for reflection point dispersal $\Delta$ in terms of $t_{0}$

$$
\Delta=\frac{x^{2}}{2 v t_{0}} \sin \alpha \cos \alpha
$$

This equation is applicable to the general case of three-dimensional geometry (Figure 3.1-14), where $\alpha$ is the angle between the normal to the dipping reflector surface and the direction of the profile line (Levin, 1971).

For the 2-D geometry of the dipping refiector (Figure E-1, note that

$$
\sin \alpha=\cos \phi
$$

where $\phi$ is the dip angle of the reflector. Hence, equation (E-12) is written in tertns of the reflector dip angle $\phi$ as follows:

$$
\Delta=\frac{x^{2}}{2 v t_{0}} \cos \phi \sin \phi
$$

Equation (E-14), by way of equation (5-6), is the same as equation (5-10) of the main text with offset $x=2 h$.

## E. 2 Equations for DMO Correction

In this section, we shall derive the traveltime equation for dip-moveout (DMO) correction by using the geometry of Figure 5.1-1. Start with equation (C-22b) of Section C.3 which defines the traveltime $t$ from source location $S$ to the reflection point $R$ to the receiver location $G$, written in prestack data coordinates

$$
t^{2}=t_{0}^{2}+\frac{4 h^{2} \cos ^{2} \phi}{v^{2}}
$$

where $2 h$ is the offset, $v$ is the medium volocity above the reflector, $\phi$ is the reflector dip, and $t_{0}$ is the two-way zero-offset time at madpont location $y_{n}$. Dip-moveout correction is preceded by normal-moveout (NMO) correction using the dip-independent velocity $v$

$$
t^{2}=t_{n}^{2}+\frac{4 h^{2}}{v^{2}}
$$

where $t_{n}$ is the event time after the NMO correction. To relate event time $t_{n}$ after the NMO correction and event time $t_{0}$, first, write cquation (E-15a) as

$$
t^{2}=t_{0}^{2}+\frac{4 h^{2}}{v^{2}}-\frac{4 h^{2} \sin ^{2} \phi}{v^{2}}
$$

Set the right-hand sides of equations (E-15b) and (E-16) equal and simplify the result to obtain the dip-dependent moveout equation

$$
t_{n}^{2}=t_{0}^{2}-\frac{4 h^{2} \sin ^{2} \phi}{v^{2}}
$$

Equations (E-15b) and (E-17) suggest that moveout correction can, in principle, be performed in two steps:

(a) Apply a dip-independent moveout corrction using equation (E-15b) to map event time $t$ to event time $t_{n}$.

(b) Apply a dip-dependent moveout correction using equation (E-17) to map event time $t_{n}$ to event time $t_{0}$.

This two-step moveout correction is equivalent to the one-step moveout correction using equation (E-15a) to map event time $t$ directly to cvent time $t_{0}$.

Our goal, however, is to map event time $t$ to $\tau_{0}$ - two-way zero-offset time, not at midpoint location $y_{n}$ associated with the source-receiver pair $S-G$, but at midpoint location $y_{0}$ associated with the normal-incidence reflection point $R$. This mapping requires coordinate transformation of moveout-corrected prestack data $P_{n}\left(y_{n}, t_{n} ; h\right)$ to $P_{0}\left(y_{0}, \tau_{0} ; h\right)$. Therefore, we need to compute the coordinates $\left(y_{0}, \tau_{0}\right)$ in terms of the coordinates $\left(y_{n}, t_{n}\right)$.

From the geometry of Figure 5.1-1, note that

$$
y_{0}=y_{n}-\frac{\Delta}{\cos \phi}
$$

where $\Delta=N R$ is the distance along the reflector between the normal-incidence reflection point $N$ associated with the zero-offset raypath from midpoint $y_{n}$ and the reflection point $R$ associated with the nonzero-offset raypath for a source-receiver pair separated by an offset $2 h$.

Adapt equation (E-14) of Section E. 1 for the prestack data coordinates $x=2 h$

$$
\Delta=\frac{2 h^{2}}{v t_{0}} \cos \phi \sin \phi
$$

and substitute into equation ( $E-18$ ) to obtain

$$
y_{0}=y_{n}-\frac{h^{2}}{t_{0}}\left(\frac{2 \sin \phi}{v}\right)
$$

Solve cquation (E-17) for $t_{0}$ and write the result in the following form

$$
t_{0}=t_{n} \sqrt{1+\frac{h^{2}}{t_{n}^{2}}\left(\frac{2 \sin \phi}{v}\right)^{2}}
$$

or

$$
t_{0}=t_{n} A \text {, }
$$

where

$$
A=\sqrt{1+\frac{h^{2}}{t_{n}^{2}}\left(\frac{2 \sin \phi}{v}\right)^{2}}
$$

Now, substitute equation (E-22) into equation (E-20) to get the final expression for $y_{0}$

$$
y_{0}=y_{n}-\frac{\hbar^{2}}{t_{n} A}\left(\frac{2 \sin \phi}{v}\right)
$$

Also from the geometry of Figure 5.1-1, note that

$$
\tau_{0}=t_{0}-\frac{2 \Delta \tan \phi}{v}
$$

Substitute equation ( $\mathrm{E}-19$ ) for $\Delta$ and carry out the required algebra to get the desired expression for $\tau_{0}$ in terrms of $t_{0}$

$$
\tau_{0}=t_{0}-\frac{h^{2}}{t_{0}}\left(\frac{2 \sin \phi}{v}\right)^{2}
$$

Now, substitute equation ( $\mathrm{E}-22)$ into equation ( $\mathrm{E}-26$ )

$$
\tau_{\mathrm{o}}=t_{n} A-\frac{h^{2}}{t_{n} A}\left(\frac{2 \sin \phi}{v}\right)^{2}
$$

Finally, simplify equation (E-27) by way of equation (E-23) to obtain the desired expression for $\tau_{0}$ in terms of $t_{n}$

$$
\tau_{0}=\frac{t_{n}}{A}
$$

We now remind oursolves of our objective to transform the normal-moveout-corrected prestack data $P_{n}\left(y_{n}, t_{n} ; h\right)$ from $y_{n}-t_{n}$ coordinates to $y_{0}-\tau_{0}$ coordinates so as to obtain the dip-moveout-corrected data $P_{0}\left(y_{0}, \tau_{0} ; h\right)$. The transformation is done using equations (E-24) and (E-28) which relate the input data coordinates $y_{n}-t_{n}$ to output data coordinates $y_{0}-\tau_{0}$. Note, however, equations (E-24) and (E-28) require knowledge of the reflector dip $\phi$. To circumvent this requirement, we use the relation from Section D. 1

$$
\sin \phi=\frac{v k_{y}}{2 \omega_{0}}
$$

which states that the reflector dip $\phi$ can be expressed in terms of wavenumber $k_{y}$ and frequency $\omega_{0}$, which are the Fourier duals of midpoint $y_{0}$ and event time $\tau_{0}$, respectively. The variables $y_{0}$ and $\tau_{0}$ defined by equations ( $\mathrm{E}-24$ ) and ( $\mathrm{E}-28$ ), respectively, are associated with the zero-ofset section after DMO correction. By way of equation (E-29), these equations are recast explicitly independent of reflector dip as

$$
y_{0}=y_{n}-\frac{h^{2} k_{y}}{t_{n} A \omega_{0}}
$$

and

$$
\tau_{0}=\frac{t_{n}}{A}
$$

where $A$ of equation (E-23), by way of equation (E-29), is of the form

$$
A=\sqrt{1+\frac{h^{2} k_{v}^{2}}{t_{n}^{2} \omega_{0}^{2}}}
$$

Since we have switched to the Fourier transform domain in our analysis, our objective now is to compute the dip-moveout-corrected data $P_{0}\left(k_{u}, w_{0} ; h\right)$ in the transform domain. Thus, start with the 2-D Fourier transform of $P_{0}\left(y_{0}, T_{0} ; h\right)$

$$
P_{0}\left(k_{y}, \omega_{0} ; h\right)=\iint P_{0}\left(y_{0}, \tau_{0} ; h\right) \exp \left(\imath k_{y} y_{0}-i \omega_{0} \tau_{0}\right) d y_{0} d \tau_{0}
$$

A wavefield is invariant under a coordinate transformation; hence, $P_{0}\left(y_{0}, \tau_{0} ; h\right)=$ $P_{n}\left(y_{n}, t_{n} ; h\right)$. Use the transform relations given by equations (E-30) and (E-31) and the invariance relation to write equation ( $\mathrm{E}-33$ ) in terms of the normal-moveout-corrected data $P_{n}\left(y_{n}, t_{n} ; h\right)$ (Liner, 1990)

$$
P_{0}\left(k_{y}, \omega_{0} ; h\right)=\iint P_{n}\left(y_{n}, t_{n} ; h\right) \frac{\partial y_{0}}{\partial y_{n}} \frac{\partial \tau_{0}}{\partial t_{n}} \exp \left[i k_{y}\left(y_{n}-\frac{h^{2} k_{y}}{t_{n} A \omega_{0}}\right)-i \frac{\omega_{0} t_{n}}{A}\right] d y_{n} d t_{n} .(E-34)
$$

Fron equation (E-30) it follows that

$$
\frac{\partial y_{0}}{\partial y_{n}}=1
$$

Square both sides of equation (E-31), substitute equation (E-32) for the quantity $A$ and simplify to get

$$
\tau_{0}^{2}=\frac{t_{n}^{4} \omega_{0}^{2}}{t_{n}^{2} \omega_{0}^{2}+h^{2} k_{y}^{2}}
$$

Next, differentiate the result,

$$
\frac{\partial \tau_{0}}{\partial t_{n}}=\frac{4 t_{n}^{3} \omega_{0}^{2}\left(t_{n}^{2} \omega_{0}^{2}+h^{2} k_{y}^{2}\right)-2 t_{n}^{5} \omega_{0}^{4}}{2 \tau_{0}\left(t_{n}^{2} \omega_{0}^{2}+h^{2} k_{y}^{2}\right)^{2}}
$$

Rearrange the terms in equation ( $E-32$ ) to the form

$$
t_{n}^{2} \omega_{0}^{2}+h^{2} k_{y}^{2}=t_{n}^{2} \omega_{0}^{2} A^{2}
$$

and use in equation (E-36b) together with equation (E-31) for the $\tau_{0}$ in the denominator to obtain

$$
\frac{\partial \tau_{0}}{\partial t_{n}}=\frac{2 A^{2}-1}{A^{3}}
$$

Finally, substitute equations (E-35) and (E-37) into equation (E-34)

$$
P_{0}\left(k_{y}, \omega_{0} ; h\right)=\iint \frac{2 A^{2}-1}{A^{3}} P_{n}\left(y_{n}, t_{n} ; h\right) \exp \left[i k_{y}\left(y_{n}-\frac{h^{2} k_{y}}{t_{n} A \omega_{0}}\right)-\frac{\omega_{0} t_{n}}{A}\right] d y_{n} d t_{n} .(E-38)
$$

Now, we turn our attention to the phase term in equation (E-38)

$$
\Phi=k_{y}\left(y_{n}-\frac{h^{2} k_{y}}{t_{n} A \omega_{0}}\right)-\frac{w_{0} t_{n}}{A}
$$

Rearrange the terms, first, as follows:

$$
\Phi=k_{y} y_{n}-\frac{\omega_{0} t_{n}}{A}\left(1+\frac{h^{2} k_{y}^{2}}{t_{n}^{2} \omega_{0}^{2}}\right)
$$

then, by way of the expression for $A$ as in equation ( $E-32$ )

$$
\Phi=k_{y} y_{n}-\omega_{0} t_{n} A
$$

Return to equation (E-38) and substitute equation (E-39) for the terms in the exponential

$$
P_{0}\left(k_{y}, \omega_{0} ; h\right)=\iint \frac{2 A^{2}-1}{A^{3}} P_{n}\left(y_{n}, t_{n} ; h\right) \exp \left(\imath k_{y} y_{n}-i \omega_{0} t_{n} A\right) d y_{n} d t_{n} . \quad(E-40)
$$

Use the Fourier tranşform integral

$$
P_{n}\left(k_{y}, t_{n} ; h\right)=\int P_{n}\left(y_{n}, t_{n} ; h\right) \exp \left(i k_{y} y_{n}\right) d y_{n}
$$

to rewrite equation ( $\mathrm{E}-40$ ) in the form

$$
P_{0}\left(k_{y}, \omega_{0} ; h\right)=\int \frac{2 A^{2}-1}{A^{3}} P_{n}\left(k_{y}, t_{n} ; h\right) \operatorname{cxp}\left(-\imath \omega_{0} t_{n} A\right) d t_{n}
$$

Equation (E-42) describes the dip-moveout correction process which transforms the normalmoveout-corrected prestack data with a specific offset $2 h$ from $y_{n}-t_{n}$ domain to $y_{0}-\tau_{0}$ domain. Referring to Figure 5.1-1, we remind ourselves that $y_{n}-t_{r}$ coordinates are associated with event time $t_{n}$ at midpoint location $y_{n}$, and $y_{0}-\tau_{0}$ coordinates are associated with event time $\tau_{0}$ at midpoint location $y_{0}$ that corresponds to the normal-incidence reflection. The lateral excursion applied by dip-moveout correction is $\Delta y_{D M O}=\left|y_{n}-y_{0}\right|$ and the verticel excursion is $\Delta t_{D M O}=t_{\mathrm{n}}-\tau_{0}$.

Once dip-moveout correction is applied, the data are inverse Fourier transformed

$$
P_{0}\left(y_{0}, \tau_{0} ; h\right)=\iint P_{0}\left(k_{3}, \omega_{0} ; h\right) \exp \left(-i k_{y} y_{0}+i \nu_{0} \tau_{0}\right) d k_{y} d \omega t_{0}
$$

A flowchart of the dip-moveout correction in the frequency-wavenumber domain described above is presented in Figure 5.1-2.

## E. 3 Log-Stretch DMO Correction

A computationally efficient DMO correction can be formulated in the logarithmic time domain (Bolondi et al., 1982; ; Bale and Jacubowicz, 1987; Notfors and Godfrey, 1987; Liner, 1990; Zhou et al., 1996). The log-stretch time variable enables linearization of the coordinate transform equation (E-28), and as a result, the DMO correction is achieved by a simple multiplication of the input data with a phase-shift operator in the Fourier transform domain.

Define the following logarithmic variables that correspond to the time variables $\tau_{0}$ and $t_{n}$ of equation ( $\mathrm{E}-28$ ):

$$
T_{0}=\ln \tau_{0}
$$

and

$$
T_{n}=\ln t_{n} .
$$

Hence, the inverse relationships are given by

$$
\tau_{0}=e^{T_{0}}
$$

and

$$
t_{n}=e^{T_{n}}
$$

In Section E.2, we derived the equations for DMO correction to transform the normalmoveout-corrected data from $\left(y_{n}, t_{n}\right)$ ccordinates to $\left(y_{0}, T_{0}\right)$ coordinates. The objective here is to derive equations for DMO correction in the log-stretch coordinates $\left(y_{0}, T_{0}\right)$,

Square both sides of equation ( $E-28$ )

$$
\tau_{0}^{2}=\frac{t_{n}^{2}}{A^{2}}
$$

and subsitute equation (E-23) for $A$

$$
\tau_{0}^{2}=-\frac{t_{n}^{2}}{1+\frac{h^{2}}{t_{n}^{2}}\left(\frac{2 \sin \phi}{v}\right)^{2}}
$$

Here, we have to make the crucial assumption that $A$ is close to unity. Refer to equation (E-23) and note that such an assumption implies one of the following: small $h$ (offset), small $\phi$ (dip), large $t_{n}$ (time after moveout) or large $v$ (velocity). As a result, equation (E-46b) can be approximated as

$$
\tau_{0}^{2}=t_{n}^{2}\left[1-\frac{h^{2}}{t_{n}^{2}}\left(\frac{2 \sin \phi}{v}\right)^{2}\right]
$$

The slope $d \tau_{0} / d y_{0}$ measured on a zero-offset section in $\left(y_{0}, \tau_{0}\right)$ coordinates is given by

$$
\frac{d \tau_{0}}{d y_{0}}=\frac{2 \sin \phi}{v}
$$

Substitute equation (E-46d) into equation (E-46c)

$$
\tau_{0}^{2}=t_{n}^{2}\left[1-\frac{h^{2}}{t_{n}^{2}}\left(\frac{d \tau_{0}}{d y_{0}}\right)^{2}\right]
$$

Apply the chain rule for differentiation

$$
\frac{d \tau_{0}}{d y_{0}}=\frac{d T_{0}}{d T_{0}} \frac{d T_{0}}{d y_{0}}
$$

and, by way of equation (E-45a), obtain the relationship

$$
\frac{d \tau_{0}}{d y_{0}}=e^{T_{0}} \frac{d T_{0}}{d y_{0}}
$$

Next, combine equations (E-29) and (E-46d) to get

$$
\frac{d \tau_{0}}{d y_{0}}=\frac{k_{y}}{\omega_{0}}
$$

By analogy, we may write

$$
\frac{d T_{0}}{d y_{0}}=\frac{k_{y}}{\Omega_{0}}
$$

where $\Omega_{0}$ is the Fourier transform variable associated with the log-stretch time variable $T_{0}$. Finally, substitute equation (E-47d) into equation (E-47b) to get

$$
\frac{d \tau_{0}}{d y_{0}}=e^{T_{0}} \frac{k_{y}}{\Omega_{0}}
$$

Now, return to equation (E-46e), and use equations (E-45a,b) and (E-47e) to obtain the expression

$$
e^{2\left(T_{0}-T_{\mathrm{r}}\right)}\left(1+\frac{h^{2} k_{\mathrm{v}}^{2}}{\Omega_{0}^{2}}\right)=1
$$

Take the logarithm of both sides and simplify to get the transform relation between the input $\log$-stretch time variable $T_{n}$ and the output log-stretch time variable $T_{0}$

$$
T_{0}=T_{n}-\ln A_{e}
$$

where

$$
A_{c}=\sqrt{1+\frac{h^{2} k_{y}^{2}}{\Omega_{0}^{2}}}
$$

We now turn our attention to equation (E-24) and derive the corresponding equation in the $\log$-stretch domain. First, substitute equation (E-23) into equation (E-24) and approximate the quantity $A$ as before

$$
y_{0}=y_{n}-\frac{h^{2}}{t_{n}}\left[1-\frac{1}{2} \frac{h^{2}}{t_{n}^{2}}\left(\frac{2 \sin \phi}{v}\right)^{2}\right]\left(\frac{2 \sin \phi}{v}\right)
$$

Substitute equation (E-46d) into equation (E-5la)

$$
y_{0}=y_{n}-\frac{h^{2}}{t_{n}}\left[1-\frac{1}{2} \frac{h^{2}}{t_{n}^{2}}\left(\frac{d \tau_{0}}{d y_{0}}\right)^{2}\right]\left(\frac{d \tau_{0}}{d y_{0}}\right)
$$

Then, make the substitutions from equations (E-45b) and (E-47e), drop the high-order term, and simplify to get

$$
y_{0}=y_{n}-e^{T_{0}-T_{n}} h^{2} \frac{k_{y}}{\Omega_{0}}
$$

Note from equation (E-48)

$$
e^{T_{0}-T_{n}}=\frac{1}{\sqrt{1+\frac{h^{2} k_{y}^{2}}{\Omega_{0}^{2}}}}
$$

Use this result in equation (E-51c) accompanjed with the definition of equation (E-50) to obtain the final expression that relates $y_{0}$ and $y_{n}$ in $\log$-stretch coordinates

$$
y_{0}=y_{n}-\frac{h^{2} k_{y}}{A_{e} \Omega_{0}}
$$

Equations (E-49), (E-50), and (E-53) correspond to equations (E-31), (E-32), and (E-30) in the $\log$-stretch domain.

We remind ourselves of the objective to compute the dip-moveout-corrected data $P_{0}\left(k_{y}, \Omega_{0} ; h\right)$ in the transform domain. Thus, start with the 2-D Fourier transform of $P_{0}\left(y_{0}, T_{0} ; h\right)$

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\iint P_{0}\left(y_{0}, T_{0} ; h\right) \exp \left(i k_{y} y_{0}-i \Omega_{0} T_{0}\right) d y_{0} d T_{0}
$$

A wavefield is invariant under a coordinate transformation; hence, $P_{0}\left(y_{0}, T_{0} ; h\right)=$ $P_{n}\left(y_{n}, T_{n} ; h\right)$, the latter being the normal-moveout-corrected data in the log-stretch domain. Use the transform relations given by equations (E-49) and (E-53) and the invariance relation to write equation (E-54) in terms of the normal-moveout-corrected data $P_{n}\left(y_{n}, T_{n} ; h\right.$ ) (Liner, 1990)

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\iint P_{n}\left(y_{n}, T_{n} ; h\right) \exp \left[i k_{y}\left(y_{n}-\frac{h^{2} k_{y}}{A_{e} \Omega_{0}}\right)-i \Omega_{0}\left(T_{n}-\ln A_{e}\right)\right] \frac{\partial y_{0}}{\partial y_{n}} \frac{\partial T_{0}}{\partial T_{n}} d y_{n} d T_{n}
$$

From equation (E-53) it follows that

$$
\frac{\partial y_{0}}{\partial y_{n}}=1
$$

and from equation ( $\mathrm{E}-49$ ), we have

$$
\frac{\partial T_{0}}{\partial T_{n}}=1
$$

Substitute equations ( $\mathbf{E}-56 \mathrm{a}, \mathrm{b}$ ) into equation (E-55) and rearrange the terms in the exponential to obtain

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\exp \left[-\imath k_{y} \frac{h^{2} k_{y}}{A_{e} \Omega_{0}}+\imath \Omega_{0} \ln A_{e}\right] \iint P_{n}\left(y_{n}, T_{n} ; h\right) \exp \left(2 k_{y} y_{n}-\imath \Omega_{0} T_{n}\right) d y_{n} d T_{n}
$$

Assume that the Fourier transform variable $\Omega_{0}$ in the log-stretch domain is independent of $T_{n}$. Then, the double integral on the right-hand side represents the 2-D Fourier transform of the normal-moveout-corrected data in the log-stretch domain as

$$
P_{n}\left(k_{y}, \Omega_{0} ; h\right)=\iint P_{n}\left(y_{n}, T_{n} ; h\right) \exp \left(\imath k_{y} y_{n}-i \Omega_{0} T_{n}\right) d y_{n} d T_{n}
$$

Therefore, by way of equation ( $E-58$ ), equation (E-57) takes the form

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\exp \left(-i \frac{h^{2} k_{y}^{2}}{A_{t} \Omega_{0}}+i \Omega_{0} \ln A_{c}\right) P_{n}\left(k_{y}, \Omega_{0} ; h\right)
$$

Equation (E-59) describes the dip-moveout correction process which transforms the normalmoveout-corrected prestack data with a specific offset $2 h$ from the log-stretch $y_{n}-T_{n}$ domain to $y_{0}-T_{0}$ domain. Note that the relationship of input $P_{n}\left(k_{y}, \Omega_{0} ; h\right)$ to output $P_{0}\left(k_{y}, \Omega_{0} ; h\right)$ given by equation (E-59) computationally is much simpler than that of equation (E-42). Once the phase-shift in the log-stretch domain given by equation (E-59) is applied to the input and the result is inverse Fourier transformed, the data are unstretched from $\left(y_{0}, T_{0}\right)$ coordinates back to $\left(y_{0}, \tau_{0}\right)$ coordinates using the relationship expressed by equation ( $\left.\mathrm{E}-45 \mathrm{a}\right)$.

A variation of the phase-shift term in equation (E-59) is given by Notfors and Godfrey (1987). As in most log-stretch formulations of DMO correction, this reference assumes that under DMO correction the midpoint variable is invariant; hence, by way of equation (E-53), the first term in the exponential of equation (E-59) drops out. A further approximation, $\ln A_{e}=A_{e}-1$, and use of the definition for $A_{e}$ given by equation ( $\mathrm{E}-50$ ) then lead to the following expression for DMO correction:

$$
P_{0}\left(k_{y}, \Omega_{0} ; h\right)=\operatorname{cxp}\left[2 \Omega_{0}\left(\sqrt{1+\frac{h^{2} k_{\nu}^{2}}{\Omega_{0}^{2}}}-1\right)\right] P_{n}\left(k_{y}, \Omega_{0} ; h\right)
$$

Various implementations of the log-stretch technique applied to shot records are described by Biondi and Ronen (1987), Cobrera and Levy (1989), and Zholn et al. (1996). The latter also includes a method in double-log-stretch domain, which involves stretching both in time and midpoint coordinates. See Section 5.1 for a practical implementation of the log-stretch DMO correction, described here.

## E. 4 The DMO Ellipse

The objective is to derive the traveltime trajectory associated with the dip-moveout correction operator by using the method of stationary phase. Insert from equation (E-42) the expression for $P_{0}\left(k_{y}, T_{0} ; h\right)$ into equation $(\mathbf{E}-43)$

$$
P_{0}\left(y_{0}, \tau_{0} ; h\right)=\iiint \frac{2 A^{2}-1}{A^{3}} P_{n}\left(k_{y}, t_{n} ; h\right) \operatorname{cxp}\left(-z \omega_{0} t_{n} A-i k_{y} y_{0}+z \omega_{0} \tau_{0}\right) d t_{n} d k_{y} d \omega_{0}
$$

where the total phase is given by

$$
\Phi=-\omega_{0} t_{n} A-k_{y} y_{0}+\omega_{0} \tau_{0}
$$

Substitute equation (E-32) for $A$

$$
\Phi=-\sqrt{\omega_{0}^{2} t_{n}^{2}+h^{2} k_{y}^{2}}-k_{y} y_{0}+\omega_{0} \tau_{0}
$$

The main contribution to the integration in equation (E-61) occurs when the phase in equation ( $\mathrm{E}-62 \mathrm{~b}$ ) stays nearly constant. We therefore determine the variation of $\Phi$ with respect
to variables $\omega_{0}$ and $k_{y}$

$$
\frac{\partial \Phi}{\partial \omega_{0}}=-\frac{\omega_{0} t_{n}^{2}}{\sqrt{\omega_{0}^{2} t_{n}^{2}+h^{2} k_{y}^{2}}}+\tau_{0}
$$

and

$$
\frac{\partial \Phi}{\partial k_{y}}=-\frac{k_{k} h^{2}}{\sqrt{\omega_{0}^{2} t_{r i}^{2}+h^{2} k_{v}^{2}}}-y_{0}
$$

Then set each variation to zero. Rearranging the terms of the resulting expressions, we have

$$
\frac{\omega_{0} t_{n}}{\sqrt{\omega_{0}^{2} t_{n}^{2}+h^{2} k_{y}^{2}}}=\frac{\tau_{0}}{t_{n}}
$$

and

$$
\frac{k_{y} h}{\sqrt{\omega_{0}^{2} t_{n}^{2}+h^{2} k_{y}^{2}}}=-\frac{y_{0}}{h}
$$

Then, square both sides of equations (E-64a,b)

$$
\frac{\omega_{0}^{2} t_{n}^{2}}{\omega_{0}^{2} t_{n}^{2}+h^{2} k_{y}^{2}}=\frac{\tau_{0}^{2}}{t_{n}^{2}}
$$

and

$$
\frac{k_{y}^{2} h^{2}}{\omega_{0}^{2} t_{n}^{2}+h^{2} k_{y}^{2}}=\frac{y_{0}^{2}}{h^{2}}
$$

Finally, sum equations ( $\mathrm{E}-65 \mathrm{a}, \mathrm{b}$ ) to obtain

$$
\frac{y_{0}^{2}}{h^{2}}+\frac{\tau_{0}^{2}}{t_{n}^{2}}=1
$$

Equation (E-66) describes an ellipse with the following properties:

(a) Semi-major axis in midpoint $y_{0}$ direction: $a=h$.

(b) Semi-minor axis in time $\tau_{0}$ direction: $b=t_{n}$.

The ellipse of equation (E-66) in the $y_{0}-\tau_{0}$ plane describes the impulse response of a dip-moveout operator applied to a common-offset section with offset $2 h$.

## E. 5 Nonzero-Offset Traveltime Equation

Prestack wave extrapolation is performed using the double-square operator which enables downward continuation of common-shot and common-receiver gathers (Section D.1). Stationary phase epproximation to the double-square root operator yields the nonzero-offset traveltime equation (D-35) derived in Section D. 2

$$
v t=\sqrt{(y+h)^{2}+z^{2}}+\sqrt{(y-h)^{2}+z^{2}}
$$

where $y, h, t_{1} z$ are midpoint, offset, two-way traveltime and depth coordinates and $v$ is the medium velocity. Here, we shall show that this equation represents an ellipse (Figure E-2) in the $y-z$ plane for a constant $t, h$, and $v$, and derive the parameters of this ellipse. The nonzero-ofset two-way time is associated with the raypath from source $S$ to reflection point $R$ to receiver $G$ as sketched in Figure E-2. The origin of the $y-z$ plane coincides with midpoint $M$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0845.jpg?height=401&width=586&top_left_y=116&top_left_x=220)

FIG. E-2. The prestack time migration ellipse. See Section E. 5 for detalk.

Square both sides of equation (E-67) to get

$$
\begin{aligned}
v^{2} t^{2} & =2 \sqrt{\left[(y+h)^{2}+z^{2}\right]\left[(y-h)^{2}+z^{2}\right]} \\
& +\left[(y+h)^{2}+z^{2}\right]+\left[(y-h)^{2}+z^{2}\right]
\end{aligned}
$$

Combine the second and third terms on the right-hand side and simplify the terms inside the square root

$$
v^{2} t^{2}=2 \sqrt{\left(y^{2}-h^{2}\right)^{2}+2 z^{2}\left(y^{2}+h^{2}\right)+z^{4}}+2\left(y^{2}+h^{2}+z^{2}\right) .
$$

Perform further algebraic manipulation to collect the terms in $y$ and $z$

$$
\left(v^{2} t^{2}-4 h^{2}\right) v^{2}+v^{2} t^{2} z^{2}=\frac{v^{4} t^{4}}{4}-v^{2} t^{2} h^{2}
$$

Finally, normalize by the terms on the right-hand side and rearrange the terms in the denominators

$$
\frac{y^{2}}{(v t / 2)^{2}}+\frac{z^{2}}{(v t / 2)^{2}-k^{2}}=1
$$

Equation (E-70) represents an ellipse in the $y-z$ plane for a constant $t$ with the following parameters (Figure E-2):

(a) Semi-major axis in midpoint $y$ direction: $a=v t / 2$.

(b) Semi-minor axis in depth $z$ direction: $b=\sqrt{(v t / 2)^{2}-h^{2}}$.

(c) Distance from center to either focus: $\sqrt{a^{2}-b^{2}}=h$.

(d) Distance from one focus to a point on the ellipse to the other focus: $v t$.

The ellipse of equation ( $\mathrm{E}-70$ ) in the $y-z$ plane describes the impulse response of a nonzero-offset migration operator applied to prestack data.

When equation (E-70) is specialized to the zero offset case, $h=0$, we get

$$
\frac{y^{2}}{(v t / 2)^{2}}+\frac{z^{2}}{(v t / 2)^{2}}=1
$$

which describes a circle in the $y-z$ plane for a constant $t$ with a radius $v t / 2$. This circle represents the impulse resporse of a zero-offset migration operator applicd to poststack data.

When equation (E-67) is specialized to the zero-offset case, $h=0$, we get

$$
v t=2 \sqrt{y^{2}+z^{2}}
$$

which describes the well-known diffraction hyperbola in the $y-t$ plane for a constant $z$.

Reduction of the double-square-root equation (E-67) to a single-square-root equation (E71b) can also be achieved by defining an equivalent offset $h_{e}$ such that (Bancroft et al., 1998)

$$
\sqrt{(y+h)^{2}+z^{2}}+\sqrt{(y-h)^{2}+z^{2}}=2 \sqrt{h_{e}^{2}+z^{2}} .
$$

Solving for $h_{e}$, we obtain (Bancroft ct al., 1998; Margrave et al., 1999)

$$
h_{e}^{2}=y^{2}+h^{2}-\frac{4 y^{2} h^{2}}{v^{2} t^{2}}
$$

where $t$ is the two-way nonzero-offset traveltime of equation (E-67).

Poststack time migration can be conceptualized either by way of a semicircle superposition using equation (E-72a) or a diffaction summation along the hyperbolic traveltime trajectory using equation ( $\mathrm{E}-72 \mathrm{~b}$ ). Similarly, prestack time migration can be conceptualized either by way of semi-elliptical superposition using equation (E-70) or diffaction summation over the travelime surface described by equation (E-67). The traveltime surface is known as Cheops' pyramid (Claerbout, 1985) and is illustrated in Figure E-3a. The result of summation of amplitudes over the pyramidal surface is placed at its apex. The question that is of practical importance is how to define the summation paths over this surface.

Four possible choices of sumnation paths over the pyramidal surface of equation (E-67) to perform prestack time migration are:

(a) Summation curves of constant offset: Consider a set of vertical cross-sections of the traveltime pyramid illustrated in Figure E-3a parallel to the midpoint axis as shown in Figure E-3b. Sum the amplitudes along each of the constant-offset table-top traveltime curves, independently, and place the result for each at the apex of the summation curve. The summation collapses the pyramidal surface onto a hyperbolic traveltime curve, which is formed by combining the apex points of the constant-offset curves. This hyperbolic traveltime curve is orthogonal to the constant-offset summation curves.

(b) Summation curves of constant tome: Consider a set of horizontal cross-sections of the traveltime pyramid as shown in Figure E-3c (Bancroft and Geiger, 1994; Bancroft et al., 1997). Sum the amplitudes along each of the constant-time curves, independently, and place the result for each at the maximum offset on the summation curve. The summation, again, collapses the pyramidal surface onto the hyperbolic traveltime curve, which is formed by combining the maximum-offset points of the constant-time curves. This hyperbolic traveltime curve is orthogonal to the constant-time summation curves. The event associated with the resulting hyperbolic moveout trajectory is on the $h_{e}-t$ plane of a common-scatter-point (CSP) gather (Bancroft et al., 1998), where the equivalent offset $h_{e}$ is given by equation (E-72b). The scatter point corresponds to the apex of the traveltime pyramid $A_{0}$ in Figure E-3c.

(c) Summation curves of constant shot Consider a set of vertical cross-sections of the traveltime pyramid as shown in Figure E-3d (Berryhill, 1996). Sum the amplitudes along each of these constant-shot curves, independently, and place the result for each at the apex of the summation curve. The summation collapses the pyramidal surface onto the hyperbolic traveltime curve, which is formed by combining the apex points of the constant-shot curves. This hyperbolic traveltime curve is orthogonal to the constant-shot summation curves and is on the common-receiver plane that passes through the apex of the pyramid itself.

(d) Summation curves of constant angle: Consider a set of slanted cross-sections of the traveltime pyramid as shown in Figure E-3e (Ottolini, 1982). These slanted traveltime curves are associated with constant angle of incidence (Section 6.3). Sum the amplitudes along each
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0847.jpg?height=988&width=332&top_left_y=136&top_left_x=354)

FIG. E-3. The nonzero-offset traveltime surface associated with a point scatterer and the various summation trajectories for prestack time migration (composed from Fowler, 1997). See Section E. 5 for details.
of the constant-angle curves, independently, and place the result tor each at the apex of the summation curve. The summation collapses the pyramidal surface onto the hyperbolic traveltime curve which is formed by combining the apex points of the constant-offset, curves. This hyperbolic traveltime curve is orthogonal to the constant-offset summation curves.

## E. 6 Prestack Frequency-Wavenumber Migration

We start with prestack data in midpoint $y$ and offset $h$ coordinates, $P(y, h, z=0, t)$, where $t$ is the event time in the unmigrated position, and perform 3-D Fouricr transform

$$
P\left(k_{y}, k_{h}, 0, \omega\right)=\iiint P(y, h, 0, t) \exp \left(i k_{y} y+i k_{h} h-i \omega t\right) d k_{y} d k_{h} d \omega
$$

where $k_{y}, k_{h}$, and $\omega$ are the Fourier duals of the variables of the midpoint-offset coordinates, $y$, $h$, and $t$.

Extrapolate the prestack data from the surface $z=0$ to a depth $z$ by the following extrapolation equation which we borrow from Section D. 1

$$
P\left(k_{y}, k_{h}, z, \omega\right)=P\left(k_{y}, k_{h}, 0, \omega\right) \exp \left(-i k_{z} z\right)
$$

The vertical wavenumber $k_{z}$ is given by

$$
k_{z}=\frac{\omega}{v} D S R(Y, H)
$$

where, the double-squarc-root (DSR) operator takes the following form in midpoint-offset coordinates (equation D-22 of Section D.1)

$$
\operatorname{DSR}(Y, H)=\sqrt{1-(Y+H)^{2}}+\sqrt{1-(Y-H)^{2}}
$$

The variables $Y$ and $H$ are the normalized midpoint and offset wavenumbers, respectively

$$
Y=\frac{v k_{y}}{24}
$$

and

$$
H=\frac{v k_{h}}{2 \omega}
$$

Assume a horizontally layered earth model associated with a vertically varying velocity function $v(z)$. By inverse Fourier transforming equation (E-74), we have

$$
P(y, h, z, t)=\iiint P\left(k_{y}, k_{h}, 0, \omega\right) \exp \left(-i k_{z} z\right) \exp \left(-i k_{y} y-i k_{h} h+i \omega t\right) d k_{y} d k_{h} d \omega
$$

The imaging principle $t=0$ then is applied to get the image volume $P(y, h, z, t=0)$,

$$
P(y, h, z, t=0)=\iiint P\left(k_{y}, k_{h}, 0, \omega\right) \exp \left(-i k_{y} y-i k_{h} h-i k_{z} z\right) d k_{y} d k_{h} d \omega
$$

This is the cquation for the prestack phase-shift method. Equation (E-79) involves integration over frequency $\omega$ and 2-D inverse Fourier transformation along midpoint $y$ and offset $h$ axes.

We now consider the special case of constant velocity $v$. Stolt (1978) devised a prestack migration technique that involves an efficient mapping in the 3-D Fourier transform domain from temporal frequency $\omega$ to vertical wavenumber $k_{k}$.

First, combine equations (E-75) and (E-76)

$$
\frac{v k_{z}}{\omega}=\sqrt{1-(Y+H)^{2}}+\sqrt{1-(Y-H)^{2}}
$$

Square both sides

$$
\begin{aligned}
\frac{v^{2} k_{z}^{2}}{\omega^{2}} & =2\left[\sqrt{1-(Y+H)^{2}} \sqrt{1-(Y-H)^{2}}\right] \\
& +\left[1-(Y+H)^{2}\right]+\left[1-(Y-H)^{2}\right]
\end{aligned}
$$

and simplify

$$
\frac{v^{2} k_{z}^{2}}{2 \omega^{2}}-\left(1-Y^{2}-H^{2}\right)=\sqrt{1-2 Y^{2}-2 H^{2}+Y^{4}-2 Y^{2} H^{2}+H^{4}}
$$

Define

$$
K^{2}=\frac{v^{2} k_{z}^{2}}{2 \omega^{2}}
$$

and square both sides of equation (E-82). After some algebra, it follows that

$$
K^{4}-2 K^{2}+2 K^{2} Y^{2}+2 K^{2} H^{2}+4 Y^{2} H^{2}=0
$$

which can be rewritten as

$$
2 K^{2}=\left(K^{2}+2 Y^{2}\right)\left(K^{2}+2 H^{2}\right)
$$

Now substitute equations (E-77a,b) and (E-83) into equation (E-85), and simplify to obtain the final expression for the dispersion relation for prestack wave extrapolation

$$
\omega=\frac{v}{2 k_{z}} \sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}
$$

By setting the offset wavenumber $k_{h}=0$, we obtain the special case of zero-ofiset dispersion relation

$$
\omega=\frac{v}{2} \sqrt{k_{z}^{2}+k_{y}^{2}}
$$

as in equation (D-85) with $x$ replaced by $y$.

By keeping the wavenumbers $k_{y}$ and $k_{h}$ unchanged and differentiating equation (E-80), we get

$$
d \omega=\frac{v}{2} \frac{k_{z}^{2}-k_{v}^{2} k_{h}^{2}}{\sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}} d k_{z}
$$

By setting the offset wavenumber $k_{h}=0$, we obtain the special case for zero-offsct

$$
d \omega=\frac{v}{2} \frac{k_{z}}{\sqrt{k_{z}^{2}+k_{v}^{2}}} d k_{z}
$$

as in equation (D-86) with $x$ replaced by $y$.

When equations ( $E-86$ ) and (E-88) are substituted into equation (E-79), we get

$$
\begin{aligned}
P\left(y, h_{1}, z, t=\right. & 0)=\iiint\left[\frac{v}{2} \frac{k_{z}^{2}-k_{y}^{2} k_{h}^{2}}{\sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{y}^{2}\right)}}\right] \\
& \times P\left[k_{y}, k_{h}, 0, \frac{v}{2 k_{z}} \sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}\right] \exp \left(-i k_{y} v-i k_{h} h-i k_{z} z\right) d k_{y} d k_{h} d k_{z} .
\end{aligned}
$$

Finally, sum over $k_{h}$ to obtain the image at zero offset, $h=0$

$$
\begin{aligned}
P(y, h=0, z, t=0) & =\iiint\left[\frac{v}{2} \frac{k_{z}^{2}-k_{y}^{2} k_{h}^{2}}{\sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{y}^{2}\right)}}\right] \\
& \times P\left[k_{y}, k_{h}, 0, \frac{v}{2 k_{z}} \sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{k}^{2}\right)}\right] \exp \left(-\imath k_{y} y-i k_{z} z\right) d k_{y} d k_{h} d k_{z} .
\end{aligned}
$$

This is the equation for constant-velocity prestack Stolt migration. It involves two operations in the $f-k$ domain. First, the temporal frequency $\omega$ is mapped onto the vertical wavenumber $k_{z}$ via equation (E-86). Second, the amplitudes are scaled by the quantity

$$
S=\frac{v}{2} \frac{k_{z}^{2}-k_{y}^{2} k_{h}^{2}}{\sqrt{\left(k_{z}^{2}+k_{y}^{2}\right)\left(k_{z}^{2}+k_{h}^{2}\right)}}
$$

The zero-offset image is then obtained by summing over the wavenumber $k_{h}$ (equation E-91), and inverse Fourier transforming in the midpoint $y$ direction.

## E. 7 Velocity Analysis by Wavefield Extrapolation

A method of migration velocity analysis besed on wavefield extrapolation is described in Section 5.4. The main computational steps of this method (Yilmaz and Chambers, 1984) are outlined below. We work with seismic data in midpoint-(half) offset $(y, h)$ coordinates. We want to obtain a volume of focused energy at zero offset in $(y, v, \tau)$ coordinates from a prestack data set in $(y, h, t)$ coordinates. For a midpoint location $y$, migration velocity function then can be picked from the corresponding $(v, \tau)$ plane.

First, a 3-D Fourier transformation is applied to the upcoming wavefield $P(y, h, \tau=0, t)$, which is recorded at the surface

$$
P\left(k_{y}, k_{h}, \tau=0, t\right)=\iiint P(y, h, \tau=0, t) \exp \left(\imath k_{y} y+\imath k_{h} h-i \omega t\right) d k_{y} d k_{h} d \omega
$$

where $t$ is the two-wny traveltime and

$$
\tau=2 \int \frac{d z}{v(z)}
$$

is the two-way vertical time equivalent of downward continuation depth $z$ in a modium with velocity $v(z)$. The variables $\left(k_{y}, k_{h}, \omega\right)$ are the Fourier duals of $(y, h, t)$.

The surface wavefield given by equation (E-93) then is extrapolated down to depth $\tau$ by

$$
P\left(k_{y}, k_{h}, \tau, \omega\right)=P\left(k_{y}, k_{h}, \tau=0, \omega\right) \exp \left(-i \frac{\omega}{2} \tau D S R\right)
$$

where

$$
D S R \equiv\left[1-(Y+H)^{2}\right]^{1 / 2}+\left[1-(Y-H)^{2}\right]^{1 / 2}-2
$$

and $Y$ and $H$ are the normalized midpoint and offeet wavenumbers given by equations (E $77 \mathrm{a})$ and (E-77b). The -2 term puts the expression in retarded time form. (This term was not included in the previous definition of $D S R$ given by equation E-76.) Equation (E-95) is used recursively to extrapolate the wavefield from one depth to another in steps of $\Delta T$.

Next, we transform the extrapolated wave field $P\left(k_{y}, k_{h}, \tau_{1}, \omega\right)$ into the space-time domain. In doing so, we only need to obtain the zero-offset information $(h=0)$. By summing the extrapolated wavefield over $k_{h}$ in equation (E-95), we get the wave field at zero offset. $P(k, h=$
$0, \tau, \omega)$. By doing the 2-D inverse transform over $\left(k_{y}, \omega\right)$. we obtain

$$
P(y . h=0, \tau, t)=\iint P\left(k_{y}, h=0, \tau, \omega\right) \exp \left(-\imath k_{y} y+i \omega t\right) d k_{y} d \omega .
$$

Here, $P(y, h=0, \tau, t)$ is the zero-offset section at various depth levels from which we want to extract velocity information.

Suppose that velocity $v_{e}$ were used to extrapolate the surface wavefield down to depth $\tau$. Equation (E-95) is written with $v_{e}$ and $\tau$ as

$$
P\left(k_{y}, k_{h}, \tau, \omega\right)=P\left(k_{y}, k_{h}, \tau=0, \omega\right) \exp \left[-i \frac{\omega}{2} \tau \operatorname{DSR}\left(v_{c}\right)\right]
$$

Now suppose that the true medium velocity $v$ were used to extrapolate the surface wavefield down to depth $\tau=t$. By rewriting equation (E-95) with $v$ and $t$, we have

$$
P\left(k_{y}, k_{h}, t, \omega\right)=P\left(k_{y}, k_{h}, \tau=0 . \omega\right) \exp \left[-i \frac{\omega}{2} t D S R(v)\right]
$$

Match the two extrapolated wavefields in equations (E-98a) and (E-98b) to get a relationship between $v_{e}, \tau, v$, and $t$

$$
\tau D S R\left(v_{e}\right)=t D S R(v)
$$

Because of the complexity of DSR [equation (E-96)], equation (E-99) does not provide an explicit expression for $v$ in terms of the other three variables $\tau, t$, and $v_{e}$. However, we can get an approximate expression by expanding the square roots in equation ( $\mathrm{E}-\mathrm{g}$ ) in the Taylor series and retaining the terms with $Y^{2}$ and $H^{2}$, only. By using this approximate form and the definitions given by equations (E-77a) and (E-77b), the following approximate relationship results

$$
\tau v_{e}^{2}=t v^{2}
$$

This expression suggests that downward continuation with the correct (medium) velocity to a wrong depth is equivalent to downward continuation to the correct depth with the wrong velocity (Doherty and Claerbout, 1974).

The derivation of equation (E-100) assumes that $v_{e}$ is constant. When $v_{e}$ is depth-variable, then the relationship in equation (E-100) still holds because equation (E-95) is valid for a stratified earth model. However, quantity $v_{e}$ in that equation is replaced by the rms velocity.

Because the approximation made to equation (E-96) is best for small ratios of offet-toreflector depth, the accuracy of the mapping procedure based on equation (E-100) degrades at very shallow depths. Refer to Section 5.4 for the practical considerations of the migration velocity estimation technique described in this appendix.

## REFERENCES

Artley, C. and Hale, D., 1994, Dip-moveout processing for depth-variable velocity: Geophysics, 59, $610-622$.

Bale, R. and Jacubowitz, H., 1987, Poststack prestack migration: 57th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 714-717.

Bancroft, J. C. and Geiger, H. D., 1994, Equivalent-offset CRP gathers 64th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 672-675.

Bancroft, J. C., Geiger, H. D, and Margrave, G., 1998, The equivalent offset method of prestack t1me migration: Geophysics, 63, 2042-2053.

Bancroft, J. C., Margrave, G., and Geiger ${ }_{2}$ H. D., 1997, A knematic comparison of DMO-PSI and equivalent offset migration (EOM): 67 th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, $1575-1578$.

Baysal, E., Kosloff, D., and Sherwood, J. W. C., 1984, A two-way nonreflecting wave equation: Geophysics, 49, 132-141.

Berkovitch, A., Keydar, S., Landa, E., and Trachtman, P., 1998, Multifacusing in practice: $68 \mathrm{tb}$ Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1748-1751.

Berryhill, J. R., 1996, System and method of seismic shot-record migration: U. S. Patent 5,544,126.

Biondi, B. and Ronen, J., 1987, Dip moveout in shot profiles: Geophysics, 52, 1473-1482.

Black, J., Schleicher, K. L. and Zhang, L., 1993, True-amplitude imaging and dip moveout: Geophysics, 58, 47-66.

Black, J.L., MeMahon, I.T., Memardus, H., and Henderson, I., 1985, Applications of prestack migration and dip moveout: Presented at the 55th Ann. Internat. Mtg., Sac. Expl. Geophys.

Bleistein, N., 1990, Born DMO revisited: 60th Ann. Internat. Mtg., Soc. Expl. Geophys., Exparded Abstracts, 1366-1369.

Bulondi, G., Loinger, E. and Rocca, F., 1982, Offset continuation of seismic sections: Geophys. Prasp., 30, 813-828.

Bolond, G., Loinger, E. and Rocca, F., 1984, Offset continuation in theory and practice: Geophys. Prosp., 32, 1045-1073.

Bolondi, G. and Rocca, F., 1985, Normal moveout correction, offset continuation and prestack partial migration compared as prestack processes: $n$ Fitch, A. A., Ed., Developments in geophysical exploration methods, 6, Elsevier Applied science Publ., Ltd.

Cabrera, J. and Levy, S., 1989, Shot dip-moveout with logarithmic transformations: Geophysics, 54, 1038-1041.

Claerbout, J.F., 1985, Imaging the earth's interior: Blackwell Scientific Publications.

Clayton, R., 1978, Common midpoint migration: Stanford Expl. Proj., Rep. No. 14, Stanford University.

de Bazelaire, E., 1988, Normal-moveout correction revisted: Inhomogeneous media and curved interfaces: Geophysics, 53, 14:-157.

Deregowski, S. M., 1982, Dip-moveout and reflector-point dispersal: Geophys Prusp., 30, 318-322.

Deregowski, S. M., 1986, What is DMO?: First Break, 4, 7-24.

Deregowski, S. M., 1987, An integral implementation of dip-moveout: Geophys. Trans. of Geophys. Inst. of Hungary, 33, 11-22.

Deregowski, S. M. and Rocca, F., 1981, Geometrical optics and wave theory for constant-offset sections in layered med1a: Geophys. Prosp., 29, 374-406.

Doherty, S. M., 1975, Structure-independent velocity estimation: Ph. D. thesis, Stanford Unviersity,

Doherty, S.M. and Claerbout, J.F., 1974, Velocity analysis besed on the wave equation: Stanford Expl. Proj., Rep. No. 1, Stanford University.

Faye, J-P. and Jeannaut, J-P., 1986, Prestack migration velocities from focusing depth analysis: 56th Ann. Internat. Mtg. Soc. Expl. Geophys., Expanded Abstracts, 438-440.

Fowler, P., 1984, Velocity-independent imaging of seismic reflectors: 54th Ann. Internat. Mtg., Soc. Explor. Goophys., Expanded Abstracts, 383-385.

Fowler, P., 1997, A comparative overview of prestack timc migration methods: 67th Ann. Int. Soc. Explor. Geophys. Mtg., Soc. Expl, Geophys., Expanded Abstracts, 1571-1574.

French, W.S., Perkins, W.T., and Zoll, R.M., 1984, Partial migration via true CRP stacking; 54th Ann. Internat. Mtg, Soc. Explor Geophys., Expanded Abstracts, 799-802.

Gardner, G. F. H. and Forel, D., 1990, Amplitude preservation equations for DMO: Geophysics, 55, $485-487$.

Gard ner, G.H.F., French, W.S., and Matzuk, T., 1974, Elements of migration and velocity analysis: Geophysics, 39, 811-825.

Gardner, G. F. H., Wang, S. Y., Pan, N. D., and Zhang, Z., 1986, Dip noveout and prestack imaging: Expended Abstracts, 75-84, 18th Ann. Ofshore Tech. Conf.

Gelchinsky, B., 1988, The common-reflecting-element (CRE) method: ASEG/SEG Internat. Geophys. Conf., Extended Abstracts, 71-75.

Gelchinsky, B., Berkovitch, A., and Keydar, S.,1999a, Multifocusing homoemorphic imaging: Part I: Basic concepts and formulas: J. Appl. Geophys., 42, 229-242.

Gelchinsky, B, Berkovitch, A., and Keydar, S.,1999b, Multifocusing homoemorphic imaging: Part II: Multifold data set and mult focusing: J. Appl. Geophys., 42, 243-260

Gunzalez-Serrano, A. and Claerbout, J.F, 1979, Wave-equation velocity analysis: Stanford Expl. Proj,-, Rep. No. 16, Stanford University.

Granser, H., 1994, Shot gather DMO in the double-log domain: Geophysics, 49, 1305-1307.

Hale, D., 1983, Dip moveout by Fourier transform: Ph.D. thesis, Stanford University.

Hale, D., 1984, Dip moveout by Fourier transform: Geophysics, 49, 741-757.

Hale, D., 1991, A nonaliased integral methot for dip moveout: Geophysics, 56, 795-805.

Hale, D. and Artley, C., 1992, Squeezing dip-moveout for depth-variable velocity: Geophysics, 58, 257-264.

Hale, D., Hill, N. R*, and Stefanj, J., 1992, Imaging salt with turning seisme waves: Geophysics, $57,1453-1462$.

Höcht, G., 1998, Common-reflection-surface stack: Master's thesı, Karlsruhe University.

Jacubowicz, H., 1990, A simple efficient method of dip-moveout correction: Geophys. Prosp., 38, 221-245.

Landa, E., Gurevich, B., Keydar, S., and Trachtman, P., 1999, Application of multifocusing method for subsurface imagingł J. Appl. Geophys., 42, 283-300.

Levin, F.K., 1971, Apparent velocity from dipping interface reflections: Geophysics, 36, 510-516.

Li, Z., Lynn, W., Chambers, R., Larner, K. and Abma, R., 1991, Enhancements to prestack frequency-wavenumber ( $f-k$ ) migration: Geophysics, $56,27-40$.

Liner, C. L., 1990, General theory and comparative anatony of dip-moveout Geophysics, 55, 595-607.

Margrave, G., Bancroft, J. C., and Geiger, H. D., 1999. Fourier prestack migration by cquivalent wavenumber: Geophysics, 64, 197-207.

Marcoux, M. O., Godfrey, R. J., and Notfors, C. D., 1987, Migration for optimum velocity evaluation and stacking: Presented at the 49th Ann. Mtg. European Asn. Expl. Geophys.

Nutfors, C. D. and Godfrey, R. J., 1987, Dip-moveout in the frequency-wavenumber doman: Geophysics, 52, 1718-1721.

Ottolni, R., 1982, Migration of seismic data in angle-midpoint coordinates: Ph D. thess, Stanford University.

Ratcliff, D. W., Gray, S. H., and Whitmore, N. D., 1992, Scismic imaging of salt structures in the Gulf of Mexico: The Leading Edge, 11, no. 4, 15-31.

Rocca, F., Bolondi, G., and Loinger, E., 1982, Offset continuation of seismic sections: Geophys. Prosp., 30, 813-828.

Salvador, L. and Savelli, S., 1982, Offset continuation for seismic stacking: Geophys. Prosp., 30, 829-849.

Sherwood, J.W.C., Schultz, P.S., and Judson, D.R., 1978, Equalizing the stacking velocities of dipping events va Devilish: Presented at the 48th Ann. Internat. Soc. Expl. Geophys. Mtg.

Shurtleff, R., 1984, An $F-K$ procedure for prestack migration and velocity analysis: Presented at the 46th Ann. Mtg. European Asn. Expl. Geophys.

Sorin, V. and Ronen, J., 1989, Ray-geometrical analysis of dip moveout amplitude distribution: Geophysics, 54, 1333-1335.

Stolt, R.H., 1978, Migration by Fourier transform: Geophysics, 43, 23-48.

Taner, M.T. and Kochler, F., 1969, Velocity spectra - digital computer derivation and applications of velocity functions: Geophysics,32, 859-881.

Tygel, M., Müller, T., Hubral, P., and Schleicher, J,, 1997, Eigenwave-based multiparameter traveltime exparsions: $67^{\text {th }}$ Ann. Internat. Mtg, Soc. Expl. Geophys., Expanded Abstracts, 1770 - 1773.

Yilmaz, O, and Chambers, R+, 1984, Migration velocity analysis by wave field extrapolation: Geophysics, 49, 1664-1674.

Yilmaz, O. and Olacrbout, J.F., 1980, Prestack partial migration: Geophysics, 45, 1753-1777.

Zhou, B, Mason, I. M., and Greenalgh, S.A., 1996, Accurate and efficient shot-gather dip-moveout. processing in the log-stretch domain: Geophys. Prosp., 43, 963-978.

## 6 Noise and Multiple Attenuation

- Introduction $\cdot$ Coherent Linear Noise - Treatment of Coherent Linear Noise by Conventional Processing $\bullet$ Reverberations and Multiples $\bullet$ Trectment of Reverberations and Multiples by Conventional Processing $\bullet$ Spatially Random Noise - Multiple Attenuation in the CMP Domain - Periodicity of Multiples - Velocity Discrimination Between Primaries and Multiples $\cdot$ Karhunen-Loeve Transform - Modeling of Multiples $\cdot$ Frequency-Wavenumber Filtering $\cdot$ Random Noise and Frequency-Wavenumber Filtering $\cdot$ Statics Corrections and Frequency-Wavenumber Filtering - Dip Filtering of Coherent Linear Noise - Frequency-Wavenumber Multiple Attenuation - The SlantStack Transform $\cdot$ Physical Aspects of Slant Stacking $\cdot$ Slant-Stack Transformation - Practical Aspects of Slant Stacking $\cdot$ Slant-Stack Parameters $\cdot$ Time-Variant Dip Filtering $\cdot$ Slant-Stack Multiple Attenuation $\bullet$ The Radon Transform $\cdot$ Velocity-Stack Transformation $\cdot$ The Discrete Radon Transform - The Parabolic Radon Transform - Practical Considerations $\cdot$ Impulse Response of the Velocity-Stack Operator $~$ Field Data Examples $\cdot$ RadonTransform Multiple Attenuation $\cdot$ Linear Uncorrelated Noise Attenuation - Design of Spatial Prediction Filters $\cdot$ Field Data Examples - Exercises - Appendix F: Multichannel Filtering Techniques for Noise and Multiple Attenuation - Analysis of Guided Waves $\cdot$ Wavefield Extrapolation in the $\tau-p$ Domain $\bullet$ Mathematical Foundation of the Discrete Radon Transform $\cdot$ Free-Surface Multiple Attenuation $\cdot$ Water-Bottom Multiple Attenuation - Spatial Prediction Filter $\cdot$ References


### 6.0 INTRODUCTION

In Section 1.3, we examined noise and signal characteristics of seismic data from 40 common-shot gathers. Noise generally is classified into two categories - random noise and coherent noise. The random noise category includes noise in the temporal direction and spatially random noise that is uncorrelated from trace to trace. The first type of random noise usually is stronger at late times than early times in recorded data. Timevariant bandpass filtering usually is applied to attenuate much of the temporally random noise. A powerful process that attenuates much of the random noise uncorrelated from trace to trace is conventional CMP stacking. By using multiple receivers per channel, nu]tiple sources per record and multiple fold of coverage, signal-to-noise ratio is increased significantly. A comprehensive review of random noise and its analysis is given by Sengbush (1983). The coherent noise category includes linear noise, and reverberations and multiples. Coherent linear noise types include guided waves, which often are abundantly present in shallow marine data, ground roll and noise associated with shallow waterbottom side scatterers.

## Coherent Linear Noise

Two types of coherent linear noise that deserve special attention are guided waves and side-scattered energy. Figure 6.0-1 shows field data with coherent linear noise in three different domains - common-shot gather, common-midpoint gather, and CMP stack. The dispersive waves labeled as $A$ in Figure 6.0-1a are guided waves, and the linear events $B$ and $C$ and the events $D$ with curvature are associated with side scatterers. Guided waves manifest themselves as dispersive linear noise on both common-shot and CMP gathers, but are attenuated largely by stacking.

Guided waves are trapped in a water layer or in a low-velocity near-surface layer and travel in the horizontal direction. They are dispersive - each frequency component propagates with a different phase velocity, and are best described by norral-mode propagation. Numerical modeling of guided waves using normalmode propagation theory is presented in Section F.1. Since they do not contain any useful reflection energy, guided waves usually are muted on CMP gathers. When one mode splits away from the rest of the guided wave packet and travels at lower speeds, and thus overlaps with reflection events, then dip filtering in the $f-k$ domain is needed (Section 6.2).

An excellent example of guided waves is seen on the field record (between 1 and $4.5 \mathrm{~s}$ at far offset) shown in Figure 6.0-2. The first part of the wave packet between 1 and $1.5 \mathrm{~s}$ at far offset contains low frequencies. High frequencies ride along the direct arrival path at approximately $0.3 \mathrm{~s}$ at near offset and $1.8 \mathrm{~s}$ at far offset, followed by moderate frequencies between $1.8-2.8 \mathrm{~s}$ at far offset. The very-low frequency dispersed wavetrain with high amplitudes between 2.8-4.5 $\mathrm{s}$ at far ofiset corresponds to the mode that has split from the rest of the guided-wave modes. This happens when there is a shallow, soft water bottom associated with a mud layer. Also seen on this record is the backscattered guided wave (zone $B$ ) with reverse linear moveout, which indicates the presence of irregularities over the ocean bottom. These irregularities also cause arrivals (zone $\boldsymbol{A}$ ) that represent point scatterers.

The dispersive nature of guided waves can vary along a seismic traverse depending on water depth and water-bottom conditions. The shallower the water depth and the softer the water bottom, the more the dispersion and splitting of modes associated with guided waves (Figure 6.0-3).

Side-scattered energy has a large noveout range depending on the position of the scatterer acting as a point source at the water bottom with respect to the position of the recording cable (events $B, C$, and $D$ in Figure 6.0-1a). Side-scattered energy manifests itself with varying moveout on common-shot gathers (Figure 6.0-1a), and is not apparent on CMP gathers (Figure $6.0-1 \mathrm{~b}$ ), but reappears as linear noise on stacked sections (Figure 6.0-1c) (Larner et al., 1983).

Side-scattered energy stacks at high velocities along the linear flanks of its traveltime curve. We then anticipate that the linear noise seen on a stacked section, particularly at late times, most likely is scattered energy along the flanks of its traveltime curve, stacked together with high-velocity primary energy (Figure 6.04).

Linear noise associated with side scatterers is recognized easily on time slices from a 3-D volume of stacked data. Note in Figure 6.0-5 the circular patterns expanding out from the source of a series of point scatterers at the water bottom. In this case, certain parts of the sea-bottom pipelines act as point scatterers.

Attenuation of coherent linear noise associated with side scatterers may be achieved by $f-k$ filtering (Section 6.2), $\tau-p$ transform (Section 6.3) or Radon transform (Section 6.4) techniques. A linear event on a shot record maps onto a radial line in the $f-k$ domain, and thus can be rejected by $f-k$ dip filtering. A linear event on a shot record maps onto a point in the $\tau-p$ domain, and thus can be rejected by muting in the $\tau-p$ domain. Finally, spatially random noise and coherent linear noise are not included in the mapping from CMP domain to Radon-transform domain based on hyperbolic moveout. As a result, the reconstructed CMP gather by way of inverse transform will be free of noise.

Coherent linear noise also exists in land data in the form of dispersive Rayleigh wave, commonly known as ground roll. This type of coherent noise has low group velocity and large amplitudes and is limited to low frequencies. In fact, as shown in Figure 6.0-6, ground-roll energy aimost always dominates the reflection energy that may be present in the recorded data. Only after some type of amplitude scaling, reflections becorne visible (Figure 6.0-7). Note from the selected shot records in Figure 6.06 that the dispersive waves associated with the ground-roll energy change in strength and stepout (the dip of the linear noise trend) as a result of variations in the near-surface conditions.

Swell noise manifests itself on shot records in the form of low-frequency vertical streaks (Figure 6.0-8). This type of noise arises from rough weather conditions during marine seismic recordings, especially in shallow waters. A low-cut filter often removes the swell noise from shot records.

Finally, cable noise is one other type of coherent noise that manifests itself in the form of low-frequency linear events with very large stepout as seen on the shot records in Figure 6.0-9. Note the increase in the
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0856.jpg?height=1050&width=500&top_left_y=158&top_left_x=200)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0856.jpg?height=293&width=70&top_left_y=249&top_left_x=708)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0856.jpg?height=98&width=57&top_left_y=544&top_left_x=710)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0857.jpg?height=935&width=344&top_left_y=125&top_left_x=123)

6.0-2. A shot gather containing predominantly gunded waves. See text for a description of the labeled events.

energy level of the cable noise as the water depth becomes shallower. As for the swell noise, a low-cut filter often removes the cable noise from shot records.

## Treatment of Coherent Linear Noise by Conventional Processing

We shall apply a processing sequence to a marine 2$D$ data set that includes very basic steps without any special attempt to attenuate coherent linear noise. The objective is to examine the treatment of such noise by the three principal processes deconvolution, stacking and migration.

Figure 6.0-10 shows selected raw shot records from the marine line under consideration. Note the presence of guided waves in all the records in the form of a prominent dispersive wave package. The dispersive nature of guided waves is pronounced especially in shallow water. Because of their high amplitudes, guided waves dominate recorded marine data before the correction for geometric spreading. Since they travel in the horizontal direction within the water layer, guided waves do not contribute to the useful reflection energy. Therefore, these waves are often muted in shallow records as shown in Figure 6.0-11. Unfortunately, some reflection energy at far offsets is inadvertently removed as a result of muting the guided waves.

Following $t^{2}$-scaling of amplitudes to compensate for geometric spreading, we note the enhancement of coherent noise at late times. Note in Figure 6.0-11, the records at shot points 300 and 400 contain linear noise below $2 \mathrm{~s}$, and all records except at shot point 200 contain coherent noise with a curvature below $3 s_{1}$ all associated with side scatterers. Additionally, observe the low-frequency cable noise with large stepout especially at near offsets below $3 \mathrm{~s}$ on the records at shot points $300,400,600$, and 700 .

Deconvolution flattens the spectrum and as a result enhances the low-frequency cable noise as seen in Figure 6.0-12. After the application of a wide bandpass filter, very low-frequency and very high-frequency noise components are removed. Nevertheless, the side-scattered energy with varying moveout still remains in the shot records (Figure 6.0-13).

When data are sorted to CMP gathers, the linear nature of the coherent noise associated with side scatterers disappears (Figure 6.0-14). On the other hand, side-scatterer noise with curvature behaves like events with nonhyperbolic moveout. Following the normalmoveout correction and stacking, the side-scatterer energy reappears as in Figure 6.0-15. Note the dipping linear noise along the steep flanks of the diffractions associated with the side scatterers in the water bottom. The steeply dipping linear noise at water velocity should
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0858.jpg?height=996&width=512&top_left_y=192&top_left_x=240)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0859.jpg?height=1049&width=746&top_left_y=159&top_left_x=155)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0860.jpg?height=765&width=639&top_left_y=123&top_left_x=196)

6.0-5. A time slice from an unmigrated 3-D volume of stacked data which exhibits circular patterns associated with point scatterers along sea-bottom pipelines. (Data courtesy Total Argentina.)

not be confused with the diffractions of the flanks of the salt diapirs at higher velocities.

Coherent linear noise asociated with side scatterers are attenuated largely by dip-moveout correction (Section 5.2). Compare the stacked section in Figure 6.0-16 with that in Figure 6.0-15, and note that DMO correction has enhanced the diffractions associated with the salt flanks while it has attenuated the linear noise associated with the side scatterers. Any remaining sidescatterer related noise at late times is overmigrated as a result of the higher primary velocities (Figure 6.0-17).

## Reverberations and Multiples

In this chapter, we shall discuss multiple attenuation techniques based on velocity discrimination betwern multiples and primaries, and periodicity of multiples. While these techniques seem to have a good conceptual basis, their performance on field data can be disappointing. There are several possible explanations for this.

First, for velocity discrimination techniques to be effective, significant moveout differences must texist between primaries and multiples. However, the inability

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0861.jpg?height=1029&width=776&top_left_y=169&top_left_x=125)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0862.jpg?height=943&width=762&top_left_y=174&top_left_x=74)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0863.jpg?height=991&width=736&top_left_y=191&top_left_x=145)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0864.jpg?height=1051&width=860&top_left_y=133&top_left_x=71)

FIG. 6.0-9. Selected shot records from a marine 2-D line with swell noise.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0865.jpg?height=1017&width=597&top_left_y=177&top_left_x=273)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0866.jpg?height=1017&width=711&top_left_y=177&top_left_x=138)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0867.jpg?height=1015&width=719&top_left_y=179&top_left_x=180)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0868.jpg?height=1013&width=609&top_left_y=177&top_left_x=206)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0869.jpg?height=1037&width=605&top_left_y=167&top_left_x=229)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0870.jpg?height=1033&width=595&top_left_y=171&top_left_x=212)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0871.jpg?height=1041&width=606&top_left_y=166&top_left_x=231)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0872.jpg?height=1033&width=595&top_left_y=169&top_left_x=201)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0873.jpg?height=198&width=362&top_left_y=126&top_left_x=125)

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0873.jpg?height=192&width=360&top_left_y=348&top_left_x=126)

(b)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0873.jpg?height=198&width=358&top_left_y=126&top_left_x=556)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0873.jpg?height=192&width=362&top_left_y=348&top_left_x=550)

(d)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0873.jpg?height=192&width=354&top_left_y=570&top_left_x=558)

6.0-18. A sketch of raypaths associated with various types of multiples. The shallowest interface in each case represents the water bottom. See text for details.

to exploit the large moveout differences between primaries and multiples in the mute zone works against the methods based on velocity discrimination.

Periodicity of multiples is preserved for the ideal case of zero offset and horizontally layered earth. At nonzero offsets, periodicity often is destroyed even for the horizontally layered case. Nevertheless, periodicity is better preserved for the horizontally layered earth in the slant-stack domain. Multiple attenuation in this domain is discussed in Section 6.3.

There is also a problem caused by the application of geometric spreading correction (Section 1.4), when it is applied using the primary velocity function. This type of correction usually results in enhancement of the amplitudes of multiple reflections. The slant-stack approach (Section 6.3) is implemented before the geometric spreading correction, so there is no danger of amplifying the multiple energy.
In Sections F. 4 and F.5, we shall review the theory of multiple attenuation using wave extrapolation techniques. These are targeted for a specific class of multiples those which are either associated with the free surface or water bottom.

We now examine the various types of multiples in recorded marine data in different domains shot records, common-offset sections and CMP gathers. Most multiple reflections arise from an interface with a strong impedance contrast such as the free surface and water bottom. Figure 6.0-18 shows raypath diagrams for:

(a) water-bottom multiples of first- and second-order,

(b) free-surface multiples of first- and second-order,

(c) peg-leg multiples of first- and second-order,

(d) intrabed multiples of first- and second-order, and

(e) interbed multiples of first- and second-order.

These are but a few of the numerous configurations of raypaths associated with multiple reflections encountered in recorded data. Regardless of the type of multiples, they all have two common properties that can be exploited to attenuate them with varying degree of success perodicaty and moveout that is different from primaries.

Figure 6.0-19 shows selected marine shot records which exhibit a broad range of multiples. The shot records over the deep water contain long-period waterbottom multiples and peg-leg multiples associated with reflectors just below the water bottom. Whereas the shot records over the shallow water contain short-period multiples and reverberations. Note the guided waves in the shallow-water records that also contain multiples which have raypaths within the water layer.

Figure 6.0-20 and 6.0-21 show selected CMP gathers and segments of near-offet sections associated with the data as in Figure 6.12-19. The near-offset sections have been moveout-corrected to zero offset - thus the small differences in the arrival times between those on the near-offset trace in the CMP gathers and traces in these moveout-corrected near-offset sections. Observe the existence of a broad range of multiple types in these pairs of CMP gathers and near-offset sections. The velocity spectra computed from the CMP gathers in Figures $6.0-20$ and $6.0-21$ are displayed in Figure 6.0-22.

## Treatment of Reverberations and Multiples by Conventional Processing

We shall apply a processing sequence to a marine 2D data set that includes very basic steps without any special attempt to attenuate multiples. The objective is to examine the treatment of various types of multiples by prestack and poststack deconvolution, the stacking process itself, and by prestack and poststack migration.

Figures $6.0-23$ through $6.0-34$ show portions of the following processing products associated with the data as in Figure 6.0-20 and 6.0-21:

(a) a movenut-corrected near-offset section,

(b) CMP-stacked section with no prestack and poststack deconvolution,

(c) CMP-stacked section with prestack deconvolution, only, and

(d) CMP-stacked section with prestack and poststack deconvolution.

The velocity spectra computed at the central CMP locations from the data as in (b) and (c) for each panel are shown in Figures $6.0-35$ and $6.0-36$.
Note from the near-offset sections in Figures 6.023a through $6.0-34$ a the abundance of a wide variety of multiples. CMP stacking itself (Figures $6.0-23 \mathrm{~b}$ through $6.0-34 \mathrm{~b}$ ) without the aid of any special multiple attenuation process suppresses a significant amount of energy associated with the multiples based on the moveout difference between the primaries and multiples.

Prestack deconvolution with the added power of conventional stacking (Figures $6.0-23 \mathrm{c}$ through $6.0-34 \mathrm{c}$ ) greatly suppresses a larger portion of the energy associated with the multiples. The corresponding velocity spectra shown in Figures $6.0-35$ and $6.0-36$ illustrate the combined power of prestack deconvolution and conventional stacking in attenuating multiples. The cascaded effect of pre- and poststack deconvolution in attenuating multiples is demonstrated in Figures 6.0-23d through 6.0-34d.

Despite the theoretical limitation that periodicity of multiples strictly is preserved only for zero-offset recording over a horizontally layered earth, practical experience as exemplified by Figures 6.0-23 through 6.0-36 convincingly suggests that statistical deconvolution can be a powerful tool for multiple attenuation. Coupled with conventional stacking, which exploits the velocity discrimination property, these two processes constitute a powerful combination to attenuate a broad range of multiples.

How does migration treat multiples? Figure 6.0-37 shows shallow portion of a CMP stack before and after poststack migration. Note the diffracted first-order water-bottom multiple reflection at approximately 750 ms. Migration collapses the diffractions along the water bottom. However, the diffractions accompanying the first-order multiple reflection are overmigrated since the migration velocity is the primary velocity at $750 \mathrm{~ms}$. The diffracted multiples would have been collapsed had the water velocity been used to migrate the data.

Figure 6.0-38a shows a portion of a CMP-stacked section that contains a strong primary reflection between 1 and $2 \mathrm{~s}$ and the associated first-order multiple with a steeper apparent dip between 1.8 and $3.2 \mathrm{~s}$, The overmigration of multiple reflections by poststack migration (Figure 6.0-38b) is more pronounced in that the apparent dip of a multiple reflection is greater than the dip of the primary associated with that multiple. Poststack migration has treated the multiple reflection in Figure 6.0-38a as a dipping primary and moved it to a position based on the primary velocity that was used to migrate the stacked section.

Prestack migration can provide the bonus effect of attenuating multiples as a result of velocity discrimination between primaries and multiples. More specifically, by using a velocity field that is appropriate for migrating primaries, multiples are undermigrated. This

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0875.jpg?height=749&width=830&top_left_y=177&top_left_x=81)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0876.jpg?height=1070&width=643&top_left_y=155&top_left_x=197)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0877.jpg?height=1020&width=610&top_left_y=178&top_left_x=229)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0878.jpg?height=1073&width=784&top_left_y=151&top_left_x=71)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0879.jpg?height=987&width=711&top_left_y=192&top_left_x=179)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0880.jpg?height=959&width=728&top_left_y=174&top_left_x=165)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0881.jpg?height=964&width=722&top_left_y=170&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0882.jpg?height=1011&width=713&top_left_y=177&top_left_x=167)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0883.jpg?height=1001&width=713&top_left_y=187&top_left_x=175)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=766&width=638&top_left_y=170&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=156&width=67&top_left_y=257&top_left_x=813)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=58&width=56&top_left_y=405&top_left_x=821)
菼识豆 름 응

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=47&width=60&top_left_y=549&top_left_x=814)
त्े율 考

告

몯하

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=79&width=57&top_left_y=701&top_left_x=821)

露雚

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=135&width=59&top_left_y=815&top_left_x=814)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=270&width=618&top_left_y=932&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0884.jpg?height=201&width=78&top_left_y=935&top_left_x=821)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0885.jpg?height=1030&width=618&top_left_y=168&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0885.jpg?height=882&width=89&top_left_y=255&top_left_x=803)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=500&width=604&top_left_y=180&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=478&width=118&top_left_y=394&top_left_x=740)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=506&width=604&top_left_y=684&top_left_x=168)

곤 홀

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=44&width=57&top_left_y=292&top_left_x=799)

로을

웅울

동 8

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=41&width=72&top_left_y=893&top_left_x=802)

댕 항융

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=122&width=74&top_left_y=952&top_left_x=799)

ف. 8

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0886.jpg?height=38&width=78&top_left_y=1087&top_left_x=794)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0887.jpg?height=1036&width=730&top_left_y=170&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0888.jpg?height=1037&width=735&top_left_y=164&top_left_x=143)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0889.jpg?height=961&width=734&top_left_y=173&top_left_x=175)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0890.jpg?height=970&width=741&top_left_y=204&top_left_x=147)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0891.jpg?height=1030&width=692&top_left_y=169&top_left_x=138)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0891.jpg?height=883&width=45&top_left_y=257&top_left_x=853)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0892.jpg?height=1027&width=765&top_left_y=173&top_left_x=136)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0893.jpg?height=577&width=825&top_left_y=123&top_left_x=106)

FIG. 6.0-37. Shallow portion of a CMP stack (top) and the same portion after time migration (bottom). Note the overmigrated diffracted water-bottom multiple at $0.75 \mathrm{~s}$.

would result in residual moveout associated with multiples on common-reflection-point (CRP) gathers derived from prestack migration. Subsequent stacking of the CRP gathers would have an attenuation effect on multiples. Note the absence of the multiple in the prestack migrated section in Figure 6.0-38c.

Figure 6.0-39 shows selected CRP gathers from prestack time migration of data as in Figure 5.4-21 using the same velocity field as in Figure 5.4-20, but with no multiple attenuation. Note the large moveouts associated with the multiple reflections. As a result of the moveout difference between primaries and multiples, stacking of the CRP gathers can to a large extent attenuate multiples. Often, as in conventional CMP stacking, CRP stacking with (Figure 5.4-22) and without (Figure 6.0-40) multiple attenuation yields comparable image quality from prestack time migration. Nevertheless, the CRP gathers derived from data that have been subjected to multiple attenuation are preferred if a postmigration velocity update is required. Compare the CRP gathers from prestack time migration of data with multiple attenuation (Figure 5.4-21) and without multiple attenuation (Figure 6.0-39), and note the interference of multiples when picking flat primaries.

## Spatially Random Noise

The spatially random noise uncorrelated from trace to trace is largely attenuated by CMP stacking (Section 1.5). Any remaining noise on stacked data can be attenuated by spatial prediction filters. Figure $6.0-41$ shows a stacked section before and after noise attenuation. The process of noise attenuation is meant to achieve attenuation of noise so as to enhance coherent events such as reflections on a stacked section. It is not meant to create any coherent events that do not exist in the data.

The spatial prediction filters also can be applied to common-offset data prior to stacking. They are conveniently designed and applied in the frequency-space domain. What is predictable by a prediction filter for a given frequency component is a signal in the lateral

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0894.jpg?height=1065&width=425&top_left_y=126&top_left_x=73)

FIG. 6.0-38. (a) A portion of a CMP stack; (b) poststack time migration; (c) prestack time migration. direction and what is not predictable is considered spatially random noise. This is just the opposite of what is intended by statistical deconvolution (Chapter 2). Specifically, the predictive deconvolution operator is a prediction error filter, and the output from predictive deconvolution is the unpredictable part of the input the white reflectivity series. What is predictable by predictive deconvolution is multiples contained in a onedimensional (1-D) seismogram associated with vertical incidence.

In Section 6.5, a frequency-space prediction filter for attenuation of spatially random noise is presented accompanied by a mathematical discussion in Section F.4.

### 6.1 MULTIPLE ATTENUATION IN THE CMP DOMAIN

We have observed many types of multiples on shot gathers in Section 1.3. Multiples are attenuated based on two principle criteria - periodicity and velocity discrimination. As in the case of coherent linear noise, these criteria are exploited in whichever domain they are applicable. For instance, periodicity is preserved to a great extent for short-period multiples and reverberations on CMP gathers, especially at near offsets. Periodicity also is preserved in the $\tau-p$ domain, provided multiples are associated with near-horizontal reflectors.

CMP stacking facilitates attenuation of multiples besed on velocity discrimination between primaries and multiples. This criterion to attentate multiples also can be exploited in the $f-k, \tau-p$, and Radon-transform domains. The degree of success depends on the moveout difference between primaries and multiples, and hence, on velocities and arrival times of primary reflections, and the cable length. Specifically, the moveout difference between primaries and multiples decreases at shallow times, low velocities, and at near offsets.

## Periodicity of Multiples

When periodicity is preserved adequately, predictive deconvolution can be used to predict and attenuate multiples either in CMP or in the $\tau-p$ domain. For instance, short-period multiples and reverberations are largely attenuated by the application of predictive deconvolution to prestack data. Figure 6.1-1 shows selected CMP gathers along a marine line with the accompanying amplitude spectra and their autocorrelograms averaged over the traces of each gather. Note the abundance of guided

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0895.jpg?height=495&width=805&top_left_y=127&top_left_x=116)

FIG. 6.0-39. Selected image gatbers from prestack time migration using the velocity field shown in Figure 5.4-20. These gathers were obtained from data that were not subjected to multiple attenuation prior to prestack time migration. Compare with the gathers shown in Figure 5.4-21.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0895.jpg?height=482&width=805&top_left_y=701&top_left_x=115)

FIG. 6.0-40. The stack of image gathers as in Figure 6.0-39 derived from prestack time migration. Compare with the stack shown in Figure 5.4-22.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0896.jpg?height=1061&width=837&top_left_y=157&top_left_x=71)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0897.jpg?height=997&width=752&top_left_y=188&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0898.jpg?height=988&width=746&top_left_y=191&top_left_x=144)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0899.jpg?height=987&width=753&top_left_y=190&top_left_x=147)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0900.jpg?height=740&width=302&top_left_y=265&top_left_x=71)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0900.jpg?height=721&width=288&top_left_y=285&top_left_x=369)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0900.jpg?height=718&width=275&top_left_y=288&top_left_x=660)

(c)

FIG. 6.1-4. (a) CMP stack associated with the gathers shown in Figure 6.1-2 without prestack deconvolution; (b) CMP stack associnted with the gathers shown in Figure 6.1-3 with deconvolution before stack; (c) CMP stack as in (b) with the additional deconvolution after stack.
waves in the postcritical region (approximately between $0.0 .5 \mathrm{~s}$ at near offset and $0-4 \mathrm{~s}$ at far offset), and shortperiod multiples and reverberations in the subcritical region (below $0.5 \mathrm{~s}$ at near offset and below $4 \mathrm{~s}$ at far offset). (See Section F. 1 for modeling guided waves.) The peaks of the amplitude spectra are associated with the short-period multiples. The smaller the period of the multiples, the larger the separation of the peaks in the amplitude spectrum. The refracted arrival and its multiples as part of the guided wave energy indicate that the line has been recorded over a hard water-bottom area. Following $t$-squared scaling for geometric spreading correction and muting guided waves (Figure 6.1-2), the periodicity character of the multiples becomes more distinctive, particularly at near offsets. With the application of predictive deconvolution using unit-prediction lag (Figure 6.1-3), the amplitude spectrum is flattened within the passband, and multiples are greatly attenuated. The multiple attenuation also is indicated by the autocorrelograms of the deconvolved gathers in Figure 6.1-3.

Figure 6.1-4a shows the CMP stack associated with the gathers in Figure 6.1-2 without multiple attenuation, and Figure 6.1-4b shows the CMP stack associated with the gathers in Figure 6.1-3 with multiple attemation using deconvolution. Compare these two stacked sections and note that deconvolution before stack has attenuated much of the short-period multiples. Additional deconvolution after stack further improves the vertical resolution by restoring the flatness of the spectrum within the passband (Figure 6.1-4c).

Figure 6.1-5 shows a CMP gather with and without deconvolition. Aside from water-battom multiples, note the peg-leg multiples associated with the two primaries with arrival times of 1.5 and $2 \mathrm{~s}$ at near offset. The autocorrelogram clearly exhibits periodicity of the multiples especially at near offsets. Following predictive deconvolution (in this case with a unit-prediction lag), multiples are largely attenuated as seen in Figure $6.1 .-4 \mathrm{~b}$. The corresponding autocorrelogram is void of the energy associated with the reverberations and multiples. High-frequency random noise that has been boosted by the whitening effect of spiking deconvolution can be filtered out.

Figures 6.1-6 and 6.1-7 clearly demonstrate that conventional statistical deconvolution is a powerful method for attenuating not just short-period multiples and reverberations, but also moderately long-period multiples based on the periodicity criterion. The data shown in Figure 6.1-6 contain nearly flat primary reflections, while the data in Figure 6.1-7 contain some dipping primary reflections. The water-bottom multiples in both figures arrive at intervals of approximately
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0901.jpg?height=968&width=352&top_left_y=129&top_left_x=580)

Autocorrelograms (a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0901.jpg?height=34&width=44&top_left_y=1110&top_left_x=822)

FIG. 6.1-5. A field record containing short-period reverberations before (a) and after deconvolution (b). The solid lines represent the start and end times for the autocorrelation estimation windows.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0902.jpg?height=997&width=594&top_left_y=138&top_left_x=232)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0903.jpg?height=1017&width=650&top_left_y=179&top_left_x=188)

350 ms. There also exist peg-leg multiples associated with the primaries at approximately 1.5 and $2.5 \mathrm{~s}$ in Figure 6.1-6, and the primaries at approximately 1.5 and $2.1 \mathrm{~s}$ in Figure 6.1-7. In a conventional processing sequence, prestack and poststack deconvolution combined with CMP stacking, which exploits velocity discrimination between primaries and long-period maltiples, can significantly attenuate a large class of multiples.

## Velocity Discrimination Between Primaries and Multiples

The CMP gathers in Figure 6.1-8a clearly illustrate the moveout difference between primaries and multiples. A primary $p$ typically has less moveout than a multiple $m$. From the velocity spectrum in Figure 6.1-8b, note the difference between the velocity trends associated with primaries $V P$ and multiples $V M 1$ and $V M 2$. The $V M 1$ and $V M 2$ velocity functions represent the water-bottom and peg-leg multiples, respectively. If NMO correction is applied using the primary velocities, as is normally done to generate final stacks, then the primaries are aligned while the multiples are undercorrected (Figure 6.1-8c). This suggests that CMP stacking itself is a viable method of multiple attenuation. The CMP stack derived from the gathers in Figure 6.1-8c is shown in Figure 6.1-8d.

The synthetic CMP gather in Figure 6.1-9c contains five primaries, including the water-bottom reflection $W$ and the multiples associated with it. The velocity spectrum shows a significant separation between the velocity functions for multiples $V M$ and primaries $V P$. Stacking with the primary velocity function should, to a large extent, discriminate against the multiples and result in a section that contains essentially the primary energy as shown in Figure 6.1-10. The stack trace in Figure 6.1-10c is repeated to better examine the relative amplitudes of the primaries and the multiples.

Stacking far offsets works to suppress multiples. However, stacking near offsets works against multiple attenuation, since the moveout difference between primaries and multiples is negligibly small on those offsets as in Figure 6.1-8c. The simplest way around this problem is to apply an inside mute to the CMP gathers before stacking. Another problem then emerges the outside mute. The severity of this mute governs the amount of far-offset data left at early times for velocity discrimination (Figure 6.1-8c). If there is a severe multiple problem, an effort must be made to preserve the maximum amount of far-offset data associated with target events. The stacked section of Figure 6.1-8d with inside mute applied is shown in Figure 6.1-11a. When compared with Figure 6.1-8d, note that the deeper pegleg multiple below $4 \mathrm{~s}$ has been further attenuated by inside trace muting. The difference between the conventional CMP stack (Figure 6.1-8d) and the inside mute stack (Figure 6.1-11a) shown in Figure 6.1-11b indicates the amolint of energy, mostly multiples, that was removed by the inside mute.

A variation of conventional muting, such as optimum-weighted stacking can produce better results. In such $a$ scheme, weights between 0 and 1 are assigned to each offet during stacking. The smaller weights are normally assigned to the near offsets.

In summary, because there is relatively less moveout differential between the primaries and multiples in the near-offset range, the inside mute (or some kind of weighted stacking) helps suppress multiples. Hence, it may help to cascade any one of the multiple attenuation techniques described in this chapter with inside mute during stacking.

## Karhunen-Loeve Transform

Actually, there is a much more powerful technique than inside-trace muting or optimum-weighted stacking to attenuate multiples. It is based on Karhunen-Loeve (KL) transform (Jones and Levy, 1987; Ulrych et al., 1988; Al-Yahya, 1991). The basic underlying concept is that one can decompose a two-dimensional data set, such as a stacked section in space-time coordinates, into a number of components the so-called eigenimages, starting with the first eigenimage that contains the highest. correlatable events, moving onto the next eigenimage with events with less degree of correlation, all the way to the last eigenimage that comprises the least correlatable components. Each eigenimage comprises the same number of traces as the original data set. Singular-value decomposition (Section F.3) is one way of decomposing a data set into its eigenimages.

So, how is this transform applicable to stacking and multiple suppression? If you apply NMO correction to CMP gathers using the primary velocities, then the primaries will be flattened and thus will have the highest correlatability from trace to trace in the gathers. Hence, these primaries will map into the first eigenimage of the $\mathrm{K}-\mathrm{L}$ transform. By retaining only the first eigenimage and discarding the others, and stacking the traces in the first eigenimage, one can obtain a stacked trace that is virtually free of random and coherent noise such as multiples. Of comrse, in reality, there is always some noise component that creeps into the first eigenimage. This happens, for example, when there is very little moveout

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0905.jpg?height=496&width=723&top_left_y=130&top_left_x=165)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0905.jpg?height=463&width=512&top_left_y=616&top_left_x=284)

(c)

(d)

FIG. 6.1-8. (a) Three CMP gathers with strong multiples; (b) velocity analysis at CMP 186 , where $V P=$ primary velocity trend, $V M 1=$ slow (water-bottom) multiples, and $V M 2=$ fast (peg-leg) multiples. ( $V B$ is the velocity function used in generating Figure 6.2-15a.) For reference, the CMP gather is displayed next to the velocity spectrum. (c) The same CMP gathers as in (a) after NMO correction using the primary velocities. (d) CMP stack using the gathers as in (c). (Data courtesy Petro-Canada Resources.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=399&width=182&top_left_y=159&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=393&width=183&top_left_y=166&top_left_x=284)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=393&width=183&top_left_y=166&top_left_x=472)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=442&width=277&top_left_y=127&top_left_x=675)

(d)

FIG. 6.1-9. Synthetic CMP gathers containing (a) primaries, (b) water-bottom multiples, (c) superposition of (a) and (b). (d) The velocity spectrum derived from (c). Here, $W=$ water-bottom primary, $V M=$ velocity function for multiples, $V P=$ velocity function for primaries, $V B=$ a velocity function between $V M$ and $V P$ used in generating Figure $62-12 \mathrm{~b}$

difference between primaries and multiples. An alternative strategy that is aimed at multiple suppression involves moveout correction using multiple velocities, rather than primary velocities.

Start with a modeled CMP gather as shown in Figure 6.1-12a that contains a primary (arriving at $0.2 \mathrm{~s}$ at zero offset) and the associated multiples. This gather also contains three additional primaries (at $0.4,0.8$ and 1.2 zero-offset times) that are weaker in amplitude compared to the multiples. The moveout difference between the multiples and primaries is less than 100 ms at the far offset.

Apply NMO correction using the multiple velocity, in this case constant $3000 \mathrm{~m} / \mathrm{s}$. Mutiples are flattened, and primaries are overcorrected (Figure 6.1-12b). Then perform singular-value decomposition, which is the basis for K-L transform, and examine the first eigenimage (Figure 6.1-12c). Note that the highest correlatable events in this gather are those events with the moveout velocity of $3000 \mathrm{~m} / \mathrm{s}$ the primary at 0.2 -s zero-offset time and the associated multiples. Subtract this eigenimage from the original NMO-corrected gather (Figure 6.1-12b) to get the gather that is a composite of all the eigenimages except the first one (Figure 6.1-13a). Note that miltiples have been attenuated and the weak primaries have been retained. Because we did not reject the higher eigenimages associated with the least correlatable energy, including the random noise, this energy is present in the output gather in Figure 6.1-13a.

Finally, apply inverse NMO correction using the same multiple velocity function to obtain the gather after multiple attenuation (Figure 6.1-13b), which should

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=277&width=128&top_left_y=843&top_left_x=550)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=275&width=126&top_left_y=845&top_left_x=687)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0906.jpg?height=277&width=133&top_left_y=843&top_left_x=821)

(c)
FIG. 6.1-10. (a) The CMP gather in Figure 6.1-9c and (b) after NMO correction using the primary velocity function ( $V P$ in Figure 6.1-9d). (c) The stack trace derived from (b) repeated to emphasize the strong cvents.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0907.jpg?height=453&width=515&top_left_y=128&top_left_x=261)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0907.jpg?height=448&width=512&top_left_y=620&top_left_x=260)

(b)

6.1-11. (a) The CMP stack derıved from the CMP gathers in Figure $61-8 \mathrm{c}$ with inside mute apphed. The inside mute pattern can be recognized on the left edge of the section. Compare this stack with that shown in Figure 6.1-8d. (b) The difference between the conventional CMP stack (Figure 6 1-8d) and the inside mute stack (a). (Data courtesy Petro-Canada Resources.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0908.jpg?height=348&width=150&top_left_y=128&top_left_x=93)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0908.jpg?height=325&width=123&top_left_y=151&top_left_x=239)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0908.jpg?height=328&width=131&top_left_y=149&top_left_x=366)

(c)
6.1-12. (a) A modeled CMP gather with a primary at 0.2$s$ zero-offset time and its multiples, and with three additional primaries at 0.4 , 0.8 and $1.2-\mathrm{s}$ zero-offset times. The gather also contains band-limited random noise. (b) the same gather after NMO correction using the velocity of multiples ( $3000 \mathrm{~m} / \mathrm{s}$ ) and muting; (c) the eigenmage associated with the first eigenvalue derived from singular-value decomposition of the moveout-corrected gather. This eigenimage contains the primary at 02 -s zero-offset time and its associated multiples.

be compared with the original gather without multiple attenuation (Figure 6.1-13c). Note that, the K-L transform, in principle, is a very powerful data decomposition technique that can be used to attenuate multiples.

In addition to multiple attenuation, the K-L transform also can be used to attenuate random noise by simply rejecting the corresponding eigenimages. For instance, a 60 -trace CMP gather would be decomposed into 60 eigenimages. Those eigenimages with eigenvalues between, say 55 and 60 , would contain the random noise to be rejected.

Figure 6.1-14a shows a CMP gather that contains strong water-bottom and peg-leg multiples. Following moveout correction using the water velocity, the waterbottom multiples are flattened, peg-legs are slightly overcorrected and primaries, which are visible at far offsets below $2 \mathrm{~s}$, are significantly overcorrected (Figure 6.1-14b).

By the K-L transform, the gather is decomposed into its eigenimages. Figure 6.1-15 shows the reconstructed gather as in Figure 6.1-14b using only a subset of the eigenimages. The reconstructed gather using only the first eigenimage contains just a few of the strong moveout-corrected multiples. With the inclusion of additional eigenimages, the reconstructed gather is allowed to contain events with some moveout. By exam-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0908.jpg?height=349&width=148&top_left_y=127&top_left_x=550)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0908.jpg?height=324&width=129&top_left_y=150&top_left_x=696)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0908.jpg?height=327&width=129&top_left_y=149&top_left_x=823)

(c)
6.1-13. (a) The difierence gather derived from subtracting the first elgenimage gather (Figure 6.1-12c) from the moveout-corrected gather (Figure 6.1-12b), (b) same difference gather after inverse moveout correction, and (c) original modeled gather as in Figure 6.1-12a with the stretch mute as in (b). The gathers in (c) and (b) are before and after multiple attenuation using the K-L transform.

ining the series of reconstructed gathers with a subset of eigenimages, a band of eigenimages that corresponds to multiples can be determined.

Figure $6.1-14$ c shows such a reconstructed gather using the eigenimages that correspond to the first 20 eigenvalues. Subtract the gather in Figure $6.1-14 \mathrm{c}$ from that in Figure 6.1-14b to obtain the gather that presumably contains the primary reflections (Figure 6.114d). Following the application of inverse moveout correction (Figure 6.1-14e) the data are ready for velocity analysis after multiple attenuation. Figure 6.1-16 shows a portion of the CMP stack associated with the data in Figure 6.1-14 with and without multiple attenuation using the K-L transform. While this example demonstrates that the method can be successful in attenuating multiples associated with near-horizontal reflections, it also can be a robust technique in handling multiples associated with moderately complex reflections. Figure 6.1-17 shows a portion of a CMP stack that contains a strong primary at $1.2 \mathrm{~s}$ at the left-hand edge of the section. The K-L transform method has largely attenuated the water-bottom and peg-leg mutiples associated with the strong primary, and enhanced the primary events above it. Following the eigenimage decomposition, caution must be exercised in determining the number of eignevalues included in the reconstruction of CMP gathers (Figure 6.1-15),

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0909.jpg?height=414&width=157&top_left_y=126&top_left_x=104)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0909.jpg?height=411&width=144&top_left_y=128&top_left_x=253)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0909.jpg?height=413&width=272&top_left_y=128&top_left_x=388)

(c) (d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0909.jpg?height=414&width=278&top_left_y=129&top_left_x=653)

(e) (f)

FIG. 6.1-14. (a) A CMP gather with an abundance of water-botton and peg-leg multiples; (b) after moveout correction using the water velocity so as to flatten the water-bottom multiples; (c) the reconstructed gather using the eigenimages from the K-L transform that correspond to the first 20 eigenvalues; (d) the difference gather obtained by subtracting (c) from (b); (e) the gather in (d) after inverse moveout correction; (f) the original gather as in (a) after the same stretch mute as in (e). The gathers in (f) and (e) are before and after multiple attenuation using the K-L transform.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0909.jpg?height=431&width=811&top_left_y=713&top_left_x=113)

FIG. 6.1-15. Reconstruction of the CMP gather in Figure 6.1-14a using the eigemmages from the K-L transform that correspond, from (a) to (f), to the first $1,2,3,4,5$, and 10 eigenvalues.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0910.jpg?height=696&width=848&top_left_y=128&top_left_x=94)

FIG. 6.1-16. A portion of the CMP stack associated with the data in Figure 6.1-14, without (left) and with (right) multiple attenuation using the K-L transform.

As mentioned earljer, a flat event within a data window in time and space has the highest degree of correlation from trace to trace, and thus, maps into the first eigenimage. Doicin and Spitz (1991) exploited this property in the frequency-space domain based on the earlier work by White (1984) to better separate primaries from peg-leg multiples into different eigenimages. Consider a portion of a common-offset section in Figure 6.1-18a associated with a marine data set. The water bottom is nearly flat at approximately $150 \mathrm{~ms}$. The commonoffset section exhibits a primary reflection $(K)$ associated with an erosional unconformity in the neighborhood of $3 \mathrm{~s}$. The flat water bottom gives rise to a series of peg-leg multiples ( $M_{1}$ and $M_{2}$ ) of the primary reflection $(K)$, arriving at an equal time interval.
If we perform horizon flattening on the primary reflection $(K)$, then the multiple reflections $\left(M_{1}\right.$ and $M_{2}$ ) would also be flattened. The eigenimage decomposition of the data window that excludes the flattened primary but includes the flattened multiples maps these into the first eigenimage. Reject the first few eigenimages and reconstruct the data window from the remaining eigenimages without the peg-leg multiples. The final step involves unflattening of the data. This process is applied to each of the common offset sections and the data are stacked. Note the absence of the peg-leg multiples on the stacked section shown in Figure 6.1-18b. This section lends itself to an improved image of the dipping events below the unconformity (Figure 6.1-18c).

Peg-leg multiples associated with a reflector below a dipping water bottom exhibit a complex traveltime

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0911.jpg?height=1038&width=789&top_left_y=169&top_left_x=71)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0912.jpg?height=658&width=680&top_left_y=128&top_left_x=177)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0912.jpg?height=312&width=681&top_left_y=812&top_left_x=175)

C

FIG. 6.1-18. (a) A portion of a common-offset section with a series of peg-leg multiples ( $M_{1}$ and $M_{2}$ ) associated with a primary reflection $(K)$, (b) the stacked section that corresponds to the data as in (a) after the application of peg-leg multiple attenuation using a frequency-space eigenimage decomposition, and (c) time migration of the stacked section as in (b) (Doicin and Spitz, 1991.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0913.jpg?height=727&width=679&top_left_y=127&top_left_x=179)

FIG. 6.1-19. Selected CMP gathers that exhibit split peg-leg multiples (Levin and Shah, 1977.)

hehavior (Levin and Shah, 1977). Figure 6.1-19 shows selected CMP gathers that include peg-leg multiples of a complex nature. A sketch of raypaths associated with peg-leg multiples is shown in Figure 6.1-20. For a horizontally layered earth model, the peg-leg raypath segment on the source end (the solid path) of the CMP raypath and the peg-leg raypath segment on the receiver end (the dotted path) of the CMP raypath give rise to coincident arrival times on the CMP gather (Figure $6.1-20 \mathrm{a})$. When there are dipping reflectors along the raypaths of the peg-leg multiples, the peg-leg raypath segment on the source end of the CMP raypath and the peg-leg raypath segment on the receiver end of the CMP raypath give rise to split peg-leg multiple arrivals (Figure 6.1-20b). Also note that, while the minimum arrival time of the primary reflection is at near-offset trace, the minimum arrival time of the peg-leg multiple reflections is at some nonzero-offset trace. The split peg-leg multiples can be extremely troublesome when interpreting data recorded over a continental slope.

## Modeling of Multiples

Another approach to multiple attenuation based on velocity discrimination operates on CMP gathers directly in the $t-x$ domain. Again, consider the synthetic CMP gather in Figure 6.1-21a, which is the same as that in Figure 6.1-9c. Apply NMO correction, this time using
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0914.jpg?height=546&width=276&top_left_y=124&top_left_x=200)

a
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0914.jpg?height=548&width=280&top_left_y=124&top_left_x=557)

b

FIG, 6.1-20. Raypaths and traveltimes for peg-leg multiples associated with (a) horizontally layered earth model, and (b) an earth model with dipping reflectors.

the multiple velocity function labeled as $V M$ in Figure 6.1-9d. The result is shown in Figure 6.1-21b, while the stack trace is shown in Figure 6.1-21c. This stack trace is called the model trace for multiples since it almost entirely contains the multiple energy. Stubtract the model trace from the individual traces of the NMOcorrected gather (Figure 6.1-21b). The resulting traces essentially should contain only primary energy. Note that this model-based approach applies to one multiple velocity function at a time.

The main problem with this technique is constructing a model trace that contains only multiples. Because of slight waveform changes and the variation of the moveout differential between primaries and multiples with offset, the model trace for multiples will not represent multiples equaily well for each offset. Better representations of multiple energy can be obtained by constructing individual model traces for each offset by stacking only a few traces on both sides of the trace associated with that offset.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0914.jpg?height=314&width=142&top_left_y=806&top_left_x=548)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0914.jpg?height=312&width=109&top_left_y=807&top_left_x=706)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0914.jpg?height=314&width=130&top_left_y=806&top_left_x=824)

(c)
FIG. 6.1-21. (a) The modeled CMP gather in Figure 6.19c, (b) after NMO correction using the multiple velocity function (VM in Figure 6.1-9d). (c) The stack trace is repeated to emphasize the strong events.

Even if individual model traces were used, it is still difficult to generate model traces that do not contain some primary energy. Good attenuation of primary energy in the model trace ultimately depends on the moveout differential between primaries and multiples being a substantial fraction of the period of the seismic wavelet. At lower temporal frequencies, this usually is not the case and, hence, the model trace often includes some of the low-frequency components of the primaries. Consequently, subtraction of the model trace from the moveout-corrected traces often leads to attenuation of the multiples and the low-frequency components of the primaries. Exclusion of the low-frequency end of the spectrum in building the model traces is a way to deal with this latter problem.

To study the results of this subtraction technique on field data, consider the selected CMP gathers in Figure 6.1-8a. From the velocity spectrum in Figure $6.1-8 \mathrm{~b}$, note that the multiples can have more than one velocity trend (the velocity trends Iabeled as $V M 1$ and $V M 2$ ). The NMO-corrected CMP gathers in Figure 6.1-22a are obtained by using one of the velocity trends (VM1). The primaries are overcorrected, while the multiples associated with the velocity trend $V M 1$ are flattened.

The velocity spectrum after multiple attenuation using the model-based subtraction technique (Figure 6.1-22b) shows an enhanced primary velocity trend. Also note the removal of the multiple trend (VM1) from the velocity spectrum. The selected CMP gathers following moveout correction using the primary velocities from Figure 6.1-22b are shown in Figure 6.1-22c. The stacked section after applying the multiple attenuation procedure is shown in Figure 6.1-22d.

The model-based approach can be cascaded to attenuate more than one class of multiples present in the data. Use of the multiple velocity trend labeled as $V M 2$ in Figure 6.1-8b, yields the results shown in Figure 6.123. Input CMP gathers to the second pass (Figure 6.123a) are the output CMP gathers from the first pass (Figure 6.1-22c). Note the attenuation of the multiple trend $V M 2$ from the velocity spectrum (Figure 6.123b). The deeper peg-leg multiple below $4 \mathrm{~s}$ has been attenuated further (compare Figures 6.1-22d and 6.123d).

The stacked sections resulting from the first pass (Figure 6.1-22d) and the second pass (Figure 6.1-23d) have a high-frequency character compared to the conventional CMP stack (Figure 6.1-8d). As indicated earlier, this effect can be suppressed by excluding the low frequencies from the model traces. Multiple attenuation using the filtered versions of the model traces yields the stacked sections in Figure 6.1-24.

### 6.2 FREQUENCY-WAVENUMBER FILTERING

Coherent linear events in the $t-x$ domain can be separated in the $f-k$ domain by their dips. This allows us to eliminate certain types of unwanted energy from the data. In particular, coherent linear noise in the form of ground roll, guided waves, and side-scattered energy commonly obscure primary reflections in recorded data. These types of noise usually are isolated from the reflection energy in the $f-k$ domain. From the field record in Figure 6.2-1a, note how ground-roll energy can dominate the data. Ground roll is a type of dispersive waveform that propagates along the surface and is low-frequency, large-amplitude in character. Typically, ground roll is suppressed in the field by using a suitable receiver array.

Figure $6.2-1 \mathrm{~b}$ is the 2-D amplitude spectrum of the field record in Figure 6.2-12. Here, various types of energy are well isolated from one another. Ground roll $A$, its backscattered component $B$, and guided waves $C$, are identifiable. Reflections $D$ are situated around the frequency axis. As shown in Figure 6.2-1c, a fan is imposed on this spectrum within which the undesired energy is rejected. This is followed by inverse mapping back to the $t-x$ domain. The resulting filtered record in Figure 6.2-1d is largely free of ground-roll energy, except for the backscattered component. Defining a reject fan in the $f-k$ domain is one implementation of the process known as $f-k$ dip filtering.

Note that dip fitering is but one type of $f-k$ filtering. The reject zone in the $f-k$ domain may be specified not just as a fan but also as a shape suitable for the objective in mind. For instance, the reject zone may be defined as one entire quadrant of the $f-k$ plane in the case of multiple attenuation. It may only be one half of one quadrant in the case of a spatial antialiasing filter (Section 1.2). The following are the steps involved in $f-k$ filtering:

(a) Starting with a common-shot or a CMP gather, or a CMP-stacked section, apply 2-D Fourier transform.

(b) Define a 2-D reject zone in the $f-k$ domain by setting the 2-D amplitude spectrum of the $f-k$ filter to zero within that zone and set its phase spectrum to zero.

(c) Apply the 2-D $f-k$ filter by multiplying its amplitude spectrum with that of the input dat a set.

(d) Apply 2-D inverse Fourier transform of the filtered data.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0916.jpg?height=946&width=724&top_left_y=130&top_left_x=156)

(d)

FIG. 6.1-22. (a) The CMP gathers in Figure 6 1-8a after NMO correction using siow multiple velocities (VM1 in Figure 6 18b). (b) The velocity spectrum at CMP 186 after single-pass model-based subtraction for multiple attenuation. For reference, the CMP gather after multiple attenuation is shown to the left of the velocity spectrum. (Compare this with Figure 6.1-8b.) (c) The same CMP gathers as in (a) after the single-pass model-based subtraction for multiple attenuation, followed by NMO correction using primary velocitics derived from velocity spectrum (b), (d) The CMP stack derived from the CMP gathers as in (c) after multiple suppression.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0917.jpg?height=952&width=723&top_left_y=127&top_left_x=157)

(d)

FIG. 6.1-23. (a) The CMP gathers from the first-pess model-based subtraction for multiple attenuation (Figure 6.1-22) after NMO correction using fast multuple velocitis (VM2 in Figure 6.1-8b) (b) The velocity spectrum at CMP 186 after the second-pass model-based subtraction for multiple attenuation. For reference, the CMP gather after multiple attemiation is shown to the left of the velocity spectrum. (c) The same CMP gathers as in (a) after the second-pass model-based subtraction for multiple attenuation, followed by NMO correction using primary velocities from (b). (d) The CMP stack derived from the CMP gathers as in (c) after the second-pass model-based subtraction for multiple attenuation.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0918.jpg?height=498&width=565&top_left_y=132&top_left_x=233)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0918.jpg?height=491&width=565&top_left_y=641&top_left_x=239)

(b)

FIG. 6.1-24. The CMP stacks after the model-based subtraction for multiple attenuation, which was implemented using filtered model traces. (a) First pass using multiple velocities $V M 1$ and (b) second pass using multiple velocities $V M 2$, as depicted in Figure 6.1-8b.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=704&width=728&top_left_y=208&top_left_x=78)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=204&width=96&top_left_y=250&top_left_x=813)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=54&width=85&top_left_y=441&top_left_x=820)

号 粦粦号

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=41&width=86&top_left_y=517&top_left_x=822)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=51&width=83&top_left_y=559&top_left_x=821)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=34&width=82&top_left_y=593&top_left_x=823)

员寻占

卷药

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=432&width=174&top_left_y=692&top_left_x=758)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0919.jpg?height=247&width=612&top_left_y=916&top_left_x=117)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0920.jpg?height=467&width=361&top_left_y=126&top_left_x=338)

FIG. 6.2-2. (a) A synthetic CMP gather with band-limited random noise uncorrelated from trace to trace; the same gather after $f-k$ filtering with different pass-fans with dip bands: (b) $(+2,-2) \mathrm{ms} / \mathrm{trace}$, and (c) $(+4,-4) \mathrm{ms} /$ trace. The $f-k$ spectra are shown at the bottom of each panel. Note that random noise in $t-x$ domain maps onto a rectangular zone in the $f-k$ domain, with its top and base corresponding to the low- and high-frequency end of the passband.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0920.jpg?height=466&width=353&top_left_y=697&top_left_x=345)

FIG. 6.2-3. A synthetic CMP gather as in Figure 6.2-2 with band-limited random noise uncorrelated from trace to trace after $f-k$ filtering with different pass-fans with dip bands (a) $(+6,-6$ ) ms/trace, (b) $(+8,-8) \mathrm{ms} / \mathrm{trace}$, and (c) (+10,-10) $\mathrm{ms} / \mathrm{trace}$. The $f-k$ spectra are shown at the bottom of each panel.

Practical issues associated with the 2-D Fourier transform and specifying a fan reject zone are outlined below:

(a) Conventional implementations of the Fourier transform itself produce wraparound noise. This is apparent in Figure 6.2-1d, location $F$. To avoid this problem, the data must be extended beyond the ranges of the spatial and temporal axes by padding with zeroes. The size of the input gather typically is increased by a factor of 4 , which is equivalent to doubling the length in $t$ and $x$. This increases the cost but removes the wraparound effects.

(b) The fan width must not be too narrow. This follows from previous observations of the 1-D Fourier analysis of frequency filters (Section 1.1). If the bandwidth of the reject zone were narrow, then the $t-x$ response of the dip filter would have a large array of nonzero elements. Fortunately, coherent noise with large stepouts, such as ground roll, often is isolated in the $f-k$ domain from the zone that includes the reflection signal. This is demonstrated by the example in Figure 6.2-1b. In such cases, ground-roll energy $A$ is attenuated without damaging the reflection signal by using a large fan (Figure 6.2-1c).

(c) As for the 1-D frequency filters (Section 1.1), the amplitude spectrum of the $f-k$ filter must not have sharp boundaries. There must be a smooth transition from the reject zone to the pass zone. This is accomplished by tapering the fan edges, which is analogous to using slopes in frequency filtering The amount of tapering must be large enough to be effective. On the other hand, it must not be so wide that it suppresses signal in the pass zone. Extra precaution is taken at low frequencies. As the fan thins to a zero width at the origin of the $f-k$ domain, as in a wedge, the actual reject zone may invade the low-frequency components of the pass zone. This invasion occurs because the fan cannot get too narrow. It may be desirable to stop the reject zone just short of the low frequencies. This effectively excludes the low frequencies from the $f-k$ dip filtering action.

(d) Spatial aliasing often causes poor $f-k$ filter performance. The fan reject zone must be extended to the spatially aliased frequency components. A practical approach to this problem is to apply linear moveout correction to the data before $f-k$ filtering so that the unwanted signal appears at lower dips, thus eliminating the spatial aliasing effects. The linear moveout then is removed after $f-k$ filtering. Unfortunately, this may not always work, since events that are not spatially aliased before may be spatially aliased after linear moveout.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0921.jpg?height=754&width=396&top_left_y=124&top_left_x=548)

FIG. 6.2-4. (a) Stack of synthetic CMP gathers as in Figure 6.2-2a without $f-k$ filtering, and (b) stack of synthetic CMP gathers as in Figure $6.2-2 \mathrm{~b}$ with $f-k$ filtering using a dip band of $(+2,-2) \mathrm{ms} / \mathrm{trace}$.

## Random Noise and Frequency-Wavenumber Filtering

Treatment of random noise uncorrelated from trace to trace by $f-k$ filtering is an important aspect of the process. Figure 6.2-2 shows a synthetic CMP gather which contains only band-limited random noise. Note that the $f-k$ spectrum exhibits the random character of the data there is energy at all wavenumbers up to the Nyquist and at all frequencies within the passband.

After the application of a narrow-fan $f-k$ dip filter, note that the CMP gather contains coherent events with dips that correspond to the pass-fan in the $f-k$ domain. By widening the pass-fan of the $f-k$ dip filter, dip range of the coherent events in the gather is broadened as demonstrated in Figure 6.2-3. As the pass-fan is widened, the coherence of events in the gather becomes increasingly less apparent, while the randomness character becomes more predominant and eventually similar to that of the input gather.

Figure 6.2-4a shows a stack of several CMP gathers as in Figure 6.2-2a with band-limited random noise. Note that stacking of CMP gathers which contain just random noise yields a stack which contains, again, random noise. The $f-k$ spectrum exhibits the random character of the stacked data - there is energy at all wavenumbers up to the Nyquist and at all frequencies within the passband. Figure $6.2-4 \mathrm{~b}$ shows a stack of $f-k$ filtered CMP gathers as in Figure 6.2-2b. Note that stacking of $f-k$ filtered CMP gathers with random noise yields, once again, a section which largely contains just random noise, despite the nonrandom character of the input gathers (Figure 6.2-2b).

The stacked section in Figure 6.2-4a was displayed at a very high gain to differentiate the noise levels at shallow and late times. The reason why the noise level is stronger at the shallow portion is because the muting after NMO correction has caused lower fold in stacking, and hence less attenuation of the random noise during stacking. The stack of the CMP gathers with $f-k$ dip filtering (Figure 6.2-4b) does not exhibit the organized character seen in the CMP gathers themselves (Figure $6.2-2 b$ ), because the stacked amplitudes are uncorrelated from one gather to another. The relatively higher amplitudes at late times in Figure $6.2-4 \mathrm{~b}$ result from less attenuation of the organized noise on CMP gathers at late times during stacking - less attenuation, because the stepout of the organized noise at late times happens to be very similar to the moveout implied by the velocity function used in NMO correction.

## Statics Corrections and <br> Frequency-Wavenumber Filtering

It should be noted that coherent linear noise on shot gathers can be influenced kinematically by surface topography and a near-surface refractor geometry. Specifically, linearity of the coherent noise may be distorted across a shot record. Distortions along a linear event in the $t-x$ domain cause smearing of energy over a broad range of wavenumbers in the $f-k$ domain. This, in turn, would make it difficult to specify a pass-fan for reflection energy. It can be concluded that statics corrections, at least in the form of field statics, should be applied to shot records prior to $f-k$ filtering.

## Dip Filtering of Coherent Linear Noise

Figure 6.2-5 shows four cornmon-shot gathers, while Figure 6.2-6 shows their $f-k$ spectra before and after $f-k$ dip filtering. The pass or reject zones in the $f-k$ spectra do not need to be constrained to fan shape. The left half of the spectra mostly contain spatially aliased data. By keeping the fan shape in the right quadrant, while zeroing out most of the left quadrant, the coherent noise trains, including the aliased energy, are eliminated.

Because aliasing is a serious concern in $f-k$ filtering, it is advisable to apply it to shot gathers rather than to CMP gathers, since CMP gathers can have twice the trace spacing of shot gathers. Nevertheless, two neighboring CMP gathers can be interleaved before applying $f-k$ dip filtering, then split afterward, thus alleviating aliasing. Such implementation is permissible provided the composite gather does not exhibit any traveltime shifts caused by changes in reflector geometries or lateral variations in velocities. Coherent noise as seen on the shot gathers in Figure $6.2-5$ is best attenuated in the shot-gather domain. When sorted into CMP gathers, no significant remnant of this noise is left in the data (Figure 6.2-7). Figure 6.2-8a shows the stacked section derived from the CMP gathers in Figure 6.2-7a with no $f-k$ filtering. Note the linear noise left in the stacked section. The CMP gathers with $f-k$ filtering (Figure $6.2-7 \mathrm{~b})$ yield a stack that is virtually free of linear noise (Figure 6.2-8b).

Coherent linear noise on stacked data also can be suppressed by poststack migration that incorporates dip filtering. If coherent linear noise is associated with side scatterers, then much of it can be attenuated by a constant-velocity DMO correction (Section 5.2). If $f-k$ filtering were not applied to common-shot gathers containing side-scat tered energy, then a stacked section with coherent linear noise could result (Figure 6.2-9a). Figure $6.2-9 \mathrm{~b}$ shows that this noise can be attenuated by $f-k$ dip filtering the stacked section. Could this noise at tenuation be done better? If an $f-k$ filter were applied to shot records, then the stack in Figure 6.2-9c results. When compared to the result in Figure $6.2-9 \mathrm{~b}$, the result in Figure 6.2-9c seerns to offer better resolution. The prestack $f-k$ filtered data also yield an improved velocity analysis (Figure 6.2-10).

Practical experience with $f-k$ filtering proves that an even better stack may result when both commonshot and common-receiver gathers are $f-k$ filtered.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0923.jpg?height=465&width=535&top_left_y=134&top_left_x=251)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0923.jpg?height=457&width=533&top_left_y=655&top_left_x=252)

(b)

FIG. 6.2-5. Four shallow marine records (a) before and (b) after $f-k$ dip filtering to remove coherent linear noise. TI coherent noise seen in these records is primarily of the guided wave type. (Data courtesy Deminex Petroleum.)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0924.jpg?height=900&width=670&top_left_y=132&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0924.jpg?height=168&width=24&top_left_y=807&top_left_x=854)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0924.jpg?height=192&width=289&top_left_y=597&top_left_x=177)

(I

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0925.jpg?height=459&width=568&top_left_y=128&top_left_x=237)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0925.jpg?height=455&width=567&top_left_y=655&top_left_x=239)

(b)

FIG. 6.2-7. The CMP gathers from a shallow marine survey (a) before and (b) after $f-k$ dip filtering implemented in the shot-gather domain to remove coherent linear noise. (These are the same data as in Figure 6.2-5.) (Data courtesy Derninex Petroleum.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0926.jpg?height=464&width=619&top_left_y=133&top_left_x=208)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0926.jpg?height=454&width=595&top_left_y=659&top_left_x=230)

(b)

FIG. B.2-8. (a) CMP stack with some coherent linear noise; and (b) $f-k$ dp filtering before stack. Selected CMP gathers are shown in Figure 6.2-7. (Data courtesy Deminex Petroleum.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0927.jpg?height=446&width=363&top_left_y=126&top_left_x=157)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0927.jpg?height=435&width=362&top_left_y=616&top_left_x=156)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0927.jpg?height=445&width=364&top_left_y=128&top_left_x=524)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0927.jpg?height=432&width=363&top_left_y=616&top_left_x=525)

(d)

FIG. 6.2-9. (a) CMP stack contaminated by coherent noise. Associated common-6hot and CMP gathers are shown in Figure 6.0-1. (b) The same CMP stack $f-k$ filtered after stack. (c) CMP stack $f-k$ filtered before stack. (d) CMP stack $f-k$ filtered twice before stack first, in common-shot domain, second, in common-receiver domain. (Data courtesy Taylor Woodrow Energy Ltd.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0928.jpg?height=410&width=228&top_left_y=127&top_left_x=83)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0928.jpg?height=399&width=194&top_left_y=138&top_left_x=305)

(b)
PIG. 6.2-10. Velocity spectrum associated with the data in Figure $60-1 \mathrm{~b}$ (a) without and (b) with $f-k$ dip filtering.

primary and multiple velocities. The resulting NMOcorrected gather and its 2-D amplitude spectrum are shown in Figure 6.2-11b. The multiples are undercorrected, while the primaries are overcorrected. In the $f-k$ domain, the multiples and primaries for the most part map onto two different quadrants (labeled as $P$ for primaries and $M$ for multiples). The exception to this separation is the near-offset energy (both primary and multiple), which almost entirely maps along the frequency axis. This occurs because multiples and primaries have no significant moveout difference at near offsets. Aliased energy (such as $A$ ) is wrapped around and mapped to the wrong quadrant. (Spatial aliasing is discussed in detail in Section 1.2.)

Multiples can be attenuated by zeroing the quadrant corresponding to multiple energy in the $f-k$ domain (Figure 6.2-11c) (Ryu, 1980; Sengbush, 1983). However, note that spatially aliased multiple energy remains in the gather (labeled as $A$ in Figure $6.12-11 \mathrm{c}$ ). A shown in Figure 6.2-11d, besides zeroing out the multiple quadrant, a reject zone labeled as $R$ can be imposed on the primary quadrant. The $f-k$ filtered CMP gather (Figure 6.2-11d) now also is free of the aliased energy (compare with Figure 6.2-11c). Inverse NMO correction (Figure 6.2-1le) using the same intermediate velocity function $V B$ (Figure 6.1-9d) restores the original moveout of the primaries. Following this procedure, apply NMO correction using the primary velocity function $V P$ (Figure 6.1-9d) as shown in Figure 6.2-11f.
The stacked trace of this gather displayed repeatedly exhibits very little multiple energy (Figure $6.2-11 \mathrm{~g}$ ).

The sequence for $f-k$ filtering of multiple attenuation is as follows:

(a) Apply moveout correction to CMP gathers using a velocity function $v_{b}$ such that $v_{m}<v_{b}<v_{p}$, where $v_{m}$ and $v_{p}$ are velocity functions associated with multiples and primaries, respectively.

(b) Apply 2-F Fourier transform.

(c) Zero the quadrant associated with the multiples and, if required, the zone that contains the energy associated with the aliased multiples within the primaries quadrant.

(d) Apply inverse 2-D Fourier transform.

(e) Apply inverse moveout correction using the velocity function $v_{b}$ as in step (a).

(f) Perform velocity analysis to update the picks for primary velocity functions.

Now consider the field data example shown in Figure 6.2-12. The moveout difference between the primaries and multiples is apparent in the CMP gathers (Figure 6.1-8a). To the left of the primary velocity function labeled as $V P$ in Figure 6.1-8b, all peaks are associated with water-bottom and peg-leg multiples. Apply moveout correction using a velocity function $V B$ that lies between the primary and multiple velocities. As a result, the multiples are undercorrected and the primaries are overcorrected as shown in Figure 6.2-12a. Now consider the moveout of primaries and multiples in the $f-k$ domain. The primary and multiple indicated in Figure 6.1-8a map to the same quadrant (say positive quadrant) in the $f-k$ domain before moveout correction. The same events after moveout correction using an intermediate velocity map into two different quadrants; in particular, the multiple maps into the positive quadrant and the primary maps into the negative quadrant. Thus, by zeroing one quadrant in which the multiples are clustered, the primaries can be enhanced.

A CMP gather and the associated velocity spectrum following $f-k$ multiple attenuation are shown in Figure 6.2-12b. When compared with Figure 6.1-8b, Figure 6.2-12b shows that the energy in the multiples region in the velocity spectrum was attenuated, while the primary velocity trend was enchanced. Finally, Figure 6.2-12c shows selected CMP gathers after moveout correction using the primary velocities picked from the velocity spectrum in Figure 6.2-12b. Stacking of these gathers yields the section in Figure 6.2-12d. This section should be compared with Figures 6.1-8d.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0929.jpg?height=948&width=688&top_left_y=210&top_left_x=180)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0930.jpg?height=501&width=734&top_left_y=136&top_left_x=149)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0930.jpg?height=470&width=525&top_left_y=625&top_left_x=273)

(c)

FIG. 6.2-12. (a) The CMP gathers in Figure 6.1-8a after NMO correction using a velocity function (labeled as VB in Figure $6.1-8 b$ ) between the primary and multiple velocities; (b) velocity spectrum at CMP 186 estrmated from the $f-k$ dip-filtered gather shown to the left of the spectrum. Compare this with Figure 6.1-8b. (c) The same CMP gathers as in (a) after $f-k$ multiple attenuation followed by NMO correction asing the primary velocties derived from velocity spectrum (b). (d) The CMP stack derived from the CMP gathers as in (c) after $f-k$ multiple attenuation.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0931.jpg?height=997&width=737&top_left_y=188&top_left_x=134)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0932.jpg?height=998&width=756&top_left_y=186&top_left_x=134)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0933.jpg?height=1040&width=826&top_left_y=136&top_left_x=104)

FIG. 6.2-15. An NMO-corrected CMP gather (left column) and the corresponding velocity spectrum (right column) associated with: (top row) the stacked data shown in Figure 6.2-13, and (bottom row) the stacked data shown in Figure 6.2-14.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0934.jpg?height=996&width=701&top_left_y=188&top_left_x=127)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0935.jpg?height=997&width=741&top_left_y=189&top_left_x=147)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0936.jpg?height=997&width=693&top_left_y=188&top_left_x=155)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0936.jpg?height=869&width=36&top_left_y=251&top_left_x=855)

In practice, there are variations in selecting the velocity function used to apply moveout correction prior to $f-k$ filtering. An alternative strategy is to apply NMO correction using the multiple velocity, then zero the energy along the frequency axis in addition to that in the multiple quadrant of the $f-k$ spectrum. Another strategy is to apply NMO correction using primary velocities and place a tight pass-zone around the frequency axis. Finally, note that the $f-k$ method of velocity discrimination is one type of $f-k$ filtering. Thus, we must deal with the same practical issues discussed in Section 1.2 - in particular, wraparound, spatial aliasing, and tapering over the boundary between the pass and reject zones.

Multiples are best attenuated when a combination of two methods based on periodicity of multiples and velocity discrimination between primaries and multiples are used. Figure 6.2-13 shows a CMP-stacked section with no attempt made to attenuate the multiples. Specifically, the processing sequence did not include deconvolution nor $f-k$ filtering. Note the abundance of peg-leg multiples associated with the strong reflections; these multiples dominate the section below $2 \mathrm{~s}$.

By combining prestack deconvolution with $f-k$ filtering followed by poststack deconvolution, as demonstrated in Figure 6.2-14, multiples in Figure 6.2-13 are Iargely attenuated despite the complicated nature of the reflectors that originate the peg-legs. The class of multiples present in the stacked section of Figure 6.2-13 is clearly identified in the corresponding velocity spectrum shown in Figure 6.2-15. Note that much of the energy associated with the multiples is absent in the velocity spectrum shown in Figure $6.2-15$ corresponding to the stacked section in Figure 6.2-14. Compare the velocity spectra in Figure 6.2-15 computed from the CMP gather without and with multiple attenuation and note that, following multiple attenuation, the energy of the primeries has been enhanced relative to that of the multiples.

Prestack deconvolution alone has limited effect in attenuating multiples (Figure 6.2-16). When combined with poststack deconvolution, however, it often is successful in attenuating a large class of multiples (Figure 6.2-17). The key to effective multiple attenuation by predictive deconvolution is to be generous with the operator length. As for the example shown in Figure 6.2-17, an operator length as long as $480 \mathrm{~ms}$ may need to be considered.

A combination of prestack deconvolution and $f-$ $k$ filtering for muitiple attenuation yields the section shown in Figure 6.2-18. Compare with Figure 6.2-17 and note the more effective multiple attenuation by combining deconvolution with $f-k$ filtering. The addition of poststack deconvolution to the sequence that includes prestack deconvolution and $f-k$ filtering yields the most favorable result within the context of multiple attenuation (Figure 6.2-14).

### 6.3 THE SLANT-STACK TRANSFORM

In Section 1.2, we learned that the 2-D Fourier transform is one way to decompose 8 wavefield into its planewave components, each with a unique frequency and each traveling at a unique angle from the vertical direction. In this section, we shall discuss the domain of ray parameter and present another way to decompose the wavefield into its plane-wave components.

Plene-wave decomposition of a wavefield, such as a common-shot gather, can be achieved by applying linear moveout and summing amplitudes over the offset axis. This procedure is called slant stacking. An underlying assumption of slant stacking is that of a horizontally layered earth model. Conventional processing is done primarily in midpoint-offset coordinates. Slant stacking replaces the offset axis with the ray parameter $p$ axis. The ray parameter is the inverse of the horizontal phase velocity. A group of traces with a range of $p$ values is called a slant-stack gather.

Several processing techniques have been devised, with varying degres of success, in midpoint-rayparameter coordinates. Examples include trace interpolation, multiple attenuation, time-variant dip filtering, refraction inversion, velocity anslysis, migration before stack, and deconvolution. Taner (1977) was the first to introduce the midpoint-ray-parameter coordinates. He discussed the interpretive use of plane-wave stacks, where several constant $p$ sections are superpositioned over a restricted range of $p$ values to enhance dipping events. Other processing methods were investigated later, such as migration (Ottolini, 1982) and velocity analysis (Schultz and Claerbout, 1978; Dicbold and Stoffa, 1981; and Gonzalez-Serrano, 1982). Alam and Lasocki (1981) and Alam and Austin (1981) discussed possible applications in trace interpolation and multiple attenuation, respectively. McMechan and Yedlin (1981) devised a method to obtain phase velocity curves for dispersive waves using slant-stack transformation (Section F.1). Clayton and McMechan (1981) devised a method to invert a refracted wavefield, which involves downward continuation in the slant-stack domain (Section F.2). Based on downward continuation of a slant-stack gather, Schultz (1982) developed a technique to estimate interval velocities.

## Physical Aspects of Slant Stacking

We now examine the physical aspects of constructing a slant-stack gather. Each trace in this gather represents

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0938.jpg?height=242&width=414&top_left_y=128&top_left_x=84)

FIG. 6.3-1. A seismic source generates waves that propagate in all directions; waves traveling in different durections are recorded at different receiver locations.

a plane wave that propagates at a certain angle from vertical. In reality, when a dynamite source explodes, the energy propagates at all angles (Figure 6.3-1). The reflected energy arrives at different receiver groups at different angles because of the offset between source and receiver locations. The farther the offset or the shallower the reflecting interface, the more oblique the angle of the upcoming wavefront

As an aid in defining a scheme for constructing slant-stack gathers, first consider how plane waves car be generated. Imagine a line of point sources as shown in Figure 6.3-2. Assume that this line of sources is activated so that all points on the line are excited simultaneously, and each point generates a spherical wavefield. Some distance from the surface, the spherical wavefronts superimpose and result in a plane wave that travels vertically downward. This plane wave reflects from an interface and is recorded by a receiver at the surface (Actually, there are source types, such as Geoflex and Primacord, which approximate short line sources.)

Instead of a vertically traveling plane wave, a plane wave that travels at a desired angle from vertical can be generated using the same line of point sources as illustrated in Figure 6.3-3. To do this, the point sources must be activated in succession starting at one end of

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0938.jpg?height=197&width=398&top_left_y=1001&top_left_x=92)

FIG. 6.3-2. A vertically incident plane wave is gcnerated by setting of mary shots in unison.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0938.jpg?height=263&width=373&top_left_y=128&top_left_x=560)

FIG. 6.3-3. A plane wave that travels at angle $\theta$ from vertical is generated by setting off many shots (starting from lefit) at appropriate time intervals.

the line with an equal time delay between them. When a particular point source is activated, the wavefront generated from the previous source location already will have traveled a certain distance into the earth. When all the spherical wavefronts generated by the various sources superimpose, the result is a tilted plane wavefront. This plane wave then propagates, refects from an interface, and is recorded by a receiver at the surface.

The amount of tilt of the wavefront, defined by the angle of propagation of the plane wave, can be controlled. Consider the raypath-wavefront geometry in Figure 6.3-4. By the time the wavefront generated at source location $S_{1}$ reaches point $A$ in the subsurface, the point source at location $S_{2}$ should be excited so that the desired angle is attained. Define the distance between $S_{1}$ and $S_{2}$ as $\Delta x$, and the medium velocity with which the waves travel as $v$. If it takes $\Delta t$ time for the wavefront to go from $S_{1}$ to $A$, using the triangle $S_{1} A S_{2}$, then the dip angle $\theta$ of the plane wave is given by

$$
\sin \theta=\frac{v \Delta t}{\Delta x}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0938.jpg?height=210&width=382&top_left_y=977&top_left_x=560)

FIG. 6.3-4. Computation of time interval between shots (S) to generate the oblique plane wave in Figure 6.3-3.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0939.jpg?height=228&width=395&top_left_y=128&top_left_x=104)

FIG. 6.3-5. The reciprocity principle applied to the geometry of Figure 6.3-4 to replace shots $(S)$ with receivers $(R)$.

The active source location must therefore travel with speed given by

$$
\frac{\Delta x}{\Delta t}=\frac{v}{\sin \theta}
$$

along the horizontal direction, and the point source at location $S_{2}$ must be excited so that we can catch the wavefront at $S_{1}$ as it reaches point $A$ on the wavefront in the subsurface. The velocity $(v / \sin \theta)$ with which the source location must move is called the horzontal phase velocity.

From the experiments illustrated by Figures 6.3-2 and $6.3-3$, note that a plane wave propagating at an angle from the vertical can be generated by:

(1) Placing a line of point sources at the earth's surface.

(2) Exciting the point sources in succession with a time delay.

(3) Superimposing the responses that are in the form of spherical wavefronts.

The superimposed response is recorded on a single receiver (Figure 6.3-3). This response is in the form of a plane wave that is reflected from an interface. Superposition means summing over the shot axis for a given receiver location. Using the reciprocity principle, summation also can be performed over the receiver axis for a given shot location.

We just discussed how a common-shot gather as a single wavefield can be decomposed into its plane-wave components. By replacing the shot axis in Figure 6.3-4 with the receiver axis, the raypath geometry in Figure $6.3-5$ results. The time delay associated with the plane wave that travels at angle $\theta$ from the vertical is given by

$$
\Delta t=\frac{\sin \theta}{v} \Delta x
$$

Snell's law says that the quantity $\sin \theta / \nu$, which is the inverse of the horizontal phase velocity, is constant

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0939.jpg?height=422&width=393&top_left_y=136&top_left_x=560)

FIG. 6.3-6. If the ray parameter $p$ is specified, then the ray can be traced in a horizontally layered earth model with a known velocity function $v(z)$.

along a raypath in a layered medium (Figure 6.3-6). This constant is called the ray parameter $p$. Equation (6-3a) then is rewritten as

$$
\Delta t=p \Delta x .
$$

The angle of propagation of the plane wave is controlled by adjusting the $p$ value. If the ray parameter $p$ is specified, then the ray can be traced in a horizontally layered earth model with a known velocity function $v(z)$. Setting $p=0$ corresponds to a plane wave that travels vertically.

Given the ray parameter $p$ and the velocity function $v(z)$ for the layered earth, the fanily of raypaths associated with a particular $p$ value can be traced as shown in Figure 6.3-7. A plane wave that travels in a layered earth is called a Snell wave (Claerbout, 1978). This type of plane wave changes its direction of propagation at each layer boundary according to Snell's law (Figure 6.3-6). For a single $p$ value, note that the signal is recorded at many offsets (Figure 6.3-7).

In general, receivers at all offsets record plane waves of many $p$ values. To decompose a shot gather into its plane-wave components, all the trace amplitudes in the gather must be summed along several slanted paths, each with a unique time delay defined by equation (6-3b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0940.jpg?height=220&width=417&top_left_y=128&top_left_x=81)

FIG, 6.3-7. Some raypaths for a given $p$ value, corresponding to a single trace in the $\tau-p$ domain.

As long as there is no dip, the traveltimes in a common-shot and a common-midpoint gather are indistinguishable. Since a CMP gather is not a single wavefield, plane-wave decomposition would not seem to apply to CMP gathers. However, the equivalence of CMP gathers and common shot gathers in a horizontally layered earth provides a rationale for applying plane-wave decomposition to both types of gathers.

## Slant-Stack Transformation

Two steps typically are used in synthesizing plane waves by summing amplitudes in the ofiset domain along slanted paths (Figure 6.3-8). First, a linear moveout (LMO) correction is applied to the data through a coordinate transformation defined by (Claerbout, 1978)

$$
\tau=t-p x
$$

where $p$ is the ray parameter, $x$ is the offset, $t$ is the two-way traveltime, and $\tau$ is the intercept time at $p=0$. Next, the data are summed over the offset axis by

$$
S(p, \tau)=\sum_{x} P(x, \tau+p x)
$$

where, $S(p, r)$ represents a plane wave with ray parameter $p=\sin \theta / v$. By repeating the LMO correction for a range of $p$ values and performing the summation in equation (6-4b), a complete slant-stack gather is constructed. A slant-stack gather, in practice, alternatively is referred to as a $\tau-p$ gather; it consists of all the dip components within the specified range of $p$ values in the original offset data.

The mapping from the $t-x$ domain to the $\tau-p$ domain is reversible (Thorson, 1978). First, apply inverse linear moveout (LMO) correction to the data in the $\tau-p$ domain by

$$
t=\tau+p x
$$

## $P(x, t):$ input data

## $\downarrow$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0940.jpg?height=210&width=408&top_left_y=231&top_left_x=546)

## slant-stack gather

FIG. 6.3-8. Construction of slant-stack gathers.

Then, sum the data in the $\tau-p$ domain over the ray parameter $p$ axis to obtain

$$
P(x, t)=\sum_{\boldsymbol{p}} S(p, t-p x)
$$

To restore amplitudes properly, tho filtering is applied before inverse mapping. This is accomplished by multiplying the amplitude spectrum of each slant-stack trace by the absolute value of the frequency. Rho filtering is equivalent to differentiating the wavefield before the summation that is involved in the integral formulation of migration (Section 4.1).

There is a distinction between slant stack and the exact plane-wave decomposition of a wavefield. Treitel et al. (1982) mathematically analyzed the planewave decomposition process and distinguished between conventional slant stack described here and what may be called the proper slant stack. A conventional slant stack yields an exact plane-wave decomposition when we deal with line sources; a proper slant stack yields an exact plane-wave decomposition when we deal with point sources. A proper slant stack is generated using the same steps that we just described for a conventional slant stack except that a convolution of the LMO-applied wavefield by a filter operator is performed before summation. This operator corrects for 3-D effects by converting a wavefield that was obtained from a point source into a wavefield that was obtained from a line source. As far as kinematics is concerned, the two types of slant stacking are equivalent. They differ only in treatment of amplitudes (Treitel, personal communication).

A schematic description of the plane-wave mapping given by equations ( $6-4 a, b)$ is shown in Figure 6.3-9. We

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0941.jpg?height=307&width=414&top_left_y=127&top_left_x=84)

FIG. 6.3-9. A hyperbola in a CMP gather maps onto an ellipse in the $r-p$ domain.

start by summing amplitudes in the offet domain along the horizontal path $p=0$. This line intersects the reflection hyperbola in the vicinity of apex $A$. Thus, point $A$ maps onto point $A^{\prime}$ on the $\tau-p$ plane, corresponding to the trace with $p=0$. By tilting the line of summation, the hyperbola is intersected at location $B$, which maps onto $B^{\prime}$. Note that a major contribution to summation along the slanted path comes in the area of the tangential point $B$. This zone of tangency is called the Fresnel zone.

The Fresnel zone gets broader for higher velocities and deeper events. In fact, the summation over the offset axis after linear moveout correction can be confined to the Fresnel zone. The steepest necessary path of summation is along $p=1 / v$, which is the asymptote to the hyperbola. This path corresponds to rays that are 90 degrees to the vertical. The energy along the asymptote maps to $C^{\prime}$ on the $p$-axis. By using the mapping described previously - linear moveout correction followed by summation over the offset axis for a range of $p$-values (equations 6-4a,b), the hyperbolic trajectories in the $t-x$ domain are mapped to elliptical trajectories in the $r-p$ domain. In reality, we never record a hyperbola with infinite extent nor a zero-offset trace. Therefore, the elliptical path in the $\tau-p$ domain never is complete from $A^{\prime}$ to $C^{\prime}$.

Figure 6.3-10 illustrates the $\tau-p$ transform of more than one hyperbolic event in the $t-x$ domain. Subcritical reflections $A$ and $D$ (those with an angle of incidence smaller than the critical angle) map into the region of lower $p$-values, while supercritical reflections $C$ (wideangle reflections) map into the region of higher $p$ values. Ideally, a linear event in the offset domain, such as a refraction arrival $B$, maps to a point in the slant-stack domain. Conversely, a linear event in the slant-stack domain maps to a point in the offset domain.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0941.jpg?height=348&width=403&top_left_y=128&top_left_x=547)

FIG. 6.3-10. Various arrivals on a CMP gather mapped onto the corresponding $\tau-p$ gather. Events $A, B, C$ and $D$ map onto $A^{\prime}, B^{\prime}, C^{\prime}$ and $D^{\prime}$.

Figure 6.3-11 shows a shot gather that contains predominantly water-bottom and peg-leg multiples. The horizonted axis in the $\tau-p$ domain, in this example, is horizontal phese velocity $1 / p$. Besides the waterbottom reflection $\boldsymbol{W}$, there are two distinct primaries, $P_{1}$ and $P_{2}$. Multiple reflections map along the elliptical trajectories that converge at $p=(1 / 1500) \mathrm{s} / \mathrm{m}$, the inverse of the water velocity.

A shot gather containing linear events is shown in Figure 6.3-12. Note the strong amplitudes on the $\tau-p$ gather that correspond to the guided waves observed in the offset data. Again, the horizontal axis in the $\tau-p \mathrm{do}-$ main is horizontal phase velocity $1 / p$. In both field data examples shown in Figures 6.3-11 and 6.3-12, the $\tau-p$ gathers were constructed using only positive $p$-values. Thus, the backscattexed energy, for instance in the shot gather shown in Figure 63-12, is not represented in the $\tau-p$ gather.

## Practical Aspects of Slant Stacking

First, we examine the interrelations between various domains used in seismic data processing. Consider a bandlimited dipping event in the $t-x$ domain as shown in Figure 6.3-13. The offset range is from 250 to $5000 \mathrm{~m}$ with a trace spacing of $50 \mathrm{~m}$. This event is mapped along a radial line $A A^{\prime}$ in the $f-k$ domain.

The slope of the radial line, $\omega / k_{x}$ is related to the horizontal phase velocity $v / \sin \theta$ by the relationship

$$
\frac{\omega}{k_{x}}=\frac{v}{\sin \theta}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0942.jpg?height=787&width=215&top_left_y=228&top_left_x=83)

(a)
Phase Veloclty $(\mathrm{km} / \mathrm{s})$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0942.jpg?height=760&width=204&top_left_y=260&top_left_x=295)

(b)

FIG. 6.3-11. (a) A shot gather containing primary and multiple refiections, (b) the corresponding $\tau-p$ gather. The horizontal axis in (b) is horizontal phase velocity $1 / p$. (Data courtesy Shell and Esso.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0942.jpg?height=664&width=426&top_left_y=225&top_left_x=538)

(a) (b)

FIG. 6.3-12. (a) A $\tau-p$ gather and (b) the corresponding shot gather. The horizontal axis in (b) is horizontal phase velocity $1 / p$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0943.jpg?height=770&width=406&top_left_y=276&top_left_x=83)

FIG. 6.3-13. A single dipping event in various domains.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0943.jpg?height=739&width=409&top_left_y=297&top_left_x=544)

FIG. 6.3-14. A spatially aliased single dipping event in various domains.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=298&width=121&top_left_y=137&top_left_x=85)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=312&width=130&top_left_y=130&top_left_x=230)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=309&width=127&top_left_y=126&top_left_x=369)

(c)
FIG. 6.3-15. Slant stacking is invertible: (a) A CMP gather is mapped from $t-z$ domain onto $\tau-p$ domain (b), from which the original gather can be reconstructed (c). The linear streaks labeled as $C T$ in (b) are caused by the finite cable length.

Substitute for $p=\sin \theta / v$ to find the relationship between the variables in the transform domain given by

$$
k_{x}=p \omega .
$$

Figure 6.3-13 also shows the mapping of the dipping event to the $\tau-p$ domain. Note that a linear event in the $t-x$ domain maps onto a point in the $\tau-p$ domain. Converse also is true - a linear event in the $\tau-p$ domain maps onto a point in the $t-x$ domain.

A 1-D Fourier transform of the slant-stack traces in the time direction gives the amplitude spectrum in the $w-p$ domain, which also is shown in Figure 6.313. Actually, the $\psi-p$ plane describes the frequency dependency of horizontal phase velocity and is used in analyzing guided waves (Section F.1). The energy along the radial direction $A A^{\prime}$ in the $\omega-k_{x}$ domain is equivalent to that along the vertical direction $B B^{\prime}$ in the $w-p$ domain.

Figure 6.3-14 shows a spatially aliased dipping event. Again, as in Figure 6.3-13, the offset range is from 250 to $5000 \mathrm{~m}$ with a trace spacing of $50 \mathrm{~m}$. The wraparound observed in the $\omega-k_{x}$ plane results from the inadequate spatial sampling of the event. Note that both the unaliased component, segment 1 , and the aliased component, segment 2 , map onto a single $p$ trace. We expect the spatially aliased part to map onto a number of negative $p$ traces. However, if this wexe the case, then the aliased frequency range (21 to $42 \mathrm{~Hz}$ ) would be absent from the $\omega-p$ plane in which only the positive $p$ values were included.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=319&width=152&top_left_y=117&top_left_x=538)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=180&width=153&top_left_y=446&top_left_x=537)

(p)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=324&width=109&top_left_y=118&top_left_x=706)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=330&width=120&top_left_y=119&top_left_x=821)

(d)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0944.jpg?height=175&width=147&top_left_y=451&top_left_x=814)

(a)

FIG. 6.3-16. Slant stack can be used for trace interpolation: (a) a $t-x$ gather is transformed to a $T-p$ gather (c), and is reconstructed using a finer trace spacing (d). The corresponding $f-k$ spectra show spatial aliasing in the original gather (b), which was eliminated after reconstruction (e).

We now outline the steps involved in slant-stack processing that includes forward and inverse $\tau-p$ transforms.

(a) Start with the offset data, apply linear moveout correction for a specified value of $p$, and sum over offset (equations 6-4a,b). Repeat for a range of $p$ values, the output is the slant-stack gather (Figure $6.3-8)$.

(b) Apply a particular process in the slant-stack domain, such as dip filtering or deconvolution.

(c) Apply tho filterng to the processed slant-stack gather.

(d) Then, apply inverse linear moveout correction for a specified offset value, and sum over the $p$-range (equations 6-5a,b). Repeat for all offsets; the output is the slant-stack processed offset data.

We illustrate the forward and inverse $\tau-p$ transforms using the synthetic CMP gather shown in Figure 6.3-15. This figure also shows the slant-stack and reconstructed CMP gather without any process applied, except the rho filter. The linear streaks labeled as $C T$
on the slant-stack gather in Figure 6.3-15 are caused by the finite cable length. To minimize the streaks, for each trace in the $t-x$ domain, Kelamis and Mitchell (1989) limit the mapping from the $t-x$ domain to the $\tau-p$ domain to a time-variant zone in the $\tau-p$ domain. Specifically, only one trace at a time from the $t-x$ domain is mapped onto all $p$ traces. The resulting $\tau-p$ gather is muted on both the low and high end of the $p$ axis in a time-varying manner. The mute functions are based on a representative primary velocity function.

During reconstruction of the $t-x$ gather, we do not have to use the same trace spacing that was used for the original $t-x$ gather. Consider the synthetic CMP gather in Figure 6.3-16a. The 2-D amplitude spectrum shows that frequencies above $48 \mathrm{~Hz}$ are spatially aliased (Figure 6.3-16b). This gather can be mapped to the slant-stack domain (Figure 6.3-16c) and reconstructed using a finer trace spacing (Figure 6.3-16d). The original trace spacing is $25 \mathrm{~m}$; the reconstructed gather has a trace spacing of $12.5 \mathrm{~m}$. The $2-\mathrm{D}$ amplitude spectrum of the trace-interpolated gather shows that no frequencies are spatially aliased (Figure 6.3-16e). Nevertheless, note the missing high-frequency energy beyond $60 \mathrm{~Hz}$. This energy mainly is along the steep direct arrival path in the input gather (Figure 6.3-16a) and is absent in the output gather (Figure 6.3-16d). We see that reconstruction can be successful even for spatially aliased data, provided dips do not have a wide range of variation.

## Slant-Stack Parameters

A single dipping event in the $t-x$ domain ideally maps onto a single trace in the $\tau-p$ domain that represents the dip of that event (Figure 6.3-13). However, because of the discrete sampling along the $p$-axis and because only a finite number of $p$ traces are spanned from a finite number of offset traces, an imperfect mapping results. When plotted with a higher gain, the slant-stack gather in Figure 6.3-13 seems surprisingly different (Figure 6.3-17b). The linear streaks are contributions from end points $E$ and $F$ of the dipping event in the $t-x$ domain. More specifically, point $E$ maps onto $A$ and $B$ when $p$ is set to its rninimum and maximum values, respectively. For any intermediate value of $p$, point $E$ maps along $A B$. Similarly, the other end point $F$ maps along $C D$.

Linear streaks that result from end effects associated with cable truncation are only one type of artifact encountered when constructing slant stacks. Another type of artifact is the high-frequency wavetrain that is especially apparent on traces with large $p$ values as in

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=284&width=425&top_left_y=117&top_left_x=539)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=284&width=87&top_left_y=400&top_left_x=549)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=306&width=50&top_left_y=696&top_left_x=557)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=280&width=91&top_left_y=405&top_left_x=686)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=306&width=88&top_left_y=696&top_left_x=686)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=274&width=88&top_left_y=409&top_left_x=833)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0945.jpg?height=305&width=87&top_left_y=698&top_left_x=835)

FIG. 6.3-17. Panels (a), (d), and (g) are the input CMP gathers, which contain a single dipping event $E F$. Panels (b), (e), and (h) are the corresponding slant-stack gathers. Panels (c), (f), and (i) are the reconstructed offet gathers. The slant-stack and reconstructed gathers are displayed at a higher gain than the input gathers.

Figure $6.3-17 \mathrm{a}$. It occurs because the dipping event is sampled along steep slanted paths.

Several practical ronsiderations affect the artifact level in slant stacks. A short cable length in the $t-x$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0946.jpg?height=598&width=829&top_left_y=128&top_left_x=104)

FIG. 6.3-18. (a) Input gather, (b) slant-stack gather, (c) reconstructed offset gather, (d) $f-k$ spectrum of panel (a), (e) $f-k$ spectrum of panel (c). Panels (f), (h), and (j) are the slant-stack gathers derived from the input gather (a) using different numbers of $p$-values and ranges, while panels (g), (i), and (k) are rœconstructions from them. Input (a) is the same for all cases. See text for details.

domain enhances the end effects and, thus causing poor reconstruction as demonstrated in Figure 6.3-17. Start with an offset gather that contains a single dipping event $E F$ in panel (a). Panel (b) is the $\tau-p$ gather and panel (c) is the reconstructed $t-x$ gather from it. To emphasize the artifacts, the last two panels of the sets of three are displayed at a higher gain compared to the original. Using two-thirds of the offet gather, panel (d), the $\tau-p$ gather and the reconstruction from it were obtained as shown in panels (e) and (f). Finally, using only one-third of the original gather, panel (g), panels (h) and (i) are obtained. Note that short cables produce artifacts $G$ and $H$ on the slant-stack and reconstructed gathers. Accurate construction of slant-stack gathers usually requires sufficiently long cable length and adequately small offset interval,

To study the sampling along the p-axis and the range of $p$ values used in constructing a slant-stack gather, consider the synthetic gather shown in Figure 6.3-18a, which consists of hyperbolic events. These events are mapped along the ellipses in the slant-stack gather (Figure 6.3-18b). The following values were chosen: the number of $p$ traces $n_{p}$ equal to the number of $x$ traces $n_{x}$; the minimum $p$ value, $p_{m 1 n}=0$; and the maximum $p$ value, $p_{\max }$ set to the largest dip present in the data. Reconstruction using these parameters produced an accurate result (Figure 6.3-18c). There is some difference in the 2-D amplitude spectra of the original, panel (d), and the reconstructed gathers panel (e), because $p_{m i n}$ was set to zero.

What happens when the p-axis is undersampled? Figure 6.3-18f shows the slant-stack gather and Figure 6.3-18g shows the reconstructed gather that is obtained by setting $n_{p}=n_{x} / 2$ and keeping ( $p_{m m}, p_{n a x}$ ) the same as in panel (b); thus, the $p$-increment is twice as large as in panel (b). The input gather is the same as it was
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0947.jpg?height=594&width=826&top_left_y=129&top_left_x=103)

FIG. 6.3-19. The same sequence of panels as in Figure 6.3-18, except that the input gather contains spatially aliased frequency components. Note wraparound in the $f-k$ spectrum (d).

in panel (a). Note that undersampling along the $p$-axis introduces some noise, labeled as $A$ in Figure $6.3-18 \mathrm{~g}$, into the reconstructed gather.

Consider the opposite situation of oversampling along the $p$-axis as in Figure 6.3-18h. Here, $n_{p}=2 n_{x}$ and the $\left(p_{m n}, p_{m a x}\right)$ range is the same as in Figure 6.3 18b. Note that oversampling in the $p$-axis does no harm, but gains nothing either (Figure 6.3-18i). Although not shown here, further experiments show that regardless of spread length, oversampling in the $p$-domain does not improve the quality of the reconstructed gather.

In practice, we may encounter an inappropriate choice of the $\left(p_{m i n}, p_{m a x}\right)$ range, meaning that $p_{m a x}$ corresponds to a larger dip than is present in the input gather (Figure 6.3-18j). Here, $n_{p}=n_{x,}, p_{\text {man }}=0$, $p_{\text {max }}$ is twice as large as the value chosen in Figure 6.3-18b, and the $p$-increment is the same as in Figure 6.3-18f. Thus, the right half of the $p$-gather (Figure $6.3-18 \mathrm{j}$ ) does not contain dip components that are present in the input data (Figure 6.3-18a). Instead, the right half contains noise resulting from cable truncation and sampling along steep slanted paths with $p$-values associated with dips not contained in the offset data. This results in some noise in the reconstructed gather, labeled as $B$ in Figure 6.3-18k. In practice, suitable muting in the $p$ domain can eliminate the artifacts caused by spurious $p$ traces as in the right half of Figure 6.3-18j.

Now consider a synthetic gather that contains spatially aliased events. Figure 6.3-19 shows panels that are equivalent to those in Figure 6.3-18, except that the input gather (Figure 6.3-19a) has spatially aliased frequency components. It is clear that the artifacts observed in Figure 6.3-19 are more pronounced. However, note that if the ( $\left.p_{m n n}, p_{m a x}\right)$ range, $n_{p}$ and the $p$-increment are chosen properly (Figure 6.3-19b), then reconstruction is quite accurate, even with spatially aliased data. The amplitude spectrum of the original gather (Figure 6.3-19d) and that of the reconstructed gather (Figure 6.3-19e) are almost identical, except that the latter does not contain unaliased energy for $p<0$, which was not included in constructing Figure 6.3-19b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0948.jpg?height=379&width=351&top_left_y=128&top_left_x=105)

(a)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0948.jpg?height=377&width=164&top_left_y=129&top_left_x=460)

(c)
Offset $(m)$

Offset $(\mathrm{m})$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0948.jpg?height=351&width=316&top_left_y=158&top_left_x=617)

(e)

FIG. 6.3-20. (a) A field data set with strong ground-roll energy $A$, its backscattered component $B$, guided waves $C_{1}$ and a strong reflection $D_{7}$ (b) $\tau-p$ gather obtained from this field data set; (c) reconstruction of the field record using the portion to the left of the solid vertical line in (b) (zone E); (d) dip-filtered data obtained by subtracting the gather in (c) from the original data in (a); (e) the original data set (a) after $f-k$ dip filtering. (Data courtesy Turkish Petroleum Corporation.)

Again, we see the case of an undersampled $p$-axis causing some noise in the reconstructed gather, the case of oversampled $p$-axis causing no harm, and finally, inappropriate inclusion of the $p$-values corresponding to dips absent from the input gather causing noise in the reconstructed gather.

This experimentad study and other similar studies of the parameters involved in slant-stack processing lead to the following empirical statements:

(a) $n_{p}=n_{x}$ is a good, general rule.

(b) The ( $p_{m i n}, p_{\max }$ ) range should only span the dip components of interest in the data. For example, for marine CMP data, $p_{m x n}=0, p_{m a x}=(1 / 1500)$ $\mathrm{s} / \mathrm{m}$

(c) The $p$-increment then is $\left(p_{\max }-p_{m a n}\right) / n_{x}$. Sampling along the $p$-axis also can be done with equal increment in horizontal phase velocity $1 / p$.

## Time-Variant Dip Filtering

The slant-stack domain is convenient for implementing dip filtering. To illustrate this, consider the problem of attenuating the strong ground roll in the field record in Figure 6.3-20a, which was obtained from a walkaway noise test. For simplicity, ignore the backscattered
Rayleigh waves, since removing them would mean computing negative $p$ traces. Figure $6.3-20 \mathrm{~b}$ shows the $\tau-p$ gather obtained from this field data set. Phase velocity is varied from $500 \mathrm{~m} / \mathrm{s}$ to over $10000 \mathrm{~m} / \mathrm{s}$. The ground roll generally has very low phase velocity and is mapped to the left of the solid line at $2500 \mathrm{~m} / \mathrm{s}$, labeled as $E$ in Figure 6.3-20b.

Suppose that the $\tau-p$ gather traces that contain the ground roll are used to reconstruct the $t$ $x$ gather with the original offsets. The reconstructed gather shown in Figure 6.3-20c contains only the dips that we want to remove from the original wavefield. If this reconstructed gather is subtracted from the original gather (Figure 6.3-20a), the result is the dip-filtered shot record shown in Figure 6.3-20d. An alternate way to compute the dip-filtered shot record is to use, for reconstruction, the slant-stack traces that are only within zone $F$ to the right of the solid line in Figure 6.3-20b. With either approach, the amplitudes at the boundary between the pass and reject zones, the solid line at 2500 $\mathrm{m} / \mathrm{s}$ in Figure $6.3-20 \mathrm{~b}$, must be tapered to reduce artifacts in the reconstructed $t-x$ gather.

Dip filtering in the slant-stack domain should be nearly equivalent to the $f-k$ dip filtering process described in Section 6.2. Figure 6.2-1b shows the 2-D amplitude spectrum of the original field record of Figure 6.2-1a, which is the same data set as in Figure 6.3-20a.

The reject zone is defined by the fan in Figure 6.2-1c, which is equivalent to zone $E$ to the left of the vertical line in Figure 6.3-20b.

When compared with the slant-stack output (Figure 6.3-20d), the result of $f-k$ dip filtering of the field data set in Figure 6.3-20e suggests basically no difference in performance. However, with the slant-stack approach, dip filtering can be applied in a time-variant manner. This means that the boundary between the pass and reject zones need not be vertical as in Figure 6.3-20b. Also, with the slant-stack technique, we can work with data that are irregularly spaced along the offset axis. This is not the case for the $f-k$ method of dip filtering, since the fast Fourier transform requires data with equal trace spacing. On occasion, dip filtering elso is incorporated into multiple attenuation in the slart-stack domain to further eliminate multiples.

An application of time-variant dip filtering to reduce the cable truncation effects on slant-stack gathers (Figure 6.3-17) is provided by Kelamis and Mitchell (1989). Their procedure is outlined below:

(a) Map a single trace in the offset domain to the slantstack domain over a specified range of p-values (equations 6-4a,b).

(b) Apply a time-varying filter by muting inner and outer portions of the slant-stack gather. The mute functions are prescribed using a velocity filter that depends on time and offset.

(c) Repeat steps (a) and (b) for all offset traces in the input gather and sum the resulting slant-stack gathers.

(d) Apply tho filtering to the summed slant-stack gather

(d) Following a specific process in the slant-stack do main, such as deconvolution, apply inverse linear moveout correction for a specified offset value, and sum over the $p$-range (equations 6-5a,b). Repeat for all ofsets; the output is the slant-stack processed offset data.

## Slant-Stack Multiple Attenuation

The slant-stack multiple attenuation technique is based on prediction of multiples. Alam and Austin (1981) and Treitel et al. (1982) investigated the application of predictive deconvolution in the slant-stack domain for multipie attentration. The application of predictive deconvolution to multiple attenuation is valid strictly for vertical incidence and the zero-offset case. Multiples are not periodic at nonzero offsets. Figure 6.3-21 shows a sketch of a shot gather with primary $P$ (waterbottom reflection) and its multiples $M_{1}, M_{2}$ with the corresponding slant-stack gather. The time separations
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0949.jpg?height=344&width=426&top_left_y=128&top_left_x=538)

FIG, 6.3-21. The periodicity of multiples along radial trace $O R$ and down the $p$ traces.

between the multiple arrivals at a particular offset $x_{0}$ are equal only if $x=0$.

Taner (1980) first recognized that the time separations between the arrivals are equal along a radial direction $O R$. A trace can be constructed by extracting the samples along one of these radial directions. The angle of propagation is constant along this radial trace (Ottolini, 1982). A radial trace in a layered medium is called a Snell trace (Claerbout, 1985). In a layered medium, the Snell trace would not follow a straight path as in Figure 6.3-21, since its angle of propagation changes at layer boundaries according to Snell's law (Figure 6.3-6).

Taner (1980) applied predictive deconvolution along radial traces to successfully eliminate long-period multiples. Note that the magnitude of the time separations between multiples is different from one radial trace to another (Figure 6.3-21). However, the time separations are equal along each of the slanted paths of summation. Therefore, a predictive deconvolution operator can be designed from the autocorrelogram of each $p$ trace (such as that denoted by $p_{0}$ in Figure 6.3-21) and applied to suppress multiples. This is demonstrated in Figure 6.3-22. The synthetic shot gather contains a water-bottom reflection and its multiples (Figure 6.322a). Note that the periodic nature of the multiples is not apparent on the autocor relogram. Therefore, predictive deconvolution should not be expected to do well in attenuating these multiples when applied to the shot gather.

The shot gather in Figure 6.3-22a now is transformed to the slant-stack domain. Figures $6.3-22_{\mathrm{C}}$ and 6.3-22e show the slant-stack gather before and after predictive deconvolution was applied. Figure $6.3-22 \mathrm{~g}$ shows
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0950.jpg?height=780&width=838&top_left_y=132&top_left_x=102)

FIG. 6.3-22. Multiple attenuation in the slant-stack domain. (a) A shot gather; (b) its autocorrelogram; (c) the slant-stack gather; (d) the autocorrelogram of (c); (e) the slant-stack gather after predictive deconvolution, where operator length $=240$ ms and prediction lag at $p=120 \mathrm{~ms}$; (f) the autocorrelogram of (e); (g) reconstruction of the shot gather from (e).

reconstruction of the shot gather from the slant-stack gather in Figure 6.3-22e. Autocorrelograms before and after deconvolution in the slant-stack domain are shown beneath the respective panels. Unlike in the autocorrelogram of the shot gather in Figure 6.3-22b, the periodic nature of the multiples in the data is pronounced in the autocorrelogram of the slant-stack gather (Figure 6.3-22d). Note that the periodicity of multiples changes from one $p$ trace to the next. The largest period occurs along the trace that corresponds to the minimum $p$ value. The autocorrelogram after predictive deconvolution shows that the energy in the lags less than the specified prediction lag is retained, while the multiple energy is attenuated (Figure 6.3-22f).

Prediction lag $\alpha$ and operator length $n$ must be specified by examining the autocorrelogram of the slantstack gather (Figure 6.3-22d). These two parameters are specified for the trace corresponding to the lowest $p$ value, as indicated in Figure 6.3-22d. Operator length is kept constant, while prediction lag is adjusted based

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0951.jpg?height=958&width=849&top_left_y=136&top_left_x=102)

FIG. 6.3-23. (a) Simulation of the shot gather shown in Figure F-1a by normal-mode modeling; (b) autocorrelogram of this synthetic gather; (c) slant stack of the synthetic gather, (d) autocorrelogram of the slant-stack gather; (e) the slant-stack gather in (c) after predictive deconvolution; (f) the autocorrelogram of (e); (g) reconstruction of the synthetic gather from the slant-stack gather in (e). (Refer to the text for a description of the labeled events.
on the $p$ value across the gather (Alam and Austin, 1981):

$$
\alpha(p)=\alpha(0) \sqrt{1-p^{2} v_{w}^{2}}, \quad(6-8)
$$

where $\alpha(0)=$ prediction lag at $p=0$ and $v_{w}$ is the velocity of the primaty reflection, the multiples of which are targeted for attenuation. At higher $p$ values, the prediction lag decreases. Compare the reconstructed offset gather (Figure 6.3-22g) with the input gather (Figure $6.3-22 \mathrm{a}$ ), and note that the output contains the waterbottom primary (the only one present in the input data) and a residual of the first multiple.

Multiple attenuation in the slant-stack domain is demonstrated further by the synthetic data in Figure 6.3-23a. The synthetic shot record in Figure 6.3-23a is a simulation of the shot gather in Figure F-la using normal-mode modeling (Section F.1). Several arrivals are identified: $C$ is the direct arrival; $A$ is the refracted arrival associated with the hard water bottom; $B$ is the water-bottom reflection; $M 1, M 2$, and $M 3$ are the refracted multiples; and $m 1, m 2$ and $m 3$ are the reflected multiples. $D$ is an artifact of the normal-mode modeling technique (Section F.1).

Figure $6.3-23 \mathrm{c}$ is the slant-stack gather of the synthetic shot record in Figure 6.3-23a. This gather should be compared with the slant-stack gather of the field data in Figure F-1b. Refraction $A$ and its multiples $M 1, M 2$, and $M 3$ map onto points in the slant-stack domain. Figure 6.3-23d is the autocorrelogram of the $\tau-p$ gather. Unlike the autocorrelogram of the offset data (Figure 6.3-23b), note that it exhibits the periodic nature of the multiples in the data. After applying predictive deconvolution, the slant-stack gather in Figure 6.3-23e results. Only the refracted arrival $A$ and the water-bottom reflection $B$ remain. The nearly linear streaks, which also are present in the unprocessed slant-stack gather (Figure 6.3-23c), are artifacts caused by the finite cable length. The autocorrelogram after deconvolution is free from the multiple energy (Figure 6.3-23f). The prediction lag and operator length for the minimum $p$-value are as labeled in Figure 6.3-23d. Adjustment for the prediction lag was made across the gather using equation (6-8). Finally, reconstruction of the shot gather is shown in Figure 6.3-23g. When compared with Figure 6.3-23a, note that both the refracted and reflected primaries are retained, while their associated multiples are largely attenuated.

The performance of slant-stack multiple attenuation on field data now is examined. Figure 6.3-24a shows a shot gather that contains a strong water-bottom reflection $A$, two distinct primaries $B$ and $C$, the waterbottom multiples $D$ and $E$, and the peg-leg $F$, which is associated with the primary event $B$. The slant-stack gathers before and after predictive deconvolution are shown in Figures 6.3-24b and 6.3-24d with their respective autocorrelograms (Figures 6.3-24c and 6.3-24e). Note that multiples are significantly attenuated in the reconstructed gather (Figure 6.3-24f).

Choice of the prediction lag and operator length is tricky for this particular data set. From the autocorrelogram in Figure 6.3-24c, note the energy $G$, which is caused by the correlation of two primaries $A$ and $B$ in Figure 6.3-24a. Energy $H$ is caused by the correlation of the water-bottom multiples. Prediction lag is chosen to retain primary energy $G$, and the operator length is chosen to include the multiple energy $H$. Note that in Figure 6.3-24e multiple energy $H$ is significantly attenuated and primary energy $G$ is preserved.

Since slant stacking is a plane-wave decomposition, and since plane waves do not have spherical divergence, input to slant stacking must not be compensated for by geometric spreading. Preserving correct amplitude relationships is essential for the effectiveness of slant-stack multiple attenuation. The geometric spreading correction is applied to offset data by using a primary velocity function. This enhasces the multiples in the data and destroys the amplitude relationship between them. Predictive deconvolution in the offet domain then may not suppress these multiples effectively.

After multiple attenuation in the slant-stack domain, reconstruction of the offset data is performed, the geometric spreading correction is applied, and processing is continued. Figures $6.3-25 \mathrm{a}$ and $6.3-25 \mathrm{~b}$ show the shot gathers in Figures 6.3-24f and 6.3-24a after the geometric spreading correction. Note that strong multiples are attenuated significantly after deconvolution in the slant-stack domain. While the autocorrelogram of the shot gather with slant-stack processing (Figure $6.3-24$ c) exhibits the presence of strong multiples, the autocorrelogram of the shot gather without slant-stack processing does not exhibit the periodicity of multiples (Figure 6.3-25c).

Figures 6.1-2, 6.1-3, and $6.1-5$ show that when multiples are in the form of short-period reverberations, the autocorrelogram of the offset data seems to adequately represent the periodic nature of multiples. Hence, predictive deconvolution of the offset data often can remove reverberations. On the other hand, long-period multiples are poorly represented by the autocorrelogram of the offset data (Figure 6.3-25c) and are better defined in the slant-stack domain (Figure 6.3-24c).

Figure 6.3-26 shows the stacked section that corresponds to the field data in Figure 6.3-25b. The slantstack processed section, which corresponds to the data in Figure 6.3-25a, is shown in Figure 6.3-27. Major primary reflections stand out more distinctively in the slant-stack processed section.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0953.jpg?height=653&width=170&top_left_y=130&top_left_x=169)

(a)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0953.jpg?height=982&width=184&top_left_y=129&top_left_x=324)

(c)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0953.jpg?height=658&width=346&top_left_y=134&top_left_x=522)

(f)

FIG. 6.3-24. Multiple attenuation in the slant-stack domain. (a) A field record without geometric spreading correction; (b) the slant-stack gather obtained from it; (c) the autocorrelogram of (b); (d) the slant-stack gather after predictive deconvolution, where operator length $=400 \mathrm{~ms}$ and prediction lag (at $p=0$ ) $=700 \mathrm{~ms}$; (e) the autocorrelogram of (d); (f) reconstruction of the shot gather from (d).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0954.jpg?height=651&width=174&top_left_y=128&top_left_x=102)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0954.jpg?height=649&width=215&top_left_y=133&top_left_x=263)

$\mathbf{s}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0954.jpg?height=321&width=185&top_left_y=776&top_left_x=292)

(c)

FIG. 6.3-25. (a) Shot gather in Figure 6.3-24f after geometric spreading correction; (b) shot gather in Figure 6.3-24a after geometric spreading correction; (c) autocorrelogram of (b). Events A, B and C are the primaries labeled as in Figure $6.3-24 \mathrm{a}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0954.jpg?height=412&width=446&top_left_y=130&top_left_x=526)

FIG. 6,3-26. A CMP stack associated with the gather shown in Figure 6.3-25b.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0954.jpg?height=432&width=458&top_left_y=731&top_left_x=517)

FIG. 6.3-27. A CMP stack associated with the gather shown in Figure $63-25$ a after slant-stack multiple attenuation. Compare with Figure 6 3-26.
ray parameter (half) offset velocity

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0955.jpg?height=369&width=663&top_left_y=167&top_left_x=187)

FIG. 6.4-1. Slant-stack (left) and velocity-stack (right) mapping of a CMP gather (center). (See text for details.)

### 6.4 THE RADON TRANSFORM

In the previous section, we discussed slant-stack transformation and its application to multiple attenuation. Slant-stack transformation involves the application of linear moveout correction and summation over the offset axis. As a result of this mapping, the offset axis is replaced with the ray-parameter axis. The relationhsip between the input coordinates $(h, t)$ and the transform coordinates $(p, \tau)$ is given by the linear moveout equation

$$
t=\tau+2 p h
$$

where $p$ is the ray parameter (Section 6.3), $t$ is the twoway traveltime, $\tau$ is the two-way intercept time at $p=0$, and $h$ is the half-offset.

A companion mapping is called velocity-stack transformation which involves application of hyperbolic moveout correction and summation over the offset axis. As a result of this mapping, the offset axis is replaced with the velocity axis. The relationship between the input coordinates $(h, t)$ and the transform coordinates $(v, \tau)$ is given by the hyperbolic moveout equation

$$
t^{2}=\tau^{2}+\frac{4 h^{2}}{\vartheta^{2}}
$$

where $t$ is the two-way traveltime, $\tau$ is the two-way zerooffset time, $h$ is the half-offset and $v$ is the stacking velocity.

Refer to Figure 6.41 to review the nature of these two transformations. A linear event in the offset do- main, such as a refracted arrival $R$ or linear noise $G$, adeally maps onto a point in the ray-parameter domain. A hyperbolic event such as a primary $\left(P_{1}, P_{2}\right)$ or a multiple $\left(M_{1}, M_{2}, M_{3}\right.$ ) is mapped onto an ellipse in the ray-parameter domain. Since we always have a truncated hyperbola, we inevitably would have a truncated ellipse. A fast-velocity hyperbola maps onto a tighter ellipse than a slow-velocity hyperbola.

Multiples are not periodic in the offset domain, even for a horizontally layered earth model; but they are periodic in the ray-parameter domain. Thus we can use the periodicity for predicting and attenuating multiples in the slant-stack domain as was demonstrated in Section 6.3

Again, we refer to Figure 6.4-1 and now turn our attention to velocity-stack transformation. Since the mapping function is hyperbolic, in this case, a hyperbola in the ofset domain, such as a primary or a multiple, ideally maps onto a point in the velocity domain. Hence, we are able to distinguish between multiples and primaries in the velocity domain based on velocity discrimination and use this criterion to attenuate multiples.

The ideal circumstances described by Figure 6.41 that a linear event in the ofset domain maps onto a point in the ray-parameter domain using equation (6-9a), and a hyperbolic event in the offset domain maps onto a point in the velocity domain using equation (6-9b) do not hold in reality. Specifically, a conventhonal velocity-stack gather consists of constant-velocity

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0956.jpg?height=440&width=184&top_left_y=129&top_left_x=199)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0956.jpg?height=410&width=164&top_left_y=157&top_left_x=366)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0956.jpg?height=434&width=160&top_left_y=135&top_left_x=528)

(c) velocity( $\mathrm{km} / \mathrm{s})$

$2 \quad 3$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0956.jpg?height=394&width=160&top_left_y=172&top_left_x=675)

(d)

FIG. 6.4-2. (a) A synthetic CMP gather with three primary reflections; (b) a synthetic CMP gather with one primary reflection (arrival time at $0.2 \mathrm{~s}$ at zero-offset time) and its multiples; (c) composite CMP gather containing the primaries and multiples in (a) and (b); (d) the conventional velocity-stack gather derived from the composste CMP gather using equation (6-10a). Note the amplitude smearing along the velocity axis.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0956.jpg?height=440&width=643&top_left_y=694&top_left_x=197)

FIG. 6.4-3. (a) The same velocity-stack gather as in Figure 6.4-2d; (b) the CMP gather reconstructed from the velocitystack gather in (a) using equation (6-10b); (c) velocity-stack gather derived from (b) using equation (6-10a); (d) CMP gather reconstructed from (c) using equation (6-10b). Note the degrudation of velocity resolution on the velocity-stack gather (c) due to reduction of far-offset amplitudes (b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0957.jpg?height=465&width=701&top_left_y=130&top_left_x=168)

FIG. 6.4-4. (a) The CMP gather of Figure 6.42c before, and (b) after $t^{2}$-stretching note the vertical axis is in unts of $t^{2}$; (c) the velocity-stack gather that represents the Radon transform of (b) using the singular-value decomposition procedure described in Section F.3; (d) the same velocity-stack gather as in (c) after undoing the $t^{2}$-stretching.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0957.jpg?height=437&width=629&top_left_y=673&top_left_x=200)

FIG. 6.4-5. (a) The same velocity-stack gather as in Figure 6 4-4d; (b) the CMP gather reconstructed from the velocity-stack gather in (a) using equation (a-10b); (c) velocity-stack gather that represents the Radon transform of (b) using the singularvalue decomposition procedure described in Section F.3; (d) CMP gather reconstructed from (c) using equation (6-10b). Note the accurate reconstruction of the CMP gather (b) from the proper velocity-stack gather (a) compared to the reduction of far-offset amplitudes on the CMP gather in Figure 6.4-3b reconstructed from the conventional velocity-stack gather in Figure $6.4-3 \mathrm{a}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0958.jpg?height=472&width=565&top_left_y=132&top_left_x=231)

(a)

(b)

(c)

FIG. 6.4-6. (a) Synthetic CMP gather; (b) conventional velocty-stack gather; (c) reconstructed CMP gather

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0958.jpg?height=468&width=393&top_left_y=685&top_left_x=232)

(a)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0958.jpg?height=466&width=174&top_left_y=686&top_left_x=622)

(c)

FIG. 6.4-7. (a) Synthetic CMP gather; (b) velocity-stack gather based on the discrete Radon transform; (c) reconstructed CMP gather.

CMP-stacked traces. It emphasizes the energy associated with the events that follow hyperbolic traveltime trajectories in the CMP gather. A fundamental problem with velocity-stack transformation is that a CMP gather only includes a cable-length portion of a hyperbolic traveltime trajectory. The finite cable length, discrete sampling along the offset axis and the closeness of hyperbolic summation paths at near offsets cause smearing of the stacked amplitudes along the velocity axis. Unless this smearing is removed, inverse mapping from the velocity domain back to the offset domain does not reproduce the amplitudes in the original CMP gather.

The gather resulting from the inverse mapping can be considered as the modeled CMP gather that contains only the hyperbolic events present in the actual CMP gather. A least-squares minimization of the energy contained in the difference between the actual CMP gather and the modeled CMP gather removes smearing of amplitudes on the velocity-stack gather and increases velocity resolution. A practical application of this procedure is in the separation of multiples from primaries.

## Velocity-Stack Transformation

Consider the synthetic CMP gather in Figure 6.4-2c. This gather is a composite of the CMP gather with three primary reflections shown in Figure 6.4-2a and the CMP gather with one primary and its multiples shown in Figure 6.4-2b. Note that the three primaries of the CMP gather in Figure 6.4-2a arrive at the same zerooffset times as the multiples, and the moveout between the primaries and multiples is less than $100 \mathrm{~ms}$ at the far offset ( $2350 \mathrm{~m}$ ).

Traces in the composite CMP gather (Figure 6.42c) are stacked with a range of constant velocities, and the resulting stacked traces are displayed side by side, forming the conventional velocity-stack gather shown in Figure 6.4-2d. Note that the maximum stacked amplitudes correspond to the primary and multiple velocities. The lower-amplitude horizontal streaks in the velocitystack gather (Figure 6.4-2d) are a result of the contribution of small offsets, while the large-amplitude regions are a result of the contribution of the full range of offsets (Sherwood and Poe, 1972).

The mapping from the offset domain to the velocity domain is achieved by applying hyperbolic moveout correction and summing over offset given by

$$
u(v, \tau)=\sum_{h} d\left(h . t=\sqrt{\tau^{2}+4 h^{2} / v^{2}}\right), \quad(6-10 a)
$$

where $t$ is the two-way traveltime, $\tau$ is the two-way zerooffset time, $h$ is the half-offset, and $v$ is the stacking velocity. The input $d(h, t)$ represents the CMP gather, and the ouptput $u(v, \tau)$ represents the velocity-stack gather. The inverse mapping from the velocity space back to the offset space is achieved by applying inverse hyperbolic moveout correction and summing over velocity given by

$$
d^{\prime}(h, t)=\sum_{v} u\left(v, \tau=\sqrt{t^{2}-4 h^{2} / v^{2}}\right)
$$

where $d^{\prime}(h, t)$ represents the modeled CMP gather.

Figure 6.4-2d was obtained by using equation (610a) in which the summation is performed over a finite range of offsets. At first, it appears that by using equation (6-10b), in which the summation is performed over a range of velocities, the original data $d(h, t)$ in Figure $6.4-2 c$ can be reconstructed from the data in Figure 6.4-2d. The modeled CMP gather $d^{\prime}(h, t)$ using equation (6-10b) is shown in Figure 6.4-3b. Observe the relative weakening of anplitudes at far offsets, especially along events with large moveout. Repeated transformations using equations ( $6-10 \mathrm{a})$ and (6-10b) from the velocity domain to the offset domain (Figure 6.4-3) further reduce the amplitudes at far offsets.

Results shown in Figure 6.4-3 demonstrate clearly that the discrete transforms given by equations (6-10a) and (6-10b) are not exact inverses of each other. The discrete summation in equation (6-10a) over a finte range of offets causes mapping of amplitudes along a hyperbolic event in the offset domain (Figure 6.4-2c) to depart from the ideal point in the velocity domain and results in the smearing of amplitudes along the velocity axis (Figure 6.4-2d). Amplitude smearing means the loss of velocity resolution between two events with little moveout difference.

To understand the inverse problem of restoring the data in the offset domain from the data in the velocity domain, consider the integral forms of equations (610a) and (6-10b). Reflection times on a CMP gather associated with a horizontally layered earth model can be represented by a Taylor series of the form $t=$ $\tau+c_{1} h^{2}+c_{2} h^{4}+\ldots$, where $c_{1}, c_{2}, \ldots$ are scalar coefficients (Hubral and Krey, 1980). By including as many terms as desired in the Taylor expansion, the traveltime curve can be expressed by $t=\tau+\phi(v, h)$. This makes the integral form of equation (6-10a) a special form of the generalized Radon transform (Beylkin, 1987) given by

$$
\psi(v, \tau)=\int_{-\infty}^{\infty} d[h, t=\tau+\phi(v, h)] d h . \quad(6-11 a)
$$

Here, the integration is along curves expressed as linear functions of traveltimes, $t$ and $\tau$. Accordingly, $d(h, t)$ and its Radon transform $u(v, r)$ are defined as continvous functions in the offset and velocity domains, respectively.

The integral form of equation (6-10b), however, is not the exact inverse of equation (6-11a). Instead, Radon's inversion formula given by (Beylkin, 1987)

$$
d(h, t)=\int_{-\infty}^{\infty} \rho(\tau) * u[v, \tau=t-\phi(v, h)] d v(6-11 b)
$$

incorporates convolution of $u(v, \tau)$ with the rho filter $\rho(\tau)$ prior to integration over velocity. In equation (611b), the asterisk denotes convolution. For 2-D data, as for any process that involves summation over a finite spatial aperture (Section 4.1), the rho filter $\rho(\tau)$ has a Fourier transform of the form $\sqrt{\omega} \exp (i \pi / 4)$, where $\omega$ is the temporal frequency.

## The Discrete Radon Transform

In practice, a discrete form of the rho filter $\rho(\tau)$ can be convolved with the discrete form of $u(v, \tau)$ prior to summing over a finite range of velocities to reconstruct the original data $d(h, t)$. Note that the rho filter is a 1-D filter that operates on each trace of $u(v, \tau)$, individually. It cam account for the suppression of high frequencies during summation along discretely sampled traveltime curves, $t=\tau+\phi(v, h)$. However, one can intuitively contend that the rho filtering alone cannot remove the annplitude smearing along the velocity axis in Figure 6.4$2 \mathrm{~d}$. Based on a rigorous mathematical analysis, Beylkin (1987) showed that a discrete form of Radon's inversion formula (equation 6-11b) can be expressed as a leastsquares solution to a set of linear system of equations. We shall review the discrete Radon transform for the special case of velocity-stack transformation.

To reduce the amplitude smearing on conventional velocity-stack gathers Thorson and Claerbout (1985) proposed a least-squares formulation. There is one issue, however, we must take into consideration before we seek a practical scheme to compute the inverse Radon transform defined by equation (6-11b). To comply with the linear form the Radon transform defined by equation (6-11a), apply stretching in the time direction by setting $t^{\prime}=t^{2}$ and $\tau^{\prime}=\tau^{2}$ (Yilmaz, 1989). Equation (6-9b) then takes the form

$$
t^{\prime}=\tau^{\prime}+\frac{4 h^{2}}{v^{2}}
$$

In the stretched coordinates, equations ( $6-10 \mathrm{a}, \mathrm{b})$ become:

$$
u\left(v, \tau^{\prime}\right)=\sum_{h} d\left(h, t^{\prime}=\tau^{\prime}+4 h^{2} / v^{2}\right)
$$

and

$$
d^{\prime}\left(h, t^{\prime}\right)=\sum_{v} u\left(v, \tau^{\prime}=t^{\prime}-4 h^{2} / v^{2}\right)
$$

As a result of the $t^{2}$-stretching, hyperbolic events in the offset domain are transformed to parabolic events described by the traveltime equation (6-12). Note that, unlike the hyperbolic events, the moveout $4 h^{2} / v^{2}$ associated with the parabolic events is time-independent.

The objective is to estimate the transform $u\left(v, \tau^{\prime}\right)$ such that the difference between the actual CMP gather $d\left(h, t^{\prime}\right)$ and the modeled CMP gather $d^{\prime}\left(h, t^{\prime}\right)$ is minimum in the least-squares sense. A direct solution for $u\left(u, \tau^{\prime}\right)$ requires computing the inverse of a large matrix which may have dimensions of $60000 \times 60000$ for a typical field data set (Section F.3).

To circumvent solving a problem that involves a very large matrix, Fourier transform the CMP gather $d\left(h, t^{\prime}\right)$ in the direction of the stretch variable $t^{\prime}$. Correspondingly, apply Fourier transform to equation (6-13b) with respect to $t^{\prime}$ :

$$
d^{\prime}\left(h, \omega^{\prime}\right)=\sum_{v} u\left(v, \omega^{\prime}\right) \exp \left(-i \omega^{\prime} 4 h^{2} / v^{2}\right), \quad(6-14)
$$

where $\omega^{\prime}$ is the Fourier dual of $t^{\prime}$.

For each $\omega^{\prime}$, define $\mathbf{d}^{\prime}: d^{\prime}\left(h, \omega^{\prime}\right)$ and $\mathbf{u}: u\left(v, \omega^{\prime}\right)$ as complex vectors in $h$ and $v$, respectively. Now, consider equation (6-14) in matrix notation:

$$
\mathrm{d}^{\prime}=\mathbf{L} \mathbf{u} .
$$

The complex matrix $L$ is given by equation ( $F-19$ ) of Section F.3. The complex vectors $\mathbf{d}^{\prime}$ and $u$ have lengths $n_{h}$, the number of offsets, and $n_{v}$, the number of constant velocities used in the transform defined by equation (6-14), respectively. The complex matrix $L$ then has dimensions $n_{k} \times n_{y}$. For a typical field data set, $n_{h}=60$ and $n_{y}=60$; hence, the complex matrix $\mathbf{L}$ may have dimensions of $60 \times 60$. As such, instead of solving one single problem using equation (6-13b) in the stretched time $t^{\prime}$ domain that involves a very large matrix, we solve $n_{\omega}$ problems, where $n_{\omega}$ is the number of frequencies $\omega^{\prime}$, in the Fourier transform domain using equation (6-14) involving a small matrix $L$ of equation (F-19).

We now restate our objective within the context of the matrix equation (6-15): For each $\omega^{\prime}$, estimate the complex vector $\mathbf{u}: u\left(v, \omega^{\prime}\right)$ such that the difference e : $e\left(v, \omega^{\prime}\right)$ between the complex vector of the actual CMP gather $\mathrm{d}: d\left(h, \omega^{\prime}\right)$ and that of the modeled CMP gather $\mathbf{d}^{\prime}: d^{\prime}\left(h, \omega^{\prime}\right)$ is minimum in the least-squares sense.

Following Lines and Treitel (1984), the solution for equation (6-15) that minimizes the error vector $e$ in the least-squares sense is derived in Section F. 3 and is given by

$$
\mathbf{u}=\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T} *} \mathbf{d}
$$

where $T$ denotes transpose of the matrix $L$, the aster: isk denotes complex conjugate and $\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}\right)^{-1} \mathbf{L}^{\mathrm{T} *}$ is the least-squares (also called generalized) inverse of $\mathbf{L}$.

Equation (6-16) gives the unconstrained leastsquares solution for $u$, which may be unstable if the matrix $\mathbf{L}^{\mathbf{T} *} \mathbf{L}$ does not have a stable inverse. Stability is attained by constraining the solution, which requires replacing $\mathbf{L}^{\mathbf{T *}} \mathbf{L}$ in equation (6-16) with $\mathbf{L}^{\mathbf{T} *} \mathbf{L}+\beta \mathbf{I}_{\text {, w }}$ where $\beta$ is called the damping factor (also called the Lagrange multiplier) and I is the identity matrix (Lines and Treitel, 1984). Also, there can be singularities or near singularities in the matrix $L$. This is primarily because of the nonuniqueness of hyperbolic summation paths at and near zero offset, and discrete sampling over a finite range of offsets. The method of singular-value decomposition (SVD) is used to obtain the least-squares solution for $\mathbf{u}$ of equation (6-16) when the matrix $\mathbf{L}$ is singular or near singular (Section F.3).

We now outline the velocity-stack processing with reduced amplitude smearing based, on the discrete hyperbolic Radon transform.

(a) Start with a CMP gather, $d(h, t)$ and apply $t^{2}$ stretching, $d\left(h, t^{\prime}=t^{2}\right)$.

(b) Fourier transform in the $t^{\prime}$ direction, $d\left(h, w^{\prime}\right)$.

(c) For each $\omega^{\prime}$, set up the $\mathbf{L}$ matrix (equation F-16) based on the geometry of the CMP gather and solve for $u$ of equation (6-16) using the singular-value decomposition (Section F.3).

(d) Inverse Fourier transform to get $u\left(v, \tau^{\prime}\right)$.

(e) Undo the $t^{2}$-stretching to get $u(v, \tau)$, the velocitystack gather with reduced amplitude smearing.

(f) Perform a desired operation, such as muting the zone of multiples, in the velocity-stack domain.

(g) Finally, perform inverse mapping back to the offset domain to get the modeled CMP gather $d^{\prime}(h, t)$ using equation (6-10b). During this inverse mapping, multiples, primaries, or all of the hyperbolic events can be modelcd.

The velocity-stack gather estimated by equation (6-16) as described by the above sequence is one form of the generalized discrete forward Radon transform (Beylkin, 1987).

Recall that the minimum error associated with the least-squares solution is the difference between the actual CMP gather and the modeled CMP gather obtained from inverse mapping from the Radon transform domain back to the offset domain using equation (610b). Since the forward mapping defined by equation (6-10a) involves hyperbolic events, only, from the offset domain to the velocity domain, this difference gather should contain only the nonhyperbolic events, such as random or linear noise, that may be present in the original CMP gather.

## The Parabolic Radon Transform

An alternative to stretching in the time direction to attain the linear form of the Radon transform (equations 6-13a,b) is given by Hampson (1986). First, the input CMP gather is NMO corrected using the hyperbolic moveout equation

$$
t_{n}=\sqrt{t^{2}-\frac{4 h^{2}}{v_{n}^{2}}}
$$

where $t_{n}$ is the time after NMO corection, and $v_{n}$ is the hyperbolic moveout correction velocity function. Resulting moveouts of the events, which were originally hyperbolic, are now approxmately parabolic:

$$
t_{n}=\tau+q h^{2}
$$

where $\tau$ is the two-way zero-offet time, and $q$ is the parameter that defines the curvature of the parabola.

In the coordinates of the NMO-corrected gather $d\left(h, t_{n}\right)$, equations $(6-10 a, b)$ take the forms

$$
u(q, \tau)=\sum_{h} d\left(h, t_{n}=\tau+q h^{2}\right)
$$

and

$$
d^{\prime}\left(h, t_{n}\right)=\sum_{q} z\left(q, \tau=t_{n}-q h^{2}\right)
$$

The strategy for computing the hyperbolic Radon transform by performing least-squares minimization for each frequency component of the input data in the stretched coordinates also applies to the moveoutcorrected data to compute the parabolic Radon transform. Fourier transform the moveout-corrected CMP gather $d\left(h, t_{n}\right)$ in the direction of the moveout correction time variable $t_{n}$. Correspondingly, apply Fourier transform to equation (6-18b) with respect to $t_{n}$ to obtain

$$
d^{\prime}\left(h, \omega_{n}\right)=\sum_{q} u\left(q \cdot \omega_{n}\right) \exp \left(-i \omega_{n} q h^{2}\right)
$$

where $\omega_{n}$ is the Fourier dual of $t_{n}$.

For each $\omega_{n}$, define $\mathbf{d}^{\prime}: \boldsymbol{d}^{\prime}\left(h, \omega_{n}\right)$ and $\mathbf{u}: u\left(q, \omega_{n}\right)$ as complex vectors in $h$ and $q$, respectively. With the new definitions of $\mathrm{d}^{\prime}$ and $\mathbf{u}$, equation (6-19) can then be pritten in the matrix form of equation (6-15), where $\mathbf{L}$ now is a complex matrix given by equation (F-29) of Section F.3. The solution that minimizes the leastsquares error vector e: $e\left(h, \omega_{n}\right)$, now defined in the $\omega_{n}$ domain, accordingly, is given by equation (6-16).

The complex vectors $\mathrm{d}^{\prime}$ and $\mathrm{u}$ have lengths $n_{h}$, the number of offsets, and $n_{q}$, the number of constant $q$ values used in the transform defined by equation (619), respectively. The complex matrix $\mathbf{L}$ then has dimensions $n_{h} \times n_{q}$. For a typical field data set, $n_{h}=60$ and $n_{q}=60$; hence, the complex matrix $L$ may have dimensions of $60 \times 60$. As for equation (6-13b), instead of solving one single problem using equation (6-18b) in the moveout correction time $t^{\prime}$ domain that involves a very large matrix, we solve $n_{\omega}$ problems, where $n_{\omega}$ is the number of frequencies $\omega_{n}$, in the Fourier transform domain using equation (6-19) involving a small matrix $\mathrm{L}$ of equation ( $\mathrm{F}-29$ ).

We now outline the velocity-stack processing based on the discrete parabolic Radon transform (Hampson, 1986).

(a) Start with a CMP gather, $d(h, t)$ and apply NMO correction, $d\left(h, t_{n}\right)$.

(b) Fourier transform in the $t_{n}$ direction, $d\left(h, \omega_{n}\right)$.

(c) For each $\omega_{n}$, set up the L matrix (equation F-29) based on the geometry of the CMP gather and solve for $\mathbf{u}$ of equation (6-16) using the singular-value decomposition (Section F.3).

(d) Inverse Fourier transform to get $u(q, \tau)$, the parabolic Radon transform.

(e) Perform a desired operation, such as muting the zone of multiples, in the parabolic Radon transform domain.

(f) Perform inverse mapping back to the offset domain to get the modeled NMO-corrected CMP gather $d^{\prime}\left(h, t_{n}\right)$. During this inverse mapping, nultiples, primaries, or all of the hyperbolic events can be modeled.

(g) Undo the moveout correction to get the modeled CMP gather $d^{\prime}(h, t)$.

As events on the NMO-corrected CMP gather deviate from the ideal parabolic form, there can be degradation in the ability to map those events into the Radortransform domain $(q, r)$ (Hampson, 1986). Moreover, stretch muting that is normally required after NMO correction can remove the far-offset data significantly. The $t^{2}$-stretching circumvents these shortcomings and replaces the moveout correction of the CMP gather. In practice, both hyperbolic and parabolic schemes in various forms are used to attenuate multiples.

## Practical Considerations

Figure 6.4-4 shows the modeled CMP gather before and after $t^{2}$-stretching. Note that the hyperbolas in Figure 6.4-4a are replaced with parabolas in Figure 6.4-4b. The $t^{2}$-transformation causes compression on data before 1 $\mathrm{s}$ and stretching on data after $1 \mathrm{~s}$. As mentioned earlier, a nice property of the parabolic moveout is that it is invariant along the axis $t^{\prime}=t^{2}$ for a specific value of velocity (equation 6-12). The sampling rate along the $t^{2}$-axis was set equal to $t^{\prime} / n_{t}$, where $n_{t}$ is the number of samples along the $t$-axis. There can be a potential problem of aliasing near $t=0$, causing frequency distortion for shallow events. This problem can be avoided by finer sampling along the $t^{\prime}$-axis.

By using the singular-value decomposition procedure described in Section F.3, we obtain the Radon transform represented by the velocity-stack gather in the stretched coordinates as shown in Figure 6.4-4c. Finally, we undo the stretching to get the Radon transform represented by the velocity-stack gather in Figure 6.4-4c. Compare this with the conventional velocitystack gather in Figure 6.4-2d. Note the significant reduction of amplitude smearing and enhancement of velocity resolution in the velocity-stack gather based on the Radon transform. In particular, multiples and primaries now are clearly distinguishable. Nevertheless, there is some frequency distortion of the wavelet associated with the shallowest event in the Radon transform (Figure 6,4-4d), primarily because of stretching and unstretching.

By using the Radon transform (Figure 6.4-5a), the CMP gather can be faithfully reconstructed (Figure 6.4-5b). Compare the panels in Figure 6.4-5 with those in Figure 6.4-3. Note that, unlike the conventional velocity-stack gather, repeated application of the Radon transformation always reproduces the CMP gather with minimal amplitude distortion (Figures 6.4-5b and 6.45d), with the exception of frequency distortion at the very early times.

To summarize the construction of velocity-stack gathers using the conventional procedure defined by equation (6-10a) and the Radon transform based on equation (6-16), we refer to Figures 6.4-6 and 6.4-7. Starting with the synthetic CMP gather (Figure 6.46 a), we use equation (6-10a) to get the conventional velocity-stack gather (Figure 6.4-6b), and the reconstructed gather from it (Figure 6.5-6c) using equation (6-10b). Again, starting with the same synthetic CMP gather (Figure 6.4-7a), we obtain the velocitystack gather based on the Radon transform (Figure 6.47b) defined by equation (6-16), and the reconstructed gather from it (Figure 6.4-7c) using equation (6-10b). It is important to note that the reconstruction procedure using equation (6-10b) to obtain the modeled CMP gather is the same in both Figures 6.4-6 and 6.4-7. The difference lies in the way the velocity-stack gather is created - the conventional approach causes amplitude

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=455&width=203&top_left_y=126&top_left_x=179)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=453&width=166&top_left_y=127&top_left_x=372)

(b) velocity( $\mathrm{km} / \mathrm{s})$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=423&width=164&top_left_y=151&top_left_x=536)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=406&width=160&top_left_y=167&top_left_x=696)

(d)

FIG. 6.4-8. (a) The synthetic CMP gather as in Figure 6.4-2c; (b) the same gather with added band-lmited random noise; (c) the conventional velocity-stack gather (b); (d) the discrete Radon transform of (b). Note the improved velocity resolution in (d) as compared to the amplitude smearing in (c).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=464&width=195&top_left_y=678&top_left_x=179)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=423&width=167&top_left_y=718&top_left_x=373)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=420&width=161&top_left_y=720&top_left_x=537)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0963.jpg?height=422&width=161&top_left_y=718&top_left_x=696)

(d)

FIG. 6.4-9. (a) Velocity-stack gathers associated with the noise-contaminated CMP gather shown in Figure 6.4-8b estimated using $\beta$ factors incorporated into the computation of the discrete Radon transform based on equation (6-16): (a) 0.01 percent, (b) 0.5 percent, (c) 1 percent, and (d) 5 percent.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0964.jpg?height=573&width=257&top_left_y=137&top_left_x=94)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0964.jpg?height=532&width=214&top_left_y=177&top_left_x=327)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0964.jpg?height=508&width=204&top_left_y=201&top_left_x=538)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0964.jpg?height=510&width=202&top_left_y=200&top_left_x=740)

(d)

FIG. 6.4-10. (a) The modeled CMP gather reconstructed from the velocity-stack gather shown in Figure 6.4-8d; (b) the difference between the modeled CMP gather in (a) and the actual CMP gather in Figure 64-8b; (c) the noise component present in the actual CMP gather in (a); (d) difference between (b) and (c). Ideally, (d) should contain zero amplitudes.

smearing along the velocity axis (Figure 6.4-6c), and the procedure based on the Radon transform reduces this smearing and thus increases the resolution along the velocity axis (Figure $6.47 \mathrm{c}$ ).

Now we examine the performance of the Radon transform in the presence of random noise. Consider the CMP gather in Figure 6.4-8a after the addition of bandlimited random noise that is uncorrelated from trace to trace (Figure 6.4-8b). Figure 6.4-8c shows the conventional velocity-stack gather constructed by using equation (6-10a), and Figure 6.4-8d shows the velocity-stack gather constructed by using the Radon transform based on equation (6-16). When the data are contaminated by noise, choice of the damping factor $\beta$ to stabilize the solution represented by equation (6-16) has a signifcant impact on the quality of the velocity-stack gather. It is important to emphasize that for the velocity-stack construction using the hyperbolic discrete Radon transform, noise is anything but hyperbolic events.
The $\beta$ factor is equivalent to the prewhitening factor in Wiener-Levinson deconvolution. In this regard, the optimum $\beta$ factor depends significantly upon the noise level in the data. Figure 6.4-9 shows estimates of the velocity-stack gathers using four different values of the $\beta$ factor. For the noise-free case (Figure 6.4-7), theoretically, the best choice of $\beta$ should be zero; however, to avoid exaggeration of numerical roundoff errors, $\beta$ should be chosen to be a very small number. A practical rule of thumb is that stability in the SVD procedure does not improve further for $\beta$ factors beyond a certain value (compare Figures 6.4-9c and d). For field data, a value of $1 \%$ of the largest eigenvalue of the matrix $\mathbf{L}^{\mathbf{T *}} \mathbf{L}$ of equation (6-16) often yields adequate results (Section F.3).

Since the elements of the matrix $L$ in equation (6-16) depends on the geometry of the CMP gather under consideration, estimation of the Radon trans-
form $\mathbf{u}$ would normally require singular-value decomposition (equation F-22) for each individual gather. To circumvent the repeated application of the singular-value decomposition - a numerically intensive scheme, the Radon transform estimation procedure can be made efficient by implementing a two-staged computation. First, the part of the Radon transform associated with the operator $L^{\mathrm{T} *}$ in equation (6-16) can be computed using the actual offset distribution of the input CMP gather. Second, the part of the Radon transform associated with the operator $\left(\mathrm{L}^{\mathbf{T}+} \mathrm{L}\right)^{-1}$ is computed by the singular-value decomposition only once for the entire data set using an offset distribution that may be considered an acceptable average of the actual offset distributions of the CMP gathers along the line traverse.

Finally, we examine the ability of the Radon transform in separating hyperbolic events from band-limited random noise. Consider the same noisy gather as in Figure $6.4-8 \mathrm{~b}$. Reconstruct this CMP gather as shown in Figure 6.4.10a using the velocity-stack gather shown in Figure $6.48 \mathrm{~d}$, and subtract the result from the original noisy CMP gather (Figure 6,4-8b). This difference gather is shown in Figure $6.4 \mathbf{1 0 b}$, and it represents the least-squares error e defined as the difference between the actual CMP gather $d$ and the modeled CMP gather $\mathbf{d}^{\prime}$ defined by equation (6-15). Ideally, it should contain anything but hyperbolic events. Nevertheless, the missing high-frequency components in the shallowest part of the reconstructed CMP gather have leaked into the difference gather (Figure 6.4-10d). The actual random noise added to the original CMP gather (Figure 6.4-8a) is shown in Figure 6.4-10c. Compare the extracted noise (Figure 6.4-10b) with the actual noise (Figure 6.4-10c) and note that the difference between the two (Figure $6.4-10 d$ ) contains negligibly small residual amplitudes aside from some remnants of the hyperbolic events.

## Impulse Response of the Velocity-Stack Operator

An isolated spike in the offset domain (Figure 6.4-11a) maps to the velocity domain using equation (6-10a) along a curved trajectory (Figure 6.4-12a). Solve equation (6-9b) for $v$ to obtain the equation for this trajectory in the velocity domain:

$$
v=\frac{2 h}{\sqrt{t^{2}-\tau^{2}}}
$$

The curvature is greater for a spike situated at far offset than a spike situated at near offset (Figures 6.4-11b and 6.4-12b). Also, the curvature is greater for a spike situated at an early time on a given offset than a spike situated at a late time on the same offset (Figures 6.4$11 \mathrm{c}$ and $6.4-12 \mathrm{c}$ ).
Inverse transformation of the conventional velocitystack gathers (Figures 6.4-12a,b,c) back to the offset domain does not reproduce the isolated spikes (Figures 6.4-13a,b,c). Instead, the amplitudes are smeared across each of the CMP gathers. The amplitude smearing is worse for spikes situated at near offsets (Figure 6.4-13b) and late times (Figure $6.4-13 \mathrm{c}$ ).

Figures $6.4-14 a, b, c$ show the velocity-stack gathers based on the Radon transform of equation (6-16) associated with the isolated spikes in Figures 6.4-11 a, b, c. Inverse mapping these velocity-stack gathers, in contrast with the results obtained from inverse mapping of the conventional velocity-stack gathers (Figures 6.4$13 a, b, c$ ), yields a fairly good focusing of energy to the isolated spike locations (Figures 6.4-15a,b,c).

How is the velocity-stack processing affected by irregularities in the data? Refer to the CMP gather in Figure 6.411d. It contains a trace with a monofrequency signal, another trace with polarity reversed, a dead trace, and another trace with a dead zone. The conventional velocity-stack gather is shown in Figure $6.4-12 \mathrm{~d}$, and the CMP gather reconstructed from it is shown in Figure 6.4-13d. Compare this figure with Figure 6.4-11d and note the differences along the reflection hyperbolas in amplitude and curvature where the anomalous traces are located. Also, note the smearing of the monofrequency signal over a large range of traces away from the original trace location. The velocity-stack gather based on the Radon transform associated with the CMP gather in Figure 6.4-11d is shown in Figure 6.4-14d. The CMP gather reconstructed from it (Figure 6.4-15d) shows less smearing of the monofrequency signal. As with the conventional velocity-stack gather, however, the dead trace and the trace with a dead zone in the original CMP gather (Figure 6.4-11d) again have been replaced with nonzero amplitudes, and traveltimes have been distorted along the reflection hyperbolas where the anomalous traces are located.

The transform paraneters of practical importance are the velocity range and the velocity increment used in constructing velocity-stack gathers. The velocity range should span the velocities associated with primary and multiple reflections. A good practice for the choice of velocity increment is such that the number of traces in velocity space is set equal to the traces in the offset space.

## Field Data Examples

We shall now consider field data examples of the Radon transform. Figure 6.4-16a shows a deep-water CMP

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=474&width=195&top_left_y=128&top_left_x=155)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=432&width=169&top_left_y=170&top_left_x=360)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=430&width=170&top_left_y=170&top_left_x=538)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=430&width=167&top_left_y=170&top_left_x=714)

(d)

FIG. 6.4-11. Synthetic CMP gathers that contain (a) a single spike; (b) a series of spikes at equal time but at different offsets; (c) a series of spikes at equal offset but at different times; (d) anomalous traces.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=468&width=193&top_left_y=697&top_left_x=156)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=432&width=162&top_left_y=739&top_left_x=358)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=425&width=162&top_left_y=740&top_left_x=538)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0966.jpg?height=430&width=160&top_left_y=740&top_left_x=716)

(d)

FIG. 6.4-12. Conventional velocity-stack gathers associated with the CMP gathers in Figure 6.4-11.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=474&width=196&top_left_y=127&top_left_x=155)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=432&width=162&top_left_y=169&top_left_x=358)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=428&width=161&top_left_y=171&top_left_x=537)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=430&width=163&top_left_y=170&top_left_x=716)

(d)

FIG. 6.4-13. Reconstructed CMP gathers from the conventional velocity-stack gathers in Figure 6 4-12. Compare with Figure 6.4-11.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=469&width=197&top_left_y=686&top_left_x=158)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=425&width=164&top_left_y=728&top_left_x=360)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=423&width=158&top_left_y=730&top_left_x=540)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0967.jpg?height=425&width=160&top_left_y=729&top_left_x=716)

(d)

FIG. 6.4-14. Velocity-stack Eathers that represent the Radon transforms of the CMP gathers in Figure 6.4-11. Compare with Figure 6.4-12.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0968.jpg?height=487&width=204&top_left_y=127&top_left_x=147)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0968.jpg?height=441&width=173&top_left_y=171&top_left_x=366)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0968.jpg?height=441&width=169&top_left_y=171&top_left_x=540)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0968.jpg?height=438&width=171&top_left_y=175&top_left_x=719)

(d)

FIG. 6.4-15. Reconstructed CMP gathers from the proper velocity-stack gathers in Figure 6.4-14. Compare with Figures 6.4-11 and 6.4-13.

gather that contains strong multiples below $3.5 \mathrm{~s}$. The conventional velocity-stack gather (Figure 6.4-16b) shows the familiar amplitude smearing, whereas the velocity-stack gather based on the Radon transform (Figure 6.4-16c) shows better focusing of hyperbolic events. The reconstructed CMP gather (Figure 6.4-16d) contains all the hyperbolic events present in the original CMP gather (Figure 6.4-16a) and excludes noise. The amplitudes on the reconstructed CMP gather appear to be faithfully restored to their original values.

A noisier CMP gather from a shallow-water survey is shown in Figure 6.4-17a. Note the strong-amplitude, low-frequency bursts of energy similar to ground roll. A spike in the offset domain maps along a curved trajectory in the velocity domain; the larger the offset and the shallower the time at which this spike is located, the more the curvature of the trajectory (Figures 6.411 through 6.4-15). Note the presence of curved trajectories in the conventional velocity-stack gather in Figure 6.4-17b. Although the velocity-stack gather based on the Radon transform (Figure 6.4-17c) also contains these features, it does not have the amplitude smearing that dominates the conventional velocity-stack gather. The CMP gather reconstructed from the velocity-stack gather shown in Figure 6.4-17c contains all the hyperbolic events and excludes the random noise and coherent noise with linear moveout present in the original CMP gather (compare Figures 6.417a and d).

The result shown in Figure 6.4-17d suggests that velocity-stack transformation, when implemented as a special form of the discrete Radon transform, can be used to attenuate random and coherent linear noise on CMP data (Hampson, 1987).

Another potential application of velocity-stack processing is in the construction of high-resolution constant-velocity stacks. Figure 6.4-18 shows constantvelocity-stack panels constructed from about 100 CMP gathers. These panels were generated twice - by computing conventional velocity-stack gathers and sorting them to CVS panels, and by computing velocity-stack gathere using the Radon transform and sorting the results into CVS panels. The multiples contaminate the primaries on the panels based on conventional velocitystack gathers even though the constant-velocity range used is associated with the primaries. This is because of the lateral smearing of amplitudes associated with multiples and primaries in the velocity space as illustrated in Figure 6.4-2d. The multiples appear to be significantly attenuated on the panels based on the velocity-

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0969.jpg?height=821&width=236&top_left_y=219&top_left_x=83)

(a)

## velocity $(\mathrm{km} / \mathrm{s})$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0969.jpg?height=774&width=213&top_left_y=264&top_left_x=317)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0969.jpg?height=742&width=203&top_left_y=293&top_left_x=528)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0969.jpg?height=750&width=213&top_left_y=286&top_left_x=740)

(d)

FIG. 6.4-16. (a) A deep-water CMP gather with strong multuples; (b) the conventional velocity-stack gather; (c) the proper velocity-stack gather; (d) the CMP gather reconstructed from (c). Compare with (a) and note the preservation of amplitudes along hyperbolic events. (Data courtesy Norwegian Petroleum Drrectorate.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0970.jpg?height=601&width=222&top_left_y=128&top_left_x=95)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0970.jpg?height=601&width=205&top_left_y=128&top_left_x=323)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0970.jpg?height=562&width=201&top_left_y=166&top_left_x=532)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0970.jpg?height=560&width=202&top_left_y=167&top_left_x=739)

(d)

FIG. 6.4-17. (a) A shallow-water CMP gather with strong linear nose; (b) conventıonal velocity-stack gather; (c) proper velocity-stack gather; (d) the CMP gather reconstructed from (c). Compare with (a) and note that hyperbolic events are enhanced, and random and linear noise are suppressed. (Data courtesy Abu Dhabi National Oil Company.)

stack gathers computed by using the Radon transform. The lateral smearing has been reduced in the velocity space by the Radon transform as illustrated in Figure $6.4-4 d$.

## Radon-Transform Multiple Attenuation

Consider the synthetic CMP gather in Figure 6.4-7a and the velocity-stack gather (Figure $6.47 \mathrm{~b}$ ) estimated from it using the discrete Radon transform. By including the entire velocity-stack gather in the summation in equation (6-10b), we get the fully reconstructed CMP gather shown in Figure 6.47c. That result is reproduced in Figure 6.4-19a. Aside from the loss of high-frequency energy at early times, this modeled CMP gather is a close approximation to the original CMP gather (Figиге $6.4-7 \mathrm{a}$ ).
Instead of including the entire velocity-stack gather (Figure 6.3-15b) in the summation in equation (6-10b), a CMP gather with only multiples (Figure 6.4-19b) or only primaries (Figure 6.4-19c) can be reconstructed by simply assigning suitable pass-reject zones over the velocity-stack gather. Compare the modeled multiplesonly and primaries-only CMP gathers (Figures 6.419b,c) with the actual CMP gathers shown in Figures 6.4-2b,a. (The modeled shallow primary in Figure 6.4-19c corresponds to the primary in Figure 6.4-2b.) It appears that, although insignificant, the multiplesonly gather (Figure 6.4-19b) contains some residual primary energy, and the primaries-only gather (Figure 6.419c) contains some residual multiple energy. In practice, it often is desirable to model the multiples and subtract the result from the actual CMP gather (Hampson, 1986). One reason for this is the necessity to retain in CMP data some of the nonhyperbolic energy, such
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0971.jpg?height=1006&width=572&top_left_y=134&top_left_x=233)

FIG. 6.4-18. Constant-velocity-stacks using five constant velocities. Panels in (a) are based on conventional velocity starking and panels in (b) are based on proper velocity stacking using the Radon transform. The constant velocities fall in the range that corresponds to the primary velocity trend. Note the multiple contamination of the panels created from conventional velocity stacking (top).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=463&width=195&top_left_y=128&top_left_x=175)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=432&width=173&top_left_y=157&top_left_x=358)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=422&width=168&top_left_y=167&top_left_x=527)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=422&width=163&top_left_y=167&top_left_x=696)

(d)

FIG. 6.4-19. (a) Reconstruction of the noise free CMP gather in Figure 6.4-7a using (a) the entire velocity-stack gather in Figure 6.4-7b; (b) allowing only the multiple energy; (c) allowing only the primary energy; (d) subtraction of (b) from Figure $6.4-7 \mathrm{a}$.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=464&width=197&top_left_y=686&top_left_x=173)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=427&width=164&top_left_y=723&top_left_x=366)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=422&width=171&top_left_y=728&top_left_x=528)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0972.jpg?height=420&width=163&top_left_y=729&top_left_x=696)

(d)

FIG. 6.4-20. Reconstruction of the noisc-contaminated CMP gather in Figure 6.4-8b using (a) the entire velocity-stack gather in Figure 6 4-8d; (b) allowing only the multiple energy; (c) allowing only the primary energy; (d) subtraction of (b) from Figure 6.4-8b. Aside from the muted zone, the noise in the original gather (Figure 6.4-8b) is retamed.
as diffractions. In the present example, Figure 6.4-19d shows the difference between the original CMP gather (Figure 6.4-7a) and the modeled multiples-only CMP gather (Figure 6.4-19b). When compared with Figure 6.4-19c, the subtraction result shown in Figure 6.4-19d shows differences at early times due to the $t^{2}$-stretching artifacts.

The subtraction actually tends to retain the original texture of the data; this is demonstrated with the noise-contaminated CMP gather in Figure 6.4-8b. U8ing the entire velocity-stack gather (Figure 6.4-8d) associated with this CMP gather, we get the fully reconstructed CMP gather shown in Figure 6.4-20a. Note that this modeled CMP gather is a close approximation to the noise-free CMP gather (Figure 6.4-7a). Also, compare the modeled multiples-only and primaries-only CMP gathers (Figures 6.4-20b,c) with the corresponding results from the noise-free CMP gather (Figures $6.4-19 \mathrm{~b}, \mathrm{c}$ ). Figure 6.4-20d shows the difference between the original CMP gather (Figure 6.4-8b) and the modeled multiples-only CMP gather (Figure 6.4-20b). When compared with Figure 6.4-20c, the subtraction result shown in Figure 6.4-20d retains the original noise component present in the data (Figure $6.4-8 \mathrm{~b}$ ).

Now consider a field data example for separation of primaries and multiples by the discrete Radon transform. Shown in Figure 6.421 are the deep-water CMP gather, and the reconstructed primaries-only, multiplesonly, and the subtraction gathers. Corresponding velocity spectra in Figure 6.4-22 clearly show that multiples largely have been removed from the input CMP gather. Nevertheless, a complete separation of multiples from primaries is not achievable. As an example, note the residual primary energy especially visible above 4 $s$ in the multiples-only CMP gather (Figure 6.4-21c). Accordingly, the subtraction result (Figure 6.4-21d) inevitably will have some remnant multiple energy. This is especially apparent in the corresponding velocity spectrum (Figure 6.4-22d); note the small coherency peaks in the multiple zone below $4 \mathrm{~s}$.

Since the Radon-transform multiple attenuation using velocity-stack gathers exploits the velocity discrimination between primaries and multiples, it is appropriate to compare the techrique with other methods that also are based on the same criterion. Figure 6.4-23 shows the synthetic CMP gather with multiple attenuation using the Radon transform, model-based (Section 6.1) and frequency-wavenumber filtering (Section 6.2) methods. Note that the model-based method fails to preserve the amplitude characteristics of the input data (Figure 6.4-23c). This is a direct consequence of the problems in creating model traces for multiples as was referred to in Section 6.1. The frequency-wavenumber filtering method has caused attemation of priamries at near offsets an effect similar to inside-trace muting (Figure 6.4-23d). Among the three approaches, the
Radon transform method appears to best preserve amplitude and phase characteristics of the input data (Figure 6.4-23b).

Further comparisons between the three methods based on velocity discrimination can be made using the noise-contaminated CMP gather in Figure 6.4-24. Again, the Radon transform yields the most desirable result. In fact, whenever data, which require multiple attenuation, are used for amplitude inversion to estimate acoustic impedance or amplitude variation with offset (AVO) analysis, the preferred technique for multiple attemuation most often is the Radon transform.

A challenging data example with short-period interbed multiples is shown in Figure 6.4-25. The velocity spectra computed from the original CMP gather (Figure 6.4-25a) and the gather with multiples removed (Figure 6.4-25d) are shown in Figure 6.4-26. Portions of CMP stacked sections with and without velocity-stack processing for multiple suppression are shown in Figure 6.4-27. An important observation in Figure 6.4-27a is the apparent lateral continuity caused by the multiples. This continuity is replaced, in Figure 6.4-27b, with features that are perhaps geologically more detailed and plausable. Note the presence of a subtle structural closure at $1.5 \mathrm{~s}$ in Figure 6.4-27b; this feature is completely disguised among the multiples in Figure 6.4-27a. Unfortunately, because of the unavailability of well $\log _{1}$ no definite assessment can be made about the details in the CMP stacked section processed for multiple suppression (Figure 6.4-27b).

We now demonstrate application of the Radon transform to moveout-corrected CMP gathers (Hampson, 1986). Figures 6.4-28 shows a CMP stack without multiple attenuation. Water-bottom and peg-leg multiples dominate the lower half of the sections and interfere with primary reflections of interest. Strong multiple reflections also are seen on the selected CMP gather in Figure 6.4-29a. Most of the multiples water-bottom and the peg-legs associated with the depositional sequence boundary at $2 \mathrm{~s}$, are long-period

Hampson's implementation of the Radon transform requires input CMP gathers to be moveout-corrected using a primary velocity function (Figure 6.4-29b). The aim is to make the moveout of events primaries and multiples, approximately parabolic. Prior to Radon transformation, spatial interpolation of the data may be needed to make the trace interval sufficiently small (Figure 6.4-29c). The Radon transformation itself is done using the moveout at a reference offset, instead of velocity, as the variable for the horizontal axis (Figure 6.4-29d).

Multiple attenuation in the transform domain is achieved by rejecting a zone that includes the primaries

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=488&width=182&top_left_y=126&top_left_x=188)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=438&width=152&top_left_y=178&top_left_x=368)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=437&width=163&top_left_y=177&top_left_x=527)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=437&width=160&top_left_y=177&top_left_x=686)

(d)

FIG. 6.4-21. (a) A deep-water CMP gather; (b) full reconstruction from the proper velocity-stack gather; (c) multiples-only reconstruction; (d) difference between (a) and (c). (Data courtesy Abu Dhabi National Oil Company.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=483&width=172&top_left_y=698&top_left_x=209)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=440&width=152&top_left_y=743&top_left_x=376)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=435&width=151&top_left_y=747&top_left_x=526)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0974.jpg?height=438&width=153&top_left_y=745&top_left_x=675)

(d)

FIG. 6.4-22. Velocity spectrea associated with the CMP gathers in Figure 6.4-21.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0975.jpg?height=480&width=679&top_left_y=128&top_left_x=179)

FIG. 6.4-23. (a) Synthetic CMP gather as in Figure 6 4-2c; after multiple attenuation using (b) the Radon transform, (c) the modeling of multiples in $t-x$ domain (Section 6.1), and (d) the $f-k$ method (Section 6.2).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0975.jpg?height=455&width=198&top_left_y=685&top_left_x=179)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0975.jpg?height=419&width=170&top_left_y=722&top_left_x=370)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0975.jpg?height=419&width=163&top_left_y=719&top_left_x=535)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0975.jpg?height=418&width=162&top_left_y=721&top_left_x=694)

(d)

FIG. 6.4-24. (a) Synthetic CMP gather as in Figure 6.4-2c with added band-limited random noise; after multiple attenuation using (b) the Radon transform, (c) the modeling of multuples in $t-x$ domain (Section 6.1), and (d) the $f-k$ method (Section 6.2).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0976.jpg?height=508&width=181&top_left_y=135&top_left_x=169)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0976.jpg?height=485&width=172&top_left_y=157&top_left_x=348)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0976.jpg?height=486&width=179&top_left_y=156&top_left_x=520)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0976.jpg?height=485&width=174&top_left_y=157&top_left_x=696)

(d)

FIG. B.4-25. (a) A shallow-water CMP gather; (b) full reconstruction from the proper velocity-stack gather; (c) multiples-only reconstruction; (d) difference between (a) and (c). (Data courtesy Abu Dhabi National Oil Company.)
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0976.jpg?height=472&width=534&top_left_y=726&top_left_x=253)

FIG. 6.4-26. Velocity spectra associated with (a) the CMP gather in Figure 6.425a; (b) the CMP gather in Figure 6 4-25d.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0977.jpg?height=356&width=836&top_left_y=126&top_left_x=104)

FIG. 6.4-27. (a) A portion of the CMP stacked section associated with the CMP gather in Figure 6.4-25a with short-period multiples; (b) same portion of the CMP stacked section associated with the CMP gather in Figure 6.4-25d with velocity-stack processing for multiple suppression. Note the apparent lateral continuity caused by the short-period multiples in (a); this false continuity is removed in (b), thereby uncovering a probable subtle structural feature at $1.5 \mathrm{~s}$ below midpoint A. (Data courtesy Abu Dhabi National Oil Company.)

(Figure 6.4-30a). The inverse transform yields the reconstructed gather that contains presumably only multiples (Figure 6.4-30b). Again, to preserve data characteristics, rather than modeling the primaries by reconstruction, it is preferred to model the multiples (Figure $6.4-30 \mathrm{~b}$ ) and subtract the modeled gather from the original (Figure 6.4-29c). The difference gather should contain the primaries (Figure 6.4-30c). Finally, traces which were generated during trace interpolation (Figure 6.4-29c) are dropped (Figure 6.4-30d). Compare Figure 6.4-30d the gather after multiple atteriuation, with Figure $6.4-29 b$ - the gather before multiple attenuation. Aside from a residual of the water-bottom multiples, much of the energy associated with multiples has been removed.

Figure 6.4-31 shows the CMP stack after Radontransform multiple attenuation. Note that multiple attenuation has uncovered the primary the event at 3.5 $s$ associated with an unconformity. Multiple attenuation also helps migration to yield an improved image as shown in Figure 6.4-32.

### 6.6 LINEAR UNCORRELATED NOISE ATTENUATION

Random noise uncorrelated from trace to trace abounds in recorded data and retains its presence at almost all steps in a processing sequence. CMP stacking reduces the uncorrelated noise in the data significantly (Section 1.5). Noise that remains in the stacked data can have adverse effect on reflection continuity.

While time-variant filtering (Section 1.1) reduces noise in the temporal direction, it does not necessarily attenuate the noise uncorrelated from trace to trace. Although a number of multichannel signal enhancement techriques has been practiced, the one that best preserves relative amplitudes and retains the signal character without amplitude distortion is based on spatial prediction filtering invented by Canales (1984). Mathematical details of this uncorrelated noise attenuation technique is provided in Section F.5.

To understand the conceptual basis for spatial prediction filtering, first, recall from Section 2.3 the prediction filtering in the temporal direction. A recorded seismic trace is represented by a time series with two components - a predictable part that relates to the multiple reflections and an unpredictable part that relates to the primary reflections. The prediction process involves estimating some future value of the input series defined by the prediction lag from the past values of the input series. For the prediction process to work on a seismic trace, strictly, it must represent a zero-offset seismogram recorded over a horizontally layered earth so as to preserve periodicity of multiples. Assuming this

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0978.jpg?height=1080&width=733&top_left_y=149&top_left_x=157)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0979.jpg?height=983&width=216&top_left_y=138&top_left_x=122)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0979.jpg?height=982&width=199&top_left_y=136&top_left_x=337)

(b)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0979.jpg?height=980&width=195&top_left_y=137&top_left_x=527)

(c)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0979.jpg?height=981&width=193&top_left_y=138&top_left_x=726)

(d)

FIG. 6.4-29. (a) A CMP gather associated with the stacked section in Figure 6.4-28; (b) after moveout correction using primary velocities; (c) after trace interpolation using the $f-x$ method (Section G.1); (d) the parabolic Radon transform of (c). Shown beneath each panel is the autocorrelogram.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0980.jpg?height=1003&width=806&top_left_y=131&top_left_x=114)

(a)

(b)

(c)

(d)

FIG. 6.4-30. (a) The Radon transform as in Figure 6.4-29d after muting the primary zone; (b) the reconstructed gather that contains only multiples; (c) the difference gather obtained by subtracting (b) from Figure 6.4-29c; (d) the same gatber as in (c) but retaining every otber trace with offsets as in Figure 6.4-29b. Compare (d) the gather after multiple attenuation. with Figure $6.4-29 \mathrm{~b}$ - the gather before multiple attenuation.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0981.jpg?height=1081&width=729&top_left_y=147&top_left_x=159)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0982.jpg?height=1023&width=692&top_left_y=179&top_left_x=175)
to be the case, another fundamental assumption in predictive deconvolution is that the reflectivity series that contains the primaries is random. Hence, a prediction filter, when applied to the recorded seismic trace produces an estimate of the predictable part - the multiple reflections. The error in the prediction process then represents the random reflectivity series - the primary reflections.

Now consider the prediction process in the spatial direction. A spatial prediction filter, when applied to a stacked section, produces an estimate of the predictable part - the coherent signal. The error in the prediction process represents the noise uncorrelated from trace to trace. Whereas, the prediction lag for the temporal prediction filter is specified according to the period of the multiples, for the spatial application, a unit prediction lag is used. Since predictive deconvolution with a unit prediction lag is equivalent to spiking deconvolution, a spatial prediction filter is of the form of a spiking deconvolution operator.

## Design of Spatial Prediction Filters

Spatially random noise is uncorrelated from trace to trace independent of temporal frequency. Therefore, spatial prediction filters can be conveniently designed and applied in the frequency-space domain. As such, spatial prediction filtering has come to be known in practice by the term $f-x$ deconvolution. While the theoretical review of the filter design and application is provided in Section F.5, below is a step-by-step procedure for $f-x$ deconvolution.

(a) Start with the CMP-stacked section $P(x, t)$ and apply Fourier transform in the time direction to obtain the complex matrix $P(x, \omega)$.

(b) Transpose the complex matrix $P(x, \omega)$, so that, for each frequency component, $P(x, \omega)$ is represented by the $n$-length complex vector $\mathbf{P}$ : $\left(P_{0}, P_{1}, P_{2}, \ldots, P_{n-1}\right)$, where $n$ is the number of traces in the stacked section.

(c) For each frequency $w$ within a specified band width, design a complex prediction filter $F(x)$ with unit prediction lag (Section F.6) represented by the $m$ length complex vector $\mathbf{F}:\left(F_{0}, F_{1}, F_{2}, \ldots, F_{m-1}\right)$, where $m$ is the number of coefficients in the filter.

(d) Apply the complex filter $F(x)$ to the input data component $P(x, \omega)$.

(e) Repeat steps (c) and (d) for all frequency components within the specified bandwidth, combine the results, and transpose to trace format. (f) Inverse Fourier transform to obtain the filtered stacked section.

In practice, the prediction filter is designed using a group of stacked traces rather than the entire stacked section itself. The filter length $m$ usually is chosen between 7-21 points, and the typical length $n$ of the input complex vector $\mathbf{P}$ is set to ten times the filter length. Starting at one end of the stacked section, say from the left-hand side, the filter is applied to output one predicted sample at $(m+1)$ st trace for each frequency component. The design gate is then moved one trace to the right by dropping the first trace within the design window on the left and picking up the next trace on the right. The design gate is slid from one end of the section to the other one trace at a time. The prediction filter may be designed and applied in two opposite directions, and the outputs from the two applications may be averaged.

## Field Data Examples

Although $f-x$ deconvolution usually is applied to stacked data, it also may be applied to moveoutcorrected common-offset sections or CMP gathers. Figure 6.5-1 shows a CMP-stacked section before and after $f-x$ deconvolution. Both the input and output sections have been displayed using the same display gain. Note the significant reduction of the noise and enhancement of the coherent signal in the section.

A way to assess the effectiveness of noise attenuation is by examining the $f-k$ spectrum of the data before and after $f-x$ deconvolution as shown in Figure 6.5-2. The $f-k$ spectrum of the input section shows that the bandwidth of the data is approximately $10-70$ $\mathrm{Hz}$. It also shows the presence of random noise in the stacked section which maps over a rectangular area in the $f-k$ plane. Specifically, band-limited random noise contains energy at all wavenumbers for all frequencies within the passband. After $f-x$ deconvolution, note that the energy in the $f-k$ spectrum is limited to the region of coherent signal in the vicinity of the frequency axis.

If a time-variant scaling is applied to the output of $f-x$ deconvolution, the residual noise in the data is boosted. Figure 6.5-3 shows the stacked section as in Figure 6.5-1 after $f-x$ deconvolution and AGC scaling. Compare the sections in Figures $6.5-1 \mathrm{~b}$ and $6.5-3 \mathrm{~b}$ and note that $A G C$ has scaled up the random noise. Nevertheless, by comparing sections in Figures $6.5-3 \mathrm{a}, \mathrm{b}$, note that the relative signal-to-noise ratio of the data has increased after $f-x$ deconvolution.

(text continues on p. 976)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0984.jpg?height=1074&width=753&top_left_y=128&top_left_x=73)

FIG. 6.5-1. A CMP-stacked section (a) before, and (b) after $f-x$ deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0985.jpg?height=524&width=760&top_left_y=124&top_left_x=112)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0985.jpg?height=525&width=765&top_left_y=653&top_left_x=112)

FIG. 6.5-2. The $f-k$ spectra of the stacked section as in Figure 6.5-1 9a) before, and (b) after $f-x$ deconvolution.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0986.jpg?height=910&width=636&top_left_y=213&top_left_x=177)

FIG. 6.5-3. (a) The CMP-stacked section as in Figure 6.5-1a, and (b) after $f-x$ deconvolution and AGC scaling.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0987.jpg?height=722&width=892&top_left_y=295&top_left_x=72)

FIG. 6.5-4. A portion of a CMP-stacked section (a) before, and (b) after $f-x$ deconvolution with no addback, (c) the difference between (a) and (b),
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0988.jpg?height=720&width=878&top_left_y=296&top_left_x=78)

FIG. 6.5-5. A portion of a CMP-stacked section (same as in Figure 6.5-4a) (a) before, and (b) after $f-x$ deconvolution with 20 percent add-back, (c) the difference between (a) and (b).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0989.jpg?height=722&width=882&top_left_y=292&top_left_x=72)

FIG. 6.5-6. A portion of a CMP-stacled section (same as in Figure 6.5-4a) (a) before, and (b) after $f-x$ deconvolution with 40 percent add-back, (c) the difference between (a) and (b).
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0990.jpg?height=720&width=890&top_left_y=296&top_left_x=72)

FIG. 6.5-7. A portion of a CMP-stacked section (same as in Figure 6.5-4a) (a) before, and (b) after $f-x$ deconvolution with 80 percent add-back, (c) the difference between (a) and (b).

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0991.jpg?height=418&width=821&top_left_y=196&top_left_x=124)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0991.jpg?height=420&width=828&top_left_y=683&top_left_x=116)

FIG. 6.5-8. A CMP-stacked section (a) before, and (b) after $f-x$ deconvolution.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0992.jpg?height=924&width=842&top_left_y=190&top_left_x=79)

FIG. 6.5-9. A CMP-stacked section (a) before, and (b) after $f-x$ deconvolution.
![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0993.jpg?height=620&width=426&top_left_y=126&top_left_x=83)

FIG. 6.E-1. Linear events in the p-gather are mapped onto ponts in the $x-t$ domain (see Exercise 6-2).

We now test $f-x$ deconvolution for noise attenuation in case of a CMP stack that contains nearhorizontal reflections as shown in Figure 6.5-4a. The section after $f-x$ deconvolution is shown in Figure $6.5-4 \mathrm{~b}$, and the difference between the input (Figure 6.5-4a) and the output (Figure 6.5-4b) is shown in Figure 6.5-4c. The difference section represents the error in the prediction process, and as such, it contains the noise uncorrelated from trace to trace. All three sections in Figure 6.5-4 are shown with the same display gain.

Note in the shallow portion of the filtered section in Figure $6.5-4 \mathrm{~b}$ g.bove $1 \mathrm{~s}$ the zipper effect of the coherent linear noise which has remained in the data after stacking. The spatial prediction filter predicts coherent signal which includes primary and multiple reflections, diffractions, and coherent linear noise. Therefore, it should not be surprising to observe a pronounced coherent linear noise trend in the data after $f-x$ deconvolution

To circumvent the smeared appearance of the data after $f-x$ deconvolution, sometimes a portion of the difference section is added back to the output. Figures $6.5-5,6.5-6$ and $6.5-7$ show the results of 20,40 , and 80 percent add-back. As the percent add-back is increased, the texture of the output from $f-x$ deconvolution resembles that of the input section more closely. In practice, typical add-back walue varies between $0-40$ percent.

Now consider a stacked data set with moderate structural complexity as shown in Figure 6.5-8. Note that a significant portion of the randorn noise has been attenueted by $f-x$ deconvolution, while diffractions at fault locations and reflections heve been preserved.

Finally, Figure $6.5-9$ shows a stacked section with a complex structure. Following $f-x$ deconvolution, coherent signal - reflections and diffractions, has largely been preserved. Hence, $f-x$ deconvolution for noise attenuation is a robust process even in the presence of a complex pattern of coherent signal as in Figure 6.59. The epplication of $f-x$ deconvolution to land data from areas with complex structures such as those associated with overthrust tectonics can improve the stack quality significantly. Also, land data from areas with near-surface complexity that causes poor penetration of the source energy inta the subsurface can benefit from application of $f-x$ deconvalution.

## EXERCISES

Exercise 6-1. Prove that a hyperbola in the offset domain $(x, t)$ maps onta an ellipse in the slant-stack domain $(\tau, p)$.

Exercise 6-2. Refer to Figure 6.E-1. What would the $t-x$ domains look like?

Exercise 6-3. Consider constructing the slantstack gather from offset data that consists of a reflection hyperbola. Does equal increment in $p$, the ray parameter, cause undersampling or oversampling of the steep dips? Of the gentle dips? What happens when an equal increment in $1 / p$ is used? What happens when an equal increment in $\theta$ is used, where $\theta$ is related to $p$ by $p=\sin \theta / v$ ?

Exercise 6-4. Identify event $E$ in Figure 6.2-1.

Exercise 6-5. What procedure does CMP stacking correspond to in the $f-k$ domain?

## Appendix F <br> MULTICHANNEL FILTERING TECHNIQUES FOR NOISE AND MULTIPLE ATTENUATION

## F. 1 Analysis of Guided Waves

Marine data often are contaminated by guided waves that travel horizontally within the water layer or in the layers beneath the water layer. These waves exhibit characteristics that depend on water depth and on the geometry and material properties of the substrata. Modeling these pressure waves traveling within the water layer can lead to a better understanding of certain aspects of the field data and sometimes may even result in inferences about the strata below the water layer.

The well-known normal mode theory provides a way to laterally extrapolate acoustic and elastic waves (Pekeris, 1948; Press and Ewing, 1950). In this section, a normal mode procedure is applied to model shot profiles recorded over a water layer on top of a homogeneous elastic half space. Raypatbs corresponding to multiple reflections, direct arrivals, refracted arrival, and its multiples are included in the normal mode theory.

The seismic waveguide effect of a surface layer is well known. Wave propagation in a surface layer, in particular guided waves, can be described by using the normal mode theory (Pekeris, 1948). Pekeris' model consists of a liquid layer over an acoustic (liquid) half space. More general models, which consist of a liquid layer on top of an elastic half space, were investigated by Press and Ewing (1950). The most complete summary of work in the field in the classic work by Ewing et al. (1957).

Guided waves are dispersive. This means each frequency component travels at a different speed; namely, the horizontal phase velocity. The dispersive character of guided waves is most pronounced in shallow water environments (less than $100 \mathrm{~m}$ ). Depending on various waterbottom conditions, such as a mud layer with variable thickness or a hard bottom, the character of these waves may vary from shot to shot (Figure 6.0-3). They also can cuuse linear noise on stacked data (Figure 6.2-8a) and are easily confused with the linear noise that is associated with side scatterers (Figure 6.0-4).

McMechan and Yedin (1981) proposed a way to obtain phase velocity information from field data. Their approach is based on a wavefield transformation. The shot record first is transformed into the slant-stack domain. Fourier transforming (in time) each trace of the slant-stack gather then yields phase velocity as a function of frequency. This two-step process is demonstrated with the field data example in Figure F-1a. Line $C C^{\prime}$ refers to the critical angle of propagation with a large reflection energy. To the right of this line is the supercritical propagation. The slant-stack gather is shown in Figure F-1b, and its 1-D amplitude spectrum is shown in Figure F-1c. Note that the horizontal axis in the slant-stack domain is the ray parameter, that is, the inverse of the horizontal phase velocity. Therefore, in Figure F-1c, we see the variation of the horizontal phase velocity as a function of frequency. Each curve corresponds to a particular normal mode propagating in the water layer. The phase velocities of the normal mode components asymptotically approach that of the water velocity $v_{w}$ at the high-frequency end of the spectrum.

Consider the recording geometry depicted in Figure F-2 with a source and a receiver cable, and subsurface model that consists of a water layer on top of an elastic half space. The source is at a certain depth below the water surface, so the two raypaths - primary and ghost, must be considered.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0995.jpg?height=514&width=689&top_left_y=113&top_left_x=173)

FIG. F-1, (a) A shot gather containing the strong reflected and refracted multiples associated with hard water-bottom conditions. Here, $C C^{\prime}=$ critical-angle energy. (b) The slant-stack gather derived from this shot gather. (c) The $\omega-p$ gather derived from the $\tau-p$ gather in panel (b). The inverse of $p$ is the horizontal phase velocity. This figure demonstrates the dispersive nature of guided waves; that is, phase velocity is a function of frequency for all propagating normal mode components. These modes are represented by the curved trajectories on panel (c).

The normal mode theory of Ewing et al. (1957) provides an analytic expression for phase velocity as a function of frequency (the so-called characteristic equation or dispersion relation) for a given surface-layer madel. The characteristic equation for the geometry in Figure F-2 is given by

$$
\tan \left(k_{x} H r_{1}\right)=\frac{\rho_{2} \beta_{2}^{4} r_{1}}{\rho_{1} c^{4} r_{2}}\left[4 r_{2} s_{2}-\left(1+s_{2}^{2}\right)^{2}\right]
$$

where $k_{z}$ is the horizantal wavenumber, which is equal to $p_{\omega}$ via equation (6-7), $H$ is water depth, $\rho_{1}$ and $\rho_{2}$ are the water and substratum densities, respectively, $\beta_{2}$ is the $S$-wave velocity of the substratum, and $c$ is the phase velocity of the guided waves in the water layer. Finally, the normalized variables are

$$
\begin{aligned}
& r_{1}=\sqrt{\frac{c^{2}}{\alpha_{1}^{2}}-1} \\
& r_{2}=\sqrt{\frac{c^{2}}{\alpha_{2}^{2}}-1} \\
& s_{2}=\sqrt{\frac{c^{2}}{\beta_{2}^{2}}-1}
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0996.jpg?height=190&width=411&top_left_y=126&top_left_x=313)

FIG, F-2. The geometry for normal-mode modeling of the guided waves illustrated in Figure F-3. Here, $S=$ the source, $R=$ receivers, $h_{s}=$ source depth, and $h_{r}=$ receiver depth.

where $\alpha_{1}$ is the $P$-wave velacity in the water layer and $\alpha_{2}$ is the $P$-weve velocity in the substratum. Because of the periodic nature of the tangent, equation ( $F-1$ ) has a multiple-valued function on the left side and a single-valued function on the right side. To explicitly state the ambiguity, equation ( $\mathrm{F}-1$ ) can be rewritten as

$$
k_{x} H r_{1}+n \pi=\tan ^{-1} B
$$

where $B$ is the right-hand side of equation (F-1), and the integer $n=0,1,2, \ldots$, defines the mode number. By carefully examining equations (F-1) and (F-3), note that phase velocity $c$ is a function of frequency $\omega$; hence, guided waves are dispersive. Equation (F-3) yields real values of $k_{\mathrm{x}}$ for $\alpha_{1} \leq c \leq \alpha_{2}$. (Here, we assume thet $\alpha_{1}<\beta_{2}<\alpha_{2}$.) Table F-1 gives a summary of the phase-velocity regions and types of rays associated with each region. Note that we get a wide range of wave types propagating each with a certain phase velocity or a range of phase velocities.

Only in the supercritical region, $\alpha_{1}<c<\beta_{2}$, are waves totally trapped within the water layer. These waves often form the major contribution to normel-mode propagation at longer offsets as in the field date example in Figure F-1a, where the supercritical region is to the right of line $C C^{\prime}$. In the subcritical region, energy leaks into the substratum (thus, the name leaky modes). The contribution of this region to energy arriving at longer offsets is relatively weak.

The recorded pressure wavefield for the supercritical region at various receiver locations (Figure F-2) is given by

$$
P\left(x, z=h_{r}, t\right)=4 \sum_{n} \int d \omega\left\{\omega^{2} A(\omega) \sin \left(k_{x} r_{1} h_{g}\right) \sin \left(k_{x} r_{1} h_{r}\right) \exp [i \omega(t-x / c)]\right\}, \quad(F-4)
$$

where $A(\omega)$ is the amplitude spectrum of the source. Yilmaz (1981) modified this expression to account for the ghost effect. Note that reciprocity is satisfied here - the product of the sinusoidal factors that modulate the source spectrum $A(\omega)$ is unchanged if $h_{r}$ and $h_{s}$ are interchanged.

Table F-1. Regions of phase velocity and assaciated ray types.

| Phase Velocity | Ray Type |
| :--- | :--- |
| $\alpha_{1}<c<\alpha_{2}$ | supercritical $P$-waves |
| $\beta_{1}<c<\alpha_{2}$ | (wide-angle reflections) |
|  | supercritical, partially |
| $c>\alpha_{2}$ | reflected $P$-waves |
| $c=\beta_{2}$ | subcritical $P$-waves |
| $c=\alpha_{2}$ | critically refracted $S$-wave |
|  | critically refracted $P$-wave |

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0997.jpg?height=478&width=681&top_left_y=126&top_left_x=175)

FIG. F-3. Superposition of all modes in water layers of different thicknesses. The depth model is shown in Figure F-2. Ghost effects are included in the modeling. Refer to the text for description of the labeled events.

We now consider modeling of normel modes using equation (F-4), including the ghost effect, for a range of water depths. The model parameters are: $\alpha_{1}=1500 \mathrm{~m} / \mathrm{s}, \beta_{2}=2 \alpha_{1}, \alpha_{2}=1.6 \beta_{2}$, and $\rho_{2} / \rho_{1}=2.2$. All the experimental results represent impulse responses of guided waves that is, $A(\omega)=1$ in equation (F-4). Guided waves in Figure F-3 manifest themselves with a complex interfering wave pattern at shallow water, then gradually separate into simple waterbottom multiples at increasing water depths. The dispersive character of the guided waves is prominent, especially for shallow water depths. In Figure F-3, the guided waves are simulated in the supercritical region. The elastic substratum, which is equivalent to the hard water-bottom case, supports the early refraction energy RP, its multiple RM, and the reflected water-bottom multiples M1, M2, and M3. The acoustic substratum ( $\beta_{2}=0$, equivalent to the soft water-bottom case), yields only the reflected water-battom multiples. Acoustic behavior of the substratum implies that no $P$-to- $S$ canversion occurs. The phase velocity curves in Figure $\mathrm{F}-4$ verify the existence of a number of propagating modes for each case. Note the cable truncation effect (CT).

## F. 2 Wavefield Extrapolation in the $\tau-p$ Domain

In Section 6.3, we discussed slant-stack transfornation of a wavefield from midpoint-offset to midpoint-ray-parameter coordinates. This transformation is done by applying linear moveout and summing over the offset range for each value of the ray-paramater. From the results in Section D.1, the double square-root operator can be specialized for migration before stack in midpoint-ray-parameter coordinates (Ottolini, 1982). To derive the extrapolation equation in the slant-stack domain, we start with the relationships between the transform-domain variables:

$$
p=\frac{\sin \theta}{v}
$$

## Phase Veloclty ( $\mathbf{k m} / \mathrm{s})$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0998.jpg?height=313&width=733&top_left_y=157&top_left_x=148)

FIG. F-4. Phase velocity as a function of frequency for the cases shown in Figure F-3. Here, CT denotes the cable truncation artifact.

and

$$
\frac{v k_{h}}{2 \omega}=\sin \theta
$$

where $k_{h}$ is the offset wavenumber, $\omega$ is the temporal frequency, $p$ is the ray parameter, $v$ is the propagation velocity, and $\theta$ is the angle of propagation measured from the vertical. The normalized offset wavenumber $H$ is defined as (Section D.1)

$$
H=\frac{v k_{h}}{2 \omega}
$$

Combining the relationships given by equations ( $\mathrm{F}-5 \mathrm{a}, \mathrm{b}$ ) with the definition given by equation (F-5c), we get

$$
H=p v
$$

We rewrite the double square-root equation from Section D. 1

$$
\operatorname{DSR}(Y, H)=\sqrt{1-(Y+H)^{2}}+\sqrt{1-(Y-H)^{2}}, \quad(F-7)
$$

and substitute the definition of $H$ in terms of $p$ from equation (F-6) to get

$$
D S R(Y, p v)=\sqrt{1-(Y+p v)^{2}}+\sqrt{1-(\bar{Y}-p v)^{2}}
$$

Ottolini (1982) used this operator for migration before stack in midpoint-ray-parameter coordjnates. The procedure is described in Figure F-5.

Clayton and McMechan (1981) adapted equation (F-8) to zero-dip case which is equivalent to setting $Y=0$ :

$$
\operatorname{DSR}(Y=0, H=p v)=2 \sqrt{1-p^{2} v^{2}}
$$

They then used this operator to downward continue refracted waves on CMP or shot gathers The objective of inversion of a refraction profile is to estimate a velocity profile in depth, $v(z)$. The procedure is outlined in Figure F-6. The final step yields a profile, $P(p, z)$, of horizontal phase velocity $1 / p$ as a function of depth $z$. Two issues must be kept in mind. First, the procedure is based on a layered earth assumption. Second, the procedure requires knowledge of the medium velocity to extrapolate the wavefield in depth. To get around this second problem, the process must be iterated until the phase velocity profile converges to the velocity function used in the extrapolation. It usually takes up to three iterations to achieve convergence.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0999.jpg?height=289&width=409&top_left_y=124&top_left_x=314)

FIG. F-5. Flowchart for migratıon before stack in mudpoint-ray-parameter coordinates.

## F. 3 Mathematical Foundation of the Discrete Radon Transform

The forward Radon transform $u(r, \tau)$ of a 2-D continuous function $d(h, t)$ is given by the integral expression (Beylkin, 1987)

$$
u(r, \tau)=\int_{-\infty}^{\infty} d[h, t=\tau+\phi(r, h)] d h
$$

where $h$ and $t$ are the input variables, and $r$ and $\tau$ are the transform variables. The integration is along trajectories expressed as linear functions of traveltimes $t$ and $\tau$.

The inverse Radon transform given by the integral expression

$$
d(h, t)=\int_{-\infty}^{\infty} \rho(\tau) * u[r, \tau=t-\phi(\tau, h)] d r \quad(F-10 b)
$$

incorporates convolution of $u(r, \tau)$ with the rho filter $\rho(\tau)$ prior to integration. For the 2-D data type $d(h, t)$, the Fourier transform of the rho filter is of the form $\sqrt{\omega} \exp (i \pi / 4)$.

In practice, of course, we do not deal with continuous functions; instead, we have discretely sampled data in time and space. So we need to replace the integrals with discrete summations in equations $(\mathrm{F}-10 \mathrm{a}, \mathrm{b})$. We can use the least-squares technique to compute the discrete

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-0999.jpg?height=302&width=367&top_left_y=903&top_left_x=335)

FIG. F-6. Processing flow for inversion of refraction profiles.

Radon transform (Beylkin, 1987) and account for the effects of discrete sampling and finite cable length. We shall consider three different forms of the function $\phi(r, h)$ in equation (F-10a) and, accotdingly, define discrete hyperbolic (Thorson and Claerbout, 1985; Yilmaz, 1989; Foster and Mosher, 1992), parabolic (Hampson, 1986), and linear (Thorson and Claerbout, 1985) Radon transforms.

First, we shall discuss the discrete hyperbolic Radon transform. The transform variable $r$ of the function $\phi(r, h)$ in equation ( $F-10 a)$ represents stacking velocity $v$. The discrete transformation of the CMP data from the offset domain to the velocity domain is achieved by hyperbolic moveout correction and summing over offset

$$
u(v, \tau)=\sum_{h} d\left(h, t=\sqrt{\tau^{2}+4 h^{2} / v^{2}}\right)
$$

where $t$ is the two-way traveltime, $\tau$ is the two-way zero-offset time, and $t$ is the half-offset. The inverse transform from the velocity domain back to the offset domain is achieved by inverse hyperbolic moveout correction and summing over velocity

$$
d^{\prime}(h, t)=\sum_{v} u\left(v, \tau=\sqrt{t^{2}-4 h^{2} / v^{2}}\right)
$$

The relationship between $(h, t)$ and $(v, \tau)$ coordinates is given by the hyperbolic moveout equation:

$$
t^{2}=\tau^{2}+\frac{4 h^{2}}{v^{2}}
$$

To comply with the linear form of the Radon transform defined by equation (F-11a), apply stretching in the time direction by setting $t^{\prime}=t^{2}$ and $\tau^{\prime}=\tau^{2}$. Equation (F-12a) then takes the form

$$
t^{\prime}=\tau^{\prime}+\frac{4 h^{2}}{v^{2}}
$$

Also in the stretched coordinates, equations (F-11a,b) take the forms

$$
u\left(v, \tau^{\prime}\right)=\sum_{h} d\left(h, t^{\prime}=\tau^{\prime}+4 h^{2} / v^{2}\right)
$$

and

$$
d^{\prime}\left(h, t^{\prime}\right)=\sum_{v} u\left(v, \tau^{\prime}=t^{\prime}-4 h^{2} / v^{2}\right)
$$

Now, consider equation ( $\mathrm{F}-13 \mathrm{~b}$ ) in matrix notation:

$$
\mathbf{d}^{\prime}=\mathbf{L} \mathbf{u} .
$$

The matrix operator $\mathrm{L}$ maps each point in $\mathbf{u}: u\left(v, \tau^{\prime}\right)$ onto a parabola in $\mathbf{d}^{\prime}: d^{\prime}\left(h, t^{\prime}\right)$, the modeled CMP gather in the stretched coordinates.

The objective is to estimate a $u: u\left(v, \tau^{\prime}\right)$ such that the difference $\mathbf{e}:\left(h, t^{\prime}\right)$ between the actual CMP gather $\mathbf{d}: d\left(h, t^{\prime}\right)$ and the modeled CMP gather $\mathbf{d}^{\prime}: d^{\prime}\left(h, t^{\prime}\right)$ is minimum in the least-squares sense. Using the matrix notation and equation (F-14), $e$ is defined as

$$
\mathrm{e}=\mathbf{d}-\mathrm{L} \mathbf{u}
$$

To distinguish from the conventional velocity-stack gather defined by equation (F-11a) with amplitude smearing, we shall refer to $u$ in equation ( $F-14)$ as the Radon transform of $d$ in the stretched coordinates. By the Radon transform, parabolas in the offset domain $\left(h, t^{\prime}\right)$ with the stretched coordinate $t^{\prime}$ (or, equivalently, hyperbolas in the offset domain $h, t$ ) with the unstretched coordinate $t$ are represented by points in the velocity domain $(v, \tau)$.

Following Lines and Treitel (1984), the least-squares solution for equation (F-14) is determined, first, by expressing the cumulative squared error $S$ as

$$
S=\mathrm{e}^{\mathbf{T}} \mathrm{e}
$$

where $\mathbf{T}$ is for transpose. By substituting for e from equation ( $F-15$ ), we get

$$
S=(\mathbf{d}-\mathbf{L u})^{\mathbf{T}}(\mathbf{d}-\mathbf{L} \mathbf{u})
$$

Minimization of $S$ with respect to u yields the desired least-squares solution:

$$
\mathbf{u}=\left(\mathbf{L}^{\mathbf{T}} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T}} \mathrm{d}
$$

where $\mathbf{T}$ denotes transpose of the matrix $L$, and $\left(L^{T} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T}}$ is the least-squares (also called generalized) inverse of $\mathbf{L}$.

In equation ( $F-17$ ) $d$ is a column vector containing all the data points from the actual CMP gather in the stretched coordinates. Its length is $n_{h} n_{t}$, where $n_{h}$ is the number of offsets and $n_{t}$ is the number of time samples in $t^{\prime}$. Also, $\mathbf{u}$ is a column vector containing all the points from the velocity stack-gather; its length is $n_{v} \pi_{\tau}$, where $n_{v}$ is the number of velocities and $n_{\tau}$ is the number of time samples in $\tau^{\prime}$. The elements of the matrix operator $\mathbf{L}$ are delta functions in the velocity domain; its dimensions are $n_{h} n_{t} \times n_{t} n_{\tau}$. For a typical field data set, $n_{h}=60, n_{t}=1000$, $n_{v}=60$ and $n_{\tau}=1000$; this implies an L matrix of dimension $60000 \times 60000$.

The minimum error $\mathbf{e}$ of equation $\mathrm{F}-15$ associated with the least-squares solution $\mathbf{u}$ of equation (F-17) should be interpreted as being the CMP gather that contains only the nonhyperbolic events, such as random or linear noise, that may be present in the original CMP gather d. The velocity-stack gather $u$ obtained from equation (F-17) is one form of the discrete Radon transform of d (Beylkin, 1987).

Direct solution for $u$ of cquation (F-17) requircs computing the inverse of the matrix $L^{T} \mathbf{L}$ which may have dimensions of $60000 \times 60000$ for a typical field data set. Inverting such a large matrix is quite impractical. To circumvent solving a problem that involves a very large matrix $\mathbf{L}$, Fourier transform the CMP gather $d\left(h, t^{\prime}\right)$ in the direction of the stretch variable $t^{\prime}$. Correspondingly, apply Fourier transform to equation (F-13b) with respect to $t^{\prime}$ given by

$$
d^{\prime}\left(h, \omega^{\prime}\right)=\sum_{v} u\left(v, \omega^{\prime}\right) \exp \left(-i \omega^{\prime} 4 h^{2} / v^{2}\right)
$$

where $\omega^{\prime}$ is the Fourier dual of $t^{\prime}$. For each $\omega^{\prime}$ component of $d^{\prime}\left(h, \omega^{\prime}\right)$ and $u\left(v, \omega^{\prime}\right)$, equation (F-18) can be written in the matrix form of equation (F-15), where $\mathbf{L}$ now is a complex matrix of the form

$$
\mathbf{L}=\left(\begin{array}{cccc}
e^{-w \omega^{\prime} 4 h_{1}^{2} / v_{1}^{2}} & e^{-3 \omega^{\prime} 4 h_{1}^{2} / v_{2}^{2}} & \cdots & e^{-z \omega^{\prime} 4 h_{1}^{2} / v_{n}^{2}} \\
e^{-i \omega^{\prime} 4 h_{2}^{2} / v_{1}^{2}} & e^{-\tau \omega^{\prime} 4 h_{2}^{2} / v_{2}^{2}} & \cdots & e^{-z \omega^{\prime} 4 h_{2}^{2} / v_{n}^{2}} \\
\vdots & \vdots & \ddots & \vdots \\
e^{-i \omega^{\prime} 4 h_{m}^{2} / v_{1}^{2}} & e^{-w \omega^{\prime} 4 h_{m}^{2} / v_{2}^{2}} & \cdots & e^{-i \omega^{\prime} 4 h_{m}^{2} / v_{\eta}^{2}}
\end{array}\right)
$$

with dimensions $m \times n=n_{h} \times n_{v}$, where $n_{h}$ is the number of offsets $n_{v}$ is the number of velocities, and $\mathbf{d}^{\prime}$ and $\mathbf{u}$ are complex vectors of lengths $n_{h}$ and $n_{v}$, respectively. Note that the elements of the L matrix depend on the geometry of the input CMP gather and the range of velocities used in constructing the velocity-stack gather.

We now restate our objective in solving for $\mathbf{u}$ of the matrix equation ( $F-14$ ) within the context of the Fourier transform domain: For each $\omega^{\prime}$, estimate the complex vector $\mathbf{u}: u\left(v, \omega^{\prime}\right)$ such that the difference $e: e\left(v, w^{\prime}\right)$ between the complex vector of the actual CMP gather $\mathbf{d}: d\left(h, \omega^{\prime}\right)$ and that of the modeled CMP gather $\mathbf{d}^{t}: d^{\prime}\left(h, \omega^{\prime}\right)$ is minimum in the least-squares sense.

As for equation (F-17), follow the steps involving equations (F-14) through (F-16) to derive the least-squares solution in the Fourier transform domain as

$$
\mathbf{u}=\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T} *} \mathbf{d}
$$

where the asterisk denotes complex conjugate.

Equation (F-20) gives the unconstrained least-squares solution for $\mathbf{u}$. To avoid singularities or near singularities in the matrix $\mathbf{L}^{\mathbf{T} *} \mathrm{~L}$, the solution is constrained by incorporating a damping
factor $\beta$ (also called the Lagrange multıplier) into equation (F-20) (Lines and Treitel, 1984):

$$
\mathbf{u}=\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}+\beta \mathbf{I}\right)^{-\mathbf{1}} \mathbf{L}^{\mathbf{T} *} \mathbf{d}
$$

Because of the near-singular character of the complex matrix $L$, especially for small values of $\omega^{\prime}$, the solution given by equation (F-21) is best reformulated in terms of the singular-value decomposition (SVD) of the matrix L (Press et al., 1986). This procedure factors $\mathbf{L}$ into a product of three matrices:

$$
\mathbf{L}=\mathbf{U} \boldsymbol{\Lambda} \mathbf{V}^{\mathbf{T} *}
$$

By using this factorized form of the matrix $L$, the constrained solution given by equation ( $F-21$ ) takes the form

$$
\mathbf{u}=\mathbf{V}\left[\left(\boldsymbol{\Lambda}^{2}+\beta \mathbf{I}\right)^{-\mathbf{1}} \mathbf{\Lambda}\right] \mathbf{U}^{\mathrm{T} *} \mathbf{d}
$$

where

$$
\left(\mathbf{\Lambda}^{\mathbf{2}}+\beta \mathbf{I}\right)^{-\mathbf{1}} \boldsymbol{\Lambda}=\left(\begin{array}{cccc}
\Gamma_{1} & 0 & \ldots & 0 \\
0 & \Gamma_{2} & \ldots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \ldots & \Gamma_{\mathrm{t}_{2}}
\end{array}\right)
$$

and $\Gamma_{4}=\lambda_{t} /\left(\lambda_{s}^{2}+\beta\right)$, with $\lambda_{2}$ as the positive square roots of the eigenvalues $\lambda_{t}^{2}$ of $L^{T} L$. Recall that the damping factor $\beta$ is a scalar that prevents the solution (equation F-23) from becoming unstable.

We now summarize the method for computing the Radon transform represented by a velocity-stack gather:

(1) Start with a CMP gather $d(h, t)$ and apply the $t^{2}$-strctching, $d\left(h, t^{\prime}=t^{2}\right)$.

(2) Fourier transform in the $t^{\prime}$ direction, $d\left(h, \omega^{\prime}\right)$.

(3) For a specific value of $\omega^{\prime}$ :

(a) Set up the $\mathbf{L}$ matrix (equation F-19) based on the geometry of the CMP gather.

(b) Set up the $\mathbf{d}$ vector by transposing the data set $d\left(h, \omega^{\prime}\right)$.

(c) Apply singular-value decomposition to $\mathbf{L}$ equation (F-22), and compute $U, \boldsymbol{A}$ and $\mathrm{V}^{\mathrm{T} *}$, hence $\mathrm{U}^{\mathbf{T *}}$ and $\mathrm{V}$.

(d) Specify a value for the damping factor $\beta$ and set up the diagonal matrix of equation (F-24).

(e) Finally, solve for $\mathbf{u}$ (equation $\mathbf{F}$-23).

(f) Repeat (3) for all $\omega^{\prime}$ values and accumulate the results in $u\left(v, \omega^{\prime}\right)$.

(4) Inverse Fourier transform to get $u\left(v, \tau^{\prime}\right)$.

(5) Undo the $t^{2}$-stretching to get $u(v, \tau)$; this is the desired result, namely the velocity-stack gather with reduced amplitude smearing, which is a special form of the discrete Radon transform of $d(h, t)$

(6) The inverse mapping back to the offset domain to get the modeled CMP gather is done using equation ( $\mathrm{F}-11 \mathrm{~b}$ ).

An important practical question is the sampling along the velocity axis in the transform domain. Specifically, in equation (F-19), one may consider sampling in terms of $\Delta v$ or $1 / \Delta v^{2}$. This will affect the quality of the velocity stack gather and the reconstructed gather. When $1 / \Delta v^{2}$ sampling is used, the structure of the $\mathrm{L}$ matrix in equation (F-19) becomes Toeplitz (Kostov, 1990). Hence, one can use Levinson recursion to solve equation (F-20) and thus obtain the Radon transform $u$.

Figure F-7 shows a comparison of the performance of the various solutions to equation (F-20). The input is a synthetic CMP gather with band-limited noise. The velocity-stack gather was computed using the SVD approach described here with $\Delta v$ and $1 / \Delta v^{2}$ sampling criteria

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1003.jpg?height=1003&width=775&top_left_y=128&top_left_x=135)

FIG. F-7. Solutions to equation (F-20) using SVD and Toeplitz procedures with two different sampling criteria $\Delta v$ and $1 / \Delta v^{2}$. (a) A synthetic CMP gather as in Figure $64-2 c$ with band-limited noise; (b), (c) and (d) the velocity-stack gathers using three combinations of sampling and procedure as indicated on top of each panel, and (e), (f) and (g) reconstructed gathers from (b), (c) and (d), respectively.
and the Toeplitz solution with the $1 / \Delta v^{2}$ sampling criterion. Figure F-7 also shows the reconstructed gathers using equation (F-11b). Results indicate that the SVD approach with the $\Delta v$ sampling criterion best preserves the amplitudes at all offsets. The $1 / \Delta v^{2}$ sampling causes loss of amplitudes at near offsets.

We now set up the least-squares problem to perform the discrete parabolic Radon transform (Hampson, 1986, 1987). As an alternative to stretching in the time direction as defined by equation (F-12b) to comply with the linear form of the Radon transform (equation F-1la), consider the application of normal moveout correction to input CMP data (equation F-12a) using a velocity function $v_{n}$ :

$$
t_{n}=\sqrt{t^{2}-\frac{4 h^{2}}{v_{n}^{2}}}
$$

such that hyperbolic events in the original gather $d(h, t)$ can be approximately represented by parabolic events with the traveltime equation

$$
t_{n}=\tau+q h^{2}
$$

where $t_{n}$ is the time after NMO corection, $v_{n}$ is the hyperbolic moveout correction velocity function, $\tau$ is the two-way zero-ofset time, and $q$ is the parameter that defines the curvature of the parabolic trajectory described by equation ( $\mathbf{F}-26$ ).

In the coordinates of the NMO-corrected gather $d\left(h, t_{n}\right)$, equations (F-11a, b) take the forms

$$
u(g, \tau)=\sum_{h} d\left(h, t_{n}=\tau+q h^{2}\right)
$$

and

$$
d^{\prime}\left(h, t_{n}\right)=\sum_{q} u\left(q, \tau=t_{n}-q h^{2}\right)
$$

We want to find an estimate of $\mathbf{u}$ such that when inverse transformed, the difference between the modeled moveout-corrected CMP gather $d^{\prime}\left(h_{1}, t_{n}\right)$ and the original moveout-corrected CMP gather $d\left(h, t_{n}\right)$, which is the desired output, is minimum in the least-squares sense.

A practical estimation of $u$ based on the least-squares scheme can be achieved, again, by first Fourier transforming equation (F-26b) as

$$
d^{\prime}\left(h, \omega_{n}\right)=\sum_{q} u\left(q, \omega_{n}\right) \exp \left(-w_{n} g h^{2}\right)
$$

where $\omega_{n}$ is the Fourier dual of $t_{n}$. For each $\omega_{n}$ component of $d^{\prime}\left(h, \omega_{n}\right)$ and $u\left(q, \omega_{n}\right)$, equation (F-28) can be written in the matrix form of equation (F-14), where $\mathbf{L}$ is a complex matrix of the form:

$$
\mathrm{L}=\left(\begin{array}{cccc}
e^{-\mho \omega_{n} q_{1} h_{1}^{2}} & e^{-\mho \omega_{r} q_{2} h_{1}^{2}} & \ldots & e^{-\omega_{n} q_{n} h_{1}^{2}} \\
e^{-2 \omega_{n} q_{2} h_{2}^{2}} & e^{-\imath \omega_{n} q_{2} h_{2}^{2}} & \cdots & e^{-\omega_{n} q_{n} h_{2}^{2}} \\
\vdots & \vdots & \ddots & \vdots \\
e^{-\imath \omega_{4} q_{1} h_{m}^{2}} & e^{-\imath \omega_{n} q_{2} h_{t n}^{2}} & \cdots & e^{-\tau \omega_{n} \psi_{n} h_{m n}^{2}}
\end{array}\right)
$$

with dimensions $m \times n=n_{h} \times n_{q}$, where $n_{h}$ is the number of offsets, and $n_{q}$ is the number of $q$ parameters for which the Radon transform $u(q, \tau)$ is to be estimated. As for the hyperbolic Radon transform (equation F-19), note that the elements of the $L$ matrix depend only on the geometry of the input CMP gather.

Aside from the $\mathbf{L}$ matrix, for each frequency component $\omega_{n}$, define the vectors for the input gather $\mathbf{d}: d(h, t)$, the unknown transform $\mathbf{u}: u(q, \tau)$, and the modeled CMP gather $\mathrm{d}^{\prime}: d^{\prime}(h, t)$, As for equation ( $F-18$ ), for each frequency component $\omega_{n}$, equation ( $\left.F-28\right)$ is written in the matrix form of equation (F-14), where $L$ is the complex matrix given by equation (F-29). Using this new form of the $L$ matrix, follow the same procedure starting with equation (F-20) to obtain the solution expressed by equation (F-23).

Finally, we set up the least-squares problem to perform the discrete linear Radon transform. The transform variable $r$ of the function $\phi(r, h)$ in equation (F-11a) represents the ray parameter $p$. The relationship between $(h, t)$ and $(p, \tau)$ coordinates is given by the parabolic moveout equation

$$
t=\tau+2 p h
$$

The transformation of the CMP data from the offset domain to the ray-parameter domain is achieved by applying linear moveout correction and summing over offset

$$
u(p, \tau)=\sum_{h} d(h, t=\tau+2 p h)
$$

where $t$ is the two-way traveltime, $\tau$ is the intercept time at $p=0$, and $h$ is the half-ofset. The inverse transform from the ray-parameter domain back to the offset domain is achieved by inverse linear moveout correction and summing over velocity

$$
d^{\prime}(h, t)=\sum_{p} u(v, \tau=t-2 p h)
$$

We want to estimate $\mathbf{u}: u(p, \tau)$ such that when inverse transformed back to the offset domain, the difference between the modeled CMP gather $\mathbf{d}^{\prime}: d^{\prime}(h, t)$ and the original CMP gather $\mathbf{d}: d(h, t)$ is minimum in the least-squares sense.

A practical estimation of $\mathbf{u}$ based on the least-squares scheme can be achieved, once again, by first Fourier transforming equation (F-31b) as

$$
d^{\prime}(h, \omega)=\sum_{p} u(p, \omega) \exp (-i \omega 2 p h)
$$

For each $\omega$ component of $d^{\prime}(h, \omega)$ and $u(p, \omega)$, equation (F-32) can be written in the matrix form of equation ( $F-14$ ), where $L$ is a complex matrix of the form

$$
\mathbf{L}=\left(\begin{array}{cccc}
e^{-v \omega 2 p_{1} h_{t}} & e^{-\omega \omega 2 p_{2} h_{1}} & \cdots & e^{-v \omega 2 p_{1} h_{1}} \\
e^{-v \omega 2 p_{1} h_{2}} & e^{-\omega 22 p_{2} h_{2}} & \cdots & e^{-\omega \omega 2 p_{2} h_{2}} \\
\vdots & \vdots & \ddots & \vdots \\
e^{-\imath \omega 2 p_{1} h_{m}} & e^{-\tau \omega 2 p_{2} h_{m}} & \cdots & e^{-i \omega 2 p_{n} h_{m}}
\end{array}\right)
$$

with dimensions $m \times n=n_{h} \times n_{p}$, where $n_{h}$ is the number of offsets, and $n_{p}$ is the number of ray parameters $p$ for which the Radon transform $u(p, \tau)$ is to be estimated. As for the hyperbolic and parabolic cases, the elements of the $\mathbf{L}$ matrix depend only on the geometry of the input CMP gather.

Aside from the $\mathbf{L}$ matrix, for each frequency component $\omega$, define the vectors for the input gather $\mathbf{d}: d(h, t)$, the unknown transform $\mathbf{u}: u(p, \tau)$, and the modeled CMP gather $\mathbf{d}^{\prime}: d^{\prime}(h, t)$. As for the hyperbolic and parabolic cases, for each frequency component $w$, equation ( $\mathrm{F}-32$ ) is written in the matrix form of equation ( $F$-14), where $\mathbf{L}$ is the complex matrix given by cquation (F-33). Using this new form of the $L$ matrix, follow the same procedure starting with equation (F-20) to obtain the solution expressed by equation (F-23).

Figure F-8 shows a CMP gather and the modeled CMP gathers computed by inverse transforming the velocity-stack and slant-stack gathers that were themselves estimated using the respective discrete Radon transforms. The reconstruction based on the velocity-stack gather restores that component of the original gather associated with the hyperbolic events. The reconstruction based on the slant-stack transformation, when implemented as a special form of the discrete Radon transform, restores virtually all of the data characteristics of the original gather.

There exists an affinity between slant-stack transformation (Section 6.3) and the discrete linear Radon transform discussed here. To compute the slant-stack gather, recall from Section (6.3) that we applied linear moveout to input data and summed over the offset axis (equation 6-5). That operation is equivalent to applying the $\mathrm{L}^{\mathbf{T *}}$ matrix on the input vector $d$ in equation (F-23). We then applied the rho filter to compensate for the attenuation of high frequencies

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1006.jpg?height=644&width=266&top_left_y=129&top_left_x=146)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1006.jpg?height=638&width=244&top_left_y=136&top_left_x=408)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1006.jpg?height=642&width=246&top_left_y=130&top_left_x=644)

c

FIG. F-8. (a) A CMP gather; (b) reconstructed CMP gather by way of velocity-stack transformation; (c) reconstructed CMP gather by way of slant-stack transformation. Both velocity-stack and slant-stack transforms are special forms of the discrete Radon transform.

during the summation over the offset axis. Applying the rho filter is to some extent equivalent to applying the additional matrix operator $\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}\right)^{-\mathbf{1}}$ of equation (F-20). Actually this 2-D operator does more than what the 1-D rho filter does it accounts for the discrete sampling along the spatial axis and the finite cable length. Nevertheless, in practice, it turns out that just applying the rho filter in lieu of applying this computationally more involved operator yields a reasonably accurate slant-stack gather.

## F. 4 Free-Surface Multiple Attenuation

Refer to the raypath configurations for the various types of multiples depicted in Figure 6.0-18. Mast significant multiples involve one or more bounces from the free surface. Figure 6.0-18a shows the first- and second-order water-bottom multiples, and Figure $6.0-18 \mathrm{~b}$ shows the firstand second-order free-surface multiples associated with a deeper reflector. Figure 6.0-18c shows the peg-leg multiples associated with a primary reflection and intrabed multiple reflection, and Figure 6.0-18d shows the first- and second-order intrabed multiple reflections. Finally, Figure 6.0-18e shows the first- and second-order interbed multiple reflections.

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1007.jpg?height=254&width=341&top_left_y=188&top_left_x=156)

(a)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1007.jpg?height=229&width=338&top_left_y=211&top_left_x=540)

(b)

FIG. F-9. (a) Marine recording geometry, (b) Noah's geometry, $S$ is the vertically downgoing source wavefield, $X$ is the recorded upcoming wavefield with and $Y$ is the wavefield without free-surface multiples. All wavefields are assumed to be plane waves. (Adapted from Riley and Claerbout, 1976.)

Shown in Figure 6.0-18 are but a limited subset of a countless group of multiples that are normally present in recorded marine data. Rather than attempting to attenuate all multiples, it makes sense to develop a technique aimed at attenuating the most significant set of multiples those associated with the free surface. Riley and Clierbout (1976) developed an elegant theory for free-surface multiple attenuation applicable to 1-D seismograms. They also extended their ideas to 2-D recorded data to attenuate diffracted multiples. The free-surface multiple attenuation theory by Riley and Claerbout (1976) was reworked and widely publicized later by Kennett (1979), Verschuur (1991), Verschuur et al. (1992), Carvalho et al. (1991), Dragoset and McKay (1993), Verschuur and Berkhout (1994), and Berkhout and Verschuur (1995). Applications to field data were reported by Dragoset and McKay (1993), Verschuur et al. (1995), Kelamis and Verschuur (1996), and Dragoset and Jericevic (1998). Here, we shall develop the theory of freesurface multiple attenuation based on the work by Riley and Clacrbout (1976), then review the work by Verschuur et al. (1992).

Consider the 1-D earth model in Figure F-9a and recording using a source represented by a vertically downward traveling plane wave $W$. If the free surface were removed from the earth model (Figure F-9b), then the associated multiples would also be removed from the recorded 1-D seismogram. The hypothetical recording geometry that facilitates removal of the free surface is called Noah's geometry by Riley and Claerbout (1976), and the technique to remove the freesufface multiples based on Noah's geometry is called Noah's deconvolution. Note that in Noah's geometry the recording cable now is being towed by a submarine rather than a surface vessel since the water level has risen as a result of the flood.

Whether you record with Noah's geometry (Figure F-9b) or the actual geometry at the same datum level (Figure F-9a), the earth's response $E(z)$ to the same source $S(z)$ defined in the $z$-transform domain should be the same. The earth's response $E(z)$ can be described by the ratio of the upcoming waves $U(z)$ to the downgoing waves $D(z)$ :

$$
E(z)=\frac{U(z)}{D(z)}
$$

From Figure (F-9a), the upcoming wave is $U(z)=-X(z)$, the recorded seismogram, and the downgoing wave is $D(z)=S(z)+X(z)$. Here, we assume that the reflection coefficient of the free surface is -1 . From Figure F-9b, the upcoming wave is $U(z)=-Y(z)$, the seismogram that
is free of surface multiples, and the downgoing wave is $D(z)=S(z)$. Hence, the earth's responsc $E(z)$ defined by equation (F-34a) for the geometry of Figure F-9a is

$$
E(z)=-\frac{X(z)}{S(z)+X(z)}
$$

and for the geometry of Figure (F-9b) is

$$
E(z)=-\frac{Y(z)}{S(z)}
$$

Combine equations ( $\mathrm{F}-34 \mathrm{~b}, \mathrm{c})$ to obtain

$$
\frac{Y(z)}{S(z)}=\frac{X(z)}{S(z\}+X(z)}
$$

Assume that the source waveform is minimum phase (Section 2.2) and define its inverse $F(z)=S^{-1}(z)$. Then, solve equation (F-35) for the seismogram $Y(z)$ free of surface multiples as

$$
Y(z)=\frac{X(z)}{1+F(z) X(z)}
$$

Equation (F-38) is the besis for Noah's deconvolution described by Riley and Claerbout (1976). A practical perspective on the use of equation (F-36) is gained by the series expansion of the right-hand side:

$$
Y(z)=X(z)\left[1-F(z) X(z)+F^{2}(z) X^{2}(z)-\cdots\right]
$$

where it is assumed that $F(z) X(z) \ll 1$.

Equation $(F-37)$ can be put into the convolutional form

$$
y(t)=x(t)-x(t) *[f(t) * x(t)]+x(t) *[f(t) * x(t)] *[f(t) * x(t)]-\cdots .
$$

An iterative scheme to estimate the seismogram $y(t)$ free of surface multiples can be devised based on equation (F-38). First, write the following recursive relation:

$$
y_{t+1}(t)=x(t)-x(t) *\left[f(t) * y_{i}(t)\right], \quad i=0,1,2, \ldots
$$

where $y_{0}(t)=x(t)$.

The recursive relation described by equation ( $\mathrm{F}-39$ ) yields the truncated form of the series on the right-hand side of equation (F-38). To see this, set $i=0$ in equation (F-39):

$$
y_{1}(t)=x(t)-x(t) *[f(t) * x(t)], \quad(F-40 a)
$$

which corresponds to the first two terms of the series in cquation (F-39). Next, set $i=1$ in equation (F-39) and substitute equation (F-40a) for $y_{1}$ to get

$$
y_{2}(t)=x(t)-x(t) *[f(t) * x(t)]+x(t) *[f(t) * x(t)] *[(f(t) * x(t)],
$$

which corresponds to the first three terms in equation (F-38).

Thus, by recursive application of equation (F-39) for a specified number of iterations, an estimate of the seismogram $y(t) \approx U_{i+1}(t)$ that is free of most of the surface-related multiples can be obtained. Specifically, equation (F*39) states that the output $y_{l+1}(t)$ of the next iteration is the difference between the input trace $x(t)$ and the input trace convolved with the inverse of the source wavelet $f(t)$ convolved with the output of the previous iteration $y_{2}(t)$. The number of iterations in practice often is no more than three.

While the recursive scheme described here based on the work by Riley and Claerbout (1976) is designed for a zero-offset seismogram $x(t)$ associated with a 1-D earth model, the theory has been extended to handle nonzero-offet data associated with a 2-D earth model by the same authors, and subsequently by Verschuur (1991), Verschuur and Berkhout (1994), and Dragoset and McKay (1993). In fact, the recursive relation given by equation (F-39), with a group of shot records as input, is the same as the update formula given by Verschuur and Berkhout (1994).

To attenuate fre-surface multiples caused by reflectors with complex geometry, in theory, you need all of the shot records along the seismic line as one single input to equation ( $\mathrm{F}-39$ ) (Dragoset and McKay, 1993). In practice, however, assumptions are made about the subsurface complexity to be able to use individual CMP gathers as input (Kelamis and Verschuur, 1996). Also, assuming that spiking deconvolution has been applied to the input CMP gather prior to free-surface multiple attenuation, the inverse of the source wavelet $f(t)$ in cquation (F-39) may be set to a unit spike at $t=0$. Then, it follows that

$$
P_{\mathrm{t}+1}(h, t)=P_{0}(h, t)-P_{0}(h, t) * P_{2}(h, t),
$$

where $P_{0}(h, t)$ is the input CMP gather and $P_{t}(h, t)$ is the gather after fresurface multiple attenuation, and $h$ and $t$ are the offset and time variables, respectively.

The recursion described by equation (F-41) requires 2-D convolution of the input gather $P_{0}(h, t)$ with the result of the previous iteration $P_{1}(h, t)$. For computational efficiency, the recursion can be performed in the space-frequency $(h-\omega)$ domain

$$
P_{\imath+1}(h, \omega)=P_{0}(h, \omega)-P_{0}(h, \omega) P_{4}(h, \omega)
$$

where $P_{0}(h, \omega)$ is the input CMP gather and $P_{t}(h, \omega)$ is the gather after free-surface multiple attenuation, both in the $h-\omega$ domain.

In practice, there are two issues that hinder the effectiveness of the free-surface multiple attenuation technique discussed here. First is the problem of an accurate estimate of the source wavelet $s(t)$. Actually, it is the inverse of the source wavelet $f(t)$ that is needed in the recursive relation described by equation (F-39). Deterministically, the source wavelet may be assumed equivalent to the recorded far-field signature (Section 2.5). Statistically, it may be assumed to be the minimum-phase inverse of the spiking deconvolution operator (Section 2.2). It is this latter viewpoint that is often taken in practice. As such, the input to the recursive estimate of the surface-related multiples in equation (F-41) is the CMP gather with spiking deconvolution.

The second issue is the missing near offsets. Attenuation of free-surface multiples using the recursive relation of equation (F-41) involves predicting multiples from the primaries. The free-surface multiples generated by a primary reflection that occurs within the near-offset range that is not recorded then are not attenuated. In fact, the problem of missing near-offset data has the most significant detrimental impact on the ability of the technique to attenuate all possible surface-related multiples (Dragoset and Jericevic, 1998). The Radon transform provides a theoretically appealing way to estimate the unrecorded near offsets (Section 6.4).

Figure F-10 shows a field data example of free-surface multiple attenuation. The frec-surface multiples in the shot record (Figure F-10a) include the water-bottom multiples and the peg-leg multiples associated with the top-salt and base-salt reflections. The same record after freesurface multiple attenuation (Figure F-10b) exhibits some residual of these multiples, primarily because of the practical issues discussed above. The free-surface multiples hesivily contaminate the subsalt refections (Figure F-10c). After multiple attenuation, the subsalt region is largely free of surface-related multiples.

## F. 5 Water-Bottom Multiple Attenuation

A subset of surface-related multiples is water-bottom multiples. Based on the work by Morley (1982), Wiggins (1988) formulated a technique to attenuate water-bottom multiples associated with a complex water-bottom geometry. As for the free-surface multiple attenuation technique, this method also predicts multiples from the primaries contained in the recorded data within the cable length. To develop the conceptual basis, here, we shall review the technique for the special case of fat water bottom.

Refer to the raypath configuration in Figure F-11. Assume a horizontally layered earth model and treat a CMP gather a single wavefield equivalent to a shot record. The downgoing wavefield $D\left(h, z_{W}, \omega\right)$ at the water bottom is given by

$$
D\left(h, z_{W}, \omega\right)=P_{0}\left(h, z_{R}, \omega\right) \exp \left[i k_{z}\left(z_{W}+z_{R}\right)\right]
$$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1010.jpg?height=442&width=226&top_left_y=128&top_left_x=294)

a

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1010.jpg?height=434&width=213&top_left_y=135&top_left_x=528)

b

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1010.jpg?height=262&width=449&top_left_y=591&top_left_x=294)

$\mathbf{C}$

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1010.jpg?height=273&width=449&top_left_y=866&top_left_x=294)

d

FIG. F-10. (a) A shot record with strong water-bottom multiples, (b) the saue record after waterbottom multiple attenuation, (c) a portion of the stacked section associated with the data ss in (a) that exhibits surface-related multiples, (d) a portion of the stacked section associated with the data as in (b) after free-surfice multiple attenuation. (Dragoset and McKay, 1993.)

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1011.jpg?height=302&width=388&top_left_y=123&top_left_x=323)

FIG. F-11. Raypath geometry associated with up- and downgoing waves at the water bottorn.

where $P_{0}\left(h, z_{R}, \omega\right)$ is the CMP gather that represents the recorded wavefield at the receiver depth $z_{R}, h$ is the offset variable, $z_{W}$ is the water depth, $\omega$ is the temporal frequency and $k_{z}$ is the vertical wavenumber. The upcoming wavefield $U\left(h, z_{w}, \omega\right)$ at the water bottom is given by

$$
U\left(h, z_{W}, \omega\right)=P_{0}\left(h, z_{R}, \omega\right) \exp \left[-i k_{z}\left(z_{W}-z_{R}\right)\right]
$$

In equations ( $\mathrm{F}-43$ ) and ( $\mathrm{F}-44$ ), the sign convention defined in Section D. 1 for wavefield extrapolation is used.

The CMP gather $P_{p}\left(h, z_{W}, \omega\right)$ free of water-bottom multiples defined at the water bottom is given by (Wiggins, 1988)

$$
P_{p}\left(h, z_{W}, \omega\right)=U\left(h, z_{W}, \omega\right)-r_{W}(\omega) D\left(h, z_{W}, \omega\right)
$$

where $r_{w}(\omega)$ is the water-bottom reflectivity.

Substitute equations (F-43) and (F-44) into equation (F-45) and simplify to get

$$
P_{p}\left(h, z_{W}, \omega\right)=P_{0}\left(h, z_{R}, \omega\right)\left\{\exp \left[-i k_{z}\left(z_{W}-z_{R}\right)\right]-r_{W}(\omega) \exp \left[i k_{z}\left(z_{W}+z_{R}\right)\right]\right\}
$$

The CMP gather $P_{p}\left(h, z_{R}, \omega\right)$ free of water-bottom multiples defined at the receiver depth is computed by extrapolating the CMP gather $P_{p}\left(h, z_{W}, \omega\right)$ defined at the water bottom:

$$
P_{p}\left(h, z_{R}, \omega\right)=P_{p}\left(h, z_{W}, \omega\right) \exp \left[i k_{x}\left(z_{W}-z_{R}\right)\right]
$$

Now substitute equation (F-46) into (F-47) and simplify to get

$$
P_{p}\left(h, z_{R}, \omega\right)=P_{0}\left(h, z_{R}, \omega\right)\left[1-r_{W}(\omega) \exp \left(i k_{z} 2 z w\right)\right] .
$$

Finally, rewrite this equation as

$$
P_{p}(h, \omega)=P_{0}(h, \omega)-r_{W}(\omega) P_{0}(h, \omega) \exp \left(i k_{z} 2 z_{W}\right),
$$

where $z_{R}$ has been omitted for simplicity. Equation ( $\left.\mathrm{F}-49\right)$ states that the gather $P_{p}(h, \omega)$ with water-bottom multiple attenuation is computed by taking the difference of the input gather $P_{0}(h, \omega)$ and the input gather scaled by the water-bottom reflectivity $r_{w}(\omega)$ and upward extrapolated by a depth interval twice the water depth $z_{W}$.

Equation (F-49) applies to data for which CMP assumptions are acceptable. For complex water-bottom multiples, the horizontal layer assumption no longer holds and therefore input data must be the entire set of shot records along the seismic line (Wiggins, 1988). As for freesurface multiple attenuation, however, computational efficiency in practice usually mandates use of individual CMP gathers in equation ( $\mathrm{F}-49$ ).

In practice, there are several limitations of the water-bottom multiple attenuation technique discussed here. First is the problem of an accurate estimate of the water-bottom reflectivity
$r_{W}(\omega)$ that is needed in equation (F-49). While attempts have been made to obtain an accurate and stable estimate of the water-bottom reflectivity (Wiggins, 1988), the problem remains as a major obstacle to the success of the technique in practice.

Additional issues arise in relation to spatial aliasing of the CMP data and missing nearofiset data. As for the free-surface multiple attenuation, these problems may be circumvented by trace interpolation and extrapolation to zero offset using the Radon transform.

Perhaps the most serious limitation of the technique is the computational requirements to handle complex water-bottom geometry. In that case, the prediction and subtraction of multiples cannot be performed by the use of equation (F-49) based on phase-shift extrapolation. Instead, equation (F-45) needs to be employed wherein wave extrapolation has to be performed using the Kirchhoff integral to handle the irregular water-bottom geometry (Section 8.1). The waterbottom geometry itself can be determined by migrating the stacked section using the constantvelocity Stolt migration (Section 4.1) and converting the picked time horizon associated with the water-bottom reflection to depth as for the layer replacement (Section 8.1).

Figure F-12 shows a field data example of atfenuation of complex water-bottom multiples (Wiggins, 1988). The shot record in Figure F-12a exhibits strong multiples associated with a dipping water bottom. After the application of the technique based on equation (F-49), waterbottom multiples have been largely attenuated as shown in Figure F-12b. The stacked section shown in Figure F-12c associated with the shot record as in Figure F-12a contains complex waterbottom multiples. Any remaining multiples after multiple attenuation (Figure F-12d) may be attributed to the limitations in an accurate estimate of the water-bottom reflectivity and the adverse effect of the missing near-offset data.

## F. 6 Spatial Prediction Filter

Consider a CMP-stacked data set $P(x, t)$, where $x$ is the CMP axis and $t$ is the two-way zerooffset time axis. Apply Fourier transform in the $t$ direction to decompose this 2-D data set to its frequency components $P(x, \omega)$. For exch frequency component, define a complex vector $\mathbf{P}: P(x, \omega)$ in the $x$ direction.

We want to design a comples Wiener prediction filter $\mathbf{F}: F(x)$, such that, when applied to the input data vector $P: P(x, \omega)$, it yields an estimate of the input vector $D: P(x+\alpha, \omega)$, at $x+\alpha$, where $\mathrm{D}$ is the desired output vector and $\alpha$ is the prediction lag. For the specifie problem of attenuating random noise uncorrelated from trace to trace, we shall consider the unit prediction $\operatorname{lag} \alpha=1$. The output of the spatial prediction filtering is the predictable component of the input data vector that can be treated as the coherent signal, and the error in the prediction process is the random noise contained in the input data (Canales, 1984).

The prediction filtering is expressed by the following convolutional relation:

$$
Y(x)=P(x, \omega) * F(x)
$$

where $Y(x)$ represents the actual output from prediction filtering. We want to compute a complex prediction filter $F(x)$ such that the difference $E(x)$ between the actual output $Y(x)$ and the desired output $D(x)$ is minimum in the least-squares sense. Consider the discrete form of equatjon (F-50), with $F(x)$ represented by the $m$-length complex vector $\mathbf{F}:\left(F_{0}, F_{1}, F_{2}, \ldots, F_{m-1}\right)$, $P(x, \omega)$ represented by the $n$-length complex vector $\mathbf{P}:\left(P_{0}, P_{1}, P_{2}, \ldots, P_{n-1}\right)$, and $Y(x)$ represented by the $(m+n-1)$-length complex vector $\mathbf{Y}:\left(Y_{0}, Y_{1}, Y_{2}, \ldots, Y_{m+n-1}\right)$. Equation $(F-50)$ can then be expressed in the following matrix form:

![](https://cdn.mathpix.com/cropped/2024_02_09_fd32ae496384d7801791g-1013.jpg?height=1002&width=597&top_left_y=130&top_left_x=196)

FIG. F-12. (a) A shot record with strong water-botlom multiples, (b) the same record after waterbottom multiple attenuation, (c) a portion of the stacked section associnted with the data as in (a) that exhibits complex water-bottom multiples, (d) a portion of the stacked section associated with the data as in (b) after water-bottom multiple attenuation. (Wiggins, 1988.)

$$
\left(\begin{array}{c}
Y_{0} \\
Y_{1} \\
Y_{2} \\
\vdots \\
Y_{m+n-1}
\end{array}\right)=\left(\begin{array}{cccc}
P_{0} & 0 & \cdots & 0 \\
P_{1} & P_{0} & \cdots & 0 \\
P_{2} & P_{1} & P_{0} & \vdots \\
\vdots & P_{2} & P_{1} & P_{0} \\
P_{m-1} & \vdots & P_{2} & P_{1} \\
0 & P_{m-1} & \vdots & P_{2} \\
\vdots & \cdots & P_{m-1} & \vdots \\
0 & 0 & \cdots & P_{m-1}
\end{array}\right)\left(\begin{array}{c}
F_{0} \\
F_{1} \\
F_{2} \\
\vdots \\
F_{n-1}
\end{array}\right)
$$

This is the equation for complete transient convolution. Define the $(m+n-1) \times(m+n-1)$ coefficient matrix on the right-hand side by L. Equation (F-51) takes the compact form

$$
\mathbf{Y}=\mathbf{L F}
$$

The error vector $\mathbf{E}:\left(E_{0}, E_{1}, E_{2}, \ldots, E_{m+n-1}\right)$ is defined as the difference betwoen the desired output $\mathbf{D}:\left(D_{0}, D_{1}, D_{2}, \ldots, D_{m+r-1}\right)$ and the actual output $\mathbf{Y}:\left(Y_{0}, Y_{1}, Y_{2}, \ldots, Y_{m+n-1}\right)$ :

$$
\mathbf{E}=\mathbf{D}-\mathbf{Y}
$$

By substituting equation (F-52) into equation (F-53), we obtain

$$
\mathbf{E}=\mathrm{D}-\mathrm{L} \mathbf{F}
$$

The energy of the error vector is

$$
S=\mathbf{E}^{\mathbf{T} *} \mathbf{E}
$$

where $T$ denotes matrix transpose and * denotes complex conjugate. Now, substitution of equation ( $F-54$ ) into the definition defined by equation ( $F-55$ ) yields:

$$
S=(\mathbf{D}-\mathbf{L F})^{\mathbf{T} *}(\mathbf{D}-\mathbf{L F})
$$

Expand the right-hand side:

$$
S=\mathrm{D}^{\mathbf{T} *} \mathbf{D}-\mathbf{F}^{\mathbf{T} *} \mathbf{L}^{\mathbf{T} *} \mathbf{D}-\mathbf{D}^{\mathbf{T} *} \mathbf{L} \mathbf{F}+\mathbf{F}^{\mathbf{T} *} \mathbf{L}^{\mathbf{T} *} \mathbf{L} \mathbf{F} .
$$

We want to estimate a prediction filter vector $\mathbf{F}$ such that the quantity $S$ is minimum. This condition leads to setting the derivative of $S$ with respect to $\mathbf{F}$ to zero. Differentiate both sides of equation (F-57) with respect to $\mathbf{F}$ and observe the requirement for least-squares minimization that $\partial S / \partial \mathbf{F}=0$

$$
-\mathrm{D}^{\mathbf{T} *} \mathbf{L}+\mathbf{F}^{\mathbf{T} *} \mathbf{L}^{\mathbf{T} *} \mathbf{L}=\mathbf{0}
$$

Apply matrix transpose and rearrange the terms:

$$
\left(\mathrm{L}^{\mathbf{T} *} \mathrm{~L}\right)^{\mathbf{T} *} \mathbf{F}=\mathbf{L}^{\mathbf{T} *} \mathbf{D}
$$

Now define

$$
\mathrm{G}=\mathrm{L}^{\mathbf{T} * \mathrm{D}}
$$

and

$$
\mathbf{R}=\mathbf{L}^{\mathbf{T} *} \mathbf{L}_{1}
$$

which yields the relation

$$
\mathbf{R}^{\mathbf{T} *}=\mathbf{R} \text {. }
$$

thus making $\mathbf{R}$ a Hermitian matrix of the size $(m+n-1) \times(m+n-1)$.

Use the relations given by equations ( $F-60 a, b, c)$, to rewrite equation ( $F-58$ ) in the form

$$
\mathbf{R F}=\mathbf{G}
$$

which can be rewritten by using equations ( $\mathrm{F}-60 \mathrm{a}, \mathrm{b}$ ) as follows:

$$
\mathbf{F}=\left(\mathbf{L}^{\mathbf{T} *} \mathbf{L}\right)^{-1} \mathbf{L}^{\mathbf{T} *} \mathbf{D}
$$

This solution is of the same form as the generalized linear inverse form of the discrete Radon transform represented by equation (F-20). As for the latter application, singular-value decomposition technique based on equation (F-23) can be used to solve for the complex Wiener filter coefficients $\mathbf{F}:\left(F_{0}, F_{1}, F_{2}, \ldots, F_{m-1}\right)$.

An efficient recursive algorithm to solve for the complex Wiener prediction filter coefficients F in equation ( $F-61$ ) is described by Treitel (1974). The technique makes use of the Hermitian property (equation F-60c) of the autocorrelation matrix R. Write this matrix in terms of its real $\mathbf{R}_{T}$ and imaginary $\mathbf{R}_{r}$ components as

$$
\mathbf{R}=\mathbf{R}_{\tau}+\imath \mathbf{R}_{\imath}
$$

Similarly, write the complex Wiener filter $\mathbf{F}$ and the crosscorrelation matrix $\mathbf{G}$ in the same form:

$$
\mathbf{F}=\mathbf{F}_{r}+\imath \mathbf{F}_{\imath}
$$

and

$$
\mathbf{G}=\mathbf{G}_{r}+i \mathbf{G}_{2}
$$

Substitute equations ( $F-63 a, b, c$ ) into equation (F-61) and equate the real and imaginary parts of boths sides of the resulting expression to get

$$
\mathbf{R}_{r} \mathbf{F}_{r}-\mathbf{R}_{r} \mathbf{F}_{s}=\mathbf{G}_{r}
$$

and

$$
\mathbf{R}_{1} \mathbf{F}_{r}+\mathbf{R}_{r} \mathbf{F}_{2}=\mathbf{G}_{2}
$$

Finally, write equations $(\mathrm{F}-6 \mathbf{4} \mathbf{a}, \mathbf{b})$ in matrix form:

$$
\left(\begin{array}{cc}
\mathbf{R}_{r} & -\mathbf{R}_{\imath} \\
\mathbf{R}_{r} & \mathbf{R}_{r}
\end{array}\right)\left(\begin{array}{l}
\mathbf{F}_{r} \\
\mathbf{F}_{i}
\end{array}\right)=\left(\begin{array}{l}
\mathbf{G}_{r} \\
\mathbf{G}_{i}
\end{array}\right)
$$

The square matrix on the left-hand side of this equation is a block Toeplitz matrix (Robinson, 1967; Robinson and Treitel, 1980). This property leads to an efficient recursive algorithm that does not require complex arithmetic to solve for the complex prediction filter coefficients F (Treitel, 1974).

## REFERENCES

Alam, A. and Austin, J., 1981, Multiple attenuation using slent stacks: Tech. Rep., Western Gcophysical Company.

Alara, A. and Lasocki, L., 1981, Slant stack and applications: Presented at the 41st Ann. Eur. Assoc. Expl. Geophys. Mtg.

Al-Yahya, K., 1991, Application of the partial Karhunen-Loeve transform to suppress random noise in seismic sections: Geophys. Prosp., 39, 77-93.

Berkhout, A. J. and Verschuur, E. J., 1995, Estimation of multiple scattering by iterative inversion, Part 1: Theoretical considerations: 55th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 715-718,

Beylkin, G., 1987, Discrete Radon transform: IEEE Trans. on Acoustics, Speech and Signal Processing, AASP-35, 162-172

Canales, L., 1984, Random noise reduction: 54th Ann. Internat. Mtg., Soc. Expl. Geophys, Expanded Abstracts, 525.

Claerbout, J. F., 1978, Snell waves: Stanford Exploration Project Report No. 15, 57-72, Stanford University.

Claerbout, J. F., 1985, Imaging the earth's interior: Blackwell Scientific Publications.

Clayton, R. W. and McMechan, G., 1981, Inversion of refraction data by wave-ficid extrapolation: Geophysics, 46, 860-868.

Carvalho, P. M., Weglein, A. B. and Stolt, R. H., 1991, Examples of a nonlinear inversion method based on the $T$ matrix of scattering theory: Application to multiple suppression: 61 st Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1319-1322.

Diebold, J. B. and Stoffa, P. L., 1981, The traveltime equation, $\tau-p$ mapping and inversion of common midpoint data: Geophysics, 46, 238-254.

Doicin, D. and Spitz, S., 1991, Multichannel extraction of water-bottom peg-legs pertaining to gihg-amplitude reflection: 61st Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1439-1442.

Dragoset, W. H. and Jericevic, Z., 1998, Some remarks on surface multiple elimination: Geophysics, 63,7 T2-789.

Dragoset, W. H. and Mackay, S., 1993, Surface multiple elimination and subsalt inaging: Expl. Geophys., 24, 463-472.

Ewing, M., Jardetsky, W. S., and Press, F., 1957, Elastic waves in layered media: McGraw-Hill Book Co.

Foster, D. J. and Mosher, C. C., 1992, Suppression of multiple reflections using the Radon transform: geophysics, $\mathbf{5 7}$, 386-395.

Gonzalez-Serrano, A., 1982, Wave-equation velocity analysis; Ph.D. thesis, Stanford University.

Hampson, D., 1986, Inverso velocity stacking for multiple elimination. J. Can. Soc. Expl. Geophys., 22, 44-55.

Hampson, D.1 1987, The discrete Radon transform: A new tool for mage enhancement and noise suppression: 57th Ann. Internat. Mtg., Soc. Expl. Geophys., Expended Abstracts, 141-143.

Hubral, P. and Krey, T., 1980, Interval velocities from seismic reflection time measurements: Soc. Expl. Geophys.

Jones, I. F. and Levy, S., 1987, Slgnal-to-noise ratio enhancement in multichannel seismic data via the Karhunen-Loeve transform: Goophys. Prosp., 35, 12-32.

Kelamis, P. G. and Mitchell, A. R., 1989, Slent-stack processing: First Break, 7, 43-54.

Kelamis, P. G. and Verschuur, D. J., 1996, Multiple elimination strategies for land data: Eur. Assoc. Expl. Geophys. Mtg., Extended Abstracts.

Kennett, B. L. N., 1979, The suppression of surface multiples on sersmic records: Geophys. Prosp., 28, 584-600.

Kostov, C., 1990, Toeplitz structure in slant-stack inversion: 60th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1618-1621.

Levin, F, K. and Shah, P. M., 1977, Peg-leg multiples and dipping reflectors: Geophysics, 42, $957-981$.

Lines, L. R. and Treitel, S., 1984, Tutorial: A review of least-squares inversion and its application to geophysicel problems: Geophys. Prosp., 32, 159-186.

McMechan, G. and Yedlin, M., 1981, Analysis of dispersive waves by wavefield transformation: Geophysics, 46, 869-879.

Morley, L., 1982, Predictive techniques for marine multiple suppression: Ph. D. dissertation, Stanford Univ.

Ottolini, R., 1982, Migration of seismic data in angle-mdpoint coordinates: Ph.D. thesis, Stanford Universty.

Pekeris, C. L., 1948, Theory of propagation of explosive sounds in shallow watcr: Geol. Soc. Am. Mem, 27.

Preas, F. and Ewing, M., 1950, Propagation of explosive sound in a liquid layer overlying a semiinfinite elastic solid: Geophysics, 15, 111-148.

Press, W. H., Flannery, B. P., Teukplsky, S. A. and Vetterling, W. T., 1986, Numcrical Recipes: The Art of Scientific Computing: Cambridge University Press.

Riley, D. C. and J, F. Claerbout 1976, 2-D multiple reflections: Geophysics, 41, 592-620.

Robinson, E. A., 1967, Multıcharmel time series analysis with digital computer programs: HoldenDay.

Robinson, E. A. and Treitel, S., 1980, Geophysical signal analysis: Prentice-Hall, Inc.

Ryu, J. V., 2980, Decomposition of seismic gathers into velocity components by a space-time filter: Presented at the 50th Ann. Internat. Mtg. Soc. Expl. Geophys.

Schultz, P. S. and Glaerbout, J. F., 1978, Velocity estimation by wavefront synthesis: Geophysics, 43, 691-712.

Sengbush, R.L., 1983, Seismic exploration methods: Internat. Human Res. Dev. Corp., Boston.

Sherwood, J. W. C. and Poe, P. H., 1972, Constant-velocity stack and wavelet processing: Geophysics, $37,769-787$.

Taner, M. T., 1977, Simplen - plane-wave stacking: Presented at the 37th Ann. Eur. Assoc. Explor. Geophys. Mtg.

Taner, M. T., 1980, Long-period sea-floor multiples and their attenuation: Geophys. Prosp., 28, $30-48$.

Thorson, J., 1978, Reconstruction of slant stacks: Stanford Exploration Project Report No. 14, 83-91, Stanford University.

Thorson, J. R. and Claerbout, J. F., 1985, Velocity-stack and slant-stack stochastic inversion: Geophysice, 50, 2727-2741.

Treitel, S., 1974, The complex Wiener filter: Geophysics, 39, 169-173.

Treitel, S., Gutowski, P. R., and Wagner, D. E., 1982, Plane-wave decomposition of seismograms: Geophysics, 47, 1375-1401.

Ulrych, T. J., Freire, S. L. and Siston, P., 1988, Eigenimage processing of seismic sections: 58th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abetracts, 1261-1265.

Verschuur, D. J., 1991, Surface-related multiple elimination, an inversion approach: $\mathrm{Ph}$. D. thesis, Delft Univ. of Tech.

Verschuur, D. J. and Berkhout, A. J., 1994, Multiple technology, part 1: Estimation of multiple reflections: 64th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1493-1496

Verschuur, D. J., Berkhout A. J., and Kelamis, P. G., 1995, Estimation of multiple scattering by iterative inversion - part II: examples of marine and land data: 65th Ann. Internat. Mtg., Soc. Expl. Geophys., Expanded Abstracts, 1470-1473.

Verschuur, D. J., Berkhout, A. J, and Wapenaar, C. P. A., 1992, Adaptive surface-related multiple elimination: Geophysics, 57, 1166-1177.

White, R. E., 1984, Signal and noise estimation from seismic reflection data using spectral coherence methods: Proc. IEEE, 72, 1340-1356

Wiggins, J. W., 1988, Attenuation of complex water-bottom multiple by wave equation-based prediction and subtraction: Geophysics, 53, 1527-1539.

Yilmaz, O., 1981, Modeling guided waves in an irregular water layer: Presented at the 5lst Ann. Internat. Mtg. Soc. Expl. Geophys.

Yilmaz, O., 1989, Velocity-stack processing: Geophys. Prosp., 37, 357-382.

## INDEX

Abnormal moveout:

associated with turning waves, 686

Acoustic mpedance: 1808

estrmation, 1863

processing sequence to stimate, 1865

thre-dumengional (3-D), 1872

volume, 1901

Air wave, 81

Aki-Richards equation for AVO, 1816, 2019

Aljes irequency, 3$]$

Amplitude spectrum

two-dmensional, 55,1541

one-dmensional, 26, 153

of a wavelet, 29

Amplitude variation with offset (AVO): 1807, 1814 equations for, 1816,1832

for anisotropic meduum, 1998

Amsotropic dip-moveout (DMO) correction, 1968

Ansotrope meration, 1980

Anostropic velocity analysis, 1965

Anisotropy: 1961

and AVO response, 1998

shear-wave splitting, 1999

elliptical, 1965

weak, 1965

Antualsaging:

in 3-D prestack depth migration, 1333

נn 3-D DMO correction, 1049

Aperture in migration: 502

effect of random nose on, 508

Asymptotic conversion point (ACP), 1946

Asymptotic ray solution, $] 348$

Autocorrelation

and multiple refiections, 209,884

frequency-domain description of, $4 \mathrm{t}$

computation of 40

and Wiener filter, 179

Automatic gan control (AGC), 81

AVO (amplitude variation wth offset), 1814

analysis, 1851

attributes, 1854

crosplots, 1858

equations for, 1816,1832

gradient, 1820

intercept, 1820

interpretation, 1862 inversion, 1827, 2020

processing sequence in relation to, 1839

three-dimensional (3-D), 1863

A verage velocity, 432

Azmuth dependence of moveout velocities, 1036

Azimuth moveout (AMO). 1047

correction for, 1340

Band-pass filtering, 42

Band-reject filtering, 42

Bandwidth-

and filter length, 46

and vertical resolution, 46

Binning of 3-D data; 1019

Birefringence, 1999

Body waves, 1795, 2008

Bortfeld equation for AVO, 1816

Bulk modulus, 1795, 2011

Cable feathering, 1019

Cable nosse, 81,840

Calibration to well tops, 1426

Cascaded migration, 525

Causal wavelet, 176

Cheops' pyramud, 726

Chebychev recursion, 1083, 1201

CMP fold, 93

CMP sorting, 93

CMP stack.

and zero-offeet section, 467

CMP stacking

as \& principle procts, $4,26,91$

effect of charge type, 6

effect of deomgraphic restrictions, 7

effect of near-surface, 6

Coherency inversion 1354, 1369, 1667

appied to $3-D$ seismic data, 1665

ray tracing in, 1443

velocaty resolution in, 1404

Coherent linear noise. 838

and $\mathrm{DMO}$ correction, 716

and slant-stack transformation, 924

dyp filtering of, 905

in the $f-k$ domain, 65,838

Common-conversion-point (CCP): 1933, 1946 binning 1933

Common-midpoint (CMP) gather, 93

Common-mudpoint (CMP) stack, 93

Common-offset section. 93 in relation to DMO correction, 669

Common-offet migration, 728,777

Common-refiection-point gathers 670, 774

and mugration velocity analysis, 788

from 3-D prestack migration, 1121

Common-refiection-point stack, 769

Common-refiection-surface stack, 769

Common-receiver gathers 93

from prestack depth migration, 1285, 1297

Common-shot gather, 93

Complex overburden structures, 1214

Complex Wiener filter, 995

Compressional ( $P$ ) waves, 1795

Compressional-wave velocity:

and confining pressure, 272

and depth of burial, 273

and lithology 273

in dry and saturated rocks, 272

Confictung dips:

and dy-moveout (DMO) correction, 655

associated with fault-plane refections, 657

associated with salt-fiank reflections, $65 \%$

Conjugate gradient method for deconvolution, 1529

Constant phase shift

and change in wavelet shape, 34

Constant time shtit

and linear phasc shift, 34

Constant-velocity migration, 776

Constant-velocity st \&ckın: 290

by Radon transform, 954

Constrained inversion, 1526

Converted waves, 1915

Convolution, 38

conmutativity in, 39

mechanics of, 39

Comvolutional model, 162

in the frequency domain, 170

and random nose, 207

in the time doman, 167

equation for, 168

surface-consistent, 169

Correlation.

as a tume-domain process, 39

of yibrosens data, 41

Coupling of geophones in 4-C recording, 1922

Critical angle of refraction, 377,445

Crosscorrelation:

frequency-doman descruption of, 41

computation of, 40

and Wiener filter, 179

Crossdip, 1029

Gros-equalization in 4-D selsmic, 1912

Crossline direction in 3-D surveys, 1002

Crossline migration, 1129
Crosslune smearing, 1020

Crossplotting in AVO analysis, 1858

Cycles per secand $(\mathrm{Hz}), 26$

Cycles per unt diatance.

(wavenumber), 48

Data modeling: 10,1355

by generalized linear imversion (GLI), 1525

Deconvolution

and random riolse, 207

as a principle process, 4, 26, 91, 159

conjugate-gradient method for, 1529

deterministic, 170, 172, 181

frequency-domain, 233

generalized lmear inverse formalism of, 1626

in the $r$ - $p$ domain, 932

poststack, 222

predictive, 185

prestack, 213

signature, 217

spiking, 180,189

surface-congistent, 262

time-varient, 227

types of, 189

reverse of convolution, 167

statistical, 170,181

Yibroseis, 219

Deep sesmic sounding, 3

Demultiplexing, 91

Depth estimation:

from refracted arrivals, 444

Depth migration: 464, 1224

applied to 3-D poststack dat,n, 1904

applied to 3-D prestack data, 1321

applied to 2-D poststack data, 1238

applied to 2-D prestack data, 1249

of zero-offget dats, 1245

versus time migration, 1244

Depth step suze: 646

in 15-degree finte-difference migration, 520

in frequency-space migration, 537

in frequency-wavenumber migration, 566

in phase-shift migration, 566

Depth structure maps, $142 \overline{5}$

Deregowski loop (iterative residual moveout analysts), 1462

Determinstic deconvolution, 170, 172, 181

Differencing schemes, 488

Diffraction $482,1795,2012$

response in laterally varying media, 1223

Diffraction hyperboln, 482

in the $f$ - $k$ domain, 498

Diffraction term, 490,640

Diffraction surnmation, 484

Diving wrves, 1524

DMO ellipee, 681,826

Dup filtering.
in slent-stack domain, 931

of coherent linear no1se. 905

time-variant, 931

Dup-lune shooting, 1027

Dip-moveout (DMO) correction: 655,820

and coherent linear noise, 716

and fault-plane reflections, 693

and multiple reflections, 705

and reflection-point dispersal, 670

and residual statics corrections 718

and salt-flank reflections, 692

and stacking velocitues, 657

and trace interpolation, 718

and velocity analysis, 662, 677

antsotropic, 1968

appled to 3-D selsmic data, 1009, 1046, 1050, 1720

as part of sequence for prestack time migration, 728

as prestack partial migration, 670

constant-velocity, 674

effect of velocity errors on, 681

frequency-wavenumber method of, 672,821

integral method of, 679

log-atretch method of, 677,823

of diffractions, 674

of dipping events, 676

of PS data, 1959

principles of, 668

processing sequence for, 692

varable-velocity, 684

Dip-moverut operator. $671,730,826$

for $P$-to-S converted data, 1963

Dipping events:

and slant-stack transformation, 924

DMO correction of, 676

mgration of, 47

NMO for, 285

in $t-x$ and $f-k$ domains, 5 ?

Discrete Radon traneform, 943

Dispersion:

of guided waves, 838

Dispersion relation, 489,629

Diving wave, 371

Dix converkion, $1354,1365,1534,1742$

Dix equation, $312,1365,1539$

Double-square-root equation, 632

Downgoing waves: 628

and free-surface multiple attenuation, 990

Downward continuation: 486, 630

of shots and recervers in wave-equation datumng, 1234

$t$-outer scheme for, 491

z-outer scheme for, 491

Earth imagng, 1213

Earth modeling: 10, 1356

by layer-by-layer inversion, 1433, 1445, 1574

by trme-to-depth conversion, 1416 structurodependent, 1354, 1574, 1651

structure-independent, 1354, 1450, 1577, 1678

Earthquake seismology, 1

Eigenimage 891

decomposition for multiple attenustion, 893

Eikonal equation, 1325, 1346

finte-difference solution to, 1349

high-frequency limit in relation to, 1325, 1349

Elastic deformation, 1795

Elrstic modul, 1795, 2006

Elastic wave equation, 2007

Elastic wavefeld modeling, 1790

Engineering seismology, 1

Explicit schemes: 488,646

appled to 3-D poststack migration, 1082, 1200

for frequency-space migration, 493,644

stability of, 493

Exploding reflectors model, 467

Exploding refectors migration operator, 636

Exploration selsmology 1

Fur-field term, 486, 1346

Fast Fourier tranaform (FFT), 27

Field statics corrections, 375

Filtering, 41

Filter coefficients, 41

Filter length, 44

and Gibbs phenomenon, 45

Filter scans, 48

Finite-difference migration: 486

and spatial aliasing, 584, 609

applied to 3-D seismic data, 1074

depth step size in, 520

downward continuation in, 486

differencing schemes in, 488,492

steep-dip, 492

velocity errors in, 525

Firat breats, 374

$f-k$ domsin, 55

mapping of dipping events in, 57

mugration of dipping events in, 496

$f$-k filtcring:

and random noise, 904

and velocity analygis, 911

of linear noise attenuation, 898, 905

$f$-k migration, 494

of dipping events, 496

of diffaction hyperbola, 496

wraparound in, 575

$f-k$ multiple attenuation, $90 ?$

$f$-k plane, 51

$f$-k spectrum, 55

Fluid factor, 1828

Fluid saturation, 1820

Focusing analysis, 798

Fold of coverage 93
in 3-D surveys, 1023, 1034

4-C sestruc method, 1915

4-D seismic method, 1911

Fourier transiorm

defintion of, 25

and addition, 154

and autocorrelation, 154

and convolution, 154

and differentiation, 154

and its relation to $z$-transform, 155

and multiplication, 154

and sceling operation, 154

and shifting operation, 154

computation of 2-D, 58

intcgral of, 153, 156

one-dimensional, 26, 153

theorems, 154

two-dimensional, 48, 156

Fourth-order moveout, 280,437

Fowler's prestack time migration, 803

noindent Fres-surfacc multiple attenuation, 989

Frequency, 26

Frequency filtering, 41

design and application of, 44

Frequency aliasing, 30

Frequency-doman deconvolution. 233

design and application of, 238

theory of, 253

Frequency-space mugration.

and spatial alsaing, 584,609

depth atep alze in, 537

dup Jimits in, 549

expluct schemes for, $493,549,644$

implicit schemes for; $492,535,641$

in practice, 530

velocity errors in, 544, 552

$f-x$ (frequency-space) deconvolution, 966, 995

$f$ - $x$ filter, 995

$f$-x (írequency-space) migration, 492, 530, 641, 644

Frequency-wavenumber DMO correction, 672

Frequency-wavenumber filtering.

and random noise, 904

and statics corrections, 905

of linear noise attenuation, 898,905

Frequency-wavenumber migration: 494, 649

and spetial alissing, 584, 610

depth step size in, 566

dip limits in, 559

in practice, 559

of preatack data, 776,831

phase-shift method of, 498

Stalt method of, 500

velocity errors in, 567

Frequency-wavenumber multiple attenuntion, 907

Gain: as $t$-squared scaling, 85

function, 84

as time-varmant scaling, 81

as rms amplitude AGC, 85

as instantaneous AGC, 87

Fresnel zone, 1803

Gapped deconvolutıon, 185

Gardner's denaity relation, 1798

Gause's divergence theorem, 1343

Generalized recuprocal method, 379

Generalized linear inversion (GLI)- 1525

applicd to reflection traveltime tomography, 1552

appled to surface-consistent deconvolution, 1530

for discrete Radon transformation, 943, 984, 1534

formalism of deconvolution, 1526

for refraction statics corrections, 448, 1532

for residual statics corrections, 444, 1531

Geometric spreading correction, 81

Gubbs phenomerion, 45

Goupulfad earth model, 167

Goodway et al inversion for AVO, 1833, 2022

Gradient (AVO attribute), 1820

Green's function, 1344

Green's theorem, 1345

Gridding, 1543

Ground roll: 69

backscattered component of, 69

Group velocity, 1963

Guided waves: 70

analysis of, 977

Half-space velucity analyase, $1415,1609,1647$

Head wave: 371

in relation to erkonal equation, 1328

Hertz (cycles per second), 26

High-cut filtering, 42

High-frequency limit, 1325, 1349

Hilbert transform, 254

Hooke's law, 1795, 2007

Horizon velocity analysis, 312

Huygens' secondary source, 482

Huygens' principle 1343

spplied to anisotropic medium, 1967

Hyperbolie moveout, 274

Hyperbolic Radon transform, 943, 984

Image gathers, 1355, 1406, 1461, 1695, 1746

and multiples, 1618

model veriflcation by, 1563

residual moveout analyses of, 1462,1756

Imaging beneath.

shallow gas anomalies, 1620

volcanics, 1597

Imaging principle, 472

Image rays, 1226, 1238, 1243

map migration by, 1425, 1674

time-to-depth conversion by, 1425

Impedance contrast, 1809

Implicit schemes, 489, 646

rational approximations for, 489

for frequency-space migration, 492, 535, 641

applied to $3-\mathrm{D}$ poststack migration, 1074, 1198

Impulse response. 36

of a dip-moveout operator, 681

of a migration operator, 484

of 15-degree operator, 520

of implucit schemes, 537

of phase-shift migration operator, 565

of prestack time migration operator, 730

of reverse time muration operator, $\mathbf{5 3 5}$

of 3-D implicit schemes, 1074

Inline direction in S-D surveys, 1002

Instantajueous AGC, 87

Instantaneous attributes, 1896

Integral DMO correction, 679

Interactive velocity analysis, 311

Intercept (AVO attribute), 1820

Interpretation of seismic data, 18,1156

removal of opacity in, 1158

seed detection applied to, 1159

structural, 1161

use of 3-D visualsation in, 1156

use of time slices in, 1156

volume based, 1690

Interval velocrty estmation:

by Dix conversion, 1365, 1417

by coherency inversion, 1369

by half-space analysı, 1415

by image-gather analysis, 1406

by stacking velocity inversion, 1392

effect of near-surface layer in, 1382

Inverse filter: 171

design and application of, 172

least-squares, 173

theory of, 252

Inverse $Q$ filtering, 234

theory of, 266

Inverse of the source wavelet, 172, 251

Inversion.

broad meaning, 10

for data modeling, 10

for earth modeling, $10,1356,1450$

narrow meaning, 10

of selsmic data, 10

to zero-offset (IZO), 1048

Irregular water bottom: 1233

imaging benerth, 1597

Lsotropic sold 1965

elastic wrve equation for, 2008

Isotropy, 1961

Iteratuve depth migration, 1247

Karhunen-Loeve transform: 887 decomposition to elgenimages by, 891

## $K$-filtering

to avoid spatiol alusing, 58

$K-L$ transform, 887

Kirchhoff integral, 1343

Kirchhoff migration, 481

amplitude and phase factors for, 485

and Huygens' secondary source, 482

and point source, 482

and spatial aliasing, 582609

aperture in, 502

maximum dip limit m, 509

of prestack drta, 788

of 3-D selsmic data, 1073

velocity errors in, 509

Kirchhof summation, 485

aperture for, 502

applied to 3-D poststack migration, 1073

applied to 3-D prestack migration, 1324

far-field term in, 485

rho filter in, 486

Klauder wavelet, 219

Kunetz seismogram, 167

Lame's constants, 1795, 2005

Laplace transform

applied to 3-D explicit schemes, 1083

Lateral resolution, 1803

Lateral velocity variations, 1222

Layer stripping (layer-by-layer earth riodeling), 1433, 1445, 1574

Layer replacement, 1226

poststack, 1230

prestack, 1231

Layer velocity esturnation.

by Dix conversion, 1365

by coherency inversion, 1369

by half-space analysis, 1415

by Imago-gather analysis, 1406

by stackung velocity inversion, 1392

effect of near-surfice layer in, 1382

Layer velocities, 1356

Least-square inverse filter, 173

Least-oquares method

for residual statics corrections, 342

for refraction statics corrections, 379

Levinson recuraion, 259

Linear moveout. 923, 938

associated with refracted arrivals, 380,450

Linear noisc, 838

Linear superposition, 38

linear uncorreiated noise attenuation, 960

L1's correction in 3-D poststack migration, 1203

$L_{1}$-norm refraction statics, 456

$L_{1}$-norm residual statics, 458

Log-stretch DMO correction, 677, 823

Long-wavelength statics anomalies, 370

Low-cut fitering, 42

Map mugration, 1356, 1425

Map processing, 1539

Marquardt's damping factor, 1526

Maxjmum-energy summation in 3-D prestack depth mugration, 1331

McClellan transform, 1082, 1202

Migration:

algorithms, 471, 501

and edre effects, 620

and line length, 621

and random noise, 619

and spatial alesing, 581

anisotropic, 1980

aperture in 2-D, 502

aperture in 3-D, 1010

as a principle process, 4, 26, 91, 463

boundary and intual conditions for, 490

from topography, 626

horizontal displacement in, 478

in the $\tau$-p doman, 982

of dippisg events, 477

of $P S$ data, 1961

of synclines and anticljnes, 480

of 3-D seismic data, 1073

strateges, 470,1322

treatmeit of multiple reflections by, 857

velocities, 475

vertical diaplacement in, 478

Migration veloctty analysis: 775

applyed to $3-\mathrm{D}$ eeismic data, 1131

by common-offset migration, 777

by Kirchhoff summation, 788

by prestack Stolt migration, 776

by wavefield extrapolation, 833

using common-reflection-point gathers, 788

Migration velocity field, 788

Mnimum delay, 178

Mimmum phase: 175

and causality, 176

Mintmum-distance summation in 3-D prestack depth migration, 1331

Minimum-time summation in 3-D prestack depth migration, 1331

Minue time in refraction theory, 378,447

Mixed phase, 178

Modeling:

elast $I c$ wavefield, 1 T90

nonzero-offset wavefield, 1781

zero-offset traveltame, 468,1780

zero-offset wavefield, 1223,1781

Model representation and visualization: 1360

triangulation in relation to, 1362

tessellation in relation to, 1363

Model updating: $\mathbf{1 4 5 0}$

appled to \&-D sessmic data, 1678 by refection traveltime tomography, 1469

by residual moveout analyses of inage gathers, 1462

Model verification, 1563

Modulus of rigdity, 1795

Mudrock line, 1828

Multicable recording in 3-D marune surveys, 1018

Multicomponent recording, 1919

Multiple attenuation: 837

by $f-k$ filtering, 898

by $K-L$ transform, 887

by modeling, 897

by predictive deconvolution, 209, 874

by Radon transtorm, 953

by $\tau-p$ deconvolution, 932

by velocity discrumination, 887

freesurface, 989

water-bottom, 992

Multiple reflections: $81,167,838$

and autocorrelogram, 884

and DMO correction, 705

and mage gathers, 1618

and migration, 857

and velocity analysis, 861

in Radon-transform domain, 952

in slant-stack domain, 924

periodicity of, 877

types of, 856

Multiplexed data, 91

Mute compensation, 308

Muting, 285

Near-field term, 1346

NMO stretching, 283,440

Noah's deconvolution, 991

Noise attenuation, 837

by $f-x$ deconvolution, 966,995

Normal-incidence rays, $468,1238,1242$

Nonhyperbolic moveout: 1232,1235

associated with anisotropy, 1966

esgociated with lateral velocity variations, 1214

asgociated with $P$-to-S conversion, 1956

Nonstationarity, 167, 222

Nonzero-offset traveltime equation, 725,827

Nonzero-offset wavefield modeling, 1781

Normal modes, 978

Normal moveout (NMO): 274, 630

for a dipping reflector, 285,442

for a flat reflector, 274

for a horzontaliy layered earth, 280

for anisotropic medum, 1966

for a 3-D dopping refiector, 1036

for layers with arbitrary dips, 287

function of offset, velocaty and time, 280, 288

in relation to dyp-noveout (DMO), 656

Normal-moveout correction: 279

d.p-dependent, 669
dip-mdependent, 669

Normal-moveout velocity: 274

versus stacking velocity, 288

Nyquist frequency, 29

Nyquist wqvenumber, 48

OBC (ocean-bottom cable), 1917

Obliquity factor, 485

Omega-x (frequency-apace) migration, 492

One-pass 3-D mugration, 1074, 1199

One-way wave equation, 489

noindent Opacity, 1158, 1714, 1773

Operator allasmg, 609

Operator length

in frequency filtering, 44

in predictive deconvalution, 190

Overcorrection in normal-mioveout, 280

Parabolic approxination to wrve equation, 639

Parabolic equation, 490,639

Parabolic moveout, 944

Paraboluc Radon transform, 944, 987

Parseval's theorem, 154, 178

Parsimony in processing, 124

Period, 26

Phase-lag, 26

Phase-shift migration: $498,629,649$

and spatial aliasing, 584,610

applied to 3-D selsmic data, 1203

impulae response of, 565

depth btep suze II, 566

vclocity errors in, 567

Phase-shift-plus-correction. migration by, 1088

Phase spectrum, 153

of a wavelet, 29 .

Phase rotation, 34 and change in polarity, 35

Phase velocity, 1963

Plane-wave decomposition

and slant-stack transform, 921

and 2-D Fourier transform, 55

Plus-minus method, 377

Plus time in refraction theory, 378,447

Point diffractor: 1223

and Kirchhoff migration, 483, 1344

and downward continuation, 487

Pont source, 482

Poison's ratio. 1795, 2005

and fluid saturation, 1820

and $V_{P} / V_{S}$ ratio, 2011

Polarity, 35

Poststack deconvolution, 222

Poststack depth migration, 1224

applied to 2-D seismc data, 1238, 1356

applied to 3-D seismic data, 1304

Poststack laver replacement, 1230
Poststack migration, 470

Power-line interference, 81

$P P$ section, 1922

PS section, 1922

Prediction error filter 186, 262 design and spplication of, 189

Prediction filter 186, 260

complex 995

design and spplication of 188

for noise attenuation, 966

Prediction lag

in predictive deconvolution, 185, 193

Predictive deconvolution

by Wiener filtering, 185

in practice, 190

multiple attenuation by, 209

operator length in, 190

percent prewhitening in, 203

prodictuon lag in, 193

theory of, 260

Prestack amplitude inversion, 1827, 1851, 2019

Prestack deconvolution, 213

Prestack depth migration: 1273, 1357

shot-geophone method of, 1274

shot-profile method ot, 1280

Prestack $f-k$ migration, 770,831

Prestack imaging (PSI), 728

Prestack layer replacement, 1231

Prestrack migration, 470

Prestack partial migration, 670

Prestack Stolt migration, 776

Prestack time migration. 725

by Kirchhoff summation, 788

ellipse for, 828

for AVO analysts, 1848

frequency-wavenumber technique for, 831

Fowler's velocity-independent, 803

of common-offet data, 728

of fault-plane retelctions, 742

of salt-fiank refiections, 729

operator for, 731

summation technques for, 726,829

Prewhitening, 255

in deconvolution, 181, 203

Primary reflections, 70, 167

Princuple of superpasition

applied to deconvolution, 167

spplied to migration, 469

Processing of sesmic data, 4

Progranmed gain control, 85

P-to-S corversion, 1813, 1915

$P$ (compressional) waves, 1795

$P$-wave impedance, 1831

$P$-wave refiectivity, 1816

$P$-wave velocity 2009
and confining pressure, 272

and depth of burial, 273

and lithology, 273

in $\mathrm{dry}$ and saturated rocks, 272

$Q$ fietor, 225

Quality control in processing, 122

Radial component in 4-C seismle, 1926

Radon transform: 932,982

and generalized linear inversion, 984

hyperbalic, 943, 984

multiple attenuation, 953

parabolic, 944, 987

Random nose, 81, 876

and convolutional model, 168

and $f-k$ filtering, 904

and mugration, 619

attemation of, 837,995

mogration aperture in the presence of, 508

Ray parameter, 922

Rnypath, 2012

Ray tracing

in coherency inverson, 14d3, 1451

in traveltime calculation for prestack depth migration, 1324

Ray velocity, 1963

Reflections, 70, 1795, 1808, 2012

Reflection coefficient. 1864

and 1 -D seismogram, 165

sertes, 165

Reflection-point disperan]. 670, 817 assocsated with transverse 15otropy, 1966 for a 3-D dipping reflector, 1047

Refiection traveltime toriography, 1469, 1545

Reflectivity;

as a tandom process, 171

serves, 167

Reflector curvature, 1813

Reflector geometries, 1356

Refractions, $375,1795,1808,2012$

from a flat interface, 375,445

from a dipping interiace, 377,446

Refraction statics corrections: 370

apphed to 3-D data, 1036

by generalized linear inversion, 449

by generalized-reciprocal method, 379

by least-squares method, 379

by $L_{1}$-norm minimuzation, 457

by plus-minus method, 377

by tomagraphy, 454

Refraction traveltime tomography, 453

Relative trace balancing, 90

Remez exchange algorithm, 645, 1083

Reservoit characterization, 1794

Reservoir montoring, 1794, 1913

Residual migration, 575, 651

Residual moveout unalysis of image gathers, 1462
Residual statics corrections: 324

find DMO correction, 718

and velocity analysis, 336

applied to 3-D data, 1050

by generalized linear inversion, 444

by stack-power maximization, 365

by traveltime decompos:tion, 345

processing sequence for, 381

surface consistent, 341

Residual statics estimation:

by least-squares method, 342

by $L_{1}$-norm minimization, 458

by stack-power maximation, 344

by traveltime decomposition, 336,443

correlation window for, 361

effect of moveout errors in, 365

Gauss-Seidel method for, 343

maximum allowable sluft in, 346

Reverberations, 843

Reverse time migration, 491,530

Rho filter

in Kirchhoff summation, 486

in slant-stack transformation, 923

RMS amplitude AGC, 85

RMS velocity: 280

estimated from prestack time migration, $776,1131,1720$

Rotation of geophone components in 4-C selsmic, 1926, 1945

Seed detection, $1159,1707,1716$

Semblance: 301

in coherency inversion, 1381, 1402, 1442

Seismic ansotropy, 1961

Seismic impedance, 1808

Seismic method, 1

Seismic monitoring, 22

Seismic resolution: 1801

vertical, 1801

lateral, 1803

Seismic wavefield, 470

Seismic waves, 1795,2008

Separation versus splitung:

in 3-D nigration, 1074, 1199, 1314

Shallow seismic method, 3

Shaping filter, 183

Shear (5) waves, 1795

Shear-wave splitting (birefrungence), 1990

Shear-wave velocity.

and confining prossure, 272

in dry and satursted rocks, 272

Shifted hyperbola, 283, 437

Shift term, 498

Shortest-path summation in 3-D prestack depth migration, 1331

Short-wavelength statics anomalies, 370

Shot-geophone migration, 633,1274

Shot-profile migration, 1280

Shuey equation for AVO, 1818

Side-scattered nojse, 81, 838

Sideswipe energy, 1003

Signal.

analog versus digital, 28

analysis of, 24,27

synthesis of, 24,27

time-dependent, 27

Signature deconvolution, 217

Slant streck. 920

and plane waves, 920

multiple attenuation, 932

practucal aspects of, 924

physical aspects of, 920

transformation, 923

Small-dip approximation:

in NMO correction, 287

in migration, 490

Small-spread hyperbola, 280

Smith and Gidiow inversion for AVO, 1824, 2020

Snell wave, 922

Snell's law, 1535, 2016

Solıd model, 1431, 1718

Sonic log.

and 1-D selsmogram, 162

Source waveform, 16 '

inverse of, 172, 251

Sparse-spike reflectivity, 1872,1900

Spatral aliasing.

and 3-D DMO correction, 1049

and migration, 581,1017

defintion of, 51

of dipping everits, 64

and threshold frequency, 65

ways to avord, 56

Spatial frequency, 48

Spatial predsction filter:

apphed to random nolse attenuation, 966,995

appled to trace interpolation, 1065, 1204

Spectral decomposition, 255

Spectral whitening, 231

Spherical spreading factor, 485

Spiking deconvolution:

and munum phase, 178

by Wiener filterng, 180

as special case of predictive deconvolution, 189

theory of, 258

Stab]e filter, 178

Stable extrapolation, 493, 644

Stacking chart, 93

Stacking operator, 636

Stacking velocity:

and dop-moveout correction, 657

for a $3-D$ dipping reflector, 1045

versus normal-moveout velocity, 288

Stackng velocity inversion. 1354, 1392 applied to 3-D seismic data, 1674

Stack-power maximization.

for residual statics corrections, 365

Stationary a1gnal, 167, 222

Statics corrections 325

and $f$-k filtering, 905

Stationary phase method

to derive traveltume equations, 638

to deruve the equation for DMO ellipsc, 826

Statistical deconvolution, 170, 181

Steep-dip mugration, 535, 549, 641

Stepout, 51, 922

Stiffness matrix, 1965

Stolt migratson. 500,649

applied to prestack data, 776

three-dimensional, 1204

Stolt stretch, 501, 572, 650

Strain. 1794, 2001

compressional, 2003

extensional, 2003

normal, 2002

shear, 2004

Stratigraphic interpretation, 1171, 1744

Stres. 1794, 2001

compressional, 1794, 2001

normal, 1794, 2001

shear, 1794, 2001

tensional, 1794, 2001

tensor, 2001

Stretching caused by NMO correction, 283, 440

Stretch factor for Stolt migration, 501, 572, 650

Strika-line shooting, 1027

Structurally consistent earth modeling, 1742

Structural interpretation, 1161, 1744

Structural inversion: 1557

three-dimensional, 1626, 1651, 1674, 1703

Structure-dependent earth modeling, 1354, 1574

Structure-independent earth modeling, 1354, 1450, 1577

Subsalt itnaging, 1558, 1574, 1626, 1651

Surface-consistent

convolutional model, 169

deconvolution, 262

Surface waves, 1795, 2008

Survey design in 3-D selamic exploration, 1010

Swath recording in 3-D land surveys, 1028, 1031

$S$ (shear) whves, 1795

$S$-wave impedance, 1831

$S$-wave reflectivity, 1816

$S$-wave velocity 2010

and confining pressure, 272

in dry and saturated rocks, 272

Swell noise, 838

Synthetic sessmogram 249

and convolutional model, 168

in relation to amplitude inversion, 1874

Synthetic sonic loge, 1864

$\boldsymbol{r}-\boldsymbol{p}$ domain 923

multiple attenuation, 932

$\boldsymbol{\tau}-\boldsymbol{p}$ fiter, 931

Temporal frequency, 48

Tessellation in earth modeling, 1363,1631

Thn-lens term, 490, 640

Three-dimensional DMO corroction: 1009, 1046, 1050, 1720 spatial aliasing in, 1049

Three-dimensional migration: 470, 1005, 1051 velocity analysis, 1131

Three-dimensional poststack mugration 1073

by phese-shift method, 1203

by Stolt method, 1204

explicit schemes applied to, 1082,1200

implicit schemes applied to, 1074, 1198

Kirchhoff summation applied to, 1073

Li's correction applied to, 1203

phase-shift-plus-correction applied to, 1088

separation and splitting in, 1199

tume versus depth, 1304

two-pass versus one-pass, 1074

Three-dmensional poststack depth migration, 1304, 1665

implicit versus explicit, 1314

summation strategies in: 1331

traveltme calculations in, 1324

versus time migration, 1304

Three-dimensional prestack time migration: 1099, 113 ?

common-offset, 1112,1720

crossline method for, 1129

Three-dimensional prestack depth mugration: 1321 common-offset method of, 1335,1757

Kirchhoff summation applied to, 1324

migration aperture in, 1333

operator antıahasing $\mathrm{m}, 1333$

traveltime calculation in, 1324

Three-dimensional refraction statics corrections, 1036

Three-dimensional residual statics corrections, 1050

Threedimessional nsualization, 1156

Threshold for velocity-depth ambiguty, 1553

Tume-lapse (4-D) sejsmic, 1912

Time migration: 464,1223

of zero-offet data, 1245

versus depth migration, 1244

Time series, 20

Time slices:

before and after 3-D migration, 1056

Time structure maps, 1416

Time-to-depth conversion, 1416

by map migration, 1425

by vertical stretch, 1356

Time-variant deconvolution, 227

Time-variant dp filtenng, 931

Time-variant DMO correction, 684

Time-variant fltering, 48
Time-variant scaling, 81

Time-variant spectral whitening, 231

Toeplitz matrix 180,253

form in Radon transform, 985

form in complex Wiener filter, 998

Tomography:

generalized linear inversion (GLI) applied to, 1474

limitations in resolving velocity-depth ambiguity by, 1479

model updating by, 1469

reflection traveltime, 1469,1545

turning-ray, 1512

Trace balancing, 89

Trace editing, 92

Trace equalization, 89

Trace interpolation:

and DMO correction, 718

and spatial aliasing, 57

by spatial prediction filters, 1065, 1204

Transverse component in 4-C seismuc, 1926

Transverse sotropy (TI), 1961

Traveltime decompastion:

for residual statics corrections, $\mathbf{3 3 6 , 4 4 3}$

Traveltime calculation in 3-D prestack depth migration: 1324

eikonal equation appled to, 1325

Fermat's principle applied to, 1331

wayefront construction applied to, 1331

Traveltime equation:

associated with double-square-root equation, 638

derivation by stationary phase approximations, 638

for 3-D nonzero-offet recording geometry, 1208

for zero-ofiset recording geometry, 638

Tringulation in earth modcling. 1362,1636

$t$-squared gain, 85

$t^{2}-x^{2}$ velocity analysis, 289

Turing thickness, 1800

Turning rays, 689

Turning-ray tomography, 1512

Turning-wave reflections: $\mathbf{6 6 5}$ processing for, 685

Turning-wave migration: 685

Two-pass 3-D migration, 1074

Unconstrained inversion, 1526

Undercorrection in normal-moveout, 280

Undersarnpling, 34

Upcoming waves: 467,628

and downward contimuation, 486,630

and free-surface multiple attenuation, 990

Velocity analys.s 288

and DMO correction, 662

and statics, 304

anisotropuc, 1965

constant-velocity stack, 290

of PS dation, 1946

of 3-D selsmic data, 1050

$t^{2}-x^{2}, 289$
using velocity spectrum, 295

Velocity field, 14

Velocity-density relatuon, 1797

Velocity-depth ambiguity 14, 1357

threshold for, 1553

Velocity-depth model, 14

Velocity errors:

and DMO correction, 681

and 15-degree finite-difference migration, 525

and frequency-space migration, 544, 552

and frequency-wavenumber mugration, 567

and Kirchhoff mugration, 509

and phase-shift mugration, 567

senstivity of image accuracy to, 1280

Velocity-independent prestack tume mgration, 803

Velocity spectrum. 292

and $f-k$ filtering, 911

and multiples, 887

effect of mute on, 308

effect of offet range on, 305

effect of partial stacking on, 305

effect of random noise ${ }_{0}, 306$

effect of statics on, 304

measure of coherency used in, 295

factors affecting, 302

Velocity-atack gather, 938

Velocity-itack operator, 948

Velocity-stack transformation, 842

Vertical resolution. 1801

Vertucally transverse isotropy (VTI), 1965

Vertucal seismic profiling (VSP), 1907

Vertical stretch, 1356

Vibrosels correlation, 41, 219

Vibroseis deconvolution, 219

Vibroseis sweep signal, 41, 219

Volume-based interpretation, 1690

$V_{P} / V_{S}$ ratio, 1799,2011

VSP (vertical sesmic profiling): 1907

acquisition geometry, 1907

processing, 1907

VSP-CDP transform, 1908

Water-bottom multuple attenuation, 992

Wave-equation datuming. 1228

applied to wavefield modeling, 1782

three-dimensional poststack, 1321

Wavefield extrapolation 628 and migration velocity analysis, 833

in the $\tau-p$ domain, 980

Wavefield modeling, 629

Wavefront divergence: 167

and geometric spreading correction, 81

Wavelength, 1801

Wavelet.

and nonstationarity, 167

as a time-depentents signal, 34

minimum-phase, 176

realizabie and causal, 176

shape and phase spectrum, 36

Wavelet processing, 183

Wavelet shaping factor, 485

Wavefront, 2012

Wavefront constrtiction, 1331

Wavefront velocity, 1963

Wavenumber. cycles per unit distarice, 48

White noise: In deconvolution, 181

Whener filters. 179

complex, 995

equation for, 180

design and application of, 180

theory of 255

Wiener-Levison algorithm, 180

Wrapround in $f-k$ migration, 575

Young's modulus, 1795,2005

Zero-oftset

depth migration, 1223, 1245

section associated with a pont diffractor, 1223

time migration, 1223, 1245

traveltime modeling, 1779

traveltime section, 468,1359

in relation to DMO correction, 655

wavefield modeling, 1781

wavefield sectson, 1239,1789

Zero-offset traveltime equation 638

as special case of nonzero-sfset traveltme equation, 726

Zero phase 34

frequericy filter, 44

Zoeppritz equations, 1811, 2014

$z$-transform 155

of a wavelet, 172

